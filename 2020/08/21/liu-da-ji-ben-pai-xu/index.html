<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"bubbleboy11.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.6.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="排序算法 Sorting algorithm是一种能将一串数据依照特定顺序进行排列的一种算法。进行从小到大进行排序，内置排序函数sort() 在平均情况下，快速排序最快；在最好情况下，插入排序和起泡排序最快；在最坏情况下，堆排序和归并排序最快。 排序算法的分析  排序算法的稳定性：如果在对象序列中有两个对象 r[i]和r[j] ,它们的排序码 k[i]&#x3D;&#x3D;k[j] 。如果排序前后,对象 r[i]和">
<meta property="og:type" content="article">
<meta property="og:title" content="六大基本排序">
<meta property="og:url" content="https://bubbleboy11.github.io/2020/08/21/liu-da-ji-ben-pai-xu/index.html">
<meta property="og:site_name" content="外心人D的博客">
<meta property="og:description" content="排序算法 Sorting algorithm是一种能将一串数据依照特定顺序进行排列的一种算法。进行从小到大进行排序，内置排序函数sort() 在平均情况下，快速排序最快；在最好情况下，插入排序和起泡排序最快；在最坏情况下，堆排序和归并排序最快。 排序算法的分析  排序算法的稳定性：如果在对象序列中有两个对象 r[i]和r[j] ,它们的排序码 k[i]&#x3D;&#x3D;k[j] 。如果排序前后,对象 r[i]和">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://bubbleboy11.github.io/2020/08/21/liu-da-ji-ben-pai-xu/..%5C%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%5C%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84.gif">
<meta property="og:image" content="https://bubbleboy11.github.io/2020/08/21/liu-da-ji-ben-pai-xu/..%5C%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%5C%E5%BF%AB%E6%8E%92%E6%95%B0%E7%BB%84%E5%89%8D%E5%90%8E%E5%8F%8C%E6%8C%87%E9%92%88.jpg">
<meta property="og:image" content="https://bubbleboy11.github.io/2020/08/21/liu-da-ji-ben-pai-xu/%E6%8E%92%E5%BA%8F%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%AF%94%E8%BE%83.jpg">
<meta property="og:image" content="https://bubbleboy11.github.io/2020/08/21/liu-da-ji-ben-pai-xu/%E6%8E%92%E5%BA%8F.png">
<meta property="og:image" content="https://bubbleboy11.github.io/2020/08/21/liu-da-ji-ben-pai-xu/%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8.jpg">
<meta property="og:image" content="https://bubbleboy11.github.io/2020/08/21/liu-da-ji-ben-pai-xu/..%5C%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%5C%E6%8E%92%E5%BA%8F%E9%93%BE%E8%A1%A8%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%EF%BC%88%E9%80%92%E5%BD%92%E6%B3%95%EF%BC%89.png">
<meta property="og:image" content="https://bubbleboy11.github.io/2020/08/21/liu-da-ji-ben-pai-xu/..%5C%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%5C%E6%8E%92%E5%BA%8F%E9%93%BE%E8%A1%A8%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%EF%BC%88%E4%BB%8E%E5%BA%95%E8%87%B3%E9%A1%B6%E7%9B%B4%E6%8E%A5%E5%90%88%E5%B9%B6%EF%BC%89.png">
<meta property="article:published_time" content="2020-08-20T16:21:41.000Z">
<meta property="article:modified_time" content="2021-05-10T01:55:30.058Z">
<meta property="article:author" content="外心人D">
<meta property="article:tag" content="剑指offer">
<meta property="article:tag" content="排序">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://bubbleboy11.github.io/2020/08/21/liu-da-ji-ben-pai-xu/..%5C%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%5C%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84.gif">


<link rel="canonical" href="https://bubbleboy11.github.io/2020/08/21/liu-da-ji-ben-pai-xu/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://bubbleboy11.github.io/2020/08/21/liu-da-ji-ben-pai-xu/","path":"2020/08/21/liu-da-ji-ben-pai-xu/","title":"六大基本排序"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>六大基本排序 | 外心人D的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="外心人D的博客" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">外心人D的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95-Sorting-algorithm"><span class="nav-text">排序算法 Sorting algorithm</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F-Bubble-Sort-%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="nav-text">1.冒泡排序 Bubble Sort （了解）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F-Insertion-Sort-%EF%BC%88%E7%86%9F%E6%82%89%EF%BC%89"><span class="nav-text">2.插入排序 Insertion Sort （熟悉）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F-Selection-sort-%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="nav-text">3.选择排序 Selection sort （了解）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F-Shell-Sort%EF%BC%88%E4%B8%8D%E5%BB%BA%E8%AE%AE%E5%A4%9A%E8%8A%B1%E6%97%B6%E9%97%B4%E4%BA%86%E8%A7%A3%EF%BC%89"><span class="nav-text">4.希尔排序 Shell Sort（不建议多花时间了解）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84"><span class="nav-text">排序数组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F-Merge-Sort-%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89"><span class="nav-text">5.归并排序  Merge_Sort （重点）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F-Quick-sort"><span class="nav-text">6.快速排序 Quick sort</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%95%E4%B8%80"><span class="nav-text">法一</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E9%80%92%E5%BD%92-%E6%8E%A8%E5%AF%BC%E5%BC%8F%E5%86%99%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F"><span class="nav-text">使用递归+推导式写快速排序</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%84%E7%A7%8D%E6%8E%92%E5%BA%8F%E7%9A%84%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%AF%B9%E6%AF%94%EF%BC%9A"><span class="nav-text">各种排序的复杂度对比：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%97%E6%B3%95%E6%89%A7%E8%A1%8C%E7%9A%84%E6%97%B6%E9%97%B4%EF%BC%9A"><span class="nav-text">算法执行的时间：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F%E7%9A%84%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8%EF%BC%9A"><span class="nav-text">排序的内存使用：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#148-%E6%8E%92%E5%BA%8F%E9%93%BE%E8%A1%A8"><span class="nav-text">148. 排序链表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A0%86-Heap-%E6%98%AF%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E4%B8%AD%E4%B8%80%E7%B1%BB%E7%89%B9%E6%AE%8A%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%9A%84%E7%BB%9F%E7%A7%B0%EF%BC%8C%E4%B8%80%E8%88%AC%E8%AE%A8%E8%AE%BA%E7%9A%84%E5%A0%86%E9%83%BD%E6%98%AF%E4%BA%8C%E5%8F%89%E5%A0%86%E3%80%82"><span class="nav-text">堆(Heap)是计算机科学中一类特殊的数据结构的统称，一般讨论的堆都是二叉堆。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A0%86%E6%8E%92%E5%BA%8F%EF%BC%9A%E5%88%A9%E7%94%A8%E5%A0%86%E7%9A%84%E6%A6%82%E5%BF%B5%E6%9D%A5%E6%8E%92%E5%BA%8F%E7%9A%84%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F%E3%80%82%E5%85%88%E5%B0%86%E5%BE%85%E6%8E%92%E5%BA%8F%E7%9A%84%E5%BA%8F%E5%88%97%E5%BB%BA%E6%88%90%E5%88%86%E4%B8%BA%E4%B8%A4%E7%A7%8D%EF%BC%9A"><span class="nav-text">堆排序：利用堆的概念来排序的选择排序。先将待排序的序列建成分为两种：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Python-%E9%87%8C%E7%9A%84-heapq-%E6%A8%A1%E5%9D%97"><span class="nav-text">Python 里的 heapq 模块</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Top-K-%E9%97%AE%E9%A2%98"><span class="nav-text">Top K 问题</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">外心人D</p>
  <div class="site-description" itemprop="description">本博客大多内容为慕课和网上博客，并非原创</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">343</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



          </div>
        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/liu-da-ji-ben-pai-xu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          六大基本排序
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-10 01:55:30" itemprop="dateModified" datetime="2021-05-10T01:55:30Z">2021-05-10</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="排序算法-Sorting-algorithm"><a href="#排序算法-Sorting-algorithm" class="headerlink" title="排序算法 Sorting algorithm"></a>排序算法 Sorting algorithm</h1><p>是一种能将一串数据依照特定顺序进行排列的一种算法。<br>进行从小到大进行排序，内置排序函数<code>sort()</code></p>
<p>在平均情况下，快速排序最快；<br>在最好情况下，插入排序和起泡排序最快；<br>在最坏情况下，堆排序和归并排序最快。</p>
<p>排序算法的分析</p>
<ol>
<li>排序算法的稳定性：如果在对象序列中有两个对象 r[i]和r[j] ,它们的排序码 k[i]==k[j] 。如果排序前后,对象 r[i]和 r[j] 的相对位置不变，则称排序算法是稳定的；否则排序算法是不稳定的。</li>
<li>时间开销：排序的时间开销可用算法执行中的数据比较次数与数据移动次数来衡量。算法运行时间代价的大略估算一般都按平均情况进行估算。对于那些受对象排序码序列初始排列及对象个数影响较大的，需要按最好情况和最坏情况进行估算3. 空间开销：算法执行时所需的附加存储。</li>
</ol>
<h2 id="1-冒泡排序-Bubble-Sort-（了解）"><a href="#1-冒泡排序-Bubble-Sort-（了解）" class="headerlink" title="1.冒泡排序 Bubble Sort （了解）"></a>1.冒泡排序 Bubble Sort （了解）</h2><p>首先是每次比较两个相邻的元素，当左面的大于右面的时候，进行互换位置，当小于的时候，都不动。<br>它重复地遍历要排序的数列直到没有再需要交换，该数列已经排序完成。<br>这个算法的名字由来是因为越小的元素会经由交换慢慢”浮”到数列的顶端，大的向下沉。</p>
<p>外层循环每一次经过两两比较，把每一轮未排定部分最大的元素放到了数组的末尾；<br>「冒泡排序」有个特点：在遍历的过程中，提前检测到数组是有序的，从而结束排序，而不像「选择排序」那样，即使输入数据是有序的，「选择排序」依然需要「傻乎乎」地走完所有的流程。<br>一趟排序完成后，则无序区减少一个数，有序区增加一个数</p>
<p>冒泡排序算法的运作如下：</p>
<ul>
<li>比较相邻的元素。如果第一个比第二个大（升序），就交换这两个。</li>
<li>对每一对相邻元素作同样的工作，从开始第一对到结尾的最后一对。这步做完后，最后的元素会是最大的数。</li>
<li>针对所有的元素重复以上的步骤，除了最后一个。</li>
<li>持续每次对越来越少的元素重复上面的步骤，直到没有任何一对数字需要比较。<br>时间复杂度 O(n^2)<br>空间复杂度：O(1) 用到常数个临时变量。<br>稳定性：稳定</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bubbleSort</span>(<span class="params">array</span>):</span></span><br><span class="line">    <span class="comment"># 遍历所有数组元素，每一个都要找到没排好序的最大值</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(array)):  <span class="comment"># 第i趟  </span></span><br><span class="line">    <span class="comment"># for i in range(len(array) - 1):  # 第i趟，减去1也不影响</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(array) - i - <span class="number">1</span>):</span><br><span class="line">            <span class="comment"># j 表示每次遍历需要比较的次数，是逐渐减小的</span></span><br><span class="line">            <span class="comment"># 将 没有排好序的数组 找最大值， 并一直将最大值换到最顶端</span></span><br><span class="line">            <span class="comment"># 判断如果说一个数大于它下面的一个数，那么就两个数的位置互换。</span></span><br><span class="line">            <span class="keyword">if</span> array[j] &gt; array[j + <span class="number">1</span>]:</span><br><span class="line">                array[j], array[j + <span class="number">1</span>] = array[j + <span class="number">1</span>], array[j]</span><br><span class="line">    <span class="keyword">return</span> array</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    array = [<span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">    print(bubbleSort(array))</span><br><span class="line">    <span class="comment"># [1, 2, 3, 4]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">len(<span class="built_in">array</span>) = <span class="number">4</span></span><br><span class="line">i = <span class="number">0</span> </span><br><span class="line">len(<span class="built_in">array</span>) - i - <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span> &gt; <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">4</span> &gt; <span class="built_in">array</span>[<span class="number">1</span> + <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">1</span> + <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span> + <span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">    j = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">4</span> &gt; <span class="built_in">array</span>[<span class="number">2</span> + <span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line">i = <span class="number">1</span>     </span><br><span class="line">len(<span class="built_in">array</span>) - i - <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">3</span> &gt; <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span> &gt; <span class="built_in">array</span>[<span class="number">1</span> + <span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">1</span> + <span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span> + <span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">i = <span class="number">2</span>     </span><br><span class="line">len(<span class="built_in">array</span>) - i - <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">1</span> &lt; <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bubble_sort</span>(<span class="params">array</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(array)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i + <span class="number">1</span>, len(array)):</span><br><span class="line">            <span class="keyword">if</span> array[i] &gt; array[j]:</span><br><span class="line">                array[i], array[j] = array[j], array[i]</span><br><span class="line">    <span class="keyword">return</span> array</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">len(<span class="built_in">array</span>) = <span class="number">4</span></span><br><span class="line">i = <span class="number">0</span> </span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span> &gt; <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">    j = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">3</span> &gt; <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">1</span> &lt; <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">i = <span class="number">1</span>     </span><br><span class="line">    j = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">4</span> &gt; <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span> &gt; <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>]</span><br><span class="line">i = <span class="number">2</span>     </span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">4</span> &gt; <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br></pre></td></tr></tbody></table></figure>

<p>优化的冒泡<br>如果在某一趟过程中没有发生交换，说明已经结束排序。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bubble_sort</span>(<span class="params">array</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(array) - <span class="number">1</span>):  </span><br><span class="line">            flag = <span class="literal">False</span>  <span class="comment"># 优化后的冒泡，设置一个交换标志位</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(array) - i - <span class="number">1</span>):  </span><br><span class="line">                <span class="keyword">if</span> array[j] &gt; array[j + <span class="number">1</span>]:</span><br><span class="line">                    array[j], array[j + <span class="number">1</span>] = array[j + <span class="number">1</span>], array[j]</span><br><span class="line">                    flag = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> flag:</span><br><span class="line">                <span class="keyword">return</span> array  <span class="comment"># 代表计算机偷懒成功</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bubble_sort</span>(<span class="params">nums</span>):</span></span><br><span class="line">    <span class="comment"># 升序排序，从列表最前面开始进行判断，如果后面一个小于前面一个，则交换位置,依次比较</span></span><br><span class="line">    <span class="comment"># 第一次循环就会把最大的值放到列表的最后面</span></span><br><span class="line">    <span class="comment"># 第二次循环就会把第二大的值放到最大值的前面，以此类推</span></span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(len(nums) - <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>):</span><br><span class="line">        <span class="keyword">for</span> num_index <span class="keyword">in</span> range(index):</span><br><span class="line">            <span class="keyword">if</span> nums[num_index] &gt; nums[num_index + <span class="number">1</span>]:</span><br><span class="line">                nums[num_index], nums[num_index + <span class="number">1</span>] = nums[num_index +</span><br><span class="line">                                                            <span class="number">1</span>], nums[num_index]</span><br><span class="line">    <span class="keyword">return</span> nums</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h2 id="2-插入排序-Insertion-Sort-（熟悉）"><a href="#2-插入排序-Insertion-Sort-（熟悉）" class="headerlink" title="2.插入排序 Insertion Sort （熟悉）"></a>2.插入排序 Insertion Sort （熟悉）</h2><p>每次将一个数据插入到已经排好序的有序数据中，从而得到一个新的、个数加1 的有序数据，<br>用于少量数据的排序，首先将第一个作为已经排好序的，然后每次从后的取出插入到前面并排序。</p>
<p>通过构建有序序列，对于未排序数据，在已排序序列中从后向前扫描，找到相应位置并插入。<br>插入排序在实现上，在从后向前扫描过程中，需要反复把已排序元素逐步向后挪位，为最新元素提供插入空间。<br>优化：「将一个数字插入一个有序的数组」这一步，可以不使用逐步交换，使用先赋值给「临时变量」，然后「适当的元素」后移，空出一个位置，最后把「临时变量」赋值给这个空位的策略（就是上面那张图的意思）。编码的时候如果不小心，可能会把数组的值修改，建议多调试；</p>
<p>特点：「插入排序」可以提前终止内层循环（体现在 nums[j - 1] &gt; temp 不满足时），在数组「几乎有序」的前提下，「插入排序」的时间复杂度可以达到 O(N)；</p>
<p>由于「插入排序」在「几乎有序」的数组上表现良好，特别地，在「短数组」上的表现也很好。因为「短数组」的特点是：每个元素离它最终排定的位置都不会太远。为此，在小区间内执行排序任务的时候，可以转向使用「插入排序」。</p>
<p>时间复杂度 O(n^2)<br>空间复杂度：O(1) 使用到常数个临时变量。<br>稳定性：稳定</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insert_sort</span>(<span class="params">ilist</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(ilist)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i):</span><br><span class="line">            <span class="keyword">if</span> ilist[i] &lt; ilist[j]:</span><br><span class="line">                ilist.insert(j, ilist.pop(i))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> ilist</span><br><span class="line"></span><br><span class="line">print(insert_sort([<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">0</span>]))</span><br><span class="line"><span class="comment"># [0, 1, 2, 3, 4, 6, 7, 8]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">len(<span class="built_in">array</span>) = <span class="number">4</span></span><br><span class="line">i = <span class="number">0</span> </span><br><span class="line">    j 为空</span><br><span class="line">i = <span class="number">1</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span> &lt; <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">    [<span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">i = <span class="number">2</span>    </span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">1</span> &lt; <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">i = <span class="number">3</span>     </span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span> &gt; <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span> &lt; <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insert_sort</span>(<span class="params">alist</span>):</span></span><br><span class="line">    <span class="comment"># 从第二个位置，即下标为1的元素开始向前插入</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(alist)):</span><br><span class="line">        <span class="comment"># 从第i个元素开始向前比较，如果小于前一个元素，交换位置</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i, <span class="number">0</span>, <span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">if</span> alist[j] &lt; alist[j<span class="number">-1</span>]:</span><br><span class="line">                alist[j], alist[j<span class="number">-1</span>] = alist[j<span class="number">-1</span>], alist[j]</span><br><span class="line"></span><br><span class="line">alist = [<span class="number">54</span>,<span class="number">26</span>,<span class="number">93</span>,<span class="number">17</span>,<span class="number">77</span>,<span class="number">31</span>,<span class="number">44</span>,<span class="number">55</span>,<span class="number">20</span>]</span><br><span class="line">print(insert_sort(alist))</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insert_sort</span>(<span class="params">li</span>):</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">        插入排序，将无序区的数据依次取出，与有序区数据比较，然后放在合理的位置</span></span><br><span class="line"><span class="string">        li: 无序列表</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(li)):  <span class="comment"># 无序列表第一个数</span></span><br><span class="line">        temp = li[i]</span><br><span class="line">        j = i - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> j &gt;= <span class="number">0</span> <span class="keyword">and</span> li[j] &gt; temp: <span class="comment">#如果有序区的数依次与无序列表第一个数比较，直到找到对应位置</span></span><br><span class="line">            li[j+<span class="number">1</span>] = li[j]</span><br><span class="line">            j -= <span class="number">1</span></span><br><span class="line">        li[j+<span class="number">1</span>] = temp</span><br><span class="line">    <span class="keyword">return</span> li</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">插入排序 Insertion Sort</span><br><span class="line">从左到右遍历每一个元素，每次将这个元素和前面的元素一一比较，如果比某个元素小，则跟其交换</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insert_sort</span>(<span class="params">arr, n</span>):</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    选择排序，每次选择未排序部分的最小值和未排序部分的第一位交换位置</span></span><br><span class="line"><span class="string">    :param arr:</span></span><br><span class="line"><span class="string">    :param n:</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n):</span><br><span class="line">        <span class="comment"># 寻找元素arr[i]合适的插入位置</span></span><br><span class="line"></span><br><span class="line">        e = arr[i]</span><br><span class="line">        j = i  <span class="comment"># j保存元素e应该插入的位置</span></span><br><span class="line">        <span class="keyword">while</span> arr[j<span class="number">-1</span>] &gt; e <span class="keyword">and</span> j &gt; <span class="number">0</span>:</span><br><span class="line">            arr[j] = arr[j<span class="number">-1</span>]</span><br><span class="line">            j -= <span class="number">1</span></span><br><span class="line">        arr[j] = e</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>选择排序一个特别重要的性质：当找到合适的位置以后（<code>arr[j-1] &gt; e</code>），可以提前终止内层循环<br>这使得在一个近乎有序的数组在进行插入排序的时候，效率要高的多，设置比o(logn)的算法效率还要高<br>当排序一个完全排序的数组时，插入排序的算法复杂度为o(n)级别</li>
</ul>
<p>（直白描述）<br>1.当只考虑第一个元素的时候，它已经排好序了，第一个元素不动。<br>2.寻找第二个元素合适的位置，把它和第一个元素比较，如果小于第一个元素，交换，否则，它的位置是合适的，继续下一次循环。<br>3.寻找第三个元素合适的位置，先和第二个元素比较，如果小于第二个元素，和第二个元素交换位置，然后和第一个元素比较，如果小于第一个元素，和第一个元素交换位置，继续下一次循环。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insertionSort</span>(<span class="params">arrList</span>):</span></span><br><span class="line">    <span class="comment"># 从1开始，第0个元素已经有序</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(arrList)):</span><br><span class="line">        <span class="comment"># 寻找arrList[i]合适的插入位置</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i, <span class="number">0</span>, <span class="number">-1</span>):</span><br><span class="line">            <span class="comment"># 如果当前位置元素比前一个位置元素小，交换</span></span><br><span class="line">            <span class="keyword">if</span> arrList[j] &lt; arrList[j<span class="number">-1</span>]:</span><br><span class="line">                arrList[j<span class="number">-1</span>], arrList[j] = arrList[j], arrList[j<span class="number">-1</span>]</span><br><span class="line">            <span class="comment"># 否则，当前元素位置合适，寻找下一个元素的合适位置</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">a = [<span class="number">10</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>]</span><br><span class="line">insertionSort(a)</span><br><span class="line"></span><br><span class="line">print(a)</span><br><span class="line"><span class="comment"># [6, 7, 8, 9, 10]</span></span><br></pre></td></tr></tbody></table></figure>

<p>插入排序算法的改进<br>（形式化描述）<br>将第一个元素标记为已排序<br>遍历每个没有排序过的元素<br>    “提取” 元素 X<br>    i = 最后排序过元素的指数 到 0 的遍历<br>        如果现在排序过的元素 &gt; 提取的元素<br>            将排序过的元素向右移一格<br>        否则：插入提取的元素</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insertionSort</span>(<span class="params">arrList</span>):</span></span><br><span class="line">    <span class="comment"># 从1开始，第0个元素已经有序</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(arrList)):</span><br><span class="line">        <span class="comment"># 寻找arrList[i]合适的插入位置</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将当前元素提取出来</span></span><br><span class="line">        x = arrList[i]</span><br><span class="line">        <span class="comment"># j保存元素应该插入的位置，初始为i</span></span><br><span class="line">        j = i</span><br><span class="line">        <span class="comment"># -1取不到，可以取到0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">if</span> arrList[j<span class="number">-1</span>] &gt; x:</span><br><span class="line">                <span class="comment"># 赋值而不做交换</span></span><br><span class="line">                arrList[j] = arrList[j<span class="number">-1</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 位置合适</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        arrList[j] = x</span><br><span class="line"></span><br><span class="line">a = [<span class="number">10</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>]</span><br><span class="line">insertionSort(a)</span><br><span class="line"></span><br><span class="line">print(a)</span><br><span class="line"><span class="comment"># [6, 7, 8, 9, 10]</span></span><br></pre></td></tr></tbody></table></figure>
<hr>
<h2 id="3-选择排序-Selection-sort-（了解）"><a href="#3-选择排序-Selection-sort-（了解）" class="headerlink" title="3.选择排序 Selection sort （了解）"></a>3.选择排序 Selection sort （了解）</h2><p>首先在未排序序列中找到最小（大）元素，存放到排序序列的起始位置，然后，再从剩余未排序元素中继续寻找最小（大）元素，然后放到已排序序列的末尾。以此类推，直到所有元素均排序完毕。</p>
<p>选择排序的主要优点与数据移动有关。如果某个元素位于正确的最终位置上，则它不会被移动。选择排序每次交换一对元素，它们当中至少有一个将被移到其最终位置上，因此对n个元素的表进行排序总共进行至多n-1次交换。在所有的完全依靠交换去移动元素的排序方法中，选择排序属于非常好的一种。<br>第一趟，在待排序记录r1 …r(n)中选出最小的记录，将它与r1 交换，<br>第二趟，在待排序记录r2 ~ r(n) 中选出最小的记录，将它与 r2 交换，<br>以此类推，第i趟在待排序记录 r[i]~r[n]中选出最小的记录，将它与r[i]交换，使有序序列不断增长直到全部排序完毕。</p>
<p>算法思想 1：贪心算法：每一次决策只看当前，当前最优，则全局最优。<br>注意：这种思想不是任何时候都适用。</p>
<p>算法思想 2：减治思想：外层循环每一次都能排定一个元素，问题的规模逐渐减少，直到全部解决，即「大而化小，小而化了」。运用「减治思想」很典型的算法就是大名鼎鼎的「二分查找」。</p>
<p>优点：交换次数最少。</p>
<p>时间复杂度 O(n^2)<br>空间复杂度：O(1)<br>稳定性：不稳定</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">select_sort</span>(<span class="params">array</span>):</span></span><br><span class="line">    <span class="comment"># 外层循环控制循环次数</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(array)):  <span class="comment"># 第i趟</span></span><br><span class="line">    <span class="comment"># for i in range(len(array) - 1):  # 第i趟</span></span><br><span class="line">        min_index = i  <span class="comment"># 假设找到的最小元素下标，无序区第一个数开始查找</span></span><br><span class="line">        <span class="comment"># 寻找最小元素的过程</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i, len(array)):</span><br><span class="line">        <span class="comment"># for j in range(i + 1, len(array)):  </span></span><br><span class="line">        <span class="comment"># 加1也不影响 从i+1位置到末尾选择出最小数据</span></span><br><span class="line">            <span class="comment"># 假设最小下标的值，大于循环中一个元素，那么就改变最小值的下标</span></span><br><span class="line">            <span class="keyword">if</span> array[j] &lt; array[min_index]:</span><br><span class="line">                min_index = j</span><br><span class="line">        <span class="comment"># 循环一开始就假设把最小值的下标赋值给变量 min_index</span></span><br><span class="line">        <span class="comment"># 在不停的循环中，不停的交换两个不一样大小的值</span></span><br><span class="line">        array[i], array[min_index] = array[min_index], array[i]</span><br><span class="line">    <span class="keyword">return</span> array</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">len(<span class="built_in">array</span>) = <span class="number">4</span></span><br><span class="line">i = <span class="number">0</span> </span><br><span class="line">min_index = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span> = <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span> &lt; <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    min_index = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    j = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">1</span> &lt; <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    min_index = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span> &gt; <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    min_index = <span class="number">2</span></span><br><span class="line">    slist[<span class="number">0</span>] = slist[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    slist[<span class="number">2</span>]  = slist[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    slist = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line">min_index = <span class="number">1</span></span><br><span class="line">    j = <span class="number">1</span>,  j 从i开始，不是从<span class="number">0</span>开始</span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span> = <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    j = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">4</span> &gt; <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span> &lt; <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    min_index = <span class="number">3</span></span><br><span class="line">    slist[<span class="number">1</span>] = slist[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">    slist[<span class="number">3</span>]  = slist[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    slist = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>]</span><br><span class="line">    </span><br><span class="line">i = <span class="number">2</span>  </span><br><span class="line">min_index = <span class="number">2</span>  </span><br><span class="line">    j = <span class="number">2</span>,  j 从i开始，不是从<span class="number">0</span>开始</span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">4</span> = <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">4</span></span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">3</span> &lt; <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">4</span></span><br><span class="line">    min_index = <span class="number">3</span></span><br><span class="line">    slist[<span class="number">2</span>] = slist[<span class="number">3</span>] = <span class="number">3</span></span><br><span class="line">    slist[<span class="number">3</span>]  = slist[<span class="number">2</span>] = <span class="number">4</span></span><br><span class="line">    slist = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">i = <span class="number">3</span>     </span><br><span class="line">min_index = <span class="number">3</span> </span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">3</span> = <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></tbody></table></figure>
<p>每次选择没有排序部分的最小值和第一位交换</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">selection_sort</span>(<span class="params">org_arr, length</span>):</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    选择排序，每次选择未排序部分的最小值和未排序部分的第一位交换位置</span></span><br><span class="line"><span class="string">    :param org_arr: 待排序数组</span></span><br><span class="line"><span class="string">    :param length: 待数组长度</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, length):</span><br><span class="line">        <span class="comment"># 寻找[i,n)区间里的最小值</span></span><br><span class="line">        main_index = i</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>, length):</span><br><span class="line">            <span class="keyword">if</span> org_arr[j] &lt; org_arr[main_index]:</span><br><span class="line">                main_index = j</span><br><span class="line">        org_arr[i], org_arr[main_index] = org_arr[main_index], org_arr[i]</span><br></pre></td></tr></tbody></table></figure>
<p>（直白描述）</p>
<ol>
<li>找出所有元素中的最小值，与第一个位置的元素互换。</li>
<li>找出剩下的元素中的最小值，与第二个位置的元素互换。</li>
<li>以此类推。</li>
</ol>
<p>（形式化描述）<br>重复（元素个数-1）次<br>    # 从0开始<br>    把第一个没有排序过的元素设置为最小值<br>    遍历每个没有排序过的元素<br>        如果元素 &lt; 现在的最小值<br>        将此元素设置成为新的最小值<br>    将最小值和第一个没有排序过的位置交换</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">selectionSort</span>(<span class="params">arrList</span>):</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    选择排序</span></span><br><span class="line"><span class="string">    :param arrList:可迭代对象</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(arrList)):</span><br><span class="line">        <span class="comment"># 寻找[i, len(arrlist))区间的最小值</span></span><br><span class="line">        minIndex = i</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>, len(arrList)):</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> arrList[j] &lt; arrList[i]:</span><br><span class="line">                minIndex = j</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 交换i位置和最小值</span></span><br><span class="line">        <span class="comment"># 注意双向交换</span></span><br><span class="line">        arrList[i], arrList[minIndex] = arrList[minIndex], arrList[i]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试</span></span><br><span class="line">a = [<span class="number">10</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">selectionSort(a)</span><br><span class="line"></span><br><span class="line">print(a)    </span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br></pre></td></tr></tbody></table></figure>
<hr>
<h2 id="4-希尔排序-Shell-Sort（不建议多花时间了解）"><a href="#4-希尔排序-Shell-Sort（不建议多花时间了解）" class="headerlink" title="4.希尔排序 Shell Sort（不建议多花时间了解）"></a>4.希尔排序 Shell Sort（不建议多花时间了解）</h2><p>是插入排序的一种。也称缩小增量排序，是直接插入排序算法的一种更高效的改进版本。</p>
<p>是把记录按下标的一定增量分组，对每组使用直接插入排序算法排序；随着增量逐渐减少，每组包含的关键词越来越多，当增量减至1时，整个文件恰好被分成一组，算法终止</p>
<p>将数组列在一个表中并对列分别进行插入排序，重复这过程，不过每次用更长的列（步长更长了，列数更少了）来进行。最后整个表就只有一列了。将数组转换至表是为了更好地理解这算法，算法本身还是使用数组进行排序。</p>
<p>时间复杂度 O(n^2)<br>空间复杂度：O(nlogn)<br>稳定性：不稳定</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shell_sort</span>(<span class="params">slist</span>):</span></span><br><span class="line">    count = len(slist)</span><br><span class="line">    step = <span class="number">2</span></span><br><span class="line">    group = count // step</span><br><span class="line">    <span class="keyword">while</span> group &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(group):</span><br><span class="line">            j = i + group</span><br><span class="line">            <span class="keyword">while</span> j &lt; count:</span><br><span class="line">                key = slist[j]</span><br><span class="line">                k = j - group</span><br><span class="line">                <span class="keyword">while</span> k &gt;= <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">if</span> slist[k] &gt; key:</span><br><span class="line">                        slist[k+group] = slist[k]</span><br><span class="line">                        slist[k] = key</span><br><span class="line">                    k = k - group</span><br><span class="line">                j = j + group</span><br><span class="line">        group = group // step</span><br><span class="line">    <span class="keyword">return</span> slist</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(shell_sort([4,5,7,3,2,6,9,8,0]))</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ShellSort</span>(<span class="params">arrList</span>):</span></span><br><span class="line">    arrayLen = len(arrList)</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> h &lt; arrayLen//<span class="number">3</span>:</span><br><span class="line">        h = h * <span class="number">3</span> + <span class="number">1</span></span><br><span class="line">        <span class="comment">#插入排序的方法，判断是不是后一个比前一个要小</span></span><br><span class="line">        <span class="comment">#如果是则交换</span></span><br><span class="line">    <span class="keyword">while</span> h &gt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(h,arrayLen):</span><br><span class="line">            j = i</span><br><span class="line">            <span class="keyword">while</span> j &gt;= h <span class="keyword">and</span> arrList[j] &lt; arrList[j-h]:</span><br><span class="line">                arrList[j] ,arrList[j-h] = arrList[j-h],arrList[j]</span><br><span class="line">                j -= h</span><br><span class="line">        h  //= <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    arrList = [<span class="number">14</span>,<span class="number">33</span>,<span class="number">27</span>,<span class="number">10</span>,<span class="number">35</span>,<span class="number">19</span>,<span class="number">42</span>,<span class="number">44</span>]</span><br><span class="line">    ShellSort(arrList)</span><br><span class="line">    print(arrList)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shell_sort</span>(<span class="params">alist</span>):</span></span><br><span class="line">    n = len(alist)</span><br><span class="line">    <span class="comment"># 初始步长</span></span><br><span class="line">    gap = n / <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> gap &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># 按步长进行插入排序</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(gap, n):</span><br><span class="line">            j = i</span><br><span class="line">            <span class="comment"># 插入排序</span></span><br><span class="line">            <span class="keyword">while</span> j&gt;=gap <span class="keyword">and</span> alist[j-gap] &gt; alist[j]:</span><br><span class="line">                alist[j-gap], alist[j] = alist[j], alist[j-gap]</span><br><span class="line">                j -= gap</span><br><span class="line">        <span class="comment"># 得到新的步长</span></span><br><span class="line">        gap = gap / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">alist = [<span class="number">54</span>,<span class="number">26</span>,<span class="number">93</span>,<span class="number">17</span>,<span class="number">77</span>,<span class="number">31</span>,<span class="number">44</span>,<span class="number">55</span>,<span class="number">20</span>]</span><br><span class="line">shell_sort(alist)</span><br><span class="line">print(alist)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="排序数组"><a href="#排序数组" class="headerlink" title="排序数组"></a>排序数组</h2><p><strong>给你一个整数数组 nums，请你将该数组升序排列。</strong></p>
<p>示例 1：</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [<span class="number">5</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>]</span><br><span class="line">输出：[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>]</span><br></pre></td></tr></tbody></table></figure>
<p>示例 2：</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [<span class="number">5</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">输出：[<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>]</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h2 id="5-归并排序-Merge-Sort-（重点）"><a href="#5-归并排序-Merge-Sort-（重点）" class="headerlink" title="5.归并排序  Merge_Sort （重点）"></a>5.归并排序  Merge_Sort （重点）</h2><p>算法思想：分而治之（分治思想）（Divide and Conquer）。<br>形象理解是「曹冲称象」、MapReduce，在一定情况下可以并行化。</p>
<p>算法描述：<br>把长度为n的输入序列中待排序数字分分成长度 n/2的子序列；<br>一直重复<br>直到每个子序列只包含一个数字，长度为一的数组是有序的<br>对两个子序列采用归并排序，合并为一个有序序列<br>反复归并，将若干个组两两合并，所有子序列。</p>
<p>直到只剩下一组，最后把另一个数组的剩余部分复制过来即可</p>
<p>让子序列有序，再将子序列间有序，</p>
<p>基本思路：是比较两个数组的最前面的数，<br>谁小就先取谁，取了后相应的指针就往后移一位。<br>然后再比较，直至一个数组为空，</p>
<p>例如：「力扣」第 88 题：合并两个有序数组。</p>
<p>「归并排序」是理解「递归思想」的非常好的学习材料，大家可以通过理解：<br>递归完成以后，合并两个有序数组的这一步骤，想清楚程序的执行流程。<br>即「递归函数执行完成以后，我们还可以做点事情」。</p>
<p>时间复杂度：O(nlogn)<br>空间复杂度：O(1)<br>稳定性：稳定</p>
<p>当n较大，则应采用时间复杂度为O(nlog2n)的排序方法：快速排序、堆排序或归并排序序。</p>
<p>思路<br>归并排序利用了分治的思想来对序列进行排序。对一个长为 n 的待排序的序列，我们将其分解成两个长度为 n/2 的子序列。每次先递归调用函数使两个子序列有序，然后我们再线性合并两个有序的子序列使整个序列有序。</p>
<p>算法</p>
<p>定义 mergeSort(nums, l, r) 函数表示对 nums 数组里 [l,r] 的部分进行排序，整个函数流程如下：</p>
<ol>
<li><p>递归调用函数 mergeSort(nums, l, mid) 对 nums 数组里 [l,mid] 部分进行排序。</p>
</li>
<li><p>递归调用函数 mergeSort(nums, mid + 1, r) 对 nums 数组里 [mid+1,r] 部分进行排序。</p>
</li>
<li><p>此时 nums 数组里 [l,mid] 和 [mid+1,r] 两个区间已经有序，我们对两个有序区间线性归并即可使 nums 数组里 [l,r] 的部分有序。</p>
</li>
</ol>
<p>线性归并的过程，由于两个区间均有序，<br>所以我们维护两个指针 i 和 j 表示当前考虑到 [l,mid] 里的第 i 个位置和 [mid+1,r] 的第 j 个位置。</p>
<p>如果 nums[i] &lt; nums[j] ，那么我们就将 nums[i] 放入临时数组 tmp 中并让 i += 1 ，即指针往后移。否则我们就将 nums[j] 放入临时数组 tmp 中并让 j += 1 。<br>如果有一个指针已经移到了区间的末尾，那么就把另一个区间里的数按顺序加入 tmp 数组中即可。</p>
<p>这样能保证我们每次都是让两个区间中较小的数加入临时数组里，那么整个归并过程结束后 [l,r] 即为有序的。</p>
<p>函数递归调用的入口为 mergeSort(nums, 0, nums.length - 1)，递归结束当且仅当 l &gt;= r。</p>
<p>时间复杂度：O(nlogn)。由于归并排序每次都将当前待排序的序列折半成两个子序列递归调用，然后再合并两个有序的子序列，而每次合并两个有序的子序列需要 O(n) 的时间复杂度，所以我们可以列出归并排序运行时间 T(n) 的递归表达式：<br>T(n)=2T(n/2}) + O(n)<br>根据主定理我们可以得出归并排序的时间复杂度为 O(nlogn)。</p>
<p>空间复杂度：O(n)。我们需要额外 O(n) 空间的 tmp 数组，且归并排序递归调用的层数最深为 \log_2 ，所以我们还需要额外的 O(logn) 的栈空间，所需的空间复杂度即为 O(n+logn)=O(n)</p>
<p><img src="/2020/08/21/liu-da-ji-ben-pai-xu/..%5C%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%5C%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84.gif"></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">merge_sort</span>(<span class="params">self, nums, l, r</span>):</span></span><br><span class="line">        <span class="keyword">if</span> l == r:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        mid = (l + r) // <span class="number">2</span></span><br><span class="line">        self.merge_sort(nums, l, mid)</span><br><span class="line">        self.merge_sort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">        tmp = []</span><br><span class="line">        i, j = l, mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> i &lt;= mid <span class="keyword">or</span> j &lt;= r:</span><br><span class="line">            <span class="keyword">if</span> i &gt; mid <span class="keyword">or</span> (j &lt;= r <span class="keyword">and</span> nums[j] &lt; nums[i]):</span><br><span class="line">                tmp.append(nums[j])</span><br><span class="line">                j += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tmp.append(nums[i])</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">        nums[l:r + <span class="number">1</span>] = tmp</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortArray</span>(<span class="params">self, nums: List[int]</span>) -&gt; List[int]:</span></span><br><span class="line">        self.merge_sort(nums, <span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> nums</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">    print(solution.sortArray(array))</span><br><span class="line">    <span class="comment"># [1, 2, 2, 3, 5, 6]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br></pre></td><td class="code"><pre><span class="line">nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">len(nums) - <span class="number">1</span> = <span class="number">6</span> - <span class="number">1</span> = <span class="number">5</span></span><br><span class="line">l = <span class="number">0</span></span><br><span class="line">r = <span class="number">5</span></span><br><span class="line">mid = (<span class="number">0</span> + <span class="number">5</span>) <span class="comment">// 2 = 2</span></span><br><span class="line"></span><br><span class="line">    merge_sort(nums, l, mid)</span><br><span class="line">    l = <span class="number">0</span></span><br><span class="line">    r = <span class="number">2</span></span><br><span class="line">    mid = (<span class="number">0</span> + <span class="number">2</span>) <span class="comment">// 2 = 1</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">        merge_sort(nums, l, mid)</span><br><span class="line">        l = <span class="number">0</span></span><br><span class="line">        r = <span class="number">1</span></span><br><span class="line">        mid = (<span class="number">0</span> + <span class="number">1</span>) <span class="comment">// 2 = 0</span></span><br><span class="line">        [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">            merge_sort(nums, l, mid)</span><br><span class="line">            l = r = <span class="number">0</span></span><br><span class="line">            [<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">            递归到最深层</span><br><span class="line"></span><br><span class="line">        回到上一层的结果</span><br><span class="line">        l = <span class="number">0</span></span><br><span class="line">        r = <span class="number">1</span></span><br><span class="line">        mid = (<span class="number">0</span> + <span class="number">1</span>) <span class="comment">// 2 = 0</span></span><br><span class="line">        [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">            merge_sort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">            l = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span> = r</span><br><span class="line">            [<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">            递归到最深层</span><br><span class="line"></span><br><span class="line">        回到上一层的结果</span><br><span class="line">        l = <span class="number">0</span></span><br><span class="line">        r = <span class="number">1</span></span><br><span class="line">        mid = (<span class="number">0</span> + <span class="number">1</span>) <span class="comment">// 2 = 0</span></span><br><span class="line">        [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">        tmp = []</span><br><span class="line">        i = l = <span class="number">0</span> = mid </span><br><span class="line">        j = mid + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span> = r </span><br><span class="line">        num[j] = nums[<span class="number">1</span>] = <span class="number">2</span> &gt; nums[i] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">        tmp.append(nums[i])</span><br><span class="line">        tmp = [<span class="number">1</span>]</span><br><span class="line">        i = i + <span class="number">1</span> = <span class="number">1</span> &gt; mid = <span class="number">0</span></span><br><span class="line">        j = r</span><br><span class="line">        tmp.append(nums[j])</span><br><span class="line">        tmp = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">        j = j + <span class="number">1</span> = <span class="number">2</span> &gt; r = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        nums[l:r + <span class="number">1</span>] = tmp = [<span class="number">1</span>, <span class="number">2</span>]  # 切片左闭右开 </span><br><span class="line">        l = <span class="number">0</span></span><br><span class="line">        r + <span class="number">1</span> = <span class="number">1</span> + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">        nums[<span class="number">0</span>:<span class="number">2</span>] = [<span class="number">1</span>, <span class="number">2</span>]  # 切片左闭右开 </span><br><span class="line">        递归到最深层</span><br><span class="line"></span><br><span class="line">    回到上一层的结果</span><br><span class="line">    merge_sort(nums, l, mid)</span><br><span class="line">    l = <span class="number">0</span></span><br><span class="line">    r = <span class="number">2</span></span><br><span class="line">    mid = (<span class="number">0</span> + <span class="number">2</span>) <span class="comment">// 2 = 1</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">        self.merge_sort(nums, l, mid)</span><br><span class="line">        已经执行过，不再执行</span><br><span class="line"></span><br><span class="line">        self.merge_sort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">        l = mid + <span class="number">1</span> = <span class="number">1</span> + <span class="number">1</span> = <span class="number">2</span> = r</span><br><span class="line">        [<span class="number">3</span>]</span><br><span class="line">        <span class="keyword">return</span>  </span><br><span class="line">        递归到最深层</span><br><span class="line"></span><br><span class="line">    回到上一层的结果</span><br><span class="line">    l = <span class="number">0</span></span><br><span class="line">    r = <span class="number">2</span></span><br><span class="line">    mid = (<span class="number">0</span> + <span class="number">2</span>) <span class="comment">// 2 = 1</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    tmp = []</span><br><span class="line">    i = l = <span class="number">0</span> &lt; mid = <span class="number">1</span></span><br><span class="line">    j = mid + <span class="number">1</span> = <span class="number">2</span> = r</span><br><span class="line"></span><br><span class="line">    num[j] = nums[<span class="number">2</span>] = <span class="number">3</span> &gt; nums[i] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    tmp.append(nums[i])</span><br><span class="line">    tmp = [<span class="number">1</span>]</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">1</span> = mid</span><br><span class="line">    tmp.append(nums[i])</span><br><span class="line">    tmp = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">2</span> &gt; mid</span><br><span class="line">    tmp.append(nums[j])</span><br><span class="line">    tmp = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">    j = j + <span class="number">1</span> = <span class="number">3</span> &gt; r 退出循环</span><br><span class="line"></span><br><span class="line">    nums[l:r + <span class="number">1</span>] = tmp </span><br><span class="line">    l = <span class="number">0</span></span><br><span class="line">    r + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">    nums[<span class="number">0</span>:<span class="number">3</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">    递归到最深层</span><br><span class="line"></span><br><span class="line">回到上一层的结果</span><br><span class="line">nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">l = <span class="number">0</span></span><br><span class="line">r = <span class="number">5</span></span><br><span class="line">mid = (<span class="number">0</span> + <span class="number">5</span>) <span class="comment">// 2 = 2</span></span><br><span class="line"></span><br><span class="line">    self.merge_sort(nums, l, mid)</span><br><span class="line">    不执行</span><br><span class="line"></span><br><span class="line">    self.merge_sort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">    l = mid + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> </span><br><span class="line">    r = <span class="number">5</span></span><br><span class="line">    mid = (<span class="number">3</span> + <span class="number">5</span>) <span class="comment">// 2 = 4</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">        self.merge_sort(nums, l, mid)</span><br><span class="line">        l = <span class="number">3</span> </span><br><span class="line">        r = <span class="number">4</span></span><br><span class="line">        mid = (<span class="number">3</span> + <span class="number">4</span>) <span class="comment">// 2 = 3</span></span><br><span class="line">        [<span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">            self.merge_sort(nums, l, mid)</span><br><span class="line">            l = <span class="number">3</span> = r </span><br><span class="line">            [<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">return</span>  </span><br><span class="line">            递归到最深层</span><br><span class="line"></span><br><span class="line">        回到上一层的结果</span><br><span class="line">        l = <span class="number">3</span> </span><br><span class="line">        r = <span class="number">4</span></span><br><span class="line">        mid = (<span class="number">3</span> + <span class="number">4</span>) <span class="comment">// 2 = 3</span></span><br><span class="line">        [<span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">            self.merge_sort(nums, l, mid)</span><br><span class="line">            不执行</span><br><span class="line">            self.merge_sort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">            l = mid + <span class="number">1</span> = <span class="number">3</span> + <span class="number">1</span> = <span class="number">4</span> = r </span><br><span class="line">            [<span class="number">5</span>]</span><br><span class="line">            <span class="keyword">return</span>  </span><br><span class="line">            递归到最深层</span><br><span class="line"></span><br><span class="line">        回到上一层的结果</span><br><span class="line">        l = <span class="number">3</span> </span><br><span class="line">        r = <span class="number">4</span></span><br><span class="line">        mid = (<span class="number">3</span> + <span class="number">4</span>) <span class="comment">// 2 = 3</span></span><br><span class="line">        [<span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">        tmp = []</span><br><span class="line">        i = l = <span class="number">3</span> = mid </span><br><span class="line">        j = mid + <span class="number">1</span> = <span class="number">3</span> + <span class="number">1</span> = <span class="number">4</span> = r </span><br><span class="line">        num[j] = nums[<span class="number">4</span>] = <span class="number">5</span> &gt; nums[i] = nums[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">        tmp.append(nums[i])</span><br><span class="line">        tmp = [<span class="number">2</span>]</span><br><span class="line">        i = i + <span class="number">1</span> = <span class="number">3</span> + <span class="number">1</span> = <span class="number">4</span> &gt; mid = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">        tmp.append(nums[j])</span><br><span class="line">        tmp = [<span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">        j = j + <span class="number">1</span> = <span class="number">4</span> + <span class="number">1</span> = <span class="number">5</span> &gt; r = <span class="number">4</span></span><br><span class="line">        跳出循环</span><br><span class="line"></span><br><span class="line">        nums[l:r + <span class="number">1</span>] = tmp  # 切片左闭右开 </span><br><span class="line">        l = <span class="number">3</span></span><br><span class="line">        r + <span class="number">1</span> = <span class="number">4</span> + <span class="number">1</span> = <span class="number">5</span></span><br><span class="line">        nums[<span class="number">3</span>:<span class="number">5</span>] = [<span class="number">2</span>, <span class="number">5</span>]  # 切片左闭右开</span><br><span class="line">        递归到最深层</span><br><span class="line"></span><br><span class="line">    回到上一层</span><br><span class="line">    l = mid + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> </span><br><span class="line">    r = <span class="number">5</span></span><br><span class="line">    mid = (<span class="number">3</span> + <span class="number">5</span>) <span class="comment">// 2 = 4</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">        self.merge_sort(nums, l, mid)</span><br><span class="line">        不再执行</span><br><span class="line"></span><br><span class="line">        self.merge_sort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">        l = mid + <span class="number">1</span> = <span class="number">4</span> + <span class="number">1</span> = <span class="number">5</span> = r </span><br><span class="line">        [<span class="number">6</span>]</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">        递归到最深层</span><br><span class="line"></span><br><span class="line">    回到上一层</span><br><span class="line">    l = mid + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> </span><br><span class="line">    r = <span class="number">5</span></span><br><span class="line">    mid = (<span class="number">3</span> + <span class="number">5</span>) <span class="comment">// 2 = 4</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">    tmp = []</span><br><span class="line">    i = l = <span class="number">3</span> &lt; mid = <span class="number">4</span></span><br><span class="line">    j = mid + <span class="number">1</span> = <span class="number">4</span> + <span class="number">1</span> = <span class="number">5</span> = r </span><br><span class="line">    num[j] = nums[<span class="number">5</span>] = <span class="number">6</span> &gt; nums[i] = nums[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">    tmp.append(nums[i])</span><br><span class="line">    tmp = [<span class="number">2</span>]</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">3</span> + <span class="number">1</span> = <span class="number">4</span> = mid = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    tmp.append(nums[i])</span><br><span class="line">    tmp = [<span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">4</span> + <span class="number">1</span> = <span class="number">5</span> &gt; mid = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    tmp.append(nums[i])</span><br><span class="line">    tmp = [<span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]    </span><br><span class="line">    j = j + <span class="number">1</span> = <span class="number">6</span> &gt; r</span><br><span class="line"></span><br><span class="line">    nums[l:r + <span class="number">1</span>] = tmp  # 切片左闭右开  </span><br><span class="line">    l = <span class="number">3</span></span><br><span class="line">    r + <span class="number">1</span> = <span class="number">5</span> + <span class="number">1</span> = <span class="number">6</span></span><br><span class="line">    nums[<span class="number">3</span>:<span class="number">6</span>] = [<span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]  # 切片左闭右开</span><br><span class="line">    递归到最深层</span><br><span class="line"></span><br><span class="line">回到上一层的结果</span><br><span class="line">nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">l = <span class="number">0</span></span><br><span class="line">r = <span class="number">5</span></span><br><span class="line">mid = (<span class="number">0</span> + <span class="number">5</span>) <span class="comment">// 2 = 2</span></span><br><span class="line"></span><br><span class="line">tmp = []</span><br><span class="line">i = l = <span class="number">0</span> &lt; mid = <span class="number">2</span></span><br><span class="line">j = mid + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> &lt; r = <span class="number">5</span></span><br><span class="line">num[j] = nums[<span class="number">3</span>] = <span class="number">2</span> &gt; nums[i] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">tmp.append(nums[i])</span><br><span class="line">tmp = [<span class="number">1</span>]</span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span> &lt; mid = <span class="number">2</span></span><br><span class="line">tmp.append(nums[i])</span><br><span class="line">tmp = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">1</span> + <span class="number">1</span> = <span class="number">2</span> = mid = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">tmp.append(nums[j])</span><br><span class="line">tmp = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>]</span><br><span class="line">j = j + <span class="number">1</span> = <span class="number">3</span> + <span class="number">1</span> = <span class="number">4</span> &lt; r = <span class="number">5</span></span><br><span class="line">num[j] = nums[<span class="number">4</span>] = <span class="number">5</span> &gt; nums[i] = nums[<span class="number">4</span>] = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">tmp.append(nums[i])</span><br><span class="line">tmp = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> &gt; mid = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">tmp.append(nums[j])</span><br><span class="line">tmp = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>]</span><br><span class="line">j = j + <span class="number">1</span> = <span class="number">4</span> + <span class="number">1</span> = <span class="number">5</span> = r = <span class="number">5</span></span><br><span class="line">num[j] = nums[<span class="number">5</span>] = <span class="number">6</span> &gt; nums[i] = nums[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">tmp.append(nums[j])</span><br><span class="line">tmp = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">j = j + <span class="number">1</span> = <span class="number">5</span> + <span class="number">1</span> = <span class="number">6</span> &gt; r = <span class="number">5</span></span><br><span class="line">跳出循环</span><br><span class="line"></span><br><span class="line">nums[l:r + <span class="number">1</span>] = tmp  # 切片左闭右开 </span><br><span class="line">l = <span class="number">0</span></span><br><span class="line">r + <span class="number">1</span> = <span class="number">5</span> + <span class="number">1</span> = <span class="number">6</span></span><br><span class="line">nums[<span class="number">0</span>:<span class="number">6</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>]  # 切片左闭右开</span><br></pre></td></tr></tbody></table></figure>



<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MergeSort</span>(<span class="params">arrayList</span>):</span></span><br><span class="line">    arrayLen = len(arrayList)</span><br><span class="line">    <span class="comment">#判断输入参数的正确性,如果长度小于1，就说明为1</span></span><br><span class="line">    <span class="keyword">if</span> arrayLen &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> arrayList</span><br><span class="line">    <span class="comment"># 二分分解</span></span><br><span class="line">    midIndex = arrayLen // <span class="number">2</span></span><br><span class="line">    <span class="comment">#左边的部分去做 MergeSort</span></span><br><span class="line">    leftArray = MergeSort(arrayList[:midIndex])</span><br><span class="line">    <span class="comment">#右边的去做 MergeSort</span></span><br><span class="line">    rightArray = MergeSort(arrayList[midIndex:])</span><br><span class="line">    <span class="comment">#将左右两边合并，称为一个新的数组，并已经排序成功</span></span><br><span class="line">    retArray = MergeCore(leftArray, rightArray)</span><br><span class="line">    <span class="keyword">return</span> retArray</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MergeCore</span>(<span class="params">leftArray, rightArray</span>):</span></span><br><span class="line">    <span class="string">'''合并操作，将两个有序数组left[]和right[]合并成一个大的有序数组'''</span></span><br><span class="line">    <span class="comment">#首先需要定义两个指针,这两个指针，分别指向这两个数组的第一个元素</span></span><br><span class="line">    leftIndex = <span class="number">0</span></span><br><span class="line">    rightIndex = <span class="number">0</span></span><br><span class="line">    <span class="comment">#获取两个数组的长度，用于指出上面两个指针的边界是什么</span></span><br><span class="line">    leftLen = len(leftArray)</span><br><span class="line">    rightLen = len(rightArray)</span><br><span class="line">    <span class="comment">#定义一个返回的列表,这一步就代表空间复杂度至少是 O(n)</span></span><br><span class="line">    retList = []</span><br><span class="line">    <span class="comment">#循环两个数组寻找最小值加入到返回值的数组中</span></span><br><span class="line">    <span class="keyword">while</span> leftIndex &lt; leftLen <span class="keyword">and</span> rightIndex &lt; rightLen:</span><br><span class="line">        <span class="keyword">if</span> leftArray[leftIndex] &lt; rightArray[rightIndex]:</span><br><span class="line">            retList.append(leftArray[leftIndex])</span><br><span class="line">            leftIndex += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            retList.append(rightArray[rightIndex])</span><br><span class="line">            rightIndex += <span class="number">1</span></span><br><span class="line">    <span class="comment">#下面的代码是将剩余的数组中内容放置在返回的数组中</span></span><br><span class="line">    retList.extend(leftArray[leftIndex:])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># while leftIndex &lt; leftLen:</span></span><br><span class="line">    <span class="comment">#     retList.append(leftArray[leftIndex])</span></span><br><span class="line">    <span class="comment">#     leftIndex += 1</span></span><br><span class="line"></span><br><span class="line">    retList.extend(rightArray[rightIndex:])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># while rightIndex &lt; rightLen:</span></span><br><span class="line">    <span class="comment">#     retList.append(rightArray[rightIndex])</span></span><br><span class="line">    <span class="comment">#     rightIndex += 1</span></span><br><span class="line">    <span class="keyword">return</span> retList</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    retList = MergeSort([<span class="number">14</span>, <span class="number">33</span>, <span class="number">27</span>, <span class="number">10</span>, <span class="number">35</span>, <span class="number">19</span>, <span class="number">42</span>, <span class="number">44</span>])</span><br><span class="line">    print(retList)  <span class="comment"># [10, 14, 19, 27, 33, 35, 42, 44]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__merge</span>(<span class="params">arrList, l, mid, r</span>):</span></span><br><span class="line">    <span class="comment"># 将arr[l...mid]和arr[mid + 1...r]两部分进行归并</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 一段辅助的临时空间，大小为r-l+1</span></span><br><span class="line">    aux = [<span class="literal">None</span>]*(r-l+<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 将当前要处理的arrList中的元素复制到aux中</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(l, r+<span class="number">1</span>):</span><br><span class="line">        <span class="comment"># aux从0开始，要处理的元素从l开始，中间有个l的偏移量。</span></span><br><span class="line">        aux[i-l] = arrList[i]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 两个指针</span></span><br><span class="line">    i = l</span><br><span class="line">    j = mid + <span class="number">1</span></span><br><span class="line">    <span class="comment"># 寻找arrList[k]处的元素</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(l, r+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> i &gt; mid:</span><br><span class="line">            arrList[k] = aux[j-l]</span><br><span class="line">            j = j + <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> j &gt; r:</span><br><span class="line">            arrList[k] = aux[i-l]</span><br><span class="line">            i = i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> aux[i-l] &lt;= aux[j-l]:</span><br><span class="line">            arrList[k] = aux[i-l]</span><br><span class="line">            i = i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            arrList[k] = aux[j-l]</span><br><span class="line">            j = j + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__mergeSort</span>(<span class="params">arrList, l, r</span>):</span></span><br><span class="line">    <span class="comment"># 递归使用归并排序, 对arr[l...r]的范围进行排序</span></span><br><span class="line">    <span class="comment"># 处理递归到底的情况</span></span><br><span class="line">    <span class="comment"># 当l &lt; r时，至少有两个元素需要处理</span></span><br><span class="line">    <span class="keyword">if</span> l &gt;= r:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    当粒度小到一定程度时，使用插入排序</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    if r-l &lt; 15:</span></span><br><span class="line"><span class="string">        insertinSort(arrList, l, r)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        return</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 最小粒度拆分</span></span><br><span class="line">    <span class="comment"># 对分开的左右两部分进行归并排序</span></span><br><span class="line">    mid = int((l+r)/<span class="number">2</span>)</span><br><span class="line">    __mergeSort(arrList, l, mid)</span><br><span class="line">    __mergeSort(arrList, mid+<span class="number">1</span>, r)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 进行归并排序之后，已经保证每个部分都是有序的</span></span><br><span class="line">    <span class="comment"># 仅当arrList[mid] &gt; arrList[mid+1]的时候，才需要进行merge操作</span></span><br><span class="line">    <span class="comment"># 对l-&gt;mid和mid+1-&gt;r进行merge操作</span></span><br><span class="line">    <span class="keyword">if</span> arrList[mid] &gt; arrList[mid+<span class="number">1</span>]:</span><br><span class="line">        __merge(arrList, l, mid, r)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mergeSort</span>(<span class="params">arrList</span>):</span></span><br><span class="line">    __mergeSort(arrList, <span class="number">0</span>, len(arrList)<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line">a = [<span class="number">4</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">7</span>]</span><br><span class="line">mergeSort(a)</span><br><span class="line"></span><br><span class="line">print(a)</span><br><span class="line"><span class="comment"># [1, 1, 2, 3, 3, 4, 4, 5, 7, 8]</span></span><br></pre></td></tr></tbody></table></figure>

<hr>
<h2 id="6-快速排序-Quick-sort"><a href="#6-快速排序-Quick-sort" class="headerlink" title="6.快速排序 Quick sort"></a>6.快速排序 Quick sort</h2><p>通过一趟排序划分将待排序的序列分成前后两部分，<br>其中前一部分的数据都比后一部分的数据要小，<br>然后再递归调用此方法对这两部分序列分别进行快速排序，以此使整个序列达到有序。</p>
<p>快速排序没有指定应如何具体实现第一步，不论是选择主元 pivot 的过程还是划分的过程，都有不止一种实现方法。</p>
<p>步骤为：</p>
<ol>
<li>在每一次 partition 之前，选一个元素作为切分元素 pivot，称为“基准”“主元”“分界点”，可以选择nums[left] 或随机<br>交换它与第 1 个或最后 1 个元素的位置，随机元素作为左端“标定点”元素的原因是为了避免极端测试用例，避免递归树加深、达不到减治的效果：</li>
</ol>
<ul>
<li><p>性能和「划分」出的子数组的长度密切相关。</p>
</li>
<li><p>最差的情况就是 pivot 被选在了数组的两侧。顺序数组与倒序数组就是这种最差的情况，<br>此时递归树画出来是链表，排序的“递归结构”就变成了“线性结构”，这个时候就很像选择排序，或者是冒泡排序了， 《算法4》这本书上有说，也可以取三个元素的中位数。<br>例如：例如“顺序数组” [1, 2, 3, 4, 5] 的 partition 过程，就是线性搜索，<br>如果找第 1 大元素，就得一个一个地看，看到末尾。<br>直观地理解如果每次规模为 n 的问题我们都划分成 1 和 n - 1，<br>每次递归的时候又向 n−1 的集合中递归，<br>而导致时间复杂度退化为 O(N)，快速排序的最坏运行情况是 O(n ^ 2)<br>出现最坏情况的概率是： 1/1 * 1/2 * 1/3 * … 1/n，这个值非常小了。<br>讨论最坏情况意义不大，所以引入随机化来加速这个过程，它的时间代价的期望是 O(n)，<br>证明过程可以参考「《算法导论》9.2：期望为线性的选择算法」。<br>快速排序的 平摊期望时间复杂度是 O(nlogn)，且 O(nlogn) 记号中隐含的常数因子很小，比复杂度稳定等于 O(nlogn) 的归并排序要小很多。<br>对绝大多数顺序性较弱的随机数列而言，是目前基于比较的内部排序中被认为是最好的方法，</p>
</li>
<li><p>最理想的情况是 快速排序每一次选择的 pivot 它最后会被交换到数组中间的部分，这样后面递归的部分，每一个小组的数据不用跟另外小组的数据比较，需要比较的元素就会减少，因此速度较快</p>
</li>
</ul>
<ol start="2">
<li>算法思想：分而治之（分治思想），不像「归并排序」无脑地一分为二，<br>把问题规模转化到一个更小的范围里，这样的思想叫做 “减而治之”（是 “分而治之” 思想的特例）。</li>
</ol>
<ul>
<li><p>partition 切分、分区：将数组 nums[left⋯right] 分成两个子数组 nums[left⋯j−1]、nums[j+1⋯right]，使得 </p>
<ul>
<li><p>nums[left⋯j−1] 中的每个元素小于等于 nums[j]，分割点左侧的数全部不大于基准值，所有元素比基准值小的摆放在基准前面，</p>
</li>
<li><p>nums[j] 小于等于 nums[j+1⋯right] 中的每个元素。右侧的数全部不小于分割点的数。所有元素比基准值大的摆在基准的后面（相同的数可以到任一边）。</p>
</li>
<li><p>计算下标 j 也是「划分」过程的一部分。</p>
</li>
<li><p>解决：通过递归调用快速排序，对子数组 nums[left⋯j−1] 和 nums[j+1⋯right] 进行排序。</p>
</li>
<li><p>因为子数组都是原址排序的，所以没有「合」的合并操作，nums[left⋯right] 已经完全有序。已经分别有序且第一个序列中的数都小于第二个数，所以直接拼接起来就好了。</p>
</li>
</ul>
</li>
</ul>
<p>即基准元素 pivot = nums[j] 每次经过 partition 切分操作以后会放置在它 “最终应该放置的地方”索引为 j，</p>
<blockquote>
<p>至于 a[left⋯j−1] 和 a[j+1⋯right] 是否是有序的，我们不关心。</p>
</blockquote>
<p>切分过程可以不借助额外的数组空间，仅通过交换数组元素实现。</p>
<ol start="3">
<li>递归（recursive）地处理左右两段，把小于基准值元素的子数列和大于基准值元素的子数列排序。<br>递归的最底部情形，是数列的大小是零或一，即直至排序区间为 0 时完成排序，也就是永远都已经被排序好了。<br>虽然一直递归下去，但是这个算法总会结束，因为在每次的迭代（iteration）中，它至少会把一个元素摆到它最后的位置去，使数组中的每个数成为基准。</li>
</ol>
<p>快排一轮递归，再对分割点左右两侧的子数组成为独立两组数据，分别再像之前一样定一个pivot，比较，分组，如此类推。</p>
<p>保持「循环不变量」，<br>即定义的变量在循环开始前、循环过程中、循环结束以后，都保持不变的性质，<br>这个性质是人为根据问题特点定义的。<br>「循环不变量」是证明算法有效性的基础，更是写对代码的保证，<br>是不是该写等于号，先交换还是先 ++ ，就会特别清楚，绝对不会写错，<br>快速排序丢失了稳定性，如果需要稳定的快速排序，需要具体定义比较函数，这个过程叫「稳定化」</p>
<h4 id="法一"><a href="#法一" class="headerlink" title="法一"></a>法一</h4><ol>
<li><p>选中列表第一个元素nums[start] 为基准值 pivot，定义两个左右指针 left 指向左边表头和 right 指向右边表尾，</p>
</li>
<li><p>因为分界点选的第一个是最左边，所以不从左边开始而是从右向左找比这个值要大的数，找到就停止，否则指针继续向左移动一个位置，直到找到或者已经比左指针位置小。首先从 right 所指位置起向前 (表头方向)直到搜索出第一个小于关键字元素和pivot基准值相互交换；</p>
</li>
<li><p>从左向右找比这个值要小的数，找到就停止，否则指针继续向右移动一个位置，直到找到或者已经比右指针位置大。然后从 left 所指位置起向后 (表尾方向)直到搜索出第一个大于基准值元素和pivot基准值相互交换。重复这两步知道 left=right为止。</p>
</li>
<li><p>然后交换这两个数字的位置。<br>重复2 3 4 步骤，直到左指针位置已经不再小于右指针位置</p>
</li>
<li><p>然后将中值和现在的左指针或者右指针位置的数 交换位置<br>此时这个数组，就已经以中值为界限，中值左边的均小于中值，中值右边的均大于中值</p>
</li>
<li><p>最后递归重复以上的所有步骤 即可将一个无序数组完整的排序。<br>分别递归左侧列表，右侧列表<br>while里面套两个while循环，从左往右一个while，从右往左一个while<br>将所有大于 nums[start] 的数放到 nums[start] 右边，所有小于 nums[start] 的数放到 nums[start] 左边</p>
</li>
</ol>
<p>跟 start 还是 end 比取决于我们把哪个元素看作”哨兵“，跟 end 比也可以，<br>如果要用 end ，哨兵 i, j 的移动先后顺序也要对换<br>因为最后要把 nums[i], nums[start] 交换，因此要保证 ``nums[i] &gt; nums[start]` （和 end 的情况正好相反），这样交换后才符合快排定义。</p>
<p>维护一前一后两个指针 p 和 q ，依次考虑当前的数是否放在了应该放的位置（前还是后）。如果当前的数没放对，比如说如果后面的指针  遇到了一个比  小的数，那么可以交换  和  位置上的数，再把  向后移一位。当前的数的位置全放对后，再移动指针继续处理，直到两个指针相遇。</p>
<p><img src="/2020/08/21/liu-da-ji-ben-pai-xu/..%5C%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%5C%E5%BF%AB%E6%8E%92%E6%95%B0%E7%BB%84%E5%89%8D%E5%90%8E%E5%8F%8C%E6%8C%87%E9%92%88.jpg"></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortArray</span>(<span class="params">self, nums: List[int]</span>) -&gt; List[int]:</span></span><br><span class="line">        <span class="comment"># nums待排序列表，第一个元素start下标值为0，最后一个元素end下标值len(nums)-1</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">partition</span>(<span class="params">start, end</span>):</span></span><br><span class="line">            <span class="comment"># 递归过程中发现start和end一致时，停止递归，直接返回列表</span></span><br><span class="line">            <span class="keyword">if</span> start &gt;= end:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="comment"># 设定待排数组第一个元素为要寻找位置的基准元素</span></span><br><span class="line">            pivot = nums[start]</span><br><span class="line">            <span class="comment"># left为序列左边的由左向右移动的指针</span></span><br><span class="line">            left = start</span><br><span class="line">            <span class="comment"># right为序列右边的由右向左移动的指针</span></span><br><span class="line">            right = end</span><br><span class="line">            <span class="keyword">while</span> left &lt; right:  <span class="comment"># 当left = right，退出循环</span></span><br><span class="line">                <span class="comment"># 如果left与right未重合，right指向的元素不比基准元素小</span></span><br><span class="line">                <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[right] &gt;= pivot:</span><br><span class="line">                    <span class="comment"># right先往左移，直到找到一个比基准值小的元素</span></span><br><span class="line">                    right -= <span class="number">1</span></span><br><span class="line">                <span class="comment"># 当 nums[left] &lt; pivot 将right指向的元素放到left的位置上</span></span><br><span class="line">                nums[left] = nums[right]</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 如果left与right未重合，left指向的元素比基准元素小，</span></span><br><span class="line">                <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[left] &lt; pivot:</span><br><span class="line">                    <span class="comment"># 则left向右移动，直到找到一个比基准值大的元素</span></span><br><span class="line">                    left += <span class="number">1</span></span><br><span class="line">                <span class="comment"># 当 nums[left] &gt; pivot, 将left指向的元素放到right的位置上</span></span><br><span class="line">                nums[right] = nums[left]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 退出循环后，left与right重合，用哪个都一样，</span></span><br><span class="line">            nums[left] = pivot  <span class="comment"># 此时所指位置为基准元素的正确位置</span></span><br><span class="line">            <span class="keyword">return</span> left</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">left, right</span>):</span></span><br><span class="line">            <span class="keyword">if</span> left &lt; right:</span><br><span class="line">                pivot = partition(left, right)</span><br><span class="line">                <span class="comment"># 对基准元素左边的子序列进行快速排序</span></span><br><span class="line">                quick_sort(left, pivot - <span class="number">1</span>)</span><br><span class="line">                <span class="comment"># 对基准元素右边的子序列进行快速排序</span></span><br><span class="line">                quick_sort(pivot + <span class="number">1</span>, right)</span><br><span class="line"></span><br><span class="line">        quick_sort(<span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> nums</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    array = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">    print(solution.sortArray(array))</span><br><span class="line">    <span class="comment"># [1, 2, 3, 4, 5, 6]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nums待排序列表，start第一个元素下标值为0，end最后一个元素下标值len(nums)-1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">nums, start, end</span>):</span></span><br><span class="line">    <span class="comment"># 递归过程中发现start和end一致时，停止递归，直接返回列表</span></span><br><span class="line">    <span class="keyword">if</span> start &gt;= end:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="comment"># 设定待排数组第一个元素为要寻找位置的基准元素</span></span><br><span class="line">    pivot = nums[start]</span><br><span class="line">    <span class="comment"># left为序列左边的由左向右移动的指针</span></span><br><span class="line">    left = start</span><br><span class="line">    <span class="comment"># right为序列右边的由右向左移动的指针</span></span><br><span class="line">    right = end</span><br><span class="line">    <span class="keyword">while</span> left &lt; right:  <span class="comment"># 当left = right，退出循环</span></span><br><span class="line">        <span class="comment"># 如果left与right未重合，right指向的元素不比基准元素小</span></span><br><span class="line">        <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[right] &gt;= pivot:</span><br><span class="line">            <span class="comment"># right往左移,直到找到一个比基准值小的元素</span></span><br><span class="line">            right -= <span class="number">1</span>   <span class="comment"># 先移动 right</span></span><br><span class="line">        <span class="comment"># 当 nums[left] &lt; pivot 将right指向的元素放到left的位置上</span></span><br><span class="line">        nums[left] = nums[right]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果left与right未重合，left指向的元素比基准元素小，</span></span><br><span class="line">        <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[left] &lt; pivot:</span><br><span class="line">            <span class="comment"># 则left向右移动，直到找到一个比基准值大的元素</span></span><br><span class="line">            left += <span class="number">1</span></span><br><span class="line">        <span class="comment"># 当 nums[left] &gt; pivot, 将left指向的元素放到right的位置上</span></span><br><span class="line">        nums[right] = nums[left]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 退出循环后，left与right重合用哪个都一样，</span></span><br><span class="line">    nums[left] = pivot  <span class="comment"># 此时所指位置为基准元素的正确位置</span></span><br><span class="line">    <span class="comment"># 对基准元素左边的子序列进行快速排序</span></span><br><span class="line">    quick_sort(nums, start, left - <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 对基准元素右边的子序列进行快速排序</span></span><br><span class="line">    quick_sort(nums, left + <span class="number">1</span>, end)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nums = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">quick_sort(nums, <span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">print(nums)</span><br><span class="line"><span class="comment"># [1, 2, 3, 4, 5, 6]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">pivot = nums[start] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">left = start = <span class="number">0</span></span><br><span class="line">right = end = <span class="number">5</span> </span><br><span class="line"></span><br><span class="line">进入外循环</span><br><span class="line">    nums[right] = nums[<span class="number">5</span>] = <span class="number">5</span> &gt; pivot = <span class="number">3</span>:</span><br><span class="line">        right = right - <span class="number">1</span> = <span class="number">1</span> = <span class="number">4</span></span><br><span class="line">        nums[right] = nums[<span class="number">4</span>] = <span class="number">2</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">        不进入子循环</span><br><span class="line">    nums[left] = nums[right] = nums[<span class="number">0</span>] = nums[<span class="number">4</span>] = <span class="number">2</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">    nums[left] = nums[<span class="number">0</span>] = <span class="number">2</span> &lt; pivot = <span class="number">3</span></span><br><span class="line">        left = left + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">        nums[left] = nums[<span class="number">1</span>] = <span class="number">4</span> &gt; pivot = <span class="number">3</span></span><br><span class="line">        不进入子循环</span><br><span class="line">    nums[right] = nums[left] = nums[<span class="number">4</span>] = nums[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">    nums[right] = nums[<span class="number">4</span>] = <span class="number">4</span> &gt; pivot = <span class="number">3</span>:</span><br><span class="line">        right = right - <span class="number">1</span> = <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">        nums[right] = nums[<span class="number">3</span>] = <span class="number">1</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">        不进入子循环</span><br><span class="line">    nums[left] = nums[right] = nums[<span class="number">1</span>] = nums[<span class="number">3</span>] = <span class="number">1</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">    nums[left] = nums[<span class="number">1</span>] = <span class="number">1</span> &lt; pivot = <span class="number">3</span></span><br><span class="line">        left = left + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">        nums[left] = nums[<span class="number">2</span>] = <span class="number">6</span> &gt; pivot = <span class="number">3</span></span><br><span class="line">        不进入子循环</span><br><span class="line">    nums[right] = nums[left] = nums[<span class="number">3</span>] = nums[<span class="number">2</span>] = <span class="number">6</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">    nums[right] = nums[<span class="number">3</span>] = <span class="number">6</span> &gt; pivot = <span class="number">3</span>:</span><br><span class="line">        right = right - <span class="number">1</span> = <span class="number">1</span> = <span class="number">2</span> = left</span><br><span class="line">退出外循环</span><br><span class="line">nums[left] = pivot = nums[<span class="number">2</span>] = <span class="number">3</span>  </span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">切分元素 pivot = <span class="number">3</span> 交换到它排序以后最终确定的位置上</span><br></pre></td></tr></tbody></table></figure>

<p>跟 l 还是 r 比取决于我们把哪个元素看作”哨兵“，<br>如果要用 r ，哨兵 i, j 的移动先后顺序也要对换<br>因为最后要把 strs[i], strs[r] 交换，因此要保证 ``strs[i] &gt; strs[r]` （和 l 的情况正好相反），这样交换后才符合快排定义。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortArray</span>(<span class="params">self, nums: List[int]</span>) -&gt; List[int]:</span></span><br><span class="line">        <span class="comment"># nums待排序列表，第一个元素start下标值为0，最后一个元素end下标值len(nums)-1</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">partition</span>(<span class="params">start, end</span>):</span></span><br><span class="line">            <span class="comment"># 递归过程中发现start和end一致时，停止递归，直接返回列表</span></span><br><span class="line">            <span class="keyword">if</span> start &gt;= end:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="comment"># 设定待排数组第一个元素为要寻找位置的基准元素</span></span><br><span class="line">            pivot = nums[end]</span><br><span class="line">            <span class="comment"># left为序列左边的由左向右移动的指针</span></span><br><span class="line">            left = start</span><br><span class="line">            <span class="comment"># right为序列右边的由右向左移动的指针</span></span><br><span class="line">            right = end</span><br><span class="line">            <span class="keyword">while</span> left &lt; right:  <span class="comment"># 当left = right，退出循环</span></span><br><span class="line">                <span class="comment"># 如果left与right未重合，left指向的元素比基准元素小，</span></span><br><span class="line">                <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[left] &lt; pivot:</span><br><span class="line">                    <span class="comment"># 则left向右移动，直到找到一个比基准值大的元素</span></span><br><span class="line">                    left += <span class="number">1</span></span><br><span class="line">                <span class="comment"># 当 nums[left] &gt; pivot, 将left指向的元素放到right的位置上</span></span><br><span class="line">                nums[right] = nums[left]</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># 如果left与right未重合，right指向的元素不比基准元素小</span></span><br><span class="line">                <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[right] &gt;= pivot:</span><br><span class="line">                    <span class="comment"># right先往左移，直到找到一个比基准值小的元素</span></span><br><span class="line">                    right -= <span class="number">1</span></span><br><span class="line">                <span class="comment"># 当 nums[left] &lt; pivot 将right指向的元素放到left的位置上</span></span><br><span class="line">                nums[left] = nums[right]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 退出循环后，left与right重合，用哪个都一样，</span></span><br><span class="line">            nums[left] = pivot  <span class="comment"># 此时所指位置为基准元素的正确位置</span></span><br><span class="line">            <span class="keyword">return</span> left</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">left, right</span>):</span></span><br><span class="line">            <span class="keyword">if</span> left &lt; right:</span><br><span class="line">                pivot = partition(left, right)</span><br><span class="line">                <span class="comment"># 对基准元素左边的子序列进行快速排序</span></span><br><span class="line">                quick_sort(left, pivot - <span class="number">1</span>)</span><br><span class="line">                <span class="comment"># 对基准元素右边的子序列进行快速排序</span></span><br><span class="line">                quick_sort(pivot + <span class="number">1</span>, right)</span><br><span class="line"></span><br><span class="line">        quick_sort(<span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> nums</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    array = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">    print(solution.sortArray(array))</span><br><span class="line">    <span class="comment"># [1, 2, 3, 4, 5, 6]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">nums, start, end</span>):</span></span><br><span class="line">    <span class="comment"># 递归过程中发现start和end一致时，停止递归，直接返回列表</span></span><br><span class="line">    <span class="keyword">if</span> start &gt;= end:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="comment"># 设定待排数组倒数第一个元素为要寻找位置的基准元素</span></span><br><span class="line">    pivot = nums[end]</span><br><span class="line">    <span class="comment"># left为序列左边的由左向右移动的指针</span></span><br><span class="line">    left = start</span><br><span class="line">    <span class="comment"># right为序列右边的由右向左移动的指针</span></span><br><span class="line">    right = end</span><br><span class="line">    <span class="keyword">while</span> left &lt; right:  <span class="comment"># 当left = right，退出循环</span></span><br><span class="line">        <span class="comment"># 如果left与right未重合，left指向的元素比基准元素小，</span></span><br><span class="line">        <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[left] &lt; pivot:</span><br><span class="line">            <span class="comment"># 则left向右移动，直到找到一个比基准值大的元素</span></span><br><span class="line">            left += <span class="number">1</span>   <span class="comment"># 先移动 left</span></span><br><span class="line">        <span class="comment"># 当 nums[left] &gt; pivot, 将left指向的元素放到right的位置上</span></span><br><span class="line">        nums[right] = nums[left]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果left与right未重合，right指向的元素不比基准元素小</span></span><br><span class="line">        <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[right] &gt;= pivot:</span><br><span class="line">            <span class="comment"># right往左移,直到找到一个比基准值小的元素</span></span><br><span class="line">            right -= <span class="number">1</span></span><br><span class="line">        <span class="comment"># 当 nums[left] &lt; pivot 将right指向的元素放到left的位置上</span></span><br><span class="line">        nums[left] = nums[right]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 退出循环后，left与right重合用哪个都一样，</span></span><br><span class="line">    nums[left] = pivot  <span class="comment"># 此时所指位置为基准元素的正确位置</span></span><br><span class="line">    <span class="comment"># 对基准元素左边的子序列进行快速排序</span></span><br><span class="line">    quick_sort(nums, start, left - <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 对基准元素右边的子序列进行快速排序</span></span><br><span class="line">    quick_sort(nums, left + <span class="number">1</span>, end)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nums = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">quick_sort(nums, <span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">print(nums)</span><br><span class="line"><span class="comment"># [1, 2, 3, 4, 5, 6]</span></span><br></pre></td></tr></tbody></table></figure>

<p>法二</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortArray</span>(<span class="params">self, nums: List[int]</span>) -&gt; List[int]:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">partition</span>(<span class="params">left, right</span>):</span></span><br><span class="line">            randidx = random.randint(left, right)</span><br><span class="line">            nums[left], nums[randidx] = nums[randidx], nums[left]</span><br><span class="line"></span><br><span class="line">            pivot = nums[left]</span><br><span class="line">            l = left + <span class="number">1</span></span><br><span class="line">            r = right</span><br><span class="line">            <span class="keyword">while</span> l &lt;= r:</span><br><span class="line">                <span class="keyword">while</span> l &lt;= r <span class="keyword">and</span> nums[l] &lt;= pivot:</span><br><span class="line">                    <span class="comment"># l 指向数字肯定比 pivot 大</span></span><br><span class="line">                    l += <span class="number">1</span></span><br><span class="line">                <span class="keyword">while</span> l &lt;= r <span class="keyword">and</span> nums[r] &gt;= pivot:</span><br><span class="line">                    <span class="comment"># r 指向数字肯定比 pivot 小</span></span><br><span class="line">                    r -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> l &gt; r:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                nums[l], nums[r] = nums[r], nums[l]</span><br><span class="line">            <span class="comment"># r 和 left 互换, r为 pivot</span></span><br><span class="line">            nums[r], nums[left] = nums[left], nums[r]</span><br><span class="line">            <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">quicksort</span>(<span class="params">left, right</span>):</span></span><br><span class="line">            <span class="keyword">if</span> left &lt; right:</span><br><span class="line">                pivot = partition(left, right)</span><br><span class="line">                quicksort(left, pivot - <span class="number">1</span>)</span><br><span class="line">                quicksort(pivot + <span class="number">1</span>, right)</span><br><span class="line"></span><br><span class="line">        quicksort(<span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> nums</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    array = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">    print(solution.sortArray(array))</span><br><span class="line">    <span class="comment"># [1, 2, 3, 4, 5, 6]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">quicksort(<span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">quicksort(<span class="number">0</span>, <span class="number">6</span> - <span class="number">1</span>)</span><br><span class="line">quicksort(<span class="number">0</span>, <span class="number">5</span>)</span><br><span class="line">left = <span class="number">0</span> &lt; right = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">partition(left, right)</span><br><span class="line">randidx = <span class="number">0</span>  随机取到最左边</span><br><span class="line">nums[left] = nums[randidx] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">nums[randidx] = nums[left] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">pivot = nums[left] = <span class="number">3</span></span><br><span class="line">l = left + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">r = right = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">l = <span class="number">1</span> &lt; r = <span class="number">5</span>:</span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">1</span> &lt; r = <span class="number">5</span> <span class="keyword">and</span> nums[l] = nums[<span class="number">1</span>] = <span class="number">4</span> &gt; pivot = <span class="number">3</span></span><br><span class="line">        不进入循环</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">1</span> &lt; r = <span class="number">5</span> <span class="keyword">and</span> nums[r] = nums[<span class="number">5</span>] = <span class="number">5</span> &gt; pivot = <span class="number">3</span>:</span><br><span class="line">        r = r - <span class="number">1</span> = <span class="number">4</span></span><br><span class="line">        <span class="keyword">while</span> l = <span class="number">1</span> &lt; r = <span class="number">4</span> <span class="keyword">and</span> nums[r] = nums[<span class="number">4</span>] = <span class="number">2</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">        退出子循环</span><br><span class="line"></span><br><span class="line">    nums[l] = nums[r] = nums[<span class="number">1</span>] = nums[<span class="number">4</span>] = <span class="number">2</span></span><br><span class="line">    nums[r] = nums[l] = nums[<span class="number">4</span>] = nums[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">1</span> &lt; r = <span class="number">4</span> <span class="keyword">and</span> nums[l] = nums[<span class="number">1</span>] = <span class="number">2</span> &lt; pivot = <span class="number">3</span></span><br><span class="line">    l = l + <span class="number">1</span> = <span class="number">1</span> + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">2</span> &lt; r = <span class="number">4</span> <span class="keyword">and</span> nums[l] = nums[<span class="number">2</span>] = <span class="number">6</span> &gt; pivot = <span class="number">3</span></span><br><span class="line">        不进入循环</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">2</span> &lt; r = <span class="number">4</span> <span class="keyword">and</span> nums[r] = nums[<span class="number">4</span>] = <span class="number">4</span> &gt; pivot = <span class="number">3</span>:</span><br><span class="line">        r = r - <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">        <span class="keyword">while</span> l = <span class="number">2</span> &lt; r = <span class="number">3</span> <span class="keyword">and</span> nums[r] = nums[<span class="number">3</span>] = <span class="number">1</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">        退出子循环</span><br><span class="line"></span><br><span class="line">    nums[l] = nums[r] = nums[<span class="number">2</span>] = nums[<span class="number">3</span>] = <span class="number">1</span></span><br><span class="line">    nums[r] = nums[l] = nums[<span class="number">3</span>] = nums[<span class="number">2</span>] = <span class="number">6</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">2</span> &lt; r = <span class="number">3</span> <span class="keyword">and</span> nums[l] = nums[<span class="number">2</span>] = <span class="number">1</span> &lt; pivot = <span class="number">3</span></span><br><span class="line">    l = l + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">3</span> = r <span class="keyword">and</span> nums[l] = nums[<span class="number">3</span>] = <span class="number">6</span> &gt; pivot = <span class="number">3</span></span><br><span class="line">        不进入循环</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">3</span> = r <span class="keyword">and</span> nums[r] = nums[<span class="number">3</span>] = <span class="number">6</span> &gt; pivot = <span class="number">3</span>:</span><br><span class="line">        r = r - <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> l = <span class="number">3</span> &gt; r = <span class="number">2</span> <span class="keyword">and</span> nums[r] = nums[<span class="number">2</span>] = <span class="number">1</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">        退出子循环</span><br><span class="line"></span><br><span class="line">l = <span class="number">3</span> &gt; r = <span class="number">2</span></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">nums[r] = nums[left] = nums[<span class="number">2</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">nums[left] = nums[r] = nums[<span class="number">0</span>] = nums[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">切分元素 pivot = <span class="number">3</span> 交换到它排序以后最终确定的位置上</span><br><span class="line"><span class="keyword">return</span> r = <span class="number">2</span></span><br><span class="line">pivot = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">quicksort(left, pivot - <span class="number">1</span>)</span><br><span class="line">    quicksort(<span class="number">0</span>, <span class="number">2</span> - <span class="number">1</span>)</span><br><span class="line">    quicksort(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    partition(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    left = <span class="number">0</span> </span><br><span class="line">    right = <span class="number">1</span></span><br><span class="line">    randidx = random.randint(left, right)</span><br><span class="line">    randidx = random.randint(<span class="number">0</span>, <span class="number">1</span>) 取不到后面的<span class="number">2</span>~<span class="number">5</span></span><br><span class="line">    randidx = <span class="number">0</span>  随机取到最左边</span><br><span class="line">    nums[left] = nums[randidx] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    nums[randidx] = nums[left] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    pivot = nums[left] = <span class="number">1</span></span><br><span class="line">    l = left + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">    r = right = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    l = <span class="number">1</span> = r:</span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">1</span> = r <span class="keyword">and</span> nums[l] = nums[<span class="number">1</span>] = <span class="number">2</span> &gt; pivot = <span class="number">1</span></span><br><span class="line">        不进入循环</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">1</span> = r <span class="keyword">and</span> nums[r] = nums[<span class="number">1</span>] = <span class="number">2</span> &gt; pivot = <span class="number">1</span>:</span><br><span class="line">        r = r - <span class="number">1</span> = <span class="number">0</span> &lt; l = <span class="number">1</span></span><br><span class="line">    l = <span class="number">1</span> &gt; r = <span class="number">0</span></span><br><span class="line">    <span class="keyword">break</span>    </span><br><span class="line">    nums[r] = nums[left] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    nums[left] = nums[r] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">    切分元素 pivot = <span class="number">1</span> 交换到它排序以后最终确定的位置上</span><br><span class="line">    <span class="keyword">return</span> r = <span class="number">0</span></span><br><span class="line">    pivot = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    quicksort(left, pivot - <span class="number">1</span>)</span><br><span class="line">        quicksort(<span class="number">0</span>, <span class="number">0</span> - <span class="number">1</span>)</span><br><span class="line">        quicksort(<span class="number">0</span>, <span class="number">-1</span>)</span><br><span class="line">        left = <span class="number">0</span> &gt; right = <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">    quicksort(pivot + <span class="number">1</span>, right)</span><br><span class="line">        quicksort(<span class="number">0</span> + <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">        left = <span class="number">1</span> = right</span><br><span class="line"></span><br><span class="line">quicksort(pivot + <span class="number">1</span>, right)</span><br><span class="line">    quicksort(<span class="number">2</span> + <span class="number">1</span>, <span class="number">5</span>)</span><br><span class="line">    quicksort(<span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line">    partition(<span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line">    randidx = random.randint(left, right)</span><br><span class="line">    randidx = random.randint(<span class="number">3</span>, <span class="number">5</span>)区间，取不到前面的<span class="number">0</span>~<span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>

<p>方法三<br>我们定义函数 randomized_quicksort(nums, l, r) 为对 nums 数组里 [l,r] 的部分进行排序，每次先调用 randomized_partition 函数对 nums 数组里 [l,r] 的部分进行划分，并返回分界值的下标 pos，然后按上述将的递归调用 randomized_quicksort(nums, l, pos - 1) 和 randomized_quicksort(nums, pos + 1, r) 即可。</p>
<p>这里我们采用随机的方式，对当前划分区间 [l,r] 里的数等概率随机一个作为我们的主元，<br>再将主元放到区间末尾，进行划分。</p>
<p>整个划分函数 partition 主要涉及两个指针 i 和 j，<br>一开始 i = l - 1，j = l。<br>实时维护两个指针使得任意时候对于任意数组下标 k，我们有如下条件成立：</p>
<ol>
<li>l ≤ k ≤ i 时，nums[k] ≤ pivot。</li>
<li>i+1 ≤ k ≤ j−1 时，nums[k] &gt; pivot。</li>
<li>k == r 时，nums[k] = pivot。</li>
</ol>
<p>我们每次移动指针 j ，如果 nums[j] &gt; pivot，我们只需要继续移动指针 j ，即能使上述三个条件成立，否则我们需要将指针 i 加一，然后交换 nums[i] 和 nums[j]，再移动指针 j 才能使得三个条件成立。</p>
<p>当 j 移动到 r−1 时结束循环，此时我们可以由上述三个条件知道 [l,i] 的数都小于等于主元 pivot，[i+1,r−1] 的数都大于主元 pivot，那么我们只要交换 nums[i+1] 和 nums[r] ，即能使得 [l,i+1] 区间的数都小于 [i+2,r] 区间的数，完成一次划分，且分界值下标为 i+1，返回即可。</p>
<p>如下的动图展示了一次划分的过程，刚开始随机选了 4 作为主元，与末尾元素交换后开始划分：</p>
<p>时间复杂度：基于随机选取主元的快速排序时间复杂度为期望 O(nlogn)，其中 n 为数组的长度。详细证明过程可以见《算法导论》第七章</p>
<p>空间复杂度：O(h)，其中 h 为快速排序递归调用的层数。我们需要额外的 O(h) 的递归调用的栈空间，由于划分的结果不同导致了快速排序递归调用的层数也会不同，最坏情况下需 O(n) 的空间，最优情况下每次都平衡，此时整个递归树高度为 nlogn，空间复杂度为 O(logn)。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">randomized_partition</span>(<span class="params">self, nums, l, r</span>):</span></span><br><span class="line">        pivot = random.randint(l, r)</span><br><span class="line">        nums[pivot], nums[r] = nums[r], nums[pivot]</span><br><span class="line">        <span class="comment"># 设置一个 左边的指针位置 为 左侧的 前一个</span></span><br><span class="line">        i = l - <span class="number">1</span></span><br><span class="line">        <span class="comment"># 双指针同时往后，一趟for循环，遍历 除 基准数之外的 数</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(l, r):  <span class="comment"># range左闭右开</span></span><br><span class="line">            <span class="comment"># 比较 遍历的当前数 和 基准数 ，若是小于基准数 则 换到数组前面去</span></span><br><span class="line">            <span class="comment"># 交换位置，将遍历的比 基准数小的数 放到 我们指针 的 后一个上，然后 这个时候指针向后移一位。当遍历的数大于我们的基准数的时候，不移动，而且 指针也不发生变化，那么 当我们遍历完一圈以后，把 我们的基准数 放到 索引i 的后一个 位置，那么就形成了 一个 基准数 左边都是比它小的数，基准数右边 都是比它大的数 这样的模式。然后要把 索引 i 的后一个位置 作为基准数 与 原基准数 交换位置，进而可以第二次来 遍历比较。</span></span><br><span class="line">            <span class="keyword">if</span> nums[j] &lt; nums[r]:</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">                nums[j], nums[i] = nums[i], nums[j]</span><br><span class="line">        <span class="comment"># 遍历完后，将 ？数 和 right 上的数互换位置，就 重置 基准数了。</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        nums[i], nums[r] = nums[r], nums[i]</span><br><span class="line">        <span class="comment"># 返回基准的下标</span></span><br><span class="line">        <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">randomized_quicksort</span>(<span class="params">self, nums, l, r</span>):</span></span><br><span class="line">        <span class="keyword">if</span> l &gt;= r:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        mid = self.randomized_partition(nums, l, r)</span><br><span class="line">        self.randomized_quicksort(nums, l, mid - <span class="number">1</span>)</span><br><span class="line">        self.randomized_quicksort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 函数入口</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortArray</span>(<span class="params">self, nums: List[int]</span>) -&gt; List[int]:</span></span><br><span class="line">        self.randomized_quicksort(nums, <span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> nums</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    array = [<span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line">    print(solution.sortArray(array))</span><br><span class="line">    <span class="comment"># [1, 2, 3, 4, 5, 6, 7, 8]</span></span><br></pre></td></tr></tbody></table></figure>

<p>调试1</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">randomized_quicksort(nums, <span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">randomized_quicksort(nums, <span class="number">0</span>, <span class="number">6</span> - <span class="number">1</span>)</span><br><span class="line">randomized_quicksort(nums, <span class="number">0</span>, <span class="number">5</span>)</span><br><span class="line">l = <span class="number">0</span> &lt; r = <span class="number">5</span></span><br><span class="line">randomized_partition(nums, l, r)</span><br><span class="line">pivot = random.randint(l, r) = <span class="number">0</span></span><br><span class="line">nums[pivot] = nums[r] = nums[<span class="number">0</span>] = nums[<span class="number">5</span>] = <span class="number">5</span></span><br><span class="line">nums[r] = nums[pivot] = nums[<span class="number">5</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">[<span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] </span><br><span class="line">i = l - <span class="number">1</span> = <span class="number">0</span> - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">num[<span class="number">0</span>] = <span class="number">5</span> &gt; num[<span class="number">5</span>] = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">1</span></span><br><span class="line">nums[<span class="number">1</span>] = <span class="number">4</span> &gt; num[<span class="number">5</span>] = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">2</span></span><br><span class="line">nums[<span class="number">2</span>] = <span class="number">6</span> &gt; num[<span class="number">5</span>] = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">3</span></span><br><span class="line">nums[<span class="number">3</span>] = <span class="number">1</span> &lt; num[<span class="number">5</span>] = <span class="number">3</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">3</span>] = nums[<span class="number">0</span>] = <span class="number">5</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">0</span>] = nums[<span class="number">3</span>] = <span class="number">1</span> </span><br><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">3</span>] </span><br><span class="line"></span><br><span class="line">j = <span class="number">4</span></span><br><span class="line">nums[<span class="number">4</span>] = <span class="number">2</span> &lt; num[<span class="number">5</span>] = <span class="number">3</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">4</span>] = nums[<span class="number">1</span>] = <span class="number">4</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">1</span>] = nums[<span class="number">4</span>] = <span class="number">2</span> </span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>] </span><br><span class="line"></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">nums[i] = nums[r] = nums[<span class="number">2</span>] = nums[<span class="number">5</span>] = <span class="number">4</span> </span><br><span class="line">nums[r] = nums[i] = nums[<span class="number">5</span>] = nums[<span class="number">2</span>] = <span class="number">6</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>] </span><br><span class="line">切分元素 nums[pivot] = <span class="number">3</span> 交换到它排序以后最终确定的位置上</span><br><span class="line">mid = i = <span class="number">2</span> 返回原来下标为<span class="number">2</span>的元素<span class="number">3</span>的最终位置在下标<span class="number">2</span> </span><br><span class="line"></span><br><span class="line">self.randomized_quicksort(nums, l, mid - <span class="number">1</span>)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">2</span> - <span class="number">1</span>)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    l = <span class="number">0</span> &lt; r = <span class="number">1</span></span><br><span class="line">    randomized_partition(nums, l, r)</span><br><span class="line">    pivot = random.randint(l, r) = <span class="number">0</span></span><br><span class="line">    nums[pivot] = nums[r] = nums[<span class="number">0</span>] = nums[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    nums[r] = nums[pivot] = nums[<span class="number">1</span>] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>] </span><br><span class="line">    i = l - <span class="number">1</span> = <span class="number">0</span> - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    num[<span class="number">0</span>] = <span class="number">2</span> &gt; num[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">    nums[i] = nums[r] = nums[<span class="number">0</span>] = nums[<span class="number">1</span>] = <span class="number">1</span> </span><br><span class="line">    nums[r] = nums[i] = nums[<span class="number">1</span>] = nums[<span class="number">0</span>] = <span class="number">2</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>] </span><br><span class="line">    切分元素 nums[pivot] = <span class="number">1</span> 交换到它排序以后最终确定的位置上</span><br><span class="line">    mid = i = <span class="number">0</span> 返回原来下标为<span class="number">0</span>的元素<span class="number">1</span>的最终位置在下标<span class="number">0</span> </span><br><span class="line"></span><br><span class="line">    self.randomized_quicksort(nums, l, mid - <span class="number">1</span>)</span><br><span class="line">    self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">0</span> - <span class="number">1</span>)</span><br><span class="line">    self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">-1</span>)</span><br><span class="line">        l = <span class="number">0</span> &gt; r = <span class="number">-1</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    self.randomized_quicksort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">    self.randomized_quicksort(nums, <span class="number">0</span> + <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">        l = <span class="number">1</span> = r</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">self.randomized_quicksort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">2</span> + <span class="number">1</span>, <span class="number">5</span>)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line">    l = <span class="number">3</span> &lt; r = <span class="number">5</span></span><br><span class="line">    randomized_partition(nums, l, r)</span><br><span class="line">    pivot = random.randint(l, r) = <span class="number">3</span></span><br><span class="line">    nums[pivot] = nums[r] = nums[<span class="number">3</span>] = nums[<span class="number">5</span>] = <span class="number">6</span></span><br><span class="line">    nums[r] = nums[pivot] = nums[<span class="number">5</span>] = nums[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>] </span><br><span class="line">    i = l - <span class="number">1</span> = <span class="number">3</span> - <span class="number">1</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    num[<span class="number">3</span>] = <span class="number">6</span> &gt; num[<span class="number">5</span>] = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    j = <span class="number">4</span></span><br><span class="line">    num[<span class="number">4</span>] = <span class="number">4</span> &lt; num[<span class="number">5</span>] = <span class="number">5</span></span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">    nums[j] = nums[i] = nums[<span class="number">4</span>] = nums[<span class="number">3</span>] = <span class="number">6</span> </span><br><span class="line">    nums[i] = nums[j] = nums[<span class="number">3</span>] = nums[<span class="number">4</span>] = <span class="number">4</span> </span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>] </span><br><span class="line"></span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">4</span></span><br><span class="line">    nums[i] = nums[r] = nums[<span class="number">4</span>] = nums[<span class="number">5</span>] = <span class="number">6</span> </span><br><span class="line">    nums[r] = nums[i] = nums[<span class="number">5</span>] = nums[<span class="number">4</span>] = <span class="number">5</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">    切分元素 nums[pivot] = <span class="number">5</span> 交换到它排序以后最终确定的位置上</span><br><span class="line">    mid = i = <span class="number">4</span> 返回原来下标为<span class="number">3</span>的元素<span class="number">5</span>的最终位置在下标<span class="number">4</span> </span><br><span class="line"></span><br><span class="line">    self.randomized_quicksort(nums, l, mid - <span class="number">1</span>)</span><br><span class="line">    self.randomized_quicksort(nums, <span class="number">3</span>, <span class="number">4</span> - <span class="number">1</span>)</span><br><span class="line">    self.randomized_quicksort(nums, <span class="number">3</span>, <span class="number">3</span>)</span><br><span class="line">        l = <span class="number">3</span> = r</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    self.randomized_quicksort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">    self.randomized_quicksort(nums, <span class="number">4</span> + <span class="number">1</span>, <span class="number">5</span>)</span><br><span class="line">        l = <span class="number">5</span> = r</span><br><span class="line">        <span class="keyword">return</span></span><br></pre></td></tr></tbody></table></figure>

<p>调试2</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>] len(nums) - <span class="number">1</span> = <span class="number">7</span></span><br><span class="line">pivot = random.randint(l, r) = <span class="number">2</span></span><br><span class="line">nums[pivot] = <span class="number">4</span> </span><br><span class="line">nums[pivot] = nums[r] = nums[<span class="number">2</span>] = nums[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">nums[r] = nums[pivot] = nums[<span class="number">3</span>] = nums[<span class="number">2</span>] = <span class="number">4</span></span><br><span class="line">[<span class="number">2</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line">i = l - <span class="number">1</span> = <span class="number">0</span> - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">num[<span class="number">0</span>] = <span class="number">2</span> &lt; num[<span class="number">7</span>] = <span class="number">4</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">2</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">2</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">1</span></span><br><span class="line">nums[<span class="number">1</span>] = <span class="number">8</span> &gt; num[<span class="number">7</span>] = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">2</span></span><br><span class="line">nums[<span class="number">2</span>] = <span class="number">7</span> &gt; num[<span class="number">7</span>] = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">3</span></span><br><span class="line">nums[<span class="number">3</span>] = <span class="number">1</span> &lt; num[<span class="number">7</span>] = <span class="number">4</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">3</span>] = nums[<span class="number">1</span>] = <span class="number">8</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">1</span>] = nums[<span class="number">3</span>] = <span class="number">1</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">4</span></span><br><span class="line">nums[<span class="number">4</span>] = <span class="number">3</span> &lt; num[<span class="number">7</span>] = <span class="number">4</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">4</span>] = nums[<span class="number">2</span>] = <span class="number">3</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">2</span>] = nums[<span class="number">4</span>] = <span class="number">7</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">5</span></span><br><span class="line">nums[<span class="number">5</span>] = <span class="number">5</span> &gt; num[<span class="number">7</span>] = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">6</span></span><br><span class="line">nums[<span class="number">6</span>] = <span class="number">6</span> &gt; num[<span class="number">7</span>] = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">nums[i] = nums[r] = nums[<span class="number">3</span>] = nums[<span class="number">7</span>] = <span class="number">4</span> </span><br><span class="line">nums[r] = nums[i] = nums[<span class="number">7</span>] = nums[<span class="number">1</span>] = <span class="number">8</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>]</span><br><span class="line">切分元素 pivot = <span class="number">4</span> 交换到它排序以后最终确定的位置上</span><br><span class="line">mid = i = <span class="number">3</span> 返回原来下标为<span class="number">2</span>的元素<span class="number">3</span>的最终位置在下标<span class="number">3</span> </span><br><span class="line"></span><br><span class="line">self.randomized_quicksort(nums, l, mid - <span class="number">1</span>)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">1</span> - <span class="number">1</span>)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">self.randomized_quicksort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">3</span> + <span class="number">1</span>, <span class="number">7</span>)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>] </span><br><span class="line">r = len(nums) - <span class="number">1</span> = <span class="number">7</span></span><br><span class="line"></span><br><span class="line">pivot = random.randint(l, r) = <span class="number">7</span> 随机取到最右边</span><br><span class="line">nums[pivot] = <span class="number">7</span> </span><br><span class="line">nums[pivot] = nums[r] = nums[<span class="number">7</span>] = nums[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">nums[r] = nums[pivot] = nums[<span class="number">7</span>] = nums[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">[<span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line">i = l - <span class="number">1</span> = <span class="number">0</span> - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">num[<span class="number">0</span>] = <span class="number">2</span> &lt; num[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">2</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">2</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">1</span></span><br><span class="line">nums[<span class="number">1</span>] = <span class="number">8</span> &gt; num[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">2</span></span><br><span class="line">nums[<span class="number">2</span>] = <span class="number">4</span> &lt; num[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">2</span>] = nums[<span class="number">1</span>] = <span class="number">8</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">1</span>] = nums[<span class="number">2</span>] = <span class="number">4</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">3</span></span><br><span class="line">nums[<span class="number">3</span>] = <span class="number">1</span> &lt; num[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">3</span>] = nums[<span class="number">2</span>] = <span class="number">8</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">2</span>] = nums[<span class="number">3</span>] = <span class="number">1</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">4</span></span><br><span class="line">nums[<span class="number">4</span>] = <span class="number">3</span> &lt; num[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">4</span>] = nums[<span class="number">3</span>] = <span class="number">8</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">3</span>] = nums[<span class="number">4</span>] = <span class="number">3</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">5</span></span><br><span class="line">nums[<span class="number">5</span>] = <span class="number">5</span> &lt; num[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">4</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">5</span>] = nums[<span class="number">4</span>] = <span class="number">8</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">4</span>] = nums[<span class="number">5</span>] = <span class="number">5</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">6</span></span><br><span class="line">nums[<span class="number">6</span>] = <span class="number">6</span> &lt; num[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">5</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">6</span>] = nums[<span class="number">5</span>] = <span class="number">8</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">5</span>] = nums[<span class="number">6</span>] = <span class="number">6</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">6</span></span><br><span class="line">nums[i] = nums[r] = nums[<span class="number">6</span>] = nums[<span class="number">7</span>] = <span class="number">8</span> </span><br><span class="line">nums[r] = nums[i] = nums[<span class="number">7</span>] = nums[<span class="number">1</span>] = <span class="number">7</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br><span class="line">切分元素 nums[pivot] = <span class="number">7</span> 交换到它排序以后最终确定的位置上</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> i = <span class="number">6</span></span><br><span class="line">mid = i = <span class="number">6</span> ，则原来下标为<span class="number">7</span>的元素<span class="number">7</span>的位置确定在下标<span class="number">6</span></span><br><span class="line"></span><br><span class="line">self.randomized_quicksort(nums, l, mid - <span class="number">1</span>)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">6</span> - <span class="number">1</span>)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">5</span>)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_pos</span>(<span class="params">lists, low, high</span>):</span></span><br><span class="line">    key = lists[low]</span><br><span class="line">    <span class="keyword">while</span> low &lt; high:</span><br><span class="line">        <span class="keyword">while</span> low &lt; high <span class="keyword">and</span> lists[high] &gt;= key:</span><br><span class="line">            high -= <span class="number">1</span></span><br><span class="line">        lists[low] = lists[high]</span><br><span class="line">        <span class="keyword">while</span> low &lt; high <span class="keyword">and</span> lists[low] &lt;= key:</span><br><span class="line">            low += <span class="number">1</span></span><br><span class="line">        lists[high] = lists[low]</span><br><span class="line">    lists[low] = key</span><br><span class="line">    <span class="keyword">return</span> low</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">alist, first, last</span>):</span></span><br><span class="line">    <span class="keyword">if</span> first &lt; last:</span><br><span class="line">        split_point = find_pos(alist, first, last)</span><br><span class="line">        quick_sort(alist, first, split_point<span class="number">-1</span>)</span><br><span class="line">        quick_sort(alist, split_point+<span class="number">1</span>, last)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">alist = [<span class="number">99</span>,<span class="number">88</span>,<span class="number">66</span>,<span class="number">23</span>,<span class="number">54</span>,<span class="number">23</span>,<span class="number">89</span>,<span class="number">0</span>,<span class="number">2</span>]</span><br><span class="line">quick_sort(alist,<span class="number">0</span>,len(alist)<span class="number">-1</span>)</span><br><span class="line">print(alist)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">array: list</span>) -&gt; list:</span></span><br><span class="line">    lower = []  <span class="comment"># 存放小于基准值的数据</span></span><br><span class="line">    higher = []  <span class="comment"># 存放大于基准值的数据</span></span><br><span class="line">    <span class="keyword">if</span> len(array) &lt;= <span class="number">1</span>:  <span class="comment"># 递归结束条件</span></span><br><span class="line">        <span class="keyword">return</span> array</span><br><span class="line"></span><br><span class="line">    pivot = array.pop()  <span class="comment"># 取列表最后一个数据为基准值</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> array:</span><br><span class="line">        <span class="keyword">if</span> i &gt;= pivot:</span><br><span class="line">            higher.append(i)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            lower.append(i)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> quick_sort(lower) + [pivot] + quick_sort(higher)</span><br></pre></td></tr></tbody></table></figure>

<h5 id="使用递归-推导式写快速排序"><a href="#使用递归-推导式写快速排序" class="headerlink" title="使用递归+推导式写快速排序"></a>使用递归+推导式写快速排序</h5><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">array</span>):</span></span><br><span class="line">    <span class="keyword">if</span> len(array) &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> array</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        pivot = array[<span class="number">0</span>]  <span class="comment"># 找到一个基准值</span></span><br><span class="line">        <span class="comment"># 遍历整个列表，将小于这个基准值的元素放到一个子列表中</span></span><br><span class="line">        less = [i <span class="keyword">for</span> i <span class="keyword">in</span> array[<span class="number">1</span>:] <span class="keyword">if</span> i &lt; pivot]</span><br><span class="line">        <span class="comment">#遍历整个列表，将大于这个基准值的元素放到一个子列表中</span></span><br><span class="line">        greater = [i <span class="keyword">for</span> i <span class="keyword">in</span> array[<span class="number">1</span>:] <span class="keyword">if</span> i &gt; pivot]</span><br><span class="line">        <span class="comment">#首先，明确我们对元素为0个/1个的列表无需要排序</span></span><br><span class="line">        <span class="comment">#使用函数递归</span></span><br><span class="line">        <span class="comment">#目标：让我们在一个基准值的一侧变为有序，然后依次返回，让我们的每个基准值的两侧都变得有序</span></span><br><span class="line">        <span class="keyword">return</span> quick_sort(less) + [pivot] + quick_sort(greater)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(quick_sort([<span class="number">2</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">11</span>]))</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">quick_list</span>):</span></span><br><span class="line">    <span class="keyword">if</span> quick_list == []:</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        first = quick_list[<span class="number">0</span>]</span><br><span class="line">        less = quick_sort([l <span class="keyword">for</span> l <span class="keyword">in</span> quick_list[<span class="number">1</span>:] <span class="keyword">if</span> l &lt; first])</span><br><span class="line">        more = quick_sort([m <span class="keyword">for</span> m <span class="keyword">in</span> quick_list[<span class="number">1</span>:] <span class="keyword">if</span> m &gt;= first])</span><br><span class="line">        <span class="keyword">return</span> less + [first] + more</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h2 id="各种排序的复杂度对比："><a href="#各种排序的复杂度对比：" class="headerlink" title="各种排序的复杂度对比："></a>各种排序的复杂度对比：</h2><p><img src="/2020/08/21/liu-da-ji-ben-pai-xu/%E6%8E%92%E5%BA%8F%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%AF%94%E8%BE%83.jpg"></p>
<hr>
<h2 id="算法执行的时间："><a href="#算法执行的时间：" class="headerlink" title="算法执行的时间："></a>算法执行的时间：</h2><p><img src="/2020/08/21/liu-da-ji-ben-pai-xu/%E6%8E%92%E5%BA%8F.png"></p>
<hr>
<h2 id="排序的内存使用："><a href="#排序的内存使用：" class="headerlink" title="排序的内存使用："></a>排序的内存使用：</h2><p><img src="/2020/08/21/liu-da-ji-ben-pai-xu/%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8.jpg"></p>
<h2 id="148-排序链表"><a href="#148-排序链表" class="headerlink" title="148. 排序链表"></a>148. 排序链表</h2><p><strong>在 O(n log n) 时间复杂度和常数级空间复杂度下，对链表进行排序。</strong></p>
<p>示例 1:</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: <span class="number">4</span>-&gt;<span class="number">2</span>-&gt;<span class="number">1</span>-&gt;<span class="number">3</span></span><br><span class="line">输出: <span class="number">1</span>-&gt;<span class="number">2</span>-&gt;<span class="number">3</span>-&gt;<span class="number">4</span></span><br></pre></td></tr></tbody></table></figure>
<p>示例 2:</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: <span class="number">-1</span>-&gt;<span class="number">5</span>-&gt;<span class="number">3</span>-&gt;<span class="number">4</span>-&gt;<span class="number">0</span></span><br><span class="line">输出: <span class="number">-1</span>-&gt;<span class="number">0</span>-&gt;<span class="number">3</span>-&gt;<span class="number">4</span>-&gt;<span class="number">5</span></span><br></pre></td></tr></tbody></table></figure>

<p>解答一：归并排序 递归的向下递推过程实际上是在切分链表。<br><img src="/2020/08/21/liu-da-ji-ben-pai-xu/..%5C%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%5C%E6%8E%92%E5%BA%8F%E9%93%BE%E8%A1%A8%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%EF%BC%88%E9%80%92%E5%BD%92%E6%B3%95%EF%BC%89.png"></p>
<ul>
<li><p>题目要求时间空间复杂度分别为O(nlogn)和O(1)，根据时间复杂度我们自然想到二分法，从而联想到归并排序；</p>
</li>
<li><p>对数组做归并排序的空间复杂度为 O(n)，分别由新开辟数组O(n)和递归函数调用O(logn)组成，而根据链表特性：</p>
<ul>
<li>数组额外空间：链表可以通过修改引用来更改节点顺序，无需像数组一样开辟额外空间；</li>
<li>递归额外空间：递归调用函数将带来O(logn)的空间复杂度，因此若希望达到O(1)空间复杂度，则不能使用递归。<br>二分是二叉树状结构，深度为 log N ~<br>切分链表时向下“二分”，因此递归树的高度是 O(log n) ，<br>每层都需遍历整个链表，占用 O(n) ，因此总体为 O(n log n) ~</li>
</ul>
</li>
</ul>
<p>每次找到中间节点的时间复杂度度是n,排序也是n,但是他们是在一个函数前后执行的还是n,<br>复杂度线性累加 还是原复杂度，只有内外嵌套才会升级为 N^2 ~</p>
<ul>
<li>通过递归实现链表归并排序，有以下两个环节：<ul>
<li>分割 cut 环节： 找到当前链表中点，并从中点将链表断开（以便在下次递归 cut 时，链表片段拥有正确边界）；<ul>
<li>我们使用 fast,slow 快慢双指针法，奇数个节点找到中点，偶数个节点找到中心左边的节点。</li>
<li>找到中点 slow 后，执行 slow.next = None 将链表切断。</li>
<li>递归分割时，输入当前链表左端点 head 和中心节点 slow 的下一个节点 mid(因为链表是从 slow 切断的)。</li>
<li>cut 递归终止条件： 当head.next == None时，说明只有一个节点了，直接返回此节点。</li>
</ul>
</li>
<li>合并 merge 环节： 将两个排序链表合并，转化为一个排序链表。<ul>
<li>双指针法合并，建立辅助ListNode h 作为头部。</li>
<li>设置两指针 left, right 分别指向两链表头部，比较两指针处节点值大小，由小到大加入合并链表头部，指针交替前进，直至添加完两个链表。</li>
<li>返回辅助ListNode h 作为头部的下个节点 h.next。</li>
<li>时间复杂度 O(l + r)，l, r 分别代表两个链表长度。</li>
</ul>
</li>
<li>当题目输入的 head == None 时，直接返回None。</li>
</ul>
</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortList</span>(<span class="params">self, head: ListNode</span>) -&gt; ListNode:</span></span><br><span class="line">        <span class="comment"># 递归结束条件</span></span><br><span class="line">        <span class="comment"># 当题目输入的 head == None 时，直接返回None。</span></span><br><span class="line">        <span class="comment"># 当head.next == None时，说明只有一个节点了，直接返回此节点。</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head <span class="keyword">or</span> <span class="keyword">not</span> head.next: </span><br><span class="line">            <span class="keyword">return</span> head <span class="comment"># termination.</span></span><br><span class="line">        <span class="comment"># cut the LinkedList at the mid index.</span></span><br><span class="line">        <span class="comment"># 每次慢指针+1，快指针都相当于+2，</span></span><br><span class="line">        <span class="comment"># 所以当快指针到终点，慢指针到达中点</span></span><br><span class="line">        slow, fast = head, head.next</span><br><span class="line">        <span class="keyword">while</span> fast <span class="keyword">and</span> fast.next:  <span class="comment"># 快</span></span><br><span class="line">            fast, slow = fast.next.next, slow.next</span><br><span class="line">        mid, slow.next = slow.next, <span class="literal">None</span> <span class="comment"># save and cut.</span></span><br><span class="line">        <span class="comment"># recursive for cutting.</span></span><br><span class="line">        <span class="comment"># left, right 分别指向两链表头部，比较两指针处节点值大小，</span></span><br><span class="line">        left, right = self.sortList(head), self.sortList(mid)</span><br><span class="line">        <span class="comment"># merge `left` and `right` linked list and return it.</span></span><br><span class="line">        <span class="comment"># res 是新建listNode，可以理解为新建一个头结点保留头指针，未创建新的链表，只是修改了原链表的节点指向，res指向的是h指针，这个h就是dummy亚指针，并不是合并后的头结点，而是它的前一个节点</span></span><br><span class="line">        <span class="comment"># 因为原头指针 h 在合并排序链表的时候会变化</span></span><br><span class="line">        h = res = ListNode(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">while</span> left <span class="keyword">and</span> right:</span><br><span class="line">            <span class="keyword">if</span> left.val &lt; right.val:</span><br><span class="line">                h.next, left = left, left.next</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                h.next, right = right, right.next</span><br><span class="line">            h = h.next</span><br><span class="line">        <span class="comment">#  前面while排序后, 如果左右子链表长度相同 ，</span></span><br><span class="line">        <span class="comment"># left和right都应该指向了左右子链表的最后一个node.next都是None</span></span><br><span class="line">        <span class="comment"># 但实际上长度可能不同，比如总长为 7 的链表，</span></span><br><span class="line">        <span class="comment"># 只能被分为7 = 3+4, 3 = 1+2……</span></span><br><span class="line">        <span class="comment"># 此时就需要把没走完的链表再加到尾部了。</span></span><br><span class="line">        h.next = left <span class="keyword">if</span> left <span class="keyword">else</span> right</span><br><span class="line">        <span class="comment"># h.next = left or right 更加 pythonic</span></span><br><span class="line">        <span class="keyword">return</span> res.next  <span class="comment"># 保存归并的结果的</span></span><br></pre></td></tr></tbody></table></figure>

<p>在 cut 到链表长度为 2 时，如果 fast, slow 都指向头部 head ，那么fast会走两步，slow走一步，cut点是不对的。 如果fast先走一步到 head.next ，就会避免长度为 2 时出现的特殊错误情况。<br>[3, 2]<br>slow = = head = 3<br>fast = = head.next = 2<br>fast.next = None不进入循环<br>mid = slow.next = 3<br>slow.next = None [3 | 2]</p>
<p>如果初始化时令fast=head，slow=head<br>slow = head = 3<br>fast.next != None进入循环</p>
<p>slow = slow.next = 2<br>fast = fast.next.next =None<br>mid = slow.next = None<br>slow.next = None </p>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span> <span class="number">2</span> <span class="number">4</span> <span class="number">6</span></span><br><span class="line"><span class="string">slow</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"><span class="string">fast</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">slow</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">fast</span> <span class="string">=</span> <span class="number">6</span></span><br><span class="line">  </span><br><span class="line"><span class="string">mid</span> <span class="string">=</span> <span class="number">4</span> </span><br><span class="line"><span class="string">slow.next</span> <span class="string">=</span> <span class="string">None</span> <span class="string">切断</span>  [<span class="number">3</span>, <span class="number">2</span> <span class="string">|</span> <span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="string">self.sortList(head)</span>  [<span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line"><span class="string">slow</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"><span class="string">fast</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">fast.next</span> <span class="string">=</span> <span class="string">None</span> <span class="string">不进入循环</span></span><br><span class="line"><span class="string">mid</span> <span class="string">=</span> <span class="string">slow.next</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">slow.next</span> <span class="string">=</span> <span class="string">None</span>    [<span class="number">3</span> <span class="string">|</span> <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="string">self.sortList(head)</span></span><br><span class="line"><span class="string">head</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"><span class="string">head.next</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"><span class="string">return</span> <span class="string">head</span> </span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="string">right</span> <span class="string">=</span> <span class="string">self.sortList(mid)</span></span><br><span class="line"><span class="string">head</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">head.next</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"><span class="string">return</span> <span class="string">head</span> </span><br><span class="line"><span class="string">right</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="string">独立的</span> <span class="number">3</span> <span class="string">和</span> <span class="number">2</span> <span class="string">合并</span></span><br><span class="line"><span class="number">3</span> <span class="string">&gt;</span> <span class="number">2</span></span><br><span class="line"><span class="string">h.next</span> <span class="string">=</span> <span class="string">right</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">right</span> <span class="string">=</span> <span class="string">right.next</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"><span class="string">h</span> <span class="string">=</span> <span class="string">h.next</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">跳出循环</span></span><br><span class="line"><span class="string">h.next</span> <span class="string">=</span> <span class="string">left</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"></span><br><span class="line"><span class="string">right</span> <span class="string">=</span> <span class="string">self.sortList(mid)</span>  [<span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line"><span class="string">slow</span> <span class="string">=</span> <span class="number">4</span></span><br><span class="line"><span class="string">fast</span> <span class="string">=</span> <span class="number">6</span></span><br><span class="line"><span class="string">fast.next</span> <span class="string">=</span> <span class="string">None</span> <span class="string">不进入循环</span></span><br><span class="line"><span class="string">mid</span> <span class="string">=</span> <span class="string">slow.next</span> <span class="string">=</span> <span class="number">6</span></span><br><span class="line"><span class="string">slow.next</span> <span class="string">=</span> <span class="string">None</span>    [<span class="number">4</span> <span class="string">|</span> <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="string">self.sortList(head)</span> </span><br><span class="line"><span class="string">head</span> <span class="string">=</span> <span class="number">4</span></span><br><span class="line"><span class="string">head.next</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"><span class="string">return</span> <span class="string">head</span> </span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="string">right</span> <span class="string">=</span> <span class="string">self.sortList(mid)</span></span><br><span class="line"><span class="string">head</span> <span class="string">=</span> <span class="number">6</span></span><br><span class="line"><span class="string">head.next</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"><span class="string">return</span> <span class="string">head</span> </span><br><span class="line"><span class="string">right</span> <span class="string">=</span> <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="string">独立的</span> <span class="number">4</span> <span class="string">和</span> <span class="number">6</span> <span class="string">合并</span></span><br><span class="line"><span class="number">4</span> <span class="string">&lt;</span> <span class="number">6</span>          </span><br><span class="line"><span class="string">h.next</span> <span class="string">=</span> <span class="string">left</span> <span class="string">=</span> <span class="number">4</span></span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="string">left.next</span> <span class="string">=</span> <span class="string">None</span> </span><br><span class="line"><span class="string">h</span> <span class="string">=</span> <span class="string">h.next</span> <span class="string">=</span> <span class="number">4</span></span><br><span class="line"><span class="string">跳出循环</span></span><br><span class="line"><span class="string">h.next</span> <span class="string">=</span> <span class="string">left</span> <span class="string">=</span> <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"></span><br><span class="line"><span class="string">独立的</span> [<span class="number">2</span>, <span class="number">3</span>] <span class="string">和</span> [<span class="number">4</span>, <span class="number">6</span>] <span class="string">合并</span></span><br><span class="line"><span class="number">2</span> <span class="string">&lt;</span> <span class="number">4</span>         </span><br><span class="line"><span class="string">h.next</span> <span class="string">=</span> <span class="string">left</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="string">left.next</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"><span class="string">h</span> <span class="string">=</span> <span class="string">h.next</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">再循环</span></span><br><span class="line"><span class="number">3</span> <span class="string">&lt;</span> <span class="number">4</span></span><br><span class="line"><span class="string">h.next</span> <span class="string">=</span> <span class="string">left</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="string">left.next</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"><span class="string">h</span> <span class="string">=</span> <span class="string">h.next</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"><span class="string">h.next</span> <span class="string">=</span> <span class="string">right</span> <span class="string">=</span> <span class="number">4</span> <span class="string">right只是链表的头节点，会指向后面排序好的节点6</span></span><br><span class="line"><span class="string">h指向2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">6</span><span class="string">，ok</span></span><br></pre></td></tr></tbody></table></figure>

<p>一次方法的调用和返回代表着一个栈帧的入栈和出栈，栈帧出栈后，该栈帧中的临时变量所占用的空间都会得到释放。 对于数组的归并排序之所以空间复杂度是O(n)，是因为数组归并排序使用了一个创建了一个辅助数组。这里每个栈帧创建的只是辅助节点，出栈后就释放了。空间复杂度应该是O(1)<br>若算法执行所需要的辅助空间相对于输入数据n而言是一个常数，则称这个算法空间复杂度辅助空间为o（1）；<br>递归算法空间复杂度：递归深度n*每次递归所要的辅助空间，如果每次递归所需要的辅助空间为常数，则递归空间复杂度o（n）。</p>
<p>递归栈的空间复杂度和递归函数调用的 深度 有关<br>（即在某时刻有多少个递归函数 “尚未返回”）。<br>在返回后，系统会释放栈空间的。<br>递归调用次数多，空间复杂度不一定更高~</p>
<p>偶數個數的時候 mid 有偏左和偏右兩個。<br>如果直接從 fast 開始，slow 永遠會走到偏右的那個，會進入無窮迴圈。<br>所以我們要的是偏左那個 mid，一開始要先多走一步<br>如果不令fast初始化为head.next，则在链表长度n为偶数的情况下返回第n/2 + 1个数，题意需要的是第n/2个数<br>因为起点一样的话,拆分到只剩两个节点的时候,这两个节点永远拆分不开</p>
<hr>
<p>法二：归并排序（从底至顶直接合并）</p>
<p><img src="/2020/08/21/liu-da-ji-ben-pai-xu/..%5C%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%5C%E6%8E%92%E5%BA%8F%E9%93%BE%E8%A1%A8%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%EF%BC%88%E4%BB%8E%E5%BA%95%E8%87%B3%E9%A1%B6%E7%9B%B4%E6%8E%A5%E5%90%88%E5%B9%B6%EF%BC%89.png"></p>
<ul>
<li><p>对于非递归的归并排序，需要使用迭代的方式替换cut环节：</p>
<ul>
<li>我们知道，cut环节本质上是通过二分法得到链表最小节点单元，再通过多轮合并得到排序结果。</li>
<li>每一轮合并merge操作针对的单元都有固定长度intv，例如：<ul>
<li>第一轮合并时intv = 1，即将整个链表切分为多个长度为1的单元，并按顺序两两排序合并，合并完成的已排序单元长度为2。</li>
<li>第二轮合并时intv = 2，即将整个链表切分为多个长度为2的单元，并按顺序两两排序合并，合并完成已排序单元长度为4。</li>
<li>以此类推，直到单元长度intv &gt;= 链表长度，代表已经排序完成。</li>
</ul>
</li>
<li>据以上推论，我们可以仅根据intv计算每个单元边界，并完成链表的每轮排序合并，例如:<ul>
<li><p>当intv = 1时，将链表第1和第2节点排序合并，第3和第4节点排序合并，……。</p>
</li>
<li><p>当intv = 2时，将链表第1-2和第3-4节点排序合并（第一组小片段），第5-6和第7-8节点排序合并（第二组小片段），……。，</p>
</li>
<li><p>当intv = 4时，将链表第1-4和第5-8节点排序合并，第9-12和第13-16节点排序合并，……。</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>此方法时间复杂度O(nlogn)，空间复杂度O(1)。</p>
</li>
<li><p>模拟上述的多轮排序合并：</p>
<ul>
<li>统计链表长度length，用于通过判断intv &lt; length判定是否完成排序；</li>
<li>额外声明一个节点root，作为头部后面接整个链表，用于：<ul>
<li>intv *= 2即切换到下一轮合并时，可通过root.next找到链表头部cur；</li>
<li>执行排序合并时，需要一个辅助节点作为头部，而root则作为链表头部排序合并时的辅助头部merge_point；后面的合并排序可以将上次合并排序的尾部tail用做辅助节点。</li>
</ul>
</li>
<li>在每轮intv下的合并流程：<ol>
<li>根据intv找到合并单元1和单元2的头部h1, h2。<br>由于链表长度可能不是2^n，需要考虑边界条件：<ul>
<li>在找h2过程中，如果链表剩余元素个数少于intv，则无需合并环节，直接break，执行下一轮合并；</li>
<li>若h2存在，但以h2为头部的剩余元素个数少于intv，也执行合并环节，h2单元的长度为len2 = intv - intv_residue_2。</li>
</ul>
</li>
<li>合并长度为len1, len2的h1, h2链表，其中：<ul>
<li>合并完后，需要修改新的合并单元的尾部merge_point指针指向下一个合并单元头部current。<br>（在寻找h1, h2环节中，current指针已经被移动到下一个单元头部）</li>
<li>合并单元尾部同时也作为下次合并的辅助头部merge_point。</li>
</ul>
</li>
<li>当current == None，代表此轮intv合并完成，跳出。</li>
</ol>
</li>
<li>每轮合并完成后将单元长度×2，切换到下轮合并：intv *= 2。</li>
</ul>
</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortList</span>(<span class="params">self, head: ListNode</span>) -&gt; ListNode:</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head <span class="keyword">or</span> <span class="keyword">not</span> head.next:</span><br><span class="line">            <span class="keyword">return</span> head</span><br><span class="line"></span><br><span class="line">        cur, length = head, <span class="number">0</span></span><br><span class="line">        <span class="comment">#  遍历链表求长度，时间复杂度就是On了,</span></span><br><span class="line">        <span class="comment">#  O(nlogn)复杂度高于线性低于平方,所以有个O(n)没关系</span></span><br><span class="line">        <span class="keyword">while</span> cur:</span><br><span class="line">            cur, length = cur.next, length + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        root = ListNode(<span class="number">0</span>)</span><br><span class="line">        root.next = head</span><br><span class="line">        intv = <span class="number">1</span>  <span class="comment"># 每次合并的规模</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 根据不同的链表切片规模，每一次都从头进行归并</span></span><br><span class="line">        <span class="keyword">while</span> intv &lt; length:</span><br><span class="line">            merge_point, current = root, root.next</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> current:  <span class="comment"># 根据当前的合并规模，将链表内的链表切片两两归并</span></span><br><span class="line">                <span class="comment"># 获取当前需要归并的子链表 h1</span></span><br><span class="line">                h1, intv_residue_1 = current, intv</span><br><span class="line">                <span class="keyword">while</span> intv_residue_1 <span class="keyword">and</span> current:</span><br><span class="line">                    current, intv_residue_1 = current.next, intv_residue_1 - <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> intv_residue_1:</span><br><span class="line">                    <span class="comment"># h2 在这种情况下不存在，所以本轮不需要合并</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># 获取当前需要归并的子链表 h2</span></span><br><span class="line">                h2, intv_residue_2 = current, intv</span><br><span class="line">                <span class="keyword">while</span> intv_residue_2 <span class="keyword">and</span> current:</span><br><span class="line">                    current, intv_residue_2 = current.next, intv_residue_2 - <span class="number">1</span></span><br><span class="line">                <span class="comment"># len2 的长度可能比 intv 小</span></span><br><span class="line">                len1, len2 = intv, intv - intv_residue_2</span><br><span class="line">                <span class="comment"># 归并排序</span></span><br><span class="line">                <span class="comment"># len1或len2一定有一个是等于0的，链接剩下的被切割剩下的一个链表</span></span><br><span class="line">                <span class="keyword">while</span> len1 <span class="keyword">and</span> len2:</span><br><span class="line">                    <span class="keyword">if</span> h1.val &lt; h2.val:</span><br><span class="line">                        merge_point.next, h1, len1 = h1, h1.next, len1 - <span class="number">1</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        merge_point.next, h2, len2 = h2, h2.next, len2 - <span class="number">1</span></span><br><span class="line">                    merge_point = merge_point.next</span><br><span class="line">                <span class="comment"># 归并排序处理一下没有被归并的剩余值</span></span><br><span class="line">                <span class="keyword">if</span> len1:</span><br><span class="line">                    merge_point.next = h1</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    merge_point.next = h2</span><br><span class="line">                <span class="comment"># merge_point.next=h1 or h2 只是完成了第一组内部小片段最后一个节点的连接，例如此时 h1 = 2, h2 = 3，把2 和 3 连上 </span></span><br><span class="line">                <span class="comment"># merge_point指向的元素不一定是当前链表切片的末尾</span></span><br><span class="line">                <span class="comment"># merge_point还应该继续后移，直到指向当前链表切片末尾（即下一次链表切片的开头）</span></span><br><span class="line">                <span class="keyword">while</span> len1 &gt; <span class="number">0</span> <span class="keyword">or</span> len2 &gt; <span class="number">0</span>:</span><br><span class="line">                    merge_point, len1, len2 = merge_point.next, len1 - <span class="number">1</span>, len2 - <span class="number">1</span></span><br><span class="line">                <span class="comment"># 把归并后的链表切片第一小组片段尾跟原链表h2之第二小组的头拼起来</span></span><br><span class="line">                <span class="comment"># 一次合并后有可能最后一个结点顺序被打乱而不是下一次合并的起点</span></span><br><span class="line">                <span class="comment"># [2 3] 要连上 还未排序的[4 6]</span></span><br><span class="line">                merge_point.next = current</span><br><span class="line"></span><br><span class="line">            intv *= <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> root.next</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span> <span class="number">2</span> <span class="number">4</span> <span class="number">6</span></span><br><span class="line"></span><br><span class="line">current = <span class="number">3</span></span><br><span class="line">length = <span class="number">0</span></span><br><span class="line">进入循环</span><br><span class="line">current = current.next = <span class="number">2</span></span><br><span class="line">length = <span class="number">1</span></span><br><span class="line">current = current.next = <span class="number">4</span></span><br><span class="line">length = <span class="number">2</span></span><br><span class="line">current = current.next = <span class="number">6</span></span><br><span class="line">length = <span class="number">3</span></span><br><span class="line">current = current.next = None</span><br><span class="line">length = <span class="number">4</span></span><br><span class="line">退出循环</span><br><span class="line"></span><br><span class="line">root.next = head</span><br><span class="line"><span class="built_in">int</span>v = <span class="number">1</span>  </span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>v = <span class="number">1</span> &lt; length = <span class="number">4</span></span><br><span class="line">merge_point = root </span><br><span class="line">current = root.next = head = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">进入循环</span><br><span class="line"></span><br><span class="line">h1 = current = <span class="number">3</span></span><br><span class="line"><span class="built_in">int</span>v_residue_1 = <span class="built_in">int</span>v = <span class="number">1</span></span><br><span class="line">进入子循环</span><br><span class="line">current = current.next = <span class="number">2</span></span><br><span class="line"><span class="built_in">int</span>v_residue_1 = <span class="built_in">int</span>v_residue_1 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">退出子循环</span><br><span class="line"></span><br><span class="line">h2 = current = <span class="number">2</span></span><br><span class="line"><span class="built_in">int</span>v_residue_2 = <span class="built_in">int</span>v = <span class="number">1</span></span><br><span class="line">进入子循环                    </span><br><span class="line">current = current.next = <span class="number">4</span></span><br><span class="line"><span class="built_in">int</span>v_residue_2 = <span class="built_in">int</span>v_residue_2 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">退出子循环</span><br><span class="line"></span><br><span class="line">len1 = <span class="built_in">int</span>v = <span class="number">1</span></span><br><span class="line">len2 = <span class="built_in">int</span>v - <span class="built_in">int</span>v_residue_2 = <span class="number">1</span>  </span><br><span class="line"></span><br><span class="line">进入子循环</span><br><span class="line"><span class="number">3</span> &gt; <span class="number">2</span></span><br><span class="line">merge_point.next = h2 = <span class="number">2</span></span><br><span class="line">h2 = h2.next = <span class="number">4</span></span><br><span class="line">len2 = len2 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">merge_point = merge_point.next = <span class="number">2</span></span><br><span class="line">跳出子循环</span><br><span class="line"></span><br><span class="line">merge_point.next = h1 = <span class="number">3</span>  </span><br><span class="line"></span><br><span class="line">merge_point = merge_point.next = <span class="number">3</span></span><br><span class="line">len1 = len1 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">len2 = len2 - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">merge_point.next = current = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">h1 = current = <span class="number">4</span></span><br><span class="line"><span class="built_in">int</span>v_residue_1 = <span class="built_in">int</span>v = <span class="number">1</span></span><br><span class="line">进入子循环</span><br><span class="line">current = current.next = <span class="number">6</span></span><br><span class="line"><span class="built_in">int</span>v_residue_1 = <span class="built_in">int</span>v_residue_1 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">退出子循环</span><br><span class="line"></span><br><span class="line">h2 = current = <span class="number">6</span></span><br><span class="line"><span class="built_in">int</span>v_residue_2 = <span class="built_in">int</span>v = <span class="number">1</span></span><br><span class="line">进入子循环                    </span><br><span class="line">current = current.next = None</span><br><span class="line"><span class="built_in">int</span>v_residue_2 = <span class="built_in">int</span>v_residue_2 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">退出子循环</span><br><span class="line">len1 = <span class="built_in">int</span>v = <span class="number">1</span></span><br><span class="line">len2 = <span class="built_in">int</span>v - <span class="built_in">int</span>v_residue_2 = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">进入子循环</span><br><span class="line"><span class="number">4</span> &lt; <span class="number">6</span></span><br><span class="line">merge_point.next = h1 = <span class="number">4</span></span><br><span class="line">h1 = h1.next = <span class="number">6</span></span><br><span class="line">len1 = len1 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">merge_point = merge_point.next = <span class="number">4</span></span><br><span class="line">跳出循环</span><br><span class="line"></span><br><span class="line">merge_point.next = h2 = <span class="number">6</span></span><br><span class="line"></span><br><span class="line">merge_point = merge_point.next = <span class="number">6</span></span><br><span class="line">len1 = len1 - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line">len2 = len2 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">merge_point.next = current = None</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>v = <span class="built_in">int</span>v * <span class="number">2</span> =  <span class="number">2</span></span><br><span class="line"></span><br><span class="line">merge_point = root</span><br><span class="line">current = root.next = head = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">进入循环</span><br><span class="line"></span><br><span class="line">h1 = current = <span class="number">2</span></span><br><span class="line"><span class="built_in">int</span>v_residue_1 = <span class="built_in">int</span>v = <span class="number">2</span></span><br><span class="line">进入子循环</span><br><span class="line">current = current.next = <span class="number">3</span></span><br><span class="line"><span class="built_in">int</span>v_residue_1 = <span class="built_in">int</span>v_residue_1 - <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">再循环</span><br><span class="line">current = current.next = <span class="number">4</span></span><br><span class="line"><span class="built_in">int</span>v_residue_1 = <span class="built_in">int</span>v_residue_1 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">退出子循环</span><br><span class="line"></span><br><span class="line">h2 = current = <span class="number">4</span></span><br><span class="line"><span class="built_in">int</span>v_residue_2 = <span class="built_in">int</span>v = <span class="number">2</span></span><br><span class="line">进入子循环                    </span><br><span class="line">current = current.next = <span class="number">6</span></span><br><span class="line"><span class="built_in">int</span>v_residue_2 = <span class="built_in">int</span>v_residue_2 - <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">退出子循环</span><br><span class="line">len1 = <span class="built_in">int</span>v = <span class="number">2</span></span><br><span class="line">len2 = <span class="built_in">int</span>v - <span class="built_in">int</span>v_residue_2 = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">进入子循环</span><br><span class="line"><span class="number">2</span> &lt; <span class="number">4</span></span><br><span class="line">merge_point.next = h1 = <span class="number">2</span></span><br><span class="line">h1 = h1.next = <span class="number">3</span> </span><br><span class="line">len1 = len1 - <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">merge_point = merge_point.next = <span class="number">2</span></span><br><span class="line"><span class="number">3</span> &lt; <span class="number">4</span></span><br><span class="line">merge_point.next = h1 = <span class="number">3</span></span><br><span class="line">h1 = h1.next = <span class="number">4</span> </span><br><span class="line">len1 = len1 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">merge_point = merge_point.next = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">merge_point.next = h2 = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">merge_point = merge_point.next = <span class="number">4</span></span><br><span class="line">len1 = len1 - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line">len2 = len2 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">merge_point.next = current = <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>v = <span class="built_in">int</span>v * <span class="number">2</span> = <span class="number">4</span> = length 跳出循环</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>root.next = head不写成root = head<br>head指向的头节点在排序过程中是变化的顺序可能会被打乱，比如 4，3，2，1第一次完成后变为3，4，1，2，此时head指向了第二个节点，就不是头节点了，而dummy.next始终会指向每次归并完之后的新头节点，我觉得可以参照代码手推下更好理解了</p>
<hr>
<h3 id="堆-Heap-是计算机科学中一类特殊的数据结构的统称，一般讨论的堆都是二叉堆。"><a href="#堆-Heap-是计算机科学中一类特殊的数据结构的统称，一般讨论的堆都是二叉堆。" class="headerlink" title="堆(Heap)是计算机科学中一类特殊的数据结构的统称，一般讨论的堆都是二叉堆。"></a>堆(Heap)是计算机科学中一类特殊的数据结构的统称，一般讨论的堆都是二叉堆。</h3><p>堆满足下列性质：</p>
<ol>
<li>堆中某个节点的值或索引总是不大于或不小于其父节点的值或索引。</li>
<li>堆总是一棵完全二叉树，且该完全二叉树的深度为 k，除第 k 层外，其它各层 (1～k-1) 的结点数都达到最大个数，第 k 层所有的结点都连续集中在最左边。</li>
</ol>
<p>把堆看作原生的Python list，数组的下标对应堆中节点的编号<br>我们使用了从零开始的索引。这使得节点和其孩子节点索引之间的关系不太直观但更加适合，<br>heap[0] 表示访问最小的元素总是在根结点而不弹出它。，同时 heap.sort() 维护了堆的不变性！</p>
<h3 id="堆排序：利用堆的概念来排序的选择排序。先将待排序的序列建成分为两种："><a href="#堆排序：利用堆的概念来排序的选择排序。先将待排序的序列建成分为两种：" class="headerlink" title="堆排序：利用堆的概念来排序的选择排序。先将待排序的序列建成分为两种："></a>堆排序：利用堆的概念来排序的选择排序。先将待排序的序列建成分为两种：</h3><ol>
<li>大顶堆：每个节点的值都大于或等于其子节点的值，在堆排序算法中用于升序排列；<br>此时整个序列最大值即为堆顶元素，我们将其与末尾元素交换，使末尾元素为最大值，然后再调整堆顶元素使得剩下的 n−1 个元素仍为大根堆，再重复执行以上操作我们即能得到一个有序的序列。</li>
<li>小顶堆：每个节点的值都小于或等于其子节点的值，在堆排序算法中用于降序排列；</li>
</ol>
<h1 id="Python-里的-heapq-模块"><a href="#Python-里的-heapq-模块" class="headerlink" title="Python 里的 heapq 模块"></a>Python 里的 heapq 模块</h1><p>python3标准库中提供了heapq，使用原地算法得到对小顶堆进行操作<br>提供了堆队列算法的实现，也称为优先队列算法。<br>一般我们刷题或者写业务代码的时候，使用这个内置的 heapq 模块就够用了</p>
<p>实现 大顶堆 方法：小顶堆的插入和弹出操作均将元素 取反<br>小顶堆[1,2,3]堆顶是1，<br>如果想让3在堆顶的话，就只能是[-3,-2,-1]，堆顶是-3，<br>然后每次heappop取出时，-3加上负号就变成3了，变相实现大顶堆</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>          <span class="number">-3</span></span><br><span class="line">  /  \       /  \</span><br><span class="line"> <span class="number">2</span>    <span class="number">3</span>     <span class="number">-2</span>  <span class="number">-1</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>shift up ：如何向一个最大堆中添加元素</li>
<li>shift down 如何从一个最大堆中取出一个元素，只能取出最大优先级的元素，也就是根节点，</li>
</ul>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">              <span class="number">62</span></span><br><span class="line">            /     \</span><br><span class="line">           <span class="number">52</span>      <span class="number">30</span></span><br><span class="line">         /   \     / \</span><br><span class="line">        <span class="number">28</span>    <span class="number">41</span>  <span class="number">22</span>  <span class="number">13</span></span><br><span class="line">       /  \      / \</span><br><span class="line">      <span class="number">19</span>  <span class="number">17</span> <span class="number">15</span> <span class="number">16</span></span><br><span class="line">把原来的 <span class="number">62</span> 取出后，</span><br><span class="line"></span><br><span class="line">            /     \</span><br><span class="line">           <span class="number">52</span>      <span class="number">30</span></span><br><span class="line">         /   \     / \</span><br><span class="line">        <span class="number">28</span>    <span class="number">41</span>  <span class="number">22</span>  <span class="number">13</span></span><br><span class="line">       /  \      / \</span><br><span class="line">      <span class="number">19</span>  <span class="number">17</span> <span class="number">15</span> <span class="number">16</span></span><br><span class="line"></span><br><span class="line">将数组最后一位数组放到根节点，此时不满足最大堆的定义。</span><br><span class="line">              <span class="number">16</span></span><br><span class="line">            /     \</span><br><span class="line">           <span class="number">52</span>      <span class="number">30</span></span><br><span class="line">         /   \     / \</span><br><span class="line">        <span class="number">28</span>    <span class="number">41</span>  <span class="number">22</span>  <span class="number">13</span></span><br><span class="line">       /  \      / \</span><br><span class="line">      <span class="number">19</span>  <span class="number">17</span> <span class="number">15</span> </span><br><span class="line">调整的过程是将这个根节点 <span class="number">16</span> 一步一步向下挪，<span class="number">16</span> 比子节点都小，</span><br><span class="line">先比较子节点 <span class="number">52</span> 和 <span class="number">30</span> 哪个大，和大的交换位置。</span><br><span class="line">              <span class="number">52</span></span><br><span class="line">            /     \</span><br><span class="line">           <span class="number">16</span>      <span class="number">30</span></span><br><span class="line">         /   \     / \</span><br><span class="line">        <span class="number">28</span>    <span class="number">41</span>  <span class="number">22</span>  <span class="number">13</span></span><br><span class="line">       /  \      / \</span><br><span class="line">      <span class="number">19</span>  <span class="number">17</span> <span class="number">15</span> </span><br><span class="line">继续比较 <span class="number">16</span> 的子节点 <span class="number">28</span> 和 <span class="number">41</span>，<span class="number">41</span> 大，所以 <span class="number">16</span> 和 <span class="number">41</span> 交换位置。</span><br><span class="line">              <span class="number">52</span></span><br><span class="line">            /     \</span><br><span class="line">           <span class="number">41</span>      <span class="number">30</span></span><br><span class="line">         /   \     / \</span><br><span class="line">        <span class="number">28</span>    <span class="number">16</span>  <span class="number">22</span>  <span class="number">13</span></span><br><span class="line">       /  \      / \</span><br><span class="line">      <span class="number">19</span>  <span class="number">17</span> <span class="number">15</span> </span><br><span class="line">继续 <span class="number">16</span> 和孩子节点 <span class="number">15</span> 进行比较，<span class="number">16</span> 大，所以现在不需要进行交换，最后我们的 shift down 操作完成，维持了一个最大堆的性质。</span><br></pre></td></tr></tbody></table></figure>


<p>要创建一个堆 </p>
<ol>
<li><p>或者 <code>heapq.heapify(list)</code> ，将列表list原地转换成为最小二叉堆列表，具备最小堆特征 线性时间内，算法时间复杂度为 O(n)。<br>Transform list x into a heap, in-place, in linear time.</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">heap2 = [<span class="number">5</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">heapq.heapify(heap2)</span><br><span class="line">print(heap2)</span><br><span class="line"><span class="comment"># [0, 1, 5, 3, 2, 7, 9, 8, 4, 6]</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">            0</span></span><br><span class="line"><span class="string">          /   \</span></span><br><span class="line"><span class="string">         1     5</span></span><br><span class="line"><span class="string">        / \   / \</span></span><br><span class="line"><span class="string">       3   2  7  9</span></span><br><span class="line"><span class="string">      / \ / \</span></span><br><span class="line"><span class="string">     8  4 6</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>可以使用list来初始化为 []<br><code>heapq.heappush(heap, item)</code><br>将 item 的值加入 heap 中，保持堆的不变性。<br>push后堆也应该是一棵完全二叉树，所以必须将元素追加到数组末尾</p>
</li>
</ol>
<p><code>heapq.heappop(heap)</code><br>弹出并返回 heap 的最小的元素，保持堆的不变性。<br>如果堆为空，抛出 IndexError 。</p>
<p><code>heapq.heappushpop(heap, item)</code><br>将 item 放入堆中，然后弹出并返回 heap 的最小元素。<br>该组合操作比先调用  heappush() 再调用 heappop() 运行起来更有效率。</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">从 iterable 所定义的数据集中返回前 n 个最小元素组成的列表。 </span><br><span class="line">如果提供了 key 则其应指定一个单参数的函数，</span><br><span class="line">用于从 iterable 的每个元素中提取比较键 (例如 key=str.lower)。 等价于: sorted(iterable, key=key)[:n]。。</span><br><span class="line"></span><br><span class="line">堆排序的原理是通过不断 交换元素 实现排序的：</span><br><span class="line">在数组中交换两个索引的元素时间复杂度为 O(1)，</span><br><span class="line">而链表 交换元素 本身是 O(N) 时间复杂度，若可以把此问题解决就可以用堆排。</span><br><span class="line"></span><br><span class="line">时间复杂度：O(nlogn)。初始化建堆的时间复杂度为 O(n)，建完堆以后需要进行 n-1 次调整，一次调整（即 maxHeapify） 的时间复杂度为 O(logn)，那么 n−1 次调整即需要 O(nlogn) 的时间复杂度。因此，总时间复杂度为 O(n+nlogn)=O(nlogn)。</span><br><span class="line"></span><br><span class="line">空间复杂度：O(1)。给一个未排序的数组arr，堆排序就地排序，不借用额外空间，仅在arr上调整元素位置完成排序。如果把原数组arr算上就是O(N)，但一般只计算使用到的额外空间，只需要常数的空间存放若干变量。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line">import heapq</span><br><span class="line"></span><br><span class="line">data = [3, 2, 6, 1]</span><br><span class="line">heap1 = []</span><br><span class="line"># 使用heapq库的heappush函数将数据堆入</span><br><span class="line">for i in data:</span><br><span class="line">    heapq.heappush(heap1, i)  # 数据堆入</span><br><span class="line">print(heap1)  # [1, 2, 6, 3]</span><br><span class="line">'''</span><br><span class="line">            1</span><br><span class="line">           /  \</span><br><span class="line">          2    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3</span><br><span class="line">'''</span><br><span class="line">heapq.heappush(heap1, 5)</span><br><span class="line">print(heap1)  # [1, 2, 6, 3, 5]</span><br><span class="line">'''</span><br><span class="line">            1</span><br><span class="line">           /  \</span><br><span class="line">          2    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5</span><br><span class="line">将元素追加到数组末尾，符合最小堆的规律        </span><br><span class="line">'''</span><br><span class="line">heapq.heappush(heap1, 0.5)</span><br><span class="line">print(heap1)</span><br><span class="line"># [0.5, 2, 1, 3, 5, 6]</span><br><span class="line">'''</span><br><span class="line">            1</span><br><span class="line">           /  \</span><br><span class="line">          2    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 0.5</span><br><span class="line">将元素追加到数组末尾，不符合最小堆的规律，需要调整</span><br><span class="line">            1</span><br><span class="line">           /  \</span><br><span class="line">          2    0.5</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 6</span><br><span class="line">            0.5</span><br><span class="line">           /  \</span><br><span class="line">          2    1</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 6</span><br><span class="line"></span><br><span class="line">'''</span><br><span class="line">print(heapq.heappop(heap1))  # 0.5 将数组堆中的最小元素弹出</span><br><span class="line">print(heap1)  # [1, 2, 6, 3, 5]</span><br><span class="line">'''</span><br><span class="line">            0.5</span><br><span class="line">           /  \</span><br><span class="line">          2    1</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 6</span><br><span class="line">第一步，先将根节点与编号最大节点的元素互换，并删除编号最大的节点。</span><br><span class="line">           /  \</span><br><span class="line">          2    1</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 6</span><br><span class="line">            6</span><br><span class="line">           /  \</span><br><span class="line">          2    1</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 </span><br><span class="line">此时堆仍然是一棵完全二叉树，但有可能不满足堆的性质一。</span><br><span class="line">所以我们需要对根节点的元素进行下沉操作，</span><br><span class="line">以大顶堆为例，设置一个游标 id, 初始指向根节点：</span><br><span class="line">如果id指向叶子节点，算法结束。</span><br><span class="line">如果id指向节点小于其左右子节点的值，算法结束。</span><br><span class="line">设id的左右子节点中，拥有较小值的编号为 p，交换 id 与 p 的值，并将 id 指向 p 节点。跳转步骤 1</span><br><span class="line">            1</span><br><span class="line">           /  \</span><br><span class="line">          2    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 </span><br><span class="line">'''</span><br><span class="line">print(heapq.heappop(heap1))  # 1 将数组堆中的最小元素弹出</span><br><span class="line">print(heap1)  # [2, 3, 6, 5]</span><br><span class="line">'''</span><br><span class="line">            1</span><br><span class="line">           /  \</span><br><span class="line">          2    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 </span><br><span class="line"></span><br><span class="line">           /  \</span><br><span class="line">          2    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 </span><br><span class="line"></span><br><span class="line">            5</span><br><span class="line">           /  \</span><br><span class="line">          2    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3 </span><br><span class="line"></span><br><span class="line">            2</span><br><span class="line">           /  \</span><br><span class="line">          5    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3  </span><br><span class="line"></span><br><span class="line">            2</span><br><span class="line">           /  \</span><br><span class="line">          3    6</span><br><span class="line">         / \  / \</span><br><span class="line">        5  </span><br><span class="line">'''</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">max_heapify</span>(<span class="params">self, heap, root, heap_len</span>):</span></span><br><span class="line">        p = root</span><br><span class="line">        <span class="keyword">while</span> p * <span class="number">2</span> + <span class="number">1</span> &lt; heap_len:</span><br><span class="line">            l, r = p * <span class="number">2</span> + <span class="number">1</span>, p * <span class="number">2</span> + <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> heap_len &lt;= r <span class="keyword">or</span> heap[r] &lt; heap[l]:</span><br><span class="line">                nex = l</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                nex = r</span><br><span class="line">            <span class="keyword">if</span> heap[p] &lt; heap[nex]:</span><br><span class="line">                heap[p], heap[nex] = heap[nex], heap[p]</span><br><span class="line">                p = nex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">build_heap</span>(<span class="params">self, heap</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(heap) - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            self.max_heapify(heap, i, len(heap))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">heap_sort</span>(<span class="params">self, nums</span>):</span></span><br><span class="line">        self.build_heap(nums)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums) - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            nums[i], nums[<span class="number">0</span>] = nums[<span class="number">0</span>], nums[i]</span><br><span class="line">            self.max_heapify(nums, <span class="number">0</span>, i)</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortArray</span>(<span class="params">self, nums: List[int]</span>) -&gt; List[int]:</span></span><br><span class="line">        self.heap_sort(nums)</span><br><span class="line">        <span class="keyword">return</span> nums</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">heap_sort(self, nums):</span><br><span class="line">self.build_heap(nums)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(heap) - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span> - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line"></span><br><span class="line">    i = <span class="number">4</span></span><br><span class="line">    self.max_heapify(heap, i, len(heap))</span><br><span class="line">    self.max_heapify(heap, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">    p = root = <span class="number">4</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">9</span> &gt; heap_len = <span class="number">5</span></span><br><span class="line">        不进入循环</span><br><span class="line">    </span><br><span class="line">    i = <span class="number">3</span></span><br><span class="line">    self.max_heapify(heap, i, len(heap))</span><br><span class="line">    self.max_heapify(heap, <span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line">    p = root = <span class="number">3</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">7</span> &gt; heap_len = <span class="number">5</span></span><br><span class="line">        不进入循环</span><br><span class="line"></span><br><span class="line">    i = <span class="number">2</span></span><br><span class="line">    self.max_heapify(heap, i, len(heap))</span><br><span class="line">    self.max_heapify(heap, <span class="number">2</span>, <span class="number">5</span>)</span><br><span class="line">    p = root = <span class="number">2</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">5</span> = heap_len = <span class="number">5</span></span><br><span class="line">        不进入循环    </span><br><span class="line"></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    self.max_heapify(heap, i, len(heap))</span><br><span class="line">    self.max_heapify(heap, <span class="number">1</span>, <span class="number">5</span>)</span><br><span class="line">    p = root = <span class="number">1</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> &lt; heap_len = <span class="number">5</span></span><br><span class="line">        [<span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>]</span><br><span class="line">        l = p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> * <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">        r = p * <span class="number">2</span> + <span class="number">2</span> = <span class="number">1</span> * <span class="number">2</span> + <span class="number">2</span> = <span class="number">4</span></span><br><span class="line">        heap_len = <span class="number">5</span> &gt; r = <span class="number">4</span> </span><br><span class="line">        heap[r] = heap[<span class="number">4</span>] = <span class="number">9</span> &gt; heap[l] = heap[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">        nex = r = <span class="number">4</span></span><br><span class="line">        heap[p] = heap[<span class="number">1</span>] = <span class="number">6</span> &lt; heap[nex] = heap[<span class="number">4</span>] = <span class="number">9</span>:</span><br><span class="line">        heap[p] = heap[nex] = heap[<span class="number">1</span>] = heap[<span class="number">4</span>] = <span class="number">9</span></span><br><span class="line">        heap[nex] = heap[p] = heap[<span class="number">4</span>] = heap[<span class="number">1</span>] = <span class="number">6</span></span><br><span class="line">        [<span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">        p = nex = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">9</span> &gt; heap_len = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    self.max_heapify(heap, i, len(heap))</span><br><span class="line">    self.max_heapify(heap, <span class="number">0</span>, <span class="number">5</span>)</span><br><span class="line">    p = root = <span class="number">0</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> &lt; heap_len = <span class="number">5</span></span><br><span class="line">        l = p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">        r = p * <span class="number">2</span> + <span class="number">2</span> = <span class="number">1</span> * <span class="number">2</span> + <span class="number">2</span> = <span class="number">2</span></span><br><span class="line">        heap_len = <span class="number">5</span> &gt; r = <span class="number">2</span> </span><br><span class="line">        heap[r] = heap[<span class="number">2</span>] = <span class="number">8</span> &lt; heap[l] = heap[<span class="number">1</span>] = <span class="number">9</span></span><br><span class="line">        nex = l = <span class="number">1</span></span><br><span class="line">        heap[p] = heap[<span class="number">0</span>] = <span class="number">4</span> &lt; heap[nex] = heap[<span class="number">1</span>] = <span class="number">9</span></span><br><span class="line">        heap[p] = heap[nex] = heap[<span class="number">0</span>] = heap[<span class="number">1</span>] = <span class="number">9</span></span><br><span class="line">        heap[nex] = heap[p] = heap[<span class="number">1</span>] = heap[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">        [<span class="number">9</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">        p = nex = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> &lt; heap_len = <span class="number">5</span></span><br><span class="line">        再循环</span><br><span class="line">        l = p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> * <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">        r = p * <span class="number">2</span> + <span class="number">2</span> = <span class="number">1</span> * <span class="number">2</span> + <span class="number">2</span> = <span class="number">4</span></span><br><span class="line">        heap_len = <span class="number">5</span> &gt; r = <span class="number">4</span> </span><br><span class="line">        heap[r] = heap[<span class="number">4</span>] = <span class="number">6</span> &gt; heap[l] = heap[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">        nex = r = <span class="number">4</span></span><br><span class="line">        heap[p] = heap[<span class="number">1</span>] = <span class="number">4</span> &lt; heap[nex] = heap[<span class="number">4</span>] = <span class="number">6</span>:</span><br><span class="line">        heap[p] = heap[nex] = heap[<span class="number">1</span>] = heap[<span class="number">4</span>] = <span class="number">6</span></span><br><span class="line">        heap[nex] = heap[p] = heap[<span class="number">4</span>] = heap[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line">        [<span class="number">9</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">4</span>]</span><br><span class="line">        p = nex = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">9</span> &gt; heap_len = <span class="number">5</span></span><br><span class="line">        退出循环</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums) - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span> - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">    i = <span class="number">4</span></span><br><span class="line">    nums[<span class="number">4</span>] = nums[<span class="number">0</span>] = <span class="number">9</span></span><br><span class="line">    nums[<span class="number">0</span>] = nums[i] = <span class="number">4</span></span><br><span class="line">    [<span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>]</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, i)</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line">    p = root = <span class="number">0</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> &lt; heap_len = <span class="number">4</span></span><br><span class="line">        l = p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">0</span> * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">        r = p * <span class="number">2</span> + <span class="number">2</span> = <span class="number">0</span> * <span class="number">2</span> + <span class="number">2</span> = <span class="number">2</span></span><br><span class="line">        heap_len = <span class="number">4</span> &gt; r = <span class="number">2</span> </span><br><span class="line">        heap[r] = heap[<span class="number">2</span>] = <span class="number">8</span> &gt; heap[l] = heap[<span class="number">1</span>] = <span class="number">6</span></span><br><span class="line">        nex = r = <span class="number">2</span></span><br><span class="line">        heap[p] = heap[<span class="number">0</span>] = <span class="number">4</span> &lt; heap[nex] = heap[<span class="number">2</span>] = <span class="number">8</span></span><br><span class="line">        heap[p] = heap[nex] = heap[<span class="number">0</span>] = heap[<span class="number">2</span>] = <span class="number">8</span></span><br><span class="line">        heap[nex] = heap[p] = heap[<span class="number">2</span>] = heap[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">        [<span class="number">8</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">9</span>]</span><br><span class="line">        p = nex = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">5</span> &gt; heap_len = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">3</span></span><br><span class="line">    nums[i] = nums[<span class="number">3</span>] = nums[<span class="number">0</span>] = <span class="number">8</span></span><br><span class="line">    nums[<span class="number">0</span>] = nums[i] = nums[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">    [<span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, i)</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, <span class="number">3</span>)</span><br><span class="line">    p = root = <span class="number">0</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> &lt; heap_len = <span class="number">3</span></span><br><span class="line">        l = p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">0</span> * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">        r = p * <span class="number">2</span> + <span class="number">2</span> = <span class="number">0</span> * <span class="number">2</span> + <span class="number">2</span> = <span class="number">2</span></span><br><span class="line">        heap_len = <span class="number">3</span> &gt; r = <span class="number">2</span> </span><br><span class="line">        heap[r] = heap[<span class="number">2</span>] = <span class="number">4</span> &lt; heap[l] = heap[<span class="number">1</span>] = <span class="number">6</span></span><br><span class="line">        nex = l = <span class="number">1</span> </span><br><span class="line">        heap[p] = heap[<span class="number">0</span>] = <span class="number">5</span> &lt; heap[nex] = heap[<span class="number">1</span>] = <span class="number">6</span></span><br><span class="line">        heap[p] = heap[nex] = heap[<span class="number">0</span>] = heap[<span class="number">1</span>] = <span class="number">6</span></span><br><span class="line">        heap[nex] = heap[p] = heap[<span class="number">1</span>] = heap[<span class="number">0</span>] = <span class="number">5</span></span><br><span class="line">        [<span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">        p = nex = <span class="number">1</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> = heap_len = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">2</span></span><br><span class="line">    nums[i] = nums[<span class="number">2</span>] = nums[<span class="number">0</span>] = <span class="number">6</span></span><br><span class="line">    nums[<span class="number">0</span>] = nums[i] = nums[<span class="number">2</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, i)</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">    p = root = <span class="number">0</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> &lt; heap_len = <span class="number">2</span></span><br><span class="line">        l = p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">0</span> * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">        r = p * <span class="number">2</span> + <span class="number">2</span> = <span class="number">0</span> * <span class="number">2</span> + <span class="number">2</span> = <span class="number">2</span></span><br><span class="line">        heap_len = <span class="number">2</span> = r = <span class="number">2</span> </span><br><span class="line">        heap[r] = heap[<span class="number">2</span>] = <span class="number">6</span> &gt; heap[l] = heap[<span class="number">1</span>] = <span class="number">6</span></span><br><span class="line">        nex = l = <span class="number">1</span> </span><br><span class="line">        heap[p] = heap[<span class="number">0</span>] = <span class="number">4</span> &lt; heap[nex] = heap[<span class="number">1</span>] = <span class="number">5</span></span><br><span class="line">        heap[p] = heap[nex] = heap[<span class="number">0</span>] = heap[<span class="number">1</span>] = <span class="number">5</span></span><br><span class="line">        heap[nex] = heap[p] = heap[<span class="number">1</span>] = heap[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">        [<span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">        p = nex = <span class="number">1</span> </span><br><span class="line"></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> &gt; heap_len = <span class="number">2</span></span><br><span class="line">    </span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    nums[i] = nums[<span class="number">1</span>] = nums[<span class="number">0</span>] = <span class="number">5</span></span><br><span class="line">    nums[<span class="number">0</span>] = nums[i] = nums[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, i)</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    p = root = <span class="number">0</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> = heap_len = <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    nums[i] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    nums[<span class="number">0</span>] = nums[i] = nums[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, i)</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    p = root = <span class="number">0</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> &gt; heap_len = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> nums</span><br></pre></td></tr></tbody></table></figure>


<p>完全二叉树有个重要性质，对于第一个非叶子节点的索引是 n/2 取整数得到的索引值，<br>其中 n 是元素个数(前提是数组索引从 1 开始计算)。</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">建立大顶堆</span><br><span class="line">    <span class="number">4</span></span><br><span class="line">   /  \</span><br><span class="line">  <span class="number">6</span>    <span class="number">8</span></span><br><span class="line"> / \  </span><br><span class="line"><span class="number">5</span>   <span class="number">9</span></span><br><span class="line"><span class="number">6</span> 是第一个非叶子节点，从它开始逐一向前分别把每个元素作为根节点进行 shift down 操作</span><br><span class="line"><span class="number">6</span> 和 <span class="number">9</span> 交换位置。</span><br><span class="line">满足最大堆的性质。</span><br><span class="line"></span><br><span class="line">    <span class="number">4</span></span><br><span class="line">   /  \</span><br><span class="line">  <span class="number">9</span>    <span class="number">8</span></span><br><span class="line"> / \  </span><br><span class="line"><span class="number">5</span>   <span class="number">6</span></span><br><span class="line">对根节点<span class="number">4</span> 元素进行 shift down 操作</span><br><span class="line"></span><br><span class="line">    <span class="number">9</span></span><br><span class="line">   /  \</span><br><span class="line">  <span class="number">4</span>    <span class="number">8</span></span><br><span class="line"> / \  </span><br><span class="line"><span class="number">5</span>   <span class="number">6</span></span><br><span class="line">对<span class="number">6</span> 元素进行 shift down 操作</span><br><span class="line"></span><br><span class="line">    <span class="number">9</span></span><br><span class="line">   /  \</span><br><span class="line">  <span class="number">6</span>    <span class="number">8</span></span><br><span class="line"> / \  </span><br><span class="line"><span class="number">5</span>   <span class="number">4</span></span><br><span class="line"></span><br><span class="line">此时整个序列最大值即为堆顶元素，</span><br><span class="line">我们将其与末尾元素交换，使末尾元素为最大值，</span><br><span class="line">然后再调整堆顶元素使得剩下的 n<span class="number">-1</span> 个元素仍为大根堆，</span><br><span class="line">再重复执行以上操作我们即能得到一个有序的序列。</span><br><span class="line"></span><br><span class="line">    <span class="number">4</span></span><br><span class="line">   /  \</span><br><span class="line">  <span class="number">6</span>    <span class="number">8</span></span><br><span class="line"> / \  </span><br><span class="line"><span class="number">5</span>   <span class="number">9</span></span><br><span class="line"></span><br><span class="line">    <span class="number">8</span></span><br><span class="line">   /  \</span><br><span class="line">  <span class="number">6</span>    <span class="number">4</span></span><br><span class="line"> / \  </span><br><span class="line"><span class="number">5</span>   <span class="number">9</span></span><br><span class="line"></span><br><span class="line">    <span class="number">5</span></span><br><span class="line">   / \</span><br><span class="line">  <span class="number">6</span>   <span class="number">4</span> </span><br><span class="line"> / \  </span><br><span class="line"><span class="number">8</span>   <span class="number">9</span></span><br><span class="line"></span><br><span class="line">    <span class="number">6</span></span><br><span class="line">   / \</span><br><span class="line">  <span class="number">5</span>   <span class="number">4</span> </span><br><span class="line"> / \  </span><br><span class="line"><span class="number">8</span>   <span class="number">9</span></span><br><span class="line"></span><br><span class="line">    <span class="number">4</span></span><br><span class="line">   / \</span><br><span class="line">  <span class="number">5</span>   <span class="number">6</span> </span><br><span class="line"> / \  </span><br><span class="line"><span class="number">8</span>   <span class="number">9</span></span><br><span class="line"></span><br><span class="line">    <span class="number">5</span></span><br><span class="line">   / \</span><br><span class="line">  <span class="number">4</span>   <span class="number">6</span> </span><br><span class="line"> / \  </span><br><span class="line"><span class="number">8</span>   <span class="number">9</span></span><br><span class="line">  </span><br><span class="line">    <span class="number">4</span></span><br><span class="line">   / \</span><br><span class="line">  <span class="number">5</span>   <span class="number">6</span> </span><br><span class="line"> / \  </span><br><span class="line"><span class="number">8</span>   <span class="number">9</span></span><br></pre></td></tr></tbody></table></figure>

<p>法二</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">heap_sort</span>(<span class="params">nums</span>):</span></span><br><span class="line">    <span class="comment"># 调整堆</span></span><br><span class="line">    <span class="comment"># 迭代写法</span></span><br><span class="line">    <span class="comment"># def adjust_heap(nums, startpos, endpos):</span></span><br><span class="line">    <span class="comment">#     newitem = nums[startpos]</span></span><br><span class="line">    <span class="comment">#     pos = startpos</span></span><br><span class="line">    <span class="comment">#     childpos = pos * 2 + 1</span></span><br><span class="line">    <span class="comment">#     while childpos &lt; endpos:</span></span><br><span class="line">    <span class="comment">#         rightpos = childpos + 1</span></span><br><span class="line">    <span class="comment">#         if rightpos &lt; endpos and nums[rightpos] &gt;= nums[childpos]:</span></span><br><span class="line">    <span class="comment">#             childpos = rightpos</span></span><br><span class="line">    <span class="comment">#         if newitem &lt; nums[childpos]:</span></span><br><span class="line">    <span class="comment">#             nums[pos] = nums[childpos]</span></span><br><span class="line">    <span class="comment">#             pos = childpos</span></span><br><span class="line">    <span class="comment">#             childpos = pos * 2 + 1</span></span><br><span class="line">    <span class="comment">#         else:</span></span><br><span class="line">    <span class="comment">#             break</span></span><br><span class="line">    <span class="comment">#     nums[pos] = newitem</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 递归写法</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">adjust_heap</span>(<span class="params">nums, startpos, endpos</span>):</span></span><br><span class="line">        pos = startpos</span><br><span class="line">        chilidpos = pos * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> chilidpos &lt; endpos:</span><br><span class="line">            rightpos = chilidpos + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> rightpos &lt; endpos <span class="keyword">and</span> nums[rightpos] &gt; nums[chilidpos]:</span><br><span class="line">                chilidpos = rightpos</span><br><span class="line">            <span class="keyword">if</span> nums[chilidpos] &gt; nums[pos]:</span><br><span class="line">                nums[pos], nums[chilidpos] = nums[chilidpos], nums[pos]</span><br><span class="line">                adjust_heap(nums, pos, endpos)</span><br><span class="line"></span><br><span class="line">    n = len(nums)</span><br><span class="line">    <span class="comment"># 建堆</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> reversed(range(n // <span class="number">2</span>)):</span><br><span class="line">        adjust_heap(nums, i, n)</span><br><span class="line">    <span class="comment"># 调整堆</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">        nums[<span class="number">0</span>], nums[i] = nums[i], nums[<span class="number">0</span>]</span><br><span class="line">        adjust_heap(nums, <span class="number">0</span>, i)</span><br><span class="line">    <span class="keyword">return</span> nums</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">alist = [<span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>]</span><br><span class="line">heap_sort(alist)</span><br><span class="line">print(alist)</span><br><span class="line"><span class="comment"># [4, 5, 6, 8, 9]</span></span><br></pre></td></tr></tbody></table></figure>

<h1 id="Top-K-问题"><a href="#Top-K-问题" class="headerlink" title="Top K 问题"></a>Top K 问题</h1><p>面试题中有这样一类问题，让求出大量数据中的top k 个元素，比如一亿个数字中最大的100个数字。<br>对于这种问题有很多种解法，比如直接排序、mapreduce、trie 树、分治法等，当然如果内存够用直接排序是最简单的。<br>如果内存不够用呢？ 这里我们提一下使用固定大小的堆来解决这个问题的方式。</p>
<p>一开始的思路可能是，既然求最大的 k 个数，是不是应该维护一个包含 k 个元素的最大堆呢？<br>稍微尝试下你会发现走不通。我们先用数组的前面 k 个元素建立最大堆，然后对剩下的元素进行比对，但是最大堆只能每次获取堆顶<br>最大的一个元素，如果我们取下一个大于堆顶的值和堆顶替换，你会发现堆底部的小数一直不会被换掉。如果下一个元素小于堆顶<br>就替换也不对，这样可能最大的元素就被我们丢掉了。</p>
<p>相反我们用最小堆呢？<br>先迭代前 k 个元素建立一个最小堆，之后的元素如果小于堆顶最小值，跳过，否则替换堆顶元素并重新调整堆。你会发现最小堆里<br>慢慢就被替换成了最大的那些值，并且最后堆顶是最大的 topk 个值中的最小值。<br>（比如1000个数找10个，最后堆里剩余的是 [990, 991, 992, 996, 994, 993, 997, 998, 999, 995]，第一个 990 最小)</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TopK</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    获取大量元素 topk 大个元素，固定内存</span></span><br><span class="line"><span class="string">    思路：</span></span><br><span class="line"><span class="string">    1.先放入元素前 K 个建立最小堆</span></span><br><span class="line"><span class="string">    2.迭代剩余元素：</span></span><br><span class="line"><span class="string">        如果当前元素小于堆顶元素，跳过该元素(肯定不是前 K 大)</span></span><br><span class="line"><span class="string">        否则替换堆顶元素为当前元素，并重新调整堆</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, iterable, k</span>):</span></span><br><span class="line">        self.minheap = []         <span class="comment"># 定义最小堆</span></span><br><span class="line">        self.capacity = k         <span class="comment"># 最小堆容量为k个元素</span></span><br><span class="line">        self.iterable = iterable</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span>(<span class="params">self, val</span>):</span></span><br><span class="line">        <span class="keyword">if</span> len(self.minheap) &gt;= self.capacity:</span><br><span class="line">            min_val = self.minheap[<span class="number">0</span>]  </span><br><span class="line">            <span class="keyword">if</span> val &lt; min_val: </span><br><span class="line">                <span class="comment"># 当然你可以直接 if val &gt; min_val操作，这里我只是显示指出跳过这个元素</span></span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 返回并且pop堆顶最小值，推入新的 val 值并调整堆</span></span><br><span class="line">                heapq.heapreplace(self.minheap, val)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 前面k个元素直接放入minheap</span></span><br><span class="line">            heapq.heappush(self.minheap, val)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_topk</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> val <span class="keyword">in</span> self.iterable:</span><br><span class="line">            self.push(val)</span><br><span class="line">        <span class="keyword">return</span> self.minheap</span><br><span class="line">            </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span>():</span></span><br><span class="line">    <span class="keyword">import</span> random</span><br><span class="line">    i = list(range(<span class="number">100</span>)) <span class="comment"># 这里可以是一个可迭代元素，节省内存</span></span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    random.shuffle(i)</span><br><span class="line">    _ = TopK(i, <span class="number">10</span>)</span><br><span class="line">    print(_.get_topk())</span><br><span class="line"> </span><br><span class="line">test()</span><br><span class="line"><span class="comment"># [90, 91, 93, 92, 97, 96, 94, 95, 98, 99]</span></span><br></pre></td></tr></tbody></table></figure>

<p>o(n^2)级别排序算法</p>
<p>为什么要学习O(n^2)的排序方法？<br>● 基础<br>● 编码简单，易于实现，是一些简单情景的首选<br>● 在一些特殊情况下，简单的排序算法更有效<br>● 简单的排序算法思想衍生出复杂的排序算法<br>● 作为子过程，改进更复杂的排序算法</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%89%91%E6%8C%87offer/" rel="tag"># 剑指offer</a>
              <a href="/tags/%E6%8E%92%E5%BA%8F/" rel="tag"># 排序</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/08/21/jian-zhi-offer25-30-ti/" rel="prev" title="剑指offer25~30题">
                  <i class="fa fa-chevron-left"></i> 剑指offer25~30题
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/08/21/jian-zhi-offer30-40-ti/" rel="next" title="剑指offer30~40题">
                  剑指offer30~40题 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">外心人D</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
