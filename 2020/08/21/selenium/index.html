<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"bubbleboy11.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.6.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="一个浏览器自动化测试的框架，可以通过 Python 代码来控制浏览器完成相关的测试，同时也能辅助完成数据的爬取。利用它我们可以驱动浏览器执行特定的动作，如点击、下拉等操作。对于一些JavaScript渲染的页面来说，这种抓取方式非常有效。  开源免费 使用灵活、简单 后期用例易于维护 支持多种语言 容易与单元测试框架结合 可支持多浏览器同时，支持远程启动其他服务器 高度复用性 代码可自主掌控，对于">
<meta property="og:type" content="article">
<meta property="og:title" content="selenium">
<meta property="og:url" content="https://bubbleboy11.github.io/2020/08/21/selenium/index.html">
<meta property="og:site_name" content="外心人D的博客">
<meta property="og:description" content="一个浏览器自动化测试的框架，可以通过 Python 代码来控制浏览器完成相关的测试，同时也能辅助完成数据的爬取。利用它我们可以驱动浏览器执行特定的动作，如点击、下拉等操作。对于一些JavaScript渲染的页面来说，这种抓取方式非常有效。  开源免费 使用灵活、简单 后期用例易于维护 支持多种语言 容易与单元测试框架结合 可支持多浏览器同时，支持远程启动其他服务器 高度复用性 代码可自主掌控，对于">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200404072628618.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BlbmdqaWFuZ2NodW4=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200404073158790.png">
<meta property="og:image" content="https://bubbleboy11.github.io/2020/08/21/selenium/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20200814235134327.png">
<meta property="article:published_time" content="2020-08-20T16:21:41.000Z">
<meta property="article:modified_time" content="2021-05-07T13:55:02.459Z">
<meta property="article:author" content="外心人D">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/20200404072628618.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BlbmdqaWFuZ2NodW4=,size_16,color_FFFFFF,t_70">


<link rel="canonical" href="https://bubbleboy11.github.io/2020/08/21/selenium/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://bubbleboy11.github.io/2020/08/21/selenium/","path":"2020/08/21/selenium/","title":"selenium"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>selenium | 外心人D的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="外心人D的博客" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">外心人D的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E6%B5%8F%E8%A7%88%E5%99%A8%E6%93%8D%E4%BD%9C"><span class="nav-text">控制浏览器操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%83%E7%B4%A0%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C"><span class="nav-text">元素简单操作</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">外心人D</p>
  <div class="site-description" itemprop="description">本博客大多内容为慕课和网上博客，并非原创</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">322</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">40</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



          </div>
        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/selenium/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          selenium
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-07 13:55:02" itemprop="dateModified" datetime="2021-05-07T13:55:02Z">2021-05-07</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">测试</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>一个浏览器自动化测试的框架，可以通过 Python 代码来控制浏览器完成相关的测试，同时也能辅助完成数据的爬取。利用它我们可以驱动浏览器执行特定的动作，如点击、下拉等操作。对于一些JavaScript渲染的页面来说，这种抓取方式非常有效。</p>
<ul>
<li>开源免费</li>
<li>使用灵活、简单</li>
<li>后期用例易于维护</li>
<li>支持多种语言</li>
<li>容易与单元测试框架结合</li>
<li>可支持多浏览器同时，支持远程启动其他服务器</li>
<li>高度复用性</li>
<li>代码可自主掌控，对于搭建框架、平台等有不可替代的优势</li>
</ul>
<p>安装chrome浏览器驱动<br>为什么需要浏览器驱动呢？这还得从selenium的原理开始讲：</p>
<p>​    当Selenium提出了WebDriver的概念之后，它提供了利用浏览器原生的接口，封装成一套更加面向对象的Selenium WebDriver API，直接操作浏览器页面里的元素，甚至操作浏览器本身（截屏，窗口大小，启动，关闭，安装插件）。</p>
<p>​     由于使用的是浏览器原生的接口，速度大大提高，而且调用的稳定性交给了浏览器厂商本身，显然是更加科学。然而带来的一些副作用就是，不同的浏览器厂商，对Web元素的操作和呈现多少会有一些差异，这就直接导致了Selenium  WebDriver要分浏览器厂商不同，而提供不同的实现。例如Firefox就有专门的geckoDriver驱动，Chrome就有专门的Chrome驱动等。</p>
<p>这里特别要注意：chrome浏览器驱动必须和安装的chrome浏览器版本对应。那么如何保证对应呢？</p>
<p>1.先检查chrome浏览器的版本：点击chrome浏览器右上角的三个点–&gt;帮助–&gt;关于Google Chrome，如下图所示：</p>
<p><img src="https://img-blog.csdnimg.cn/20200404072628618.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BlbmdqaWFuZ2NodW4=,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>2.chrome浏览器驱动下载地址：</p>
<p>Chromedriver驱动下载地址：<a target="_blank" rel="noopener" href="http://npm.taobao.org/mirrors/chromedriver/">http://npm.taobao.org/mirrors/chromedriver/</a></p>
<p>找到和上图chrome版本最接近的版本：上图为：78.0.3904.108，所以这里驱动选择：</p>
<p><img src="https://img-blog.csdnimg.cn/20200404073158790.png" alt="img"></p>
<p>下载完成后：把chrome驱动包放入：C:\python37 目录下 （这个是必须的）</p>
<p>Edge驱动 <a target="_blank" rel="noopener" href="https://developer.microsoft.com/zh-cn/microsoft-edge/tools/webdriver/">https://developer.microsoft.com/zh-cn/microsoft-edge/tools/webdriver/</a></p>
<ul>
<li>火狐 驱动<ul>
<li>下载firefox浏览器驱动 Mozilla GeckoDriver<br> （ 官网 <a target="_blank" rel="noopener" href="https://github.com/mozilla/geckodriver/releases/tag/v0.23.0%EF%BC%89">https://github.com/mozilla/geckodriver/releases/tag/v0.23.0）</a></li>
</ul>
</li>
</ul>
<p><img src="/2020/08/21/selenium/Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200814235134327.png" alt="image-20200814235134327"></p>
<p><a target="_blank" rel="noopener" href="https://developer.microsoft.com/zh-cn/microsoft-edge/tools/webdriver/">https://developer.microsoft.com/zh-cn/microsoft-edge/tools/webdriver/</a></p>
<p>python只能启动浏览器稳定版本，不能启动canary，除非改edge的软链接？</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># driver = 'C:\\Users\\rose\\Downloads\\Compressed\\chromedriver.exe'</span></span><br><span class="line">driver_path = <span class="string">'C:\\Users\\rose\\Downloads\\edgedriver_win64\\msedgedriver.exe'</span></span><br><span class="line"></span><br><span class="line">driver=webdriver.Edge(driver_path)  <span class="comment"># 创建chrome驱动</span></span><br><span class="line">driver.get(<span class="string">"https://www.baidu.com"</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>（3）将驱动移动到python安装目录 C:\Users\rose\AppData\Local\Programs\Python\Python38\</p>
<p>（4）重启 IDEA，记得一定要</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># driver = 'C:\\Users\\rose\\Downloads\\Compressed\\chromedriver.exe'</span></span><br><span class="line"><span class="comment"># driver_path = 'C:\\Users\\rose\\Downloads\\edgedriver_win64\\msedgedriver.exe'</span></span><br><span class="line"></span><br><span class="line">driver = webdriver.Edge()  <span class="comment"># 创建Edge浏览器驱动</span></span><br><span class="line">driver = webdriver.Firefox()    <span class="comment"># Firefox浏览器</span></span><br><span class="line">driver = webdriver.Chrome()     <span class="comment"># Chrome浏览器</span></span><br><span class="line">driver = webdriver.Ie()         <span class="comment"># Ie浏览器</span></span><br><span class="line">driver = webdriver.PhantomJS()  <span class="comment"># PhantomJS()</span></span><br><span class="line">driver.get(<span class="string">"https://www.baidu.com"</span>)</span><br><span class="line"></span><br><span class="line">deiver.quit()  <span class="comment"># 关闭当前的浏览器窗口，退出webdriver释放资源</span></span><br><span class="line">deiver.close()  <span class="comment"># 关闭当前的浏览器窗口，关闭之后还想开 </span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><code>deiver.quit()</code> 关闭当前的浏览器窗口，退出webdriver释放资源</li>
<li><code>deiver.close()</code> 关闭当前的浏览器窗口，关闭之后还想开</li>
</ul>
<p><code>EC.title_contains</code>/<code>EC.title_is</code><br>这两个方法都是用来判断title的，区别是：<br><code>EC.title_contains</code>只要包含即可<br><code>EC.title_is</code>必须完全匹配</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">'https://www.baidu.com'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># title中包含即可</span></span><br><span class="line">print(EC.title_contains(<span class="string">"百度"</span>)(driver))  <span class="comment"># True</span></span><br><span class="line">print(EC.title_contains(<span class="string">"必应"</span>)(driver))  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># title完全匹配</span></span><br><span class="line">print(EC.title_is(<span class="string">"百度一下"</span>)(driver))  <span class="comment"># False</span></span><br><span class="line">print(EC.title_is(<span class="string">"百度一下，你就知道"</span>)(driver))  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></tbody></table></figure>

<h3 id="控制浏览器操作"><a href="#控制浏览器操作" class="headerlink" title="控制浏览器操作"></a>控制浏览器操作</h3><ul>
<li><code>set_window_size()</code> 来设置浏览器窗口的大小 </li>
<li><code>maximize_window()</code> 使打开的浏览器全屏显示。</li>
<li><code>back()</code> 和 <code>forward()</code> 来模拟控制浏览器后退、前进按钮。</li>
<li><code>refresh()</code> 刷新页面 F5</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.maximize_window()</span><br><span class="line">driver.get(<span class="string">"https://www.baidu.com"</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line">driver.get(<span class="string">"https://www.imooc.com"</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line">driver.back()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line">driver.forward()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line">driver.refresh()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line">print(<span class="string">'browser will be closed'</span>)</span><br><span class="line">driver.quit()</span><br></pre></td></tr></tbody></table></figure>

<p><strong>2.Selenium元素定位</strong><br>HTML浏览器的开发者模式选择元素复制对应元素属性值</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span> <span class="attr">link</span>=<span class="string">"#0000cc"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"result_logo"</span> <span class="attr">href</span>=<span class="string">"/"</span> <span class="attr">onmousedown</span>=<span class="string">"return c({'fm':'tab','tab':'logo'})"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"form"</span> <span class="attr">class</span>=<span class="string">"fm"</span> <span class="attr">name</span>=<span class="string">"f"</span> <span class="attr">action</span>=<span class="string">"/s"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"soutu-btn"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"kw"</span> <span class="attr">class</span>=<span class="string">"s_ipt"</span> <span class="attr">name</span>=<span class="string">"wd"</span> <span class="attr">value</span>=<span class="string">""</span> <span class="attr">maxlength</span>=<span class="string">"255"</span> <span class="attr">autocomplete</span>=<span class="string">"off"</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p> Message: element not interactable</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过 id 定位</span></span><br><span class="line">dr.find_element_by_id(<span class="string">"kw"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过name定位:</span></span><br><span class="line">dr.find_element_by_name(<span class="string">"wd"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过 class_name定位:</span></span><br><span class="line">dr.find_element_by_class_name(<span class="string">"s_ipt"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过 tag_name 标签名定位:</span></span><br><span class="line">dr.find_element_by_tag_name(<span class="string">"input"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过 xpath 定位的几种写法</span></span><br><span class="line">dr.find_element_by_xpath(<span class="string">"//*[@id='kw']"</span>)</span><br><span class="line">dr.find_element_by_xpath(<span class="string">"//*[@name='wd']"</span>)</span><br><span class="line">dr.find_element_by_xpath(<span class="string">"//input[@class='s_ipt']"</span>)</span><br><span class="line">dr.find_element_by_xpath(<span class="string">"/html/body/form/span/input"</span>)</span><br><span class="line">dr.find_element_by_xpath(<span class="string">"//span[@class='soutu-btn']/input"</span>)</span><br><span class="line">dr.find_element_by_xpath(<span class="string">"//form[@id='form']/span/input"</span>)</span><br><span class="line">dr.find_element_by_xpath(<span class="string">"//input[@id='kw' and @name='wd']"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过 css 定位的几种写法</span></span><br><span class="line">dr.find_element_by_css_selector(<span class="string">"#kw"</span>)</span><br><span class="line">dr.find_element_by_css_selector(<span class="string">"[name=wd]"</span>)</span><br><span class="line">dr.find_element_by_css_selector(<span class="string">".s_ipt"</span>)</span><br><span class="line">dr.find_element_by_css_selector(<span class="string">"html &gt; body &gt; form &gt; span &gt; input"</span>)</span><br><span class="line">dr.find_element_by_css_selector(<span class="string">"span.soutu-btn&gt; input#kw"</span>)</span><br><span class="line">dr.find_element_by_css_selector(<span class="string">"form#form &gt; span &gt; input"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过 link_text / partial_link_text 定位</span></span><br><span class="line">dr.find_element_by_link_text(<span class="string">"新闻"</span>)</span><br><span class="line">dr.find_element_by_link_text(<span class="string">"hao123"</span>)</span><br><span class="line">dr.find_element_by_partial_link_text(<span class="string">"新"</span>)</span><br><span class="line">dr.find_element_by_partial_link_text(<span class="string">"hao"</span>)</span><br><span class="line">dr.find_element_by_partial_link_text(<span class="string">"123"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果是定位一组元素，用下面</span></span><br><span class="line">find_elements_by_id()</span><br><span class="line">find_elements_by_name()</span><br><span class="line">find_elements_by_class_name()</span><br><span class="line">find_elements_by_tag_name()</span><br><span class="line">find_elements_by_link_text()</span><br><span class="line">find_elements_by_partial_link_text()</span><br><span class="line">find_elements_by_xpath()</span><br><span class="line">find_elements_by_css_selector()</span><br></pre></td></tr></tbody></table></figure>

<hr>
<p><code>form.html</code></p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"content-type"</span> <span class="attr">content</span>=<span class="string">"text/html;charset=utf-8"</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">title</span>&gt;</span>Form<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">async</span>=<span class="string">""</span> <span class="attr">src</span>=<span class="string">"jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"bootstrap-combined.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">h3</span>&gt;</span>simple login form<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"control-group"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label"</span> <span class="attr">for</span>=<span class="string">"inputEmail"</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"controls"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"inputEmail"</span> <span class="attr">placeholder</span>=<span class="string">"Email"</span> <span class="attr">name</span>=<span class="string">"email"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"control-group"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label"</span> <span class="attr">for</span>=<span class="string">"inputPassword"</span>&gt;</span>Password<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"controls"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">id</span>=<span class="string">"inputPassword"</span> <span class="attr">placeholder</span>=<span class="string">"Password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"control-group"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"controls"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"checkbox"</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span> Remember me</span><br><span class="line">           <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn"</span>&gt;</span>Sign in<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>register<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">driver_path = <span class="string">'C:\\Users\\rose\\Downloads\\msedgedriver.exe'</span></span><br><span class="line"></span><br><span class="line">driver = webdriver.Edge(driver_path)</span><br><span class="line">driver.maximize_window()</span><br><span class="line">driver.get(<span class="string">r"file:/C:\python代码\步骤4 Flask基础及项目实战\第31周 实战测试慕旅游网：Web自动化测试\web自动化\WEBAUTO(测试网页)/form.html"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># by id</span></span><br><span class="line">driver.find_element_by_id(<span class="string">'inputEmail'</span>).click()</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#by name</span></span><br><span class="line">driver.find_element_by_name(<span class="string">'password'</span>).click()</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#by tagname</span></span><br><span class="line">print(driver.find_element_by_tag_name(<span class="string">'form'</span>).get_attribute(<span class="string">'class'</span>))  <span class="comment"># form-horizontal</span></span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#by classname</span></span><br><span class="line">el = driver.find_element_by_class_name(<span class="string">'controls'</span>)</span><br><span class="line">driver.```<span class="string">'$(arguments[0]).fadeOut().fadeIn()'</span>,el)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#by linktext</span></span><br><span class="line">link = driver.find_element_by_link_text(<span class="string">'register'</span>)</span><br><span class="line">driver.```<span class="string">'$(arguments[0]).fadeOut().fadeIn()'</span>,link)</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">partial = driver.find_element_by_partial_link_text(<span class="string">'reg'</span>)</span><br><span class="line">driver.```<span class="string">'$(arguments[0]).fadeOut().fadeIn()'</span>,partial)</span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># by css selector</span></span><br><span class="line"><span class="comment"># div = driver.find_element_by_css_selector('body &gt; form &gt; div:nth-child(1) &gt; div')</span></span><br><span class="line"><span class="comment"># driver.execute_script('$(arguments[0]).fadeOut().fadeIn()',div)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#by xpath</span></span><br><span class="line">driver.find_element_by_xpath(<span class="string">'//*[@id="inputEmail"]'</span>).click()</span><br><span class="line">driver.find_element_by_xpath(<span class="string">'//*[name="email"]'</span>).click()</span><br><span class="line"><span class="comment"># driver.find_element_by_xpath("/html/body/form/div[3]/div/button").click()</span></span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">定位一组同类型元素批量操作</span><br><span class="line">```py</span><br><span class="line">from selenium import webdriver</span><br><span class="line">from time import sleep</span><br><span class="line"></span><br><span class="line">driver_path = 'C:\\Users\\rose\\Downloads\\msedgedriver.exe'</span><br><span class="line"></span><br><span class="line">driver = webdriver.Edge(driver_path)</span><br><span class="line">driver.maximize_window()</span><br><span class="line">driver.get(r"file:/C:\python代码\步骤4 Flask基础及项目实战\第31周 实战测试慕旅游网：Web自动化测试\web自动化\WEBAUTO(测试网页)/checkbox.html")</span><br><span class="line"># 所有的checkbox 并勾选</span><br><span class="line"></span><br><span class="line"># css_selector定位</span><br><span class="line"># checkboxes = driver.find_elements_by_css_selector('input[type=checkbox]')</span><br><span class="line"># for chk in checkboxes:</span><br><span class="line">#     chk.click()</span><br><span class="line"></span><br><span class="line"># tag定位</span><br><span class="line">inputs = driver.find_elements_by_tag_name('input')</span><br><span class="line">for input in inputs:</span><br><span class="line">    if input.get_attribute('type') == 'checkbox':</span><br><span class="line">        input.click()</span><br><span class="line">        sleep(1)</span><br><span class="line">sleep(1)</span><br><span class="line"></span><br><span class="line"># 最后一个取消勾选</span><br><span class="line">driver.find_elements_by_css_selector('input[type=checkbox]').pop().click()</span><br><span class="line">sleep(1)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></tbody></table></figure>

<h4 id="元素简单操作"><a href="#元素简单操作" class="headerlink" title="元素简单操作"></a>元素简单操作</h4><ul>
<li><code>.click()</code> 点击、</li>
<li><code>.clear()</code> 清除</li>
<li><code>el.send_keys('hello')</code> 输入</li>
<li><code>submit()</code> 方法用于提交表单，在搜索框后输入关键字后，可用于“回车”模拟。</li>
<li><code>size</code>： 返回元素的尺寸。</li>
<li><code>text</code>： 获取元素的文本。</li>
<li><code>get_attribute(name)</code>： 获得属性值。</li>
<li><code>is_displayed()</code>： 设置该元素是否用户可见。</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">base_url = <span class="string">'https://www.baidu.com'</span></span><br><span class="line"></span><br><span class="line">browser = webdriver.Chrome(<span class="string">'../tools/chromedriver.exe'</span>)</span><br><span class="line">browser.get(base_url)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 其他常用方法</span></span><br><span class="line">size = browser.find_element_by_id(<span class="string">'kw'</span>).size</span><br><span class="line">print(<span class="string">"返回元素的尺寸：%s"</span> % size)</span><br><span class="line"></span><br><span class="line">text = browser.find_element_by_id(<span class="string">'cp'</span>).text</span><br><span class="line">print(<span class="string">"返回元素的文本：%s"</span> % text)</span><br><span class="line"></span><br><span class="line">attribute = browser.find_element_by_id(<span class="string">'kw'</span>).get_attribute(<span class="string">'type'</span>)</span><br><span class="line">print(<span class="string">"返回元素的属性：%s"</span> % attribute)</span><br><span class="line"></span><br><span class="line">result = browser.find_element_by_id(<span class="string">'kw'</span>).is_displayed()</span><br><span class="line">print(<span class="string">"返回元素是否可见：%s"</span> % result)</span><br><span class="line"></span><br><span class="line">browser.quit()</span><br></pre></td></tr></tbody></table></figure>



<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">driver_path = <span class="string">'C:\\Users\\rose\\Downloads\\msedgedriver.exe'</span></span><br><span class="line">driver = webdriver.Edge(driver_path)</span><br><span class="line">driver.maximize_window()</span><br><span class="line">driver.get(</span><br><span class="line">    <span class="string">r"file:/C:\python代码\步骤4 Flask基础及项目实战\第31周 实战测试慕旅游网：Web自动化测试\web自动化\WEBAUTO(测试网页)/form.html"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">el = driver.find_element_by_xpath(<span class="string">"//*[@id='inputEmail']"</span>)</span><br><span class="line">el.send_keys(<span class="string">'jackson'</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">el.clear()</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">el.send_keys(<span class="string">'fengluo'</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">"//*[@id='inputPassword']"</span>).send_keys(<span class="string">'123456'</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">"/html/body/form/div[3]/div/button"</span>).click()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></tbody></table></figure>


<p><strong>1.鼠标事件</strong></p>
<p>在webdriver中，鼠标操作的方法封装在 <code>ActionChains</code> 类提供。<code>ActionChains</code> 类提供了鼠标操作的常用方法：</p>
<blockquote>
<p>ActionChains(driver)，将浏览器驱动 driver 作为参数传入。</p>
<p>(1) <code>perform()</code>: 执行所有 ActionChains 中存储的行为，是对整个操作的提交动作；</p>
<p>(2) <code>context_click()</code>: 右击</p>
<p>(3) <code>double_click()</code>: 双击</p>
<p>(4) <code>drag_and_drop()</code>: 拖动</p>
<p>(5) <code>move_to_element()</code>: 鼠标悬停， 在调用时需要指定元素定位</p>
</blockquote>
<p>Action<br>key_down 模拟按键按下<br>key_up<br>click<br>send_keys<br>click_and_hold<br>release<br>move_to</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line"></span><br><span class="line">driver_path = <span class="string">'C:\\Users\\rose\\Downloads\\msedgedriver.exe'</span></span><br><span class="line"></span><br><span class="line">driver = webdriver.Edge(driver_path)</span><br><span class="line">driver.maximize_window()</span><br><span class="line">driver.get(</span><br><span class="line">    <span class="string">r"file:/C:\python代码\步骤4 Flask基础及项目实战\第31周 实战测试慕旅游网：Web自动化测试\web自动化\WEBAUTO(测试网页)/sendkeys.html"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">double_click_el = driver.find_element_by_id(<span class="string">'A'</span>)</span><br><span class="line">ActionChains(driver).double_click(double_click_el).context_click(</span><br><span class="line">    double_click_el).perform()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">driver.quit()</span><br></pre></td></tr></tbody></table></figure>


<p>键盘事件<br> 前面的 send_keys() 方法用来模拟键盘输入；keys() 类提供了键盘上几乎所有按键的方法，组合键也是可以的。</p>
<p>常用的键盘操作如下：</p>
<blockquote>
<p>send_keys(Keys.BACK_SPACE) 删除键（BackSpace）<br>send_keys(Keys.SPACE) 空格键(Space)<br>send_keys(Keys.TAB) 制表键(Tab)<br>send_keys(Keys.ESCAPE) 回退键（Esc）<br>send_keys(Keys.ENTER) 回车键（Enter）<br>send_keys(Keys.CONTROL,’a’) 全选（Ctrl+A）<br>send_keys(Keys.CONTROL,’c’) 复制（Ctrl+C）<br>send_keys(Keys.CONTROL,’x’) 剪切（Ctrl+X）<br>send_keys(Keys.CONTROL,’v’) 粘贴（Ctrl+V）<br>send_keys(Keys.F1) 键盘 F1<br>……<br>send_keys(Keys.F12) 键盘 F12</p>
</blockquote>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">base_url = <span class="string">'https://www.baidu.com/'</span></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'../tools/chromedriver.exe'</span>)</span><br><span class="line">driver.get(base_url)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 先输入百度</span></span><br><span class="line">driver.find_element_by_id(<span class="string">'kw'</span>).send_keys(<span class="string">'百度'</span>)</span><br><span class="line"><span class="comment"># 1.删除度</span></span><br><span class="line">driver.find_element_by_id(<span class="string">'kw'</span>).send_keys(Keys.BACK_SPACE)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.键入空格</span></span><br><span class="line">driver.find_element_by_id(<span class="string">'kw'</span>).send_keys(Keys.SPACE)</span><br><span class="line">driver.find_element_by_id(<span class="string">'kw'</span>).send_keys(<span class="string">'加入空格'</span>)</span><br><span class="line">time.sleep(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.ctrl+a 全选输入框里的内容</span></span><br><span class="line">driver.find_element_by_id(<span class="string">'kw'</span>).send_keys(Keys.CONTROL, <span class="string">'a'</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.ctrl+x 剪切输入框里的内容</span></span><br><span class="line">driver.find_element_by_id(<span class="string">'kw'</span>).send_keys(Keys.CONTROL, <span class="string">'x'</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. ctrl+v 粘贴剪切的内容</span></span><br><span class="line">driver.find_element_by_id(<span class="string">'kw'</span>).send_keys(Keys.CONTROL, <span class="string">'v'</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 回车</span></span><br><span class="line">driver.find_element_by_id(<span class="string">'su'</span>).send_keys(Keys.ENTER)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line"></span><br><span class="line">driver_path = <span class="string">'C:\\Users\\rose\\Downloads\\msedgedriver.exe'</span></span><br><span class="line"></span><br><span class="line">driver = webdriver.Edge(driver_path)</span><br><span class="line">driver.maximize_window()</span><br><span class="line">driver.get(</span><br><span class="line">    <span class="string">r"file:/C:\python代码\步骤4 Flask基础及项目实战\第31周 实战测试慕旅游网：Web自动化测试\web自动化\WEBAUTO(测试网页)/sendkeys.html"</span></span><br><span class="line">)</span><br><span class="line">driver.find_element_by_id(<span class="string">'A'</span>).send_keys((Keys.CONTROL, <span class="string">'a'</span>))</span><br><span class="line">driver.find_element_by_id(<span class="string">'A'</span>).send_keys((Keys.CONTROL, <span class="string">'x'</span>))</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">driver.find_element_by_id(<span class="string">'B'</span>).send_keys((Keys.CONTROL, <span class="string">'v'</span>))</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">driver.find_element_by_id(<span class="string">'B'</span>).send_keys((Keys.CONTROL, <span class="string">'a'</span>))</span><br><span class="line">driver.find_element_by_id(<span class="string">'B'</span>).send_keys((Keys.CONTROL, <span class="string">'c'</span>))</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">driver.find_element_by_id(<span class="string">'A'</span>).send_keys((Keys.CONTROL, <span class="string">'v'</span>))</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">driver.quit()</span><br></pre></td></tr></tbody></table></figure>






<p><strong>Selenium之-警告框处理</strong></p>
<p>在 webdriver 中处理 JavaScript 所生成的 alert、confirm 以及 prompt 十分简单，<br>具体做法是使用  switch_to.alert 方法定位到 alert/confirm/prompt，然后使用 text/accept/dismiss/  send_keys 等方法进行操作。<br>弹出框处理</p>
<blockquote>
<p><code>text</code>：返回 alert/confirm/prompt 中的文字信息。<br><code>accept()</code>：接受现有警告框。<br><code>dismiss()</code>：无视现有警告框。<br><code>send_keys(keysToSend)</code>：发送文本至prompt警告框。keysToSend：将文本发送至警告框。原生的js，不会在python终端显示</p>
</blockquote>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.action_chains <span class="keyword">import</span> ActionChains</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">base_url = <span class="string">'https://www.baidu.com/'</span></span><br><span class="line">driver = webdriver.Chrome(<span class="string">'../tools/chromedriver.exe'</span>)</span><br><span class="line">driver.implicitly_wait(<span class="number">10</span>)</span><br><span class="line">driver.get(base_url)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 鼠标悬停至 “设置” 链接</span></span><br><span class="line">link = driver.find_element_by_link_text(<span class="string">'设置'</span>)</span><br><span class="line">ActionChains(driver).move_to_element(link).perform()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开搜索设置</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">'搜索设置'</span>).click()</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 点击 “搜索设置”</span></span><br><span class="line">driver.find_element_by_class_name(<span class="string">'prefpanelgo'</span>).click()</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 接受警告框prefpanelgo</span></span><br><span class="line">driver.switch_to.alert.accept()</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></tbody></table></figure>


<p><code>alert.html</code></p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"content-type"</span> <span class="attr">content</span>=<span class="string">"text/html;charset=utf-8"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>attribute<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">async</span>=<span class="string">""</span> <span class="attr">src</span>=<span class="string">"D:/Besttest/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> /&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>alert<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row-fluid"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"span6"</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"tooltip"</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">data-toggle</span>=<span class="string">"tooltip"</span> <span class="attr">title</span>=<span class="string">"selenium-webdriver"</span> <span class="attr">onclick</span>=<span class="string">"alert(this.title);"</span>&gt;</span>hover to see tooltip<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line"></span><br><span class="line">driver_path = <span class="string">'C:\\Users\\rose\\Downloads\\msedgedriver.exe'</span></span><br><span class="line">driver = webdriver.Edge(driver_path)</span><br><span class="line">driver.maximize_window()</span><br><span class="line">driver.get(<span class="string">r"file:/C:\python代码\步骤4 Flask基础及项目实战\第31周 实战测试慕旅游网：Web自动化测试\web自动化\WEBAUTO(测试网页)/alert.html"</span>)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line">driver.find_element_by_id(<span class="string">'tooltip'</span>).click()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">alert = driver.switch_to.alert</span><br><span class="line">print(alert.text)</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">alert.accept()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></tbody></table></figure>

<p><code>confirm.html</code></p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>confirm<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">???????????????</span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">"JavaScript"</span>&gt;</span></span><br><span class="line">            </span><br><span class="line"></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span>(confirm(<span class="string">"are you ready?"</span>)){</span></span><br><span class="line"><span class="javascript">                alert(<span class="string">"Go!"</span>);</span></span><br><span class="line">            }</span><br><span class="line"><span class="javascript">            <span class="keyword">else</span>{</span></span><br><span class="line"><span class="javascript">                alert(<span class="string">"Hold on!"</span>);</span></span><br><span class="line">            }</span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line"></span><br><span class="line">driver_path = <span class="string">'C:\\Users\\rose\\Downloads\\msedgedriver.exe'</span></span><br><span class="line">driver = webdriver.Edge(driver_path)</span><br><span class="line">driver.maximize_window()</span><br><span class="line"></span><br><span class="line">driver.get(</span><br><span class="line">    <span class="string">r"file:/C:\python代码\步骤4 Flask基础及项目实战\第31周 实战测试慕旅游网：Web自动化测试\web自动化\WEBAUTO(测试网页)/confirm.html"</span></span><br><span class="line">)</span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line">confirm = driver.switch_to.alert</span><br><span class="line">print(confirm.text)</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">confirm.dismiss()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">print(confirm.text)</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">confirm.accept()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 法一</span></span><br><span class="line"><span class="comment"># alert = driver.switch_to.alert</span></span><br><span class="line"><span class="comment"># print(alert.text)</span></span><br><span class="line"><span class="comment"># sleep(2)</span></span><br><span class="line"><span class="comment"># alert.accept()</span></span><br><span class="line"><span class="comment"># sleep(2)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 法二</span></span><br><span class="line">print(confirm.text)</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">confirm.accept()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></tbody></table></figure>

<p><code>prompt.html</code></p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">'JavaScript'</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> &gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> aa= prompt(<span class="string">"What's your name?"</span>,<span class="string">"haha"</span>);</span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.write(<span class="string">"Welcome to my world, "</span>+aa+<span class="string">"&lt;br&gt;"</span>)</span></span><br><span class="line">/*</span><br><span class="line"><span class="javascript"><span class="keyword">if</span>(confirm(<span class="string">"准备好了吗？？"</span>)){</span></span><br><span class="line"><span class="javascript">  alert(<span class="string">"那就开始吧！！"</span>);</span></span><br><span class="line">}</span><br><span class="line"><span class="javascript"><span class="keyword">else</span>{</span></span><br><span class="line"><span class="javascript">  alert(<span class="string">"再等一下"</span>);</span></span><br><span class="line">}</span><br><span class="line">*/</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line"></span><br><span class="line">driver_path = <span class="string">'C:\\Users\\rose\\Downloads\\msedgedriver.exe'</span></span><br><span class="line">driver = webdriver.Edge(driver_path)</span><br><span class="line">driver.maximize_window()</span><br><span class="line"></span><br><span class="line">driver.get(</span><br><span class="line">    <span class="string">r"file:/C:\python代码\步骤4 Flask基础及项目实战\第31周 实战测试慕旅游网：Web自动化测试\web自动化\WEBAUTO(测试网页)/prompt.html"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">prompt = driver.switch_to.alert</span><br><span class="line">print(prompt.text)</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">prompt.send_keys(<span class="string">'fengluo'</span>)</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">prompt.accept()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">driver.quit()</span><br></pre></td></tr></tbody></table></figure>


<p><br>Selenium 场景警告场景学习<br>在页面操作过程中有时候点击某个链接会弹出新的窗口，这时就需要主机切换到新打开的窗口上进行多页面切换</p>
<blockquote>
<p><code>current_window_handle</code>：获得当前窗口句柄<br><code>window_handles</code>：返回所有窗口的句柄到当前会话<br><code>switch_to.window()</code>：用于切换到相应的窗口</p>
</blockquote>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">base_url = <span class="string">'https://www.baidu.com/'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">browser = webdriver.Chrome(<span class="string">'../tools/chromedriver.exe'</span>)</span><br><span class="line"><span class="comment"># 隐式等待10秒</span></span><br><span class="line">browser.implicitly_wait(<span class="number">10</span>)</span><br><span class="line">browser.get(base_url)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得搜索窗口的句柄</span></span><br><span class="line">search_windows = browser.current_window_handle</span><br><span class="line">browser.find_element_by_link_text(<span class="string">'登录'</span>).click()</span><br><span class="line">browser.find_element_by_link_text(<span class="string">'立即注册'</span>).click()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得当前打开窗口的句柄</span></span><br><span class="line">all_handles = browser.window_handles</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入注册窗口</span></span><br><span class="line"><span class="keyword">for</span> handle <span class="keyword">in</span> all_handles:</span><br><span class="line">    <span class="keyword">if</span> handle != search_windows:</span><br><span class="line">        browser.switch_to.window(handle)</span><br><span class="line">        print(<span class="string">'now register window!'</span>)</span><br><span class="line">        browser.find_element_by_name(<span class="string">'account'</span>).send_keys(<span class="string">'username'</span>)</span><br><span class="line">        browser.find_element_by_name(<span class="string">'password'</span>).send_keys(<span class="string">'password'</span>)</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">browser.quit()</span><br></pre></td></tr></tbody></table></figure>


<p><code>multi.html</code></p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"content-type"</span> <span class="attr">content</span>=<span class="string">"text/html;charset=utf-8"</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">title</span>&gt;</span>Form<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">async</span>=<span class="string">""</span> <span class="attr">src</span>=<span class="string">"jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"bootstrap-combined.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"bootstrap.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">h3</span>&gt;</span>simple login form<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"control-group"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label"</span> <span class="attr">for</span>=<span class="string">"inputEmail"</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"controls"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"inputEmail"</span> <span class="attr">placeholder</span>=<span class="string">"Email"</span> <span class="attr">name</span>=<span class="string">"email"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"control-group"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label"</span> <span class="attr">for</span>=<span class="string">"inputPassword"</span>&gt;</span>Password<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"controls"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">id</span>=<span class="string">"inputPassword"</span> <span class="attr">placeholder</span>=<span class="string">"Password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"control-group"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"controls"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"checkbox"</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span> Remember me</span><br><span class="line">           <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn"</span>&gt;</span>Sign in<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://www.baidu.com"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>register<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">driver_path = <span class="string">'C:\\Users\\rose\\Downloads\\msedgedriver.exe'</span></span><br><span class="line">driver = webdriver.Edge(driver_path)</span><br><span class="line">driver.maximize_window()</span><br><span class="line">driver.get(</span><br><span class="line">    <span class="string">r"file:/C:\python代码\步骤4 Flask基础及项目实战\第31周 实战测试慕旅游网：Web自动化测试\web自动化\WEBAUTO(测试网页)//multi.html"</span></span><br><span class="line">)</span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line">first_window = driver.current_window_handle  <span class="comment"># 将首页句柄暂存</span></span><br><span class="line">driver.find_element_by_link_text(<span class="string">'register'</span>).click()</span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line">all_window = driver.window_handles  <span class="comment"># 获取所有句柄</span></span><br><span class="line"><span class="keyword">for</span> handle <span class="keyword">in</span> all_window:</span><br><span class="line">    <span class="keyword">if</span> handle != first_window:  <span class="comment"># 遍历找到不等于首页的</span></span><br><span class="line">        driver.switch_to.window(handle)</span><br><span class="line">        print(<span class="string">'jumping!!'</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">driver.find_element_by_id(<span class="string">'kw'</span>).send_keys(<span class="string">'fengluo'</span>)</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">driver.find_element_by_id(<span class="string">'su'</span>).click()</span><br><span class="line">sleep(<span class="number">3</span>)</span><br><span class="line">driver.switch_to.window(first_window)</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">el = driver.find_element_by_xpath(<span class="string">"//*[@id='inputEmail']"</span>)</span><br><span class="line">el.send_keys(<span class="string">'jackson'</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">el.clear()</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">el.send_keys(<span class="string">'fengluo'</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">"//*[@id='inputPassword']"</span>).send_keys(<span class="string">'123456'</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">"/html/body/form/div[3]/div/button"</span>).click()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># driver.quit()</span></span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/08/21/unittest/" rel="prev" title="unittest">
                  <i class="fa fa-chevron-left"></i> unittest
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/08/21/restful/" rel="next" title="REST">
                  REST <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">外心人D</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
