<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"bubbleboy11.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.6.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:type" content="website">
<meta property="og:title" content="外心人D的博客">
<meta property="og:url" content="https://bubbleboy11.github.io/page/17/index.html">
<meta property="og:site_name" content="外心人D的博客">
<meta property="og:description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="外心人D">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://bubbleboy11.github.io/page/17/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/17/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>外心人D的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="外心人D的博客" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">外心人D的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">外心人D</p>
  <div class="site-description" itemprop="description">本博客大多内容为慕课和网上博客，并非原创</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">351</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



          </div>
        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/01/08/zip/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/01/08/zip/" class="post-title-link" itemprop="url">Python zip</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-01-07 16:21:41" itemprop="dateCreated datePublished" datetime="2021-01-07T16:21:41Z">2021-01-07</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-24 01:35:34" itemprop="dateModified" datetime="2021-05-24T01:35:34Z">2021-05-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>zip() 函数用于<br>将可迭代的对象作为参数，将对象中对应的元素打包成一个个元组，然后返回由这些元组组成的列表。<br> 如果各个迭代器的元素个数不一致，则返回列表长度与最短的对象相同，利用 * 号操作符，可以将元组解压为列表。<br>将多个可迭代对象组合为一个可迭代的对象，每次组合时都取出对应顺序的对象元素组合为元组，直到最少的对象中元素全部被组合，剩余的其他对象中未被组合的元素将被舍弃。</p>
<ol>
<li>解压<br>传入的data为batch个元组,即batch个(iamges,captions) 对儿<br>images,captions=zip(data)<br>表示zip(data)=(batch 个image,batch 个 caption)</li>
<li>压缩<br>data=zip(images,captions)</li>
</ol>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">b = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">c = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br><span class="line">zipped = zip(a, b)  <span class="comment"># 返回一个对象</span></span><br><span class="line">print(zipped)  <span class="comment"># &lt;zip object at 0x0000015578597FC0&gt;</span></span><br><span class="line"></span><br><span class="line">print(list(zipped))  <span class="comment"># list() 转换为列表</span></span><br><span class="line"><span class="comment"># [(1, 4), (2, 5), (3, 6)]</span></span><br><span class="line"></span><br><span class="line">print(list(zip(a, c)))  <span class="comment"># 元素个数与最短的列表一致</span></span><br><span class="line"><span class="comment"># [(1, 4), (2, 5), (3, 6)]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 与 zip 相反，zip(*) 可理解为解压，返回二维矩阵式</span></span><br><span class="line">a1, a2 = zip(*zip(a, b))</span><br><span class="line">print(list(a1))</span><br><span class="line"><span class="comment"># [1, 2, 3]</span></span><br><span class="line">print(list(a2))</span><br><span class="line"><span class="comment"># [4, 5, 6]</span></span><br><span class="line"></span><br><span class="line">print(zip(*zip(a, b)))  <span class="comment"># &lt;zip object at 0x000001D12224A540&gt;</span></span><br><span class="line"></span><br><span class="line">keys = [<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>]</span><br><span class="line">values = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">d = zip(keys, values)</span><br><span class="line">older = zip(*d)</span><br><span class="line">print(list(older))</span><br><span class="line"><span class="comment"># [('one', 'two', 'three'), (1, 2, 3)]</span></span><br></pre></td></tr></tbody></table></figure>

<p>由zip模拟了一个类似字典的一一对应的元组迭代对象，并将其转化为list类型查看，<br>当然我们可以利用获取迭代对象生成真正的键值字典：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br><span class="line">b = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">d = {}</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    d[a[i]] = b[i]</span><br><span class="line">print(d)  <span class="comment"># {'a': 1, 'b': 2, 'c': 3}</span></span><br><span class="line"></span><br><span class="line">d = {k: v <span class="keyword">for</span> k, v <span class="keyword">in</span> zip(a, b)}  <span class="comment"># 字典比循环简单</span></span><br><span class="line">print(d)  <span class="comment"># {'a': 1, 'b': 2, 'c': 3}</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">d = zip(a, b)</span><br><span class="line"></span><br><span class="line">E = {}</span><br><span class="line"><span class="keyword">for</span> key, value <span class="keyword">in</span> d:</span><br><span class="line">    print(key, value)</span><br><span class="line">    E[key] = value</span><br><span class="line"><span class="comment"># a 1</span></span><br><span class="line"><span class="comment"># b 2</span></span><br><span class="line"><span class="comment"># c 3</span></span><br><span class="line">print(E)</span><br><span class="line"><span class="comment"># {'a': 1, 'b': 2, 'c': 3}</span></span><br><span class="line"></span><br><span class="line">D = dict(zip(a, b))</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 把元组("a","b")和元组(1,2)，变为字典{"a":1,"b":2}</span></span><br><span class="line">a, b = (<span class="string">"a"</span>, <span class="string">"b"</span>), (<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">z = zip(a, b)</span><br><span class="line">print(z)</span><br><span class="line"><span class="comment"># [("a", 1), ("b", 2)]</span></span><br><span class="line"></span><br><span class="line">c = dict(z)</span><br><span class="line">print(c)</span><br><span class="line"><span class="comment"># Out[8]: {'a': 1, 'b': 2}</span></span><br><span class="line"></span><br><span class="line">d = dict(zip((<span class="string">"a"</span>, <span class="string">"b"</span>), (<span class="number">1</span>, <span class="number">2</span>)))</span><br><span class="line">print(d)</span><br><span class="line"><span class="comment"># Out[4]: {'a': 1, 'b': 2}</span></span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">b = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">c = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br><span class="line">zipped = zip(a, b)  <span class="comment"># 打包为元组的列表</span></span><br><span class="line">print(zipped)</span><br><span class="line">print(list(zipped))</span><br><span class="line"><span class="comment"># [(1, 4), (2, 5), (3, 6)]</span></span><br><span class="line">p = zip(a, c)  <span class="comment"># 元素个数与最短的列表一致</span></span><br><span class="line">print(p)</span><br><span class="line">print(list(p))</span><br><span class="line"><span class="comment"># [(1, 4), (2, 5), (3, 6)]</span></span><br><span class="line">q = zip(zipped)  <span class="comment"># 与 zip 相反，zipped 可理解为解压，返回二维矩阵式</span></span><br><span class="line">print(list(q))</span><br><span class="line"><span class="comment"># []</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> align, text <span class="keyword">in</span> zip(<span class="string">'&lt;^&gt;'</span>, [<span class="string">'left'</span>, <span class="string">'center'</span>, <span class="string">'right'</span>]):</span><br><span class="line">    print(<span class="string">'{0:{fill}{align}16}'</span>.format(text, fill=align, align=align))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 'left&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;'</span></span><br><span class="line"><span class="comment"># '^^^^^center^^^^^'</span></span><br><span class="line"><span class="comment"># '&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;right'</span></span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/12/04/django-zi-ding-yi-mo-xing-pei-zhi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/04/django-zi-ding-yi-mo-xing-pei-zhi/" class="post-title-link" itemprop="url">django自定义模型配置和表单界面</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-03 17:12:42" itemprop="dateCreated datePublished" datetime="2020-12-03T17:12:42Z">2020-12-03</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-08-04 00:44:28" itemprop="dateModified" datetime="2021-08-04T00:44:28Z">2021-08-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%85%E6%B8%B8%E7%BD%91%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">旅游网项目</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="django自定义模型配置和表单界面"><a href="#django自定义模型配置和表单界面" class="headerlink" title="django自定义模型配置和表单界面"></a>django自定义模型配置和表单界面</h1><h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><h3 id="定制个性化的列表显示字段"><a href="#定制个性化的列表显示字段" class="headerlink" title="定制个性化的列表显示字段"></a>定制个性化的列表显示字段</h3><h3 id="自定义后台模型的表单验证"><a href="#自定义后台模型的表单验证" class="headerlink" title="自定义后台模型的表单验证"></a>自定义后台模型的表单验证</h3><p>从ORM模型直接创建一个表单<br><code>accounts\forms.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileEditForm</span>(<span class="params">forms.ModelForm</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息编辑 """</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = Profile</span><br><span class="line">        fields = (<span class="string">'real_name'</span>, <span class="string">'email'</span>, <span class="string">'phone_no'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">clean_age</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">""" 验证用户的年龄 """</span></span><br><span class="line">        age = self.cleaned_data[<span class="string">'age'</span>]</span><br><span class="line">        <span class="keyword">if</span> int(age) &gt;= <span class="number">120</span> <span class="keyword">or</span> int(age) &lt;= <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">raise</span> forms.ValidationError(<span class="string">'年龄只能在1-120之间'</span>)</span><br><span class="line">        <span class="keyword">return</span> age</span><br></pre></td></tr></tbody></table></figure>

<p>通过装饰器注册把模型注册到后台管理，可在admin后台对模型字段数据进行增删改查<br><code>trip\accounts\admin.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> accounts.forms <span class="keyword">import</span> ProfileEditForm</span><br><span class="line"><span class="keyword">from</span> accounts.models <span class="keyword">import</span> Profile</span><br><span class="line"></span><br><span class="line"><span class="meta">@admin.register(Profile)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息表 """</span></span><br><span class="line">    <span class="comment"># 列表中显示的字段</span></span><br><span class="line">    list_display = (<span class="string">'format_username'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>, <span class="string">'created_at'</span>)</span><br><span class="line">    <span class="comment"># 关联的字段一次性查出，减少查询次数</span></span><br><span class="line">    <span class="comment"># 查询用户详细信息表需要在后台管理中展示用户基础信息表的内容</span></span><br><span class="line">    list_select_related = (<span class="string">'user'</span>, )</span><br><span class="line">    <span class="comment"># 表单中可以编辑的字段</span></span><br><span class="line">    fields = (<span class="string">'real_name'</span>, <span class="string">'email'</span>, <span class="string">'phone_no'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>)</span><br><span class="line">    <span class="comment"># 自定义表单验证</span></span><br><span class="line">    form = ProfileEditForm</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/2020/12/04/django-zi-ding-yi-mo-xing-pei-zhi/5.png" alt="description"></p>
<h3 id="重写保存方法，执行其它业务逻辑"><a href="#重写保存方法，执行其它业务逻辑" class="headerlink" title="重写保存方法，执行其它业务逻辑"></a>重写保存方法，执行其它业务逻辑</h3><p><code>accounts\forms.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileEditForm</span>(<span class="params">forms.ModelForm</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息编辑 """</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = Profile</span><br><span class="line">        fields = (<span class="string">'real_name'</span>, <span class="string">'email'</span>, <span class="string">'phone_no'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">save</span>(<span class="params">self, commit=False</span>):</span></span><br><span class="line">        obj = super().save(commit)</span><br><span class="line">        <span class="comment"># 保存数据时做一些其他的业务逻辑处理</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> obj.source:</span><br><span class="line">            <span class="comment"># 对象的source字段存为web</span></span><br><span class="line">            obj.source = <span class="string">'web'</span></span><br><span class="line">            obj.save()</span><br><span class="line">        <span class="keyword">return</span> obj</span><br></pre></td></tr></tbody></table></figure>


<h3 id="限制可以编辑的模型字段"><a href="#限制可以编辑的模型字段" class="headerlink" title="限制可以编辑的模型字段"></a>限制可以编辑的模型字段</h3><ul>
<li><code>editable=False</code><br><code>accounts\models.py</code><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息 """</span></span><br><span class="line">    SEX_CHOICES = (</span><br><span class="line">        (<span class="number">1</span>, <span class="string">'男'</span>),</span><br><span class="line">        (<span class="number">0</span>, <span class="string">'女'</span>),</span><br><span class="line">    )</span><br><span class="line">    username = models.CharField(<span class="string">'用户名'</span>,</span><br><span class="line">                                max_length=<span class="number">64</span>,</span><br><span class="line">                                unique=<span class="literal">True</span>,</span><br><span class="line">                                editable=<span class="literal">False</span>)</span><br><span class="line">    user = models.OneToOneField(User,</span><br><span class="line">                                related_name=<span class="string">'profile'</span>,</span><br><span class="line">                                on_delete=models.CASCADE,</span><br><span class="line">                                editable=<span class="literal">False</span>)</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p><img src="/2020/12/04/django-zi-ding-yi-mo-xing-pei-zhi/1.png" alt="description"></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息 """</span></span><br><span class="line">    SEX_CHOICES = (</span><br><span class="line">        (<span class="number">1</span>, <span class="string">'男'</span>),</span><br><span class="line">        (<span class="number">0</span>, <span class="string">'女'</span>),</span><br><span class="line">    )</span><br><span class="line">    username = models.CharField(<span class="string">'用户名'</span>,</span><br><span class="line">                                max_length=<span class="number">64</span>,</span><br><span class="line">                                unique=<span class="literal">True</span>,</span><br><span class="line">                                editable=<span class="literal">False</span>)</span><br><span class="line">    user = models.OneToOneField(User,</span><br><span class="line">                                related_name=<span class="string">'profile'</span>,</span><br><span class="line">                                on_delete=models.CASCADE,</span><br><span class="line">                                editable=<span class="literal">False</span>)</span><br></pre></td></tr></tbody></table></figure>


<ul>
<li><code>filed</code>/<code>exclude</code>——需要编辑/不需要编辑的字段列表<br>通过装饰器注册把模型注册到后台管理，可在admin后台对模型字段数据进行增删改查<br><code>trip\accounts\admin.py</code></li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> accounts.forms <span class="keyword">import</span> ProfileEditForm</span><br><span class="line"><span class="keyword">from</span> accounts.models <span class="keyword">import</span> Profile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@admin.register(Profile)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息表 """</span></span><br><span class="line">    list_display = (<span class="string">'format_username'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>, <span class="string">'created_at'</span>)</span><br><span class="line">    <span class="comment"># 关联的字段一次性查出，减少查询次数</span></span><br><span class="line">    list_select_related = (<span class="string">'user'</span>, )</span><br><span class="line">    <span class="comment"># 表单中可以编辑的字段</span></span><br><span class="line">    fields = (<span class="string">'real_name'</span>, <span class="string">'email'</span>, <span class="string">'phone_no'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/2020/12/04/django-zi-ding-yi-mo-xing-pei-zhi/2.png" alt="description"></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息 """</span></span><br><span class="line">    username = models.CharField(<span class="string">'用户名'</span>,</span><br><span class="line">                                max_length=<span class="number">64</span>,</span><br><span class="line">                                unique=<span class="literal">True</span>,</span><br><span class="line">                                editable=<span class="literal">False</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""setting.py installed_apps messages的提示的修改对象改成对应的中文用户名"""</span></span><br><span class="line">        <span class="keyword">return</span> self.username</span><br></pre></td></tr></tbody></table></figure>

<p><img src="/2020/12/04/django-zi-ding-yi-mo-xing-pei-zhi/3.png" alt="description"></p>
<p>取消外键检查<br><code>setting.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = {</span><br><span class="line"><span class="string">'default'</span>: {</span><br><span class="line">    ...</span><br><span class="line">    <span class="string">'OPTIONS'</span>: {</span><br><span class="line">         <span class="string">"init_command"</span>: <span class="string">"SET foreign_key_checks = 0;"</span>,</span><br><span class="line">    },</span><br><span class="line"> }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>在Django的早期版本中，使用InnoDB存储引擎时，带有前向引用(即与尚未插入数据库的行的关系)的固定装置将无法加载。这是因为InnoDB偏离了SQL标准，立即检查外键约束，而不是将检查推迟到事务提交之后。这个问题在Django 1.4得到了解决。</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/32-wei/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/32-wei/" class="post-title-link" itemprop="url">32位</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-04 15:08:29" itemprop="dateModified" datetime="2021-05-04T15:08:29Z">2021-05-04</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>32位是什么<br>现在主流的操作系统都是64位的，早期存在32位操作系统，相信大家也都有所听闻，其实，在更早之前，还有16位、8位的，这里就不展开了。</p>
<p>位，指的比特位，32位指的就是计算机总线一次传输的数据长度，包括数据总线、地址总线、控制总线。</p>
<p>地址总线<br>地址总线是用来传送数据的地址的，主要用于CPU、DMA，通过地址总线传输地址，找到对应地址的数据，再通过数据总线传输对应的数据。那么因为操作系统是32位，所以地址长度最长也为32位，则最大的寻址范围为2^32次方。</p>
<p>到这里，问题似乎就结束了，因为2^32字节=4G，说明最大寻址空间为4G。</p>
<p>但其实没有，提问：为啥2^32寻址范围对应的是字节呢？为什么不能是比特或者是其他的单位。</p>
<p>这其实是寻址方式决定的。</p>
<p>按字节寻址<br>计算机内存一般是按字节寻址的，当计算机以这种方式寻址时，一个地址就和一个字节对应，所以才有了2^32字节=4G的计算方式，通过这种计算方式，可以得到32位系统最多支持4G内存的结论。</p>
<p>按字寻址<br>除了按字节寻址以外，还有一种按字寻址的方式。字的大小可以是32位，也可以是64位，当按字寻址的时候，每个地址指向的就是一个字，假设一个字为32位，那么32位地址就可以存储2^32*32/8=16G空间。</p>
<p>所以在讨论寻址范围的时候，还需要把按字节寻址和按字寻址的区别也考虑进去。</p>
<p>寻址范围和寻址空间<br>寻址范围和寻址空间是两个概念，上面也多次提到，这两个概念是不一样的，这里也需要特别注意一下，寻址范围指的是一个范围，他是一个区间，不带任何单位；而寻址空间指的是可以寻址的容量，它是带单位的。</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/android-studio/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/android-studio/" class="post-title-link" itemprop="url">Android Studio</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-07-09 08:59:47" itemprop="dateModified" datetime="2021-07-09T08:59:47Z">2021-07-09</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>工具 工作区间 工程<br>eclipse          Workspace   project<br>android studio   project     module<br>命名和路径不能包含中文</p>
<p>30版本开始build-tools配合jdk1.8会报错，所以需要手动降级到29版本</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell</span><br></pre></td></tr></tbody></table></figure>

<h3 id="Android模式"><a href="#Android模式" class="headerlink" title="Android模式"></a>Android模式</h3><p>通过类型分类，所看到的样式并不是硬盘实际文件结构，需要关心的文件以各自的类别编排在不同的目录下<br>manifests 放配置文件<br>java 放源文件<br>res 资源目录<br>drawable 图形图像相关的资源<br>mipmap 添加图片<br>values 常量资源</p>
<h3 id="Project模式"><a href="#Project模式" class="headerlink" title="Project模式"></a>Project模式</h3><p>展示全部的文件信息，文件的位置是真实的物理结构，可以知道硬盘的实际摆放位置，<br>project模式删除一个module，右键open module setting，点击 -，再右键module点击多了一个delete，<br><code>src\main\AndroidManifest.xml</code> <activity></activity>中的MainActivity 中的 <intent-filter> 决定了是启动界面，</intent-filter></p>
<p>src\main\java\com\example\mainactivity 右键new-activity-empty activity，会在src\main\AndroidManifest.xml自动注册</p>
<p>导入项目 File-new-import Module</p>
<p>activity 窗口页面<br>页面代码和逻辑代码分离<br>逻辑代码放在activity java类中间 进行处理，<br>界面设计 由布局文件.xml，布局名称要全小写</p>
<p>Android应⽤程序设置的图标保存在res⽬录<br>src是存放所有java代码的⽬录，<br>gen是⾃动⽣成的⽬录，⽤来存放资源id，<br>libs⽤来存放第三⽅jar包。</p>
<p>运行：绿色三角或者右键MainActivity 选择 run</p>
<h3 id="Gradle"><a href="#Gradle" class="headerlink" title="Gradle"></a>Gradle</h3><p>Android主流的编译工具</p>
<ul>
<li><p>项目: </p>
<ul>
<li>setting.gradle 哪些项目应该加入到编译过程， </li>
<li>build.gradle 配置会加入到所有项目</li>
</ul>
</li>
<li><p>Module: build.gradle 对当前目录的配置(优先于项目的build.gradle)</p>
</li>
<li><p>minsdkversion:应用程序运行时所需要的最小 API level，默认为1</p>
</li>
<li><p>compileSdk version:编译的SDK版本，指定指定的版本编译应用，默认使用最新，不会打包生成到apk，你修改了它，不会改变已运行时的现象</p>
</li>
<li><p>targetsdkversion:目标版本，Android提供向前兼容的一个主流依据，同一个项目在不同设备会有不同现象，指定SDK版本，禁止不同SDK版本的兼容性所产生的差异，匹配运行程序的平台API级别，</p>
</li>
<li><p>dependencies:依赖配置，依赖的库</p>
</li>
</ul>
<p>快捷键<br>ctrl + z 撤销<br>ctrl + shift + z 撤销<br>ctrl + y 不是反撤销，删除光标所在行</p>
<p>提示代码:ctrL+aLt+空格<br>代码自动修正aLt+ enter<br>显示文档说明ctrL+q</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/csrf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/csrf/" class="post-title-link" itemprop="url">CSRF</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-18 05:25:41" itemprop="dateModified" datetime="2021-04-18T05:25:41Z">2021-04-18</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/django/" itemprop="url" rel="index"><span itemprop="name">django</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>CSRF：Cross-site request forgery 跨站请求伪造<br>利用网站对已认证的权限去执行未授权的命令的一种恶意攻击<br>攻击者它们会利用登录过的用户在浏览器中的认证信息，欺骗用户的浏览器去访问以你的身份在一个自己曾经认证过的网站上模拟发送请求，，然后做了一些没有经过你授权的一些行为，比发邮件，发消息，甚至财产操作如转账和购买商品。<br>由于浏览器曾经认证过，所以被访问的网站会认为是真正的用户操作而去运行。</p>
<p>这利用了web中用户身份验证的一个漏洞：简单的身份验证只能保证请求发自某个用户的浏览器，却不能保证请求本身是用户自愿发出的或者批准发送的</p>
<ol>
<li>用户C打开浏览器，访问受信任网站A，输入用户名和密码请求登录网站A；</li>
<li>在用户信息通过验证后，网站A产生Cookie信息并返回给浏览器，此时用户登录网站A成功，可以正常发送请求到网站A；</li>
<li>用户未退出网站A之前，在同一浏览器中，打开一个TAB页访问网站B；</li>
<li>网站B接收到用户请求后，返回一些攻击性代码，并发出一个请求要求访问第三方站点A；</li>
<li>浏览器在接收到这些攻击性代码后，根据网站B的请求，在用户不知情的情况下携带Cookie信息，向网站A发出请求。网站A并不知道该请求其实是由B发起的，所以会根据用户C的Cookie信息以C的权限处理该请求，导致来自网站B的恶意代码被执行。</li>
</ol>
<p>Csrf 是利用网站本身的漏洞，比如一个网站a用cookie就可以登录，不需要用户重新输入用户名和密码。那么我们就可以利用csrf攻击，携带cookie去登录网站a，进行钱的转账<br>Xss是在网站a里面注入恶意的脚本，我们一访问这个网站a，那么就执行恶意的代码</p>
<p>Csrf是需要登录的，xss是不需要进行登录的。</p>
<p>2.CSRF产生的条件<br>要完成一个 CSRF攻击，需要具备两个条件<br>受害者已经登录到目标网站并且没有退出( 保持登录状态 ）<br>受害者访问了攻击者发布的链接或者表单按钮<br>二者必须缺一不可</p>
<p>3.如何防范 CSRF？使用CSRF保护（针对同步提交，比如注册页面）<br>    在使用Get请求的时候非常容易伪造链接，所以尽量不要在GET请求里有任务数据修改操作。目前所有Python主流的web 框架所采用的的方式令牌同步。</p>
<p>令牌同步(Synchronizer token pattern , 简称STP)：在用户请求的表单中嵌入一个隐藏的<code>csrf_token</code>，服务端验证其是否与cookie中的一致(基于同源策略其他网站是无法获取cookie中的<code>csrf_token</code>)。黑客是拿不到你cookie中的 <code>csrftoken</code>值的，前提是网站本身没有 xss漏洞。</p>
<p>如果是 js 提交需要先从cookie获取csrf_token作为 X-CSRFToken请求头提交<br>    1. 在MIDDLEWARE设置中激活CSRF中间件<br>django.middleware.csrf.CsrfViewMiddleware<br>    2. </p><form>元素中使用<code>csrf_token</code>标签（POST请求)<br>Html<br>    1    <code>&lt;form class="xxx" method="post" action="."&gt;</code><br>    2    <code>{% csrf_token %}</code><br>    3. 选择合适的渲染方式<br>视图函数中，确保使用RequestContext来渲染（或者render()函数）</form><p></p>
<p>其他：检测来源HTTP Referer(容易被伪造)；验证码方式(安全但是繁琐)</p>
<p>开启使用CSRF保护之后，浏览器源码会生成一个隐藏的表单域。这个表单中自动生成了唯一的value值（每一次request都会有不同的value值），提交表单时候会将其一并提交，因为value值唯一，就不会有重复提交的情况。</p>
<p>图解：左边是用户，右边是需要登陆的网站。一个用户A通过自己的身份验证，去登陆网站SNS，网站会返回一个cookie值Cookie: sid=1234567890用来标识这个用户。然后中间一个攻击者给你发一个链接或者给你一个图片你可能会对它进行一个点击，比如发给你一个图<code>&lt;img src="http://example.com/msg?q=你好"&gt;</code>误导你来去点击，这个链接是发送评论的请求地址，如果你点击这个地址它就会以你的名义来发送这个你好。这个时候假如你误点这个图片就会触发这个链接的操作，然后你就会携带你的Cookie去请求SNS网站。这个时候你就会发现你实际上并没有想去发送你好这个评论。但是你通过攻击者留下的链接陷阱点进去之后然后你就误发这个评论。</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/django-zhong-kuo-zhan-yong-hu-mo-xing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/django-zhong-kuo-zhan-yong-hu-mo-xing/" class="post-title-link" itemprop="url">扩展Django中的用户模型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-29 02:43:24" itemprop="dateModified" datetime="2021-05-29T02:43:24Z">2021-05-29</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/django/" itemprop="url" rel="index"><span itemprop="name">django</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="django自带的用户模型"><a href="#django自带的用户模型" class="headerlink" title="django自带的用户模型"></a>django自带的用户模型</h2><p><code>UserProfile</code>模型类继承自<code>django.contrib.auth.models.AbstractUser</code><br>抽象模型，不会生成对应的数据表，这样可以使用Django自带的认证。</p>
<p><code>accounts\models.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> AbstractUser  <span class="comment"># 可以使用Django自带的认证</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserProfile</span>(<span class="params">AbstractUser</span>):</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>setting.py</code> 系统默认用户</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重载系统的用户，让 UserProfile 生效</span></span><br><span class="line">AUTH_USER_MODEL = <span class="string">"users.UserProfile"</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="扩展Django中的用户模型"><a href="#扩展Django中的用户模型" class="headerlink" title="扩展Django中的用户模型"></a>扩展Django中的用户模型</h2><p>是对ORM抽象模型的应用</p>
<h4 id="对用户进行扩展"><a href="#对用户进行扩展" class="headerlink" title="对用户进行扩展"></a>对用户进行扩展</h4><ul>
<li><p>思考如下场景如何实现</p>
<ul>
<li>Django内置的用户模型满足不了需求怎么办？</li>
<li>要用户模型添加头像字段怎么办？</li>
</ul>
</li>
<li><p>两种方式解决用户问题</p>
<ul>
<li><p>方式1：使用OneToOneField对用户进行扩展</p>
</li>
<li><p>方式2：替换现有的用户模型</p>
<ul>
<li>步骤一：配置用户模型，告诉django框架</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><code>setting.py</code> 定义的用户替换系统默认用户</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重载系统的用户，让User生效</span></span><br><span class="line">AUTH_USER_MODEL = <span class="string">'accounts.User'</span></span><br></pre></td></tr></tbody></table></figure>

<pre><code>- 步骤二：添加字段，同步模型到数据库
</code></pre>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python manage.py check</span><br><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></tbody></table></figure>

<p>数据库生成表格<br><code>account_user</code>和<code>account_user_group</code>和<code>account_user_user_permissions</code></p>
<ul>
<li>创建普通用户 命令行输入命令</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py shell  <span class="comment"># django控制台</span></span><br></pre></td></tr></tbody></table></figure>
<p>或者pycharm的<code>Python Console</code><br>引入用户</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> accounts.models <span class="keyword">import</span> User</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>使用命令行创建超级管理员</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;python manage.py createsuperuser</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>获取用户对象</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">user = User.objects.create_user(<span class="string">'john'</span>,<span class="string">'john@example.com'</span>,<span class="string">'johnpassword'</span>)</span><br><span class="line">user = User.objects.create_user(<span class="string">'admin'</span>,<span class="string">'admin@example.com'</span>,<span class="string">'123456'</span>)</span><br><span class="line">u = User.objects.get(username=<span class="string">'admin'</span>)</span><br><span class="line">u = User.objects.get(username=<span class="string">'13500000000'</span>)</span><br><span class="line">u.check_password(<span class="string">'123456'</span>)</span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/git-bash-cmd-pei-zhi-dai-li/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/git-bash-cmd-pei-zhi-dai-li/" class="post-title-link" itemprop="url">Git Bash, CMD配置代理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-07-22 03:38:52" itemprop="dateModified" datetime="2021-07-22T03:38:52Z">2021-07-22</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Markdown/" itemprop="url" rel="index"><span itemprop="name">Markdown</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="方法一-pip-linux配置文件换成清华源"><a href="#方法一-pip-linux配置文件换成清华源" class="headerlink" title="方法一 pip linux配置文件换成清华源"></a>方法一 pip linux配置文件换成清华源</h3><p>linux:<br>修改 <code>~/.pip/pip.conf</code> (没有就创建)，文件夹要加“.”，表示是隐藏文件夹)，内容如下：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">timeout = 6000</span><br><span class="line">index-url = https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">trusted-host = pypi.tuna.tsinghua.edu.cn</span><br></pre></td></tr></tbody></table></figure>

<p>windows:<br>直接在user目录中创建一个pip目录，如：<code>C:\Users\xx\pip</code>，在pip 目录下新建文件<code>pip.ini</code>，内容如下</p>
<figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[global]</span></span><br><span class="line"><span class="attr">timeout</span> = <span class="number">6000</span></span><br><span class="line"><span class="attr">index-url</span> = https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line"><span class="attr">trusted-host</span> = pypi.tuna.tsinghua.edu.cn</span><br></pre></td></tr></tbody></table></figure>

<p>在安装python库，在网络不好的情况会遇到<br>raise ReadTimeoutError(self._pool, None, ‘Read timed out.’)<br>ReadTimeoutError: HTTPSConnectionPool(host=’files.pythonhosted.org’, port=443): Read timed out.</p>
<ul>
<li>pycharm-setting-proxy-manual-127.0.0.1 prot 7890</li>
</ul>
<h3 id="ping的协议不是https，是ICMP协议，不是TCP-UDP协议"><a href="#ping的协议不是https，是ICMP协议，不是TCP-UDP协议" class="headerlink" title="ping的协议不是https，是ICMP协议，不是TCP/UDP协议"></a>ping的协议不是https，是ICMP协议，不是TCP/UDP协议</h3><p>不要输入<code>ping www.google.comping</code>,<br>Ping无法走代理。<br>如果你坚持要能Ping通才行，请考虑常规VPN（PPTP/L2PT/IPSec等）。</p>
<p>设置代理基本思路 : 配置梯子的 ip : port ,梯子会为通过此端口的流量加密混淆 , 将配置端口的命令以某种格式写入到配置文件中实现长久代理</p>
<p><code>curl -vv http://www.google.com</code>，用这条命令来验证，查看响应数据即可,有则说明成功<br><code>curl -I www.google.com</code> , 测试连接是否成功的 看状态码是否为 200<br>失败时<code>curl: (7) Failed to connect to www.google.com port 80: Timed out</code></p>
<p>直接打开CFW-setting—port点击terminal图标，点击端口是设置端口<br>速度</p>
<h3 id="Windows-下给cmd配置代理"><a href="#Windows-下给cmd配置代理" class="headerlink" title="Windows 下给cmd配置代理"></a>Windows 下给cmd配置代理</h3><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置本地代理的端口号 7890 为你实际的端口号</span></span><br><span class="line"><span class="built_in">set</span> http_proxy=http://127.0.0.1:7890</span><br><span class="line"><span class="built_in">set</span> https_proxy=http://127.0.0.1:7890</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置代理的用户名和密码（Clash For Windows不需要）</span></span><br><span class="line"><span class="comment"># HTTP</span></span><br><span class="line"><span class="built_in">set</span> http_proxy_user=username</span><br><span class="line"><span class="built_in">set</span> http_proxy_pass=password</span><br><span class="line"></span><br><span class="line"><span class="comment"># HTTPS</span></span><br><span class="line"><span class="built_in">set</span> https_proxy_user=username</span><br><span class="line"><span class="built_in">set</span> https_proxy_pass=password</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果需要恢复本地代理（清除代理）</span></span><br><span class="line"><span class="built_in">set</span> http_proxy=</span><br><span class="line"><span class="built_in">set</span> https_proxy=</span><br></pre></td></tr></tbody></table></figure>

<h3 id="Windows-下给终端Git-Bash，配置代理"><a href="#Windows-下给终端Git-Bash，配置代理" class="headerlink" title="Windows 下给终端Git Bash，配置代理"></a>Windows 下给终端Git Bash，配置代理</h3><ul>
<li>命令行配置</li>
</ul>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置本地代理的端口号 7890 为你实际的端口号</span></span><br><span class="line"><span class="built_in">export</span> http_proxy=http://127.0.0.1:7890</span><br><span class="line"><span class="built_in">export</span> https_proxy=http://127.0.0.1:7890</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>配置文件<blockquote>
<p>每次新建一个终端会话时,默认让终端去走代理,这样就不需要每次都复制拷贝一下了, 代理程序去智能分流(国内 IP 直连,国外走代理)，避免了连接国内 IP 地址时“绕远”.</p>
</blockquote>
<ul>
<li>假设 Git 默认路径为 <code>C:\Program Files\Git</code><br>那么配置文件路径为<br><code>C:\Program Files\Git\etc\bash.bashrc</code></li>
</ul>
</li>
</ul>
<ul>
<li>或者 ~/.gitconfig中添加<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[http]</span><br><span class="line">    proxy = http://127.0.0.1:7890</span><br><span class="line">[https]</span><br><span class="line">    proxy = https://127.0.0.1:7890</span><br></pre></td></tr></tbody></table></figure>


</li>
</ul>
<p>git配置ssh协议代理<br>linux目录 : <code>~/.ssh/config</code> (没有就自己新建一个,注意没有后缀)<br>进入 ssh 配置目录<br><code>cd ~/.ssh</code><br>编辑 config 文件,如果没有那就新建一个 config 文件<br><code>touch config</code><br><code>vi config</code></p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">  ProxyCommand <span class="string">"C:\Program Files\Git\mingw64\bin\connect.exe"</span> -H 127.0.0.1:7890 %h %p</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Host *</span><br><span class="line">    ProxyCommand nc -X 5 -x localhost:7890 %h %p</span><br><span class="line"><span class="comment"># 第一行代表所有的 ssh 的主机</span></span><br><span class="line"><span class="comment"># 第二行代表让所有的 ssh 的主机在连接的时候,通过你本地的端口为 7890 的 socks5 代理去连接,一般来讲,本地的 socks5 都是由翻墙工具提供,</span></span><br><span class="line"><span class="comment">#诸如 Surge  ClashX 或者 Ssr,所以,7891这个端口需要换成对应的服务端口即可</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>-H</code>为http代理, <code>-S</code>为socks5代理<br>以后不管是在用 git 进行 push 和 pull 操作还是 ssh 连接服务器的时候,均可获得畅快体验,</p>
<h3 id="npm配置代理"><a href="#npm配置代理" class="headerlink" title="npm配置代理"></a>npm配置代理</h3><ul>
<li>命令行配置</li>
<li>文件配置<br><code>~/.npmrc</code>随便哪一行添加下面的命令</li>
</ul>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">proxy=http://127.0.0.1:7890</span><br><span class="line">https-proxy=http://127.0.0.1:7890</span><br></pre></td></tr></tbody></table></figure>

<h3 id="在-vscode-中添加-git-bash"><a href="#在-vscode-中添加-git-bash" class="headerlink" title="在 vscode 中添加 git bash"></a>在 vscode 中添加 git bash</h3><p>在 vscode <code>setting.json</code>末尾添加</p>
<figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用Git Bash的配置</span></span><br><span class="line">"terminal.integrated.shell.windows": "C:\\Program Files\\Git\\bin\\bash.exe",</span><br><span class="line">"terminal.integrated.shellArgs.windows": ["--login","-i"]</span><br></pre></td></tr></tbody></table></figure>

<h3 id="Windows-下给终端PowerShell配置代理-env-https-proxy-“127-0-0-1-8080”"><a href="#Windows-下给终端PowerShell配置代理-env-https-proxy-“127-0-0-1-8080”" class="headerlink" title="Windows 下给终端PowerShell配置代理 env:https_proxy = “127.0.0.1:8080”"></a>Windows 下给终端PowerShell配置代理 env:https_proxy = “127.0.0.1:8080”</h3><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># <span class="doctag">NOTE:</span> registry keys for IE 8, may vary for other versions</span></span><br><span class="line"><span class="variable">$regPath</span> = <span class="string">'HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> Clear-Proxy</span><br><span class="line">{</span><br><span class="line">    Set-ItemProperty -Path <span class="variable">$regPath</span> -Name ProxyEnable -Value 0</span><br><span class="line">    Set-ItemProperty -Path <span class="variable">$regPath</span> -Name ProxyServer -Value <span class="string">''</span></span><br><span class="line">    Set-ItemProperty -Path <span class="variable">$regPath</span> -Name ProxyOverride -Value <span class="string">''</span></span><br><span class="line"></span><br><span class="line">    [Environment]::SetEnvironmentVariable(<span class="string">'http_proxy'</span>, <span class="variable">$null</span>, <span class="string">'User'</span>)</span><br><span class="line">    [Environment]::SetEnvironmentVariable(<span class="string">'https_proxy'</span>, <span class="variable">$null</span>, <span class="string">'User'</span>)</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> Set-Proxy</span><br><span class="line">{</span><br><span class="line">    <span class="variable">$proxy</span> = <span class="string">'http://example.com'</span></span><br><span class="line"></span><br><span class="line">    Set-ItemProperty -Path <span class="variable">$regPath</span> -Name ProxyEnable -Value 1</span><br><span class="line">    Set-ItemProperty -Path <span class="variable">$regPath</span> -Name ProxyServer -Value <span class="variable">$proxy</span></span><br><span class="line">    Set-ItemProperty -Path <span class="variable">$regPath</span> -Name ProxyOverride -Value <span class="string">'&lt;local&gt;'</span></span><br><span class="line"></span><br><span class="line">    [Environment]::SetEnvironmentVariable(<span class="string">'http_proxy'</span>, <span class="variable">$proxy</span>, <span class="string">'User'</span>)</span><br><span class="line">    [Environment]::SetEnvironmentVariable(<span class="string">'https_proxy'</span>, <span class="variable">$proxy</span>, <span class="string">'User'</span>)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="在-idea-中添加-git-bash"><a href="#在-idea-中添加-git-bash" class="headerlink" title="在 idea 中添加 git bash"></a>在 idea 中添加 git bash</h3><p>setting-tools-terminal-application settiing-shell path<br><code>"C:\\Program Files\\Git\\bin\\bash.exe" --login -i</code></p>
<p>就是两条命令，前两条。<br>要点<br>一定要加 <code>http://</code>，直接写域名或者 IP 不行。<br>http 和 https 都要设置。</p>
<h3 id="linux-配置终端代理"><a href="#linux-配置终端代理" class="headerlink" title="linux 配置终端代理"></a>linux 配置终端代理</h3><p>推荐使用qv2r*y<br>archlinux 下载 :</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S v2r*y</span><br><span class="line">sudo pacman -S qv2r*y</span><br></pre></td></tr></tbody></table></figure>

<p>配置代理 :</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> http_proxy=http://127.0.0.1:7890;<span class="built_in">export</span> https_proxy=http://127.0.0.1:7890</span><br></pre></td></tr></tbody></table></figure>

<p>添加到当前 shell 的配置文件中,<br>比如 zsh 的配置文件为家目录下的<code>~/.zshrc</code></p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置本地代理的端口号 7890 为你实际的端口号</span></span><br><span class="line"><span class="built_in">export</span> http_proxy=http://127.0.0.1:7890</span><br><span class="line"><span class="built_in">export</span> https_proxy=http://127.0.0.1:7890</span><br><span class="line"><span class="built_in">export</span> all_proxy=socks5://127.0.0.1:7891</span><br></pre></td></tr></tbody></table></figure>

<p>VM虚拟机配置共享主机，访问外网<br>查看是否启动VM服务(win+R)输入:<code>services.msc</code><br>代理工具设置允许来自局域网的访问：<br>5、VMware可以设置为NAT模式，或者桥接（桥接需要编辑虚拟网络编辑器–更改设置–添加网络-选择桥接模式–选择实体网卡即可），建议使用NAT简单</p>
<p>6、设置网络浏览器中的代理设置，设置的IP为主机的IP，端口号默认为7890<br>则浏览器即可使用主机的网络访问外网</p>
<p>、设置虚拟机中的终端设置临时代理：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> http_proxy=http://主机IP:7890</span><br><span class="line"><span class="built_in">export</span> https_proxy=http://主机IP:7890</span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/gunicorn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/gunicorn/" class="post-title-link" itemprop="url">Gunicorn</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-14 07:34:08" itemprop="dateModified" datetime="2021-04-14T07:34:08Z">2021-04-14</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/django/" itemprop="url" rel="index"><span itemprop="name">django</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Gunicorn：Python WSGI HTTP Server.<br>纯 Python 编写的高性能的 WSGI Server</p>
<p>pre-fork 预先分配多个 worker 进程处理请求(master-slave)。master-slave方式：一个master负责去管理多个worker进程，比如那个worker超时了把它重启，worker负责处理客服端的用户请求。</p>
<p>多钟 worker 支持：Sync 同步worker / Async(Gevent) 基于gevent的异步worker/ Tornado / AsyncIO。一般需要支持比较高的并发的时候，可以采用基于gevent的异步worker。</p>
<p>图解：使用Gunicorn来去部署 web的一种方式，首先客户端的请求先到Nginx这一层，Nginx负责反向代理，它就又把请求直接转发给Gunicorn。Gunicorn通过Pre-fork预先fork一堆worker进程，然后把请求转给worker进程处理请求。master进程它不会负责去处理请求，它只是负责监控和重启worker进程。</p>
<p>2.Gunicorn的代码示例</p>
<figure class="highlight cmake"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip <span class="keyword">install</span> gunicorn     <span class="comment"># 安装gunicorn</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建文件 myapp.py, 添加内容如下</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">app</span>(<span class="params">environ, start_response</span>):</span>  <span class="comment"># 一个web应用</span></span><br><span class="line">    data = <span class="string">b'Hello, World!\n'</span></span><br><span class="line">    start_response( <span class="string">"200 OK"</span>, [</span><br><span class="line">        (<span class="string">"Content-Type"</span>, <span class="string">"text/plain"</span>),</span><br><span class="line">        (<span class="string">"Content-Length"</span>, str(len(data))</span><br><span class="line">    ])</span><br><span class="line">    <span class="keyword">return</span> iter([data])</span><br><span class="line">``` </span><br><span class="line">```shell </span><br><span class="line">$ gunicorn -w <span class="number">4</span> myapp:app  <span class="comment"># 使用gunicorn指定4个worker启动 web应用</span></span><br></pre></td></tr></tbody></table></figure>
<p>由于gunicorn部署个启动都非常容易，所以很多公司都使用 Gunicorn来作为 WSGI server。</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/http-fang-fa/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/http-fang-fa/" class="post-title-link" itemprop="url">HTTP 方法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-07-20 08:50:14" itemprop="dateModified" datetime="2021-07-20T08:50:14Z">2021-07-20</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" itemprop="url" rel="index"><span itemprop="name">计算机网络</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>常见的 HTTP 方法、接口的分类： </p>
<p>GET 请求</p>
<ul>
<li><p>可以用浏览器地址栏直接输入网址访问</p>
</li>
<li><p>请求参数直接放在URL后面，明文传递明文显示</p>
</li>
<li><p>请求访问已被 URI 识别的资源。指定的资源经服务器端解析后返回响应内容。</p>
</li>
</ul>
<ul>
<li>可以用来提交表单和其他数据，会带来安全问题，比如一个登录页面，通过GET方式提交数据时，用户名和密码将出现在URL上，如果页面可以被缓存或者其他人可以访问这台机器，就可以从历史记录获得该用户的账号和密码<br>GET 方法是从指定的资源请求数据<br>GET 请求所包含的参数会被缓存(浏览器cache)，而post不会<br>GET 请求保留在浏览器历史记录中<br>GET 请求可被收藏为书签 get的url能被存为标签，post不会<br>get只能被url编码，而post可以被多种编码<br>get只接受ASCII字符，而post没有限制<br>get后退无害，而post后退会再次发送请求<br>GET 请求不应在处理敏感数据时使用<br>GET提交的数据大小有限制（因为浏览器对URL的长度有限制），<br>请求只应当用于取回数据</li>
</ul>
<p>POST请求</p>
<ul>
<li>不能使用浏览器地址栏直接输入网址访问</li>
<li>传输实体的主体。</li>
<li>主要目的不是获取响应主体的内容。</li>
</ul>
<ul>
<li>放在Http报文实体的主体请求体，更安全。</li>
</ul>
<ul>
<li>可以用来上传文件、登录注册等需求</li>
<li>通过 request body 传递参数，加密传递数据</li>
</ul>
<p>幂等性(Idempotent): 发送一次和多次请求引起的边界效应是一致的，都得到相同请求结果的 HTTP 方法<br>幂等的方法客户端可以安全地重新请求，因为不会对服务器上的数据造成什么影响。<br>例如：a = 4 是幂等的，但是 a += 4 就是非幂等的</p>
<p>GET 是幂等的，就是对服务器没有副作用；<br>POST 非幂等，就是每一次创建一个新的东西会影响数据库的数据。<br>PUT是幂等的，将PUT方法用作传输资源。更新：从客户端向服务器传送的数据取代指定的文档的内容。</p>
<p>我们可以看到GET请求消息体为空没有请求体，POST请求带有消息体。</p>
<p>POST方法提交的数据没有限制。<br>post请求携带的数据量比get请求多，常用于传输大文本的时候<br>从客户端向服务器传送的数据取代指定的文档的内容。</p>
<p>高级区别：<br>HTTP的底层是TCP/IP。所以GET和POST的底层也是TCP/IP，也就是说，GET/POST都是TCP链接。<br>GET和POST能做的事情是一样一样的。你要给GET加上request body，给POST带上url参数，技术上是完全行的通的。<br>    • get产生一个tcp数据包，post产生两个数据包。<br>对于GET方式的请求，浏览器会把http header和data一并发送出去，服务器响应200（返回数据）；<br>而对于POST，浏览器先发送header，服务器响应100 continue，浏览器再发送data，服务器响应200 ok（返回数据）。</p>
<p>也就是说，GET只需要汽车跑一趟就把货送到了，而POST得跑两趟，第一趟，先去和服务器打个招呼“嗨，我等下要送一批货来，你们打开门迎接我”，然后再回头把货送过去。</p>
<p>因为POST需要两步，时间上消耗的要多一点，看起来GET比POST更有效。因此Yahoo团队有推荐用GET替换POST来优化网站性能。但这是一个坑！跳入需谨慎。为什么？</p>
<ol>
<li>GET与POST都有自己的语义，不能随便混用。</li>
<li>据研究，在网络环境好的情况下，发一次包的时间和发两次包的时间差别基本可以无视。而在网络环境差的情况下，两次包的TCP在验证数据包完整性上，有非常大的优点。</li>
<li>并不是所有浏览器都会在POST中发送两次包，Firefox就只发送一次。</li>
</ol>
<p>（1）web开发中 Post 和 Get 有哪些区别，各适合用于什么情况 ？<br> ① 功能差异：<br>    get ：获取数据，客户端去向服务器请求取数据资源<br>    post：提交数据，从客户端向服务器送处上传数据。<br>② 数据传输：<br>   get：通过URL里面加上参数去把数据传输给服务器端，然后服务器端根据发送过来参数返回对应内容。<br>   get把请求的数据拼接在URL后面，在地址栏里提交<br>   浏览器的地址栏会显示出来当前URL，get会把所有的数据放到url部分，数据会以明文显示对于用户来说是可见的，并且浏览器会有历史记录的功能。</p>
<p>  post：URL唯一标识，通过唯一标识向唯一标识路径下提交一些数据，<br>  Post把所有请求的数据放到Body里面不在URL里，页面里面通过form表单或者Ajax等方式发送一个请求给服务器端,服务器会把Body(消息主体)里面的数据存储到服务器端数据库。<br>地址栏也是无法直接发送一个post请求，post把所有数据放到Body部分对于用户来说是不可见的 浏览器无法记录，</p>
<p>③ 安全性：post相对于get更安全。安全指的是是否会修改数据。<br>安全性：GET,HEAD 和 OPTIONS 均被认为是安全的方法，因为它们旨在实现对数据的获取，并不具有’边界效应(side effect)’<br>无论是get还是post如果传输的数据未经过加密，通过第三方抓包工具依然是可以把数据抓取到的，一旦抓取到数据还是可以看到传输的数据内容都包含哪些。<br>为了保证传输的内容安全，一般对关键信息或者敏感信息都会采用这种加密的形式。</p>
<p>GET提交的数据会放在URL之后，以?分割URL和传输数据，参数之间以&amp;相连，如EditPosts.aspx?name=test1&amp;id=123456。POST方法是把提交的数据放在HTTP包的body中。</p>
<p>POST 方法向指定资源提交要被处理的数据<br>POST 请求不会被缓存<br>POST 请求不会保留在浏览器历史记录中<br>POST 不能被收藏为书签</p>
<p>HEAD 类似于 GET 请求，返回的响应中没有具体的内容，用于获取资源的报头元数据<br>⑤ DELETE 请求服务器删除指定的资源<br>⑥ OPTIONS 用来查询针对请求 URI 指定的资源支持的方法，获取信息，关于资源的哪些属性是客户端可以改变的</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-0-9-centos ~]<span class="comment"># curl -X OPTIONS http://www.baidu.com -i</span></span><br><span class="line">HTTP/1.1 302 Found</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Length: 17931</span><br><span class="line">Content-Type: text/html</span><br><span class="line">Date: Tue, 27 Apr 2021 04:11:06 GMT</span><br><span class="line">Etag: <span class="string">"54d97487-460b"</span></span><br><span class="line">Server: bfe/1.0.8.18</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"content-type"</span> content=<span class="string">"text/html;charset=utf-8"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"IE=Edge"</span>&gt;</span><br><span class="line">&lt;title&gt;页面不存在_百度搜索&lt;/title&gt;</span><br><span class="line"></span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body link=<span class="string">"#0000cc"</span>&gt;</span><br><span class="line">&lt;div id=<span class="string">"wrapper"</span> style=<span class="string">""</span> class=<span class="string">"wrapper_s"</span>&gt;</span><br><span class="line"></span><br><span class="line"> &lt;div id=<span class="string">"head"</span>&gt; &lt;div class=<span class="string">"head_wrapper"</span>&gt; &lt;div class=<span class="string">"s_form"</span>&gt; &lt;div class=<span class="string">"s_form_wrapper"</span>&gt; &lt;div id=<span class="string">"lg"</span>&gt; &lt;img hidefocus=<span class="string">"true"</span> src=<span class="string">"//www.baidu.com/img/bd_logo1.png"</span> width=<span class="string">"270"</span> height=<span class="string">"129"</span>&gt; &lt;/div&gt; &lt;a href=<span class="string">"/"</span> id=<span class="string">"result_logo"</span> onmousedown=<span class="string">"return c({'fm':'tab','tab':'logo'})"</span>&gt; &lt;img src=<span class="string">"//www.baidu.com/img/baidu_jgylogo3.gif"</span> alt=<span class="string">"到百度首页"</span> title=<span class="string">"到百度首页"</span>&gt; &lt;/a&gt; &lt;form id=<span class="string">"form"</span> name=<span class="string">"f"</span> action=<span class="string">"/s"</span> class=<span class="string">"fm"</span>&gt; &lt;input <span class="built_in">type</span>=<span class="string">"hidden"</span> name=<span class="string">"ie"</span> value=<span class="string">"utf-8"</span>&gt; &lt;input <span class="built_in">type</span>=<span class="string">"hidden"</span> name=<span class="string">"f"</span> value=<span class="string">"8"</span>&gt; &lt;input <span class="built_in">type</span>=<span class="string">"hidden"</span> name=<span class="string">"rsv_bp"</span> value=<span class="string">"1"</span>&gt; &lt;input <span class="built_in">type</span>=<span class="string">"hidden"</span> name=<span class="string">"rsv_idx"</span> value=<span class="string">"1"</span>&gt; &lt;input <span class="built_in">type</span>=<span class="string">"hidden"</span> name=<span class="string">"ch"</span> value=<span class="string">""</span>&gt; &lt;input <span class="built_in">type</span>=<span class="string">"hidden"</span> name=<span class="string">"tn"</span> value=<span class="string">"baiduerr"</span>&gt; &lt;input <span class="built_in">type</span>=<span class="string">"hidden"</span> name=<span class="string">"bar"</span> value=<span class="string">""</span>&gt; &lt;span class=<span class="string">"bg s_ipt_wr"</span>&gt; &lt;input id=<span class="string">"kw_tip"</span> unselectable=<span class="string">"on"</span> onselectstart=<span class="string">"return false;"</span> class=<span class="string">"s_ipt s_ipt_tip"</span> disabled=<span class="string">""</span> autocomplete=<span class="string">"off"</span> value=<span class="string">""</span> maxlength=<span class="string">"100"</span> style=<span class="string">"display: none;"</span>&gt; &lt;input id=<span class="string">"kw"</span> name=<span class="string">"wd"</span> class=<span class="string">"s_ipt"</span> value=<span class="string">""</span> maxlength=<span class="string">"100"</span> autocomplete=<span class="string">"off"</span>&gt; &lt;/span&gt;&lt;span class=<span class="string">"bg s_btn_wr"</span>&gt; &lt;input <span class="built_in">type</span>=<span class="string">"submit"</span> id=<span class="string">"su"</span> value=<span class="string">"百度一下"</span> class=<span class="string">"bg s_btn"</span>&gt; &lt;/span&gt;&lt;span class=<span class="string">"tools"</span>&gt; &lt;span id=<span class="string">"mHolder"</span>&gt; &lt;div id=<span class="string">"mCon"</span>&gt; &lt;span&gt;输入法&lt;/span&gt; &lt;/div&gt; &lt;ul id=<span class="string">"mMenu"</span>&gt; &lt;li&gt;&lt;a href=<span class="string">"javascript:;"</span> name=<span class="string">"ime_hw"</span>&gt;手写&lt;/a&gt; &lt;/li&gt; &lt;li&gt;&lt;a href=<span class="string">"javascript:;"</span> name=<span class="string">"ime_py"</span>&gt;拼音&lt;/a&gt; &lt;/li&gt; &lt;li class=<span class="string">"ln"</span>&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=<span class="string">"javascript:;"</span> name=<span class="string">"ime_cl"</span>&gt;关闭&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/span&gt; &lt;span class=<span class="string">"shouji"</span> style=<span class="string">"display: none;"</span>&gt;&lt;a href=<span class="string">"http://w.x.baidu.com/go/mini/8/10000020"</span> onmousedown=<span class="string">"return ns_c({'fm':'behs','tab':'bdbrowser'})"</span>&gt;百度浏览器，打开网页快2秒！&lt;/a&gt; &lt;/span&gt; &lt;/span&gt; &lt;input <span class="built_in">type</span>=<span class="string">"hidden"</span> name=<span class="string">"rn"</span> value=<span class="string">""</span>&gt; &lt;input <span class="built_in">type</span>=<span class="string">"hidden"</span> name=<span class="string">"rsv_enter"</span> value=<span class="string">"1"</span>&gt; &lt;/form&gt; &lt;div id=<span class="string">"m"</span>&gt;&lt;/div&gt; &lt;/div&gt;&lt;/div&gt; &lt;/div&gt;&lt;/div&gt; &lt;div class=<span class="string">"s_tab"</span> id=<span class="string">"s_tab"</span>&gt; &lt;b&gt;网页&lt;/b&gt; &lt;a href=<span class="string">"http://news.baidu.com/ns?cl=2&amp;amp;rn=20&amp;amp;tn=news&amp;amp;word="</span> wdfield=<span class="string">"word"</span> onmousedown=<span class="string">"return c({'fm':'tab','tab':'news'})"</span>&gt;新闻&lt;/a&gt;&lt;a href=<span class="string">"http://tieba.baidu.com/f?kw=&amp;amp;fr=wwwt"</span> wdfield=<span class="string">"kw"</span> onmousedown=<span class="string">"return c({'fm':'tab','tab':'tieba'})"</span>&gt;贴吧&lt;/a&gt;&lt;a href=<span class="string">"http://zhidao.baidu.com/q?ct=17&amp;amp;pn=0&amp;amp;tn=ikaslist&amp;amp;rn=10&amp;amp;word=&amp;amp;fr=wwwt"</span> wdfield=<span class="string">"word"</span> onmousedown=<span class="string">"return c({'fm':'tab','tab':'zhidao'})"</span>&gt;知道&lt;/a&gt;&lt;a href=<span class="string">"http://music.baidu.com/search?fr=ps&amp;amp;key="</span> wdfield=<span class="string">"key"</span> onmousedown=<span class="string">"return c({'fm':'tab','tab':'music'})"</span>&gt;音乐&lt;/a&gt;&lt;a href=<span class="string">"http://image.baidu.com/i?tn=baiduimage&amp;amp;ps=1&amp;amp;ct=201326592&amp;amp;lm=-1&amp;amp;cl=2&amp;amp;nc=1&amp;amp;word="</span> wdfield=<span class="string">"word"</span> onmousedown=<span class="string">"return c({'fm':'tab','tab':'pic'})"</span>&gt;图片&lt;/a&gt;&lt;a href=<span class="string">"http://v.baidu.com/v?ct=301989888&amp;amp;rn=20&amp;amp;pn=0&amp;amp;db=0&amp;amp;s=25&amp;amp;word="</span> wdfield=<span class="string">"word"</span> onmousedown=<span class="string">"return c({'fm':'tab','tab':'video'})"</span>&gt;视频&lt;/a&gt;&lt;a href=<span class="string">"http://map.baidu.com/m?word=&amp;amp;fr=ps01000"</span> wdfield=<span class="string">"word"</span> onmousedown=<span class="string">"return c({'fm':'tab','tab':'map'})"</span>&gt;地图&lt;/a&gt;&lt;a href=<span class="string">"http://wenku.baidu.com/search?word=&amp;amp;lm=0&amp;amp;od=0"</span> wdfield=<span class="string">"word"</span> onmousedown=<span class="string">"return c({'fm':'tab','tab':'wenku'})"</span>&gt;文库&lt;/a&gt;&lt;a href=<span class="string">"//www.baidu.com/more/"</span> onmousedown=<span class="string">"return c({'fm':'tab','tab':'more'})"</span>&gt;更多»&lt;/a&gt; &lt;/div&gt;</span><br><span class="line">&lt;div id=<span class="string">"ftCon"</span>&gt;&lt;div id=<span class="string">"ftConw"</span>&gt;&lt;p id=<span class="string">"lh"</span>&gt; &lt;a id=<span class="string">"seth"</span> onclick=<span class="string">"h(this)"</span> href=<span class="string">"/"</span> onmousedown=<span class="string">"return ns_c({'fm':'behs','tab':'homepage','pos':0})"</span>&gt;把百度设为主页&lt;/a&gt;&lt;a id=<span class="string">"setf"</span> href=<span class="string">"http://www.baidu.com/cache/sethelp/index.html"</span> onmousedown=<span class="string">"return ns_c({'fm':'behs','tab':'favorites','pos':0})"</span> target=<span class="string">"_blank"</span> style=<span class="string">"display: inline;"</span>&gt;把百度设为主页&lt;/a&gt;&lt;a onmousedown=<span class="string">"return ns_c({'fm':'behs','tab':'tj_about'})"</span> href=<span class="string">"http://home.baidu.com"</span>&gt;关于百度&lt;/a&gt;&lt;a onmousedown=<span class="string">"return ns_c({'fm':'behs','tab':'tj_about_en'})"</span> href=<span class="string">"http://ir.baidu.com"</span>&gt;About Baidu&lt;/a&gt; &lt;/p&gt; &lt;p id=<span class="string">"cp"</span>&gt;©2014&amp;nbsp;Baidu&amp;nbsp;&lt;a href=<span class="string">"/duty/"</span> name=<span class="string">"tj_duty"</span>&gt;使用百度前必读&lt;/a&gt;&amp;nbsp;京ICP证030173号&amp;nbsp;&lt;i class=<span class="string">"c-icon-icrlogo"</span>&gt;&lt;/i&gt; &lt;/p&gt; &lt;/div&gt; &lt;/div&gt;</span><br><span class="line">&lt;div id=<span class="string">"wrapper_wrapper"</span> style=<span class="string">"display: block;"</span>&gt;</span><br><span class="line">        &lt;div id=<span class="string">"content_left"</span>&gt;</span><br><span class="line">                &lt;div class=<span class="string">"nors"</span>&gt;</span><br><span class="line">                        &lt;div class=<span class="string">"norsSuggest"</span>&gt;</span><br><span class="line">                                &lt;h3 class=<span class="string">"norsTitle"</span>&gt;很抱歉，您要访问的页面不存在！&lt;/h3&gt;</span><br><span class="line">                                &lt;p class=<span class="string">"norsTitle2"</span>&gt;温馨提示：&lt;/p&gt;</span><br><span class="line">                                &lt;ol&gt;</span><br><span class="line">                                        &lt;li&gt;请检查您访问的网址是否正确&lt;/li&gt; </span><br><span class="line">                                        &lt;li&gt;如果您不能确认访问的网址，请浏览&lt;a href=<span class="string">"http://www.baidu.com/more/index.html"</span>&gt;百度更多&lt;/a&gt;页面查看更多网址。&lt;/li&gt;</span><br><span class="line">                                        &lt;li&gt;回到顶部重新发起搜索&lt;/li&gt;</span><br><span class="line">                                        &lt;li&gt;如有任何意见或建议，请及时&lt;a href=<span class="string">"http://qingting.baidu.com/index"</span>&gt;反馈给我们&lt;/a&gt;。&lt;/li&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                &lt;/ol&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id=<span class="string">"foot"</span>&gt;&lt;span class=<span class="string">"foot_c"</span>&gt;©2015&amp;nbsp;Baidu&amp;nbsp;&lt;span&gt;此内容系百度根据您的指令自动搜索的结果，不代表百度赞成被搜索网站的内容或立场&lt;/span&gt;&lt;/span&gt;</span><br><span class="line">&lt;span id=<span class="string">"help"</span>&gt;&lt;a href=<span class="string">"http://www.baidu.com/search/jubao.html"</span> target=<span class="string">"_blank"</span>&gt;举报&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class=<span class="string">"c-tips-container"</span> id=<span class="string">"c-tips-container"</span>&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=<span class="string">"c-tips-container"</span> id=<span class="string">"c-tips-container"</span>&gt;&lt;/div&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>TRACE： 回显服务器收到的请求，主要用于测试或诊断。<br>CONNECT：开启一个客户端与所请求资源之间的双向沟通的通道。它可以用来创建隧道</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/io-duo-lu-fu-yong/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/io-duo-lu-fu-yong/" class="post-title-link" itemprop="url">HTML</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-05 14:11:43" itemprop="dateModified" datetime="2021-04-05T14:11:43Z">2021-04-05</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Markdown/" itemprop="url" rel="index"><span itemprop="name">Markdown</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Unix网络编程中提到了5种网络模型</p>
<ul>
<li>Blocking IO 阻塞式IO，一次只能处理一个请求。</li>
<li>Noblocking IO 非阻塞式IO</li>
<li>IO multiplexing IO多路复用（高并发框架使用）</li>
<li>Signal Driven IO 信号驱动的IO</li>
<li>Asynchronous IO 异步IO</li>
</ul>
<p>现在服务器基本使用 IO多路复用，实现单进程同时处理多个 socket 请求。</p>
<h3 id="IO多路复用？"><a href="#IO多路复用？" class="headerlink" title="IO多路复用？"></a>IO多路复用？</h3><p>IO多路复用就是操作系统提供的同时监听多个 socket 的机制</p>
<ul>
<li>为了实现高并发需要一种机制并发处理多个 socket</li>
<li>Linux 常见的是 select / poll / epoll 系统调用</li>
<li>可以使用单线程单进程处理多个 socket<br>为什么 select 就能实现高并发呢？<br>select 可以同时处理多个 socket，有一个就绪应用程序代码就可以处理它<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用IO复用代码格式</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    events = sel.select()    <span class="comment"># 系统阻塞在select，直到有一个socket就绪</span></span><br><span class="line">    <span class="keyword">for</span> key,mask <span class="keyword">in</span> events:   <span class="comment"># 当socket就绪之后就遍历事件</span></span><br><span class="line">        callback = key.data</span><br><span class="line">        callback(key.fileobj, mask)</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p>重点是索引就绪文件的时间复杂度，一般优先使用epoll,O(1)</p>
<p>Python 封装了操作系统的IO多路复用<br>Python 的IO多路复用基于操作系统实现( select / poll / epoll )<br>Python2 select 模块<br>Python3 selectors 模块<br>selectors模块<br>事件类型: </p>
<ul>
<li>EVENT_READ 表示socket可读，</li>
<li>EVENT_WRITE 表示socket可写</li>
</ul>
<p>Default selector:自动根据平台选取合适的o模型</p>
<ul>
<li>register(fileobj, events, data=None)</li>
<li>unregister(fileobj)</li>
<li>modify(fileobj, events, data=None)</li>
<li>select(timeout=None): returns[(key, events)]</li>
<li>close()</li>
</ul>
<p>下面是一个简单的echo服务器实现 ：异步的TCP回显,它能够并发的处理客户端请求，把客户端发的再发回去，这就是TCP回显服务器。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> selectors</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"> </span><br><span class="line">sel = selectors.DefaultSelector()</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">accept</span>(<span class="params">sock, mask</span>):</span></span><br><span class="line">    conn, addr = sock.accept()  <span class="comment"># Should be ready</span></span><br><span class="line">    print(<span class="string">'accepted'</span>, conn, <span class="string">'from'</span>, addr)</span><br><span class="line">    conn.setblocking(<span class="literal">False</span>)</span><br><span class="line">    sel.register(conn, selectors.EVENT_READ, read)  <span class="comment"># 注册read回调</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">conn, mask</span>):</span></span><br><span class="line">    data = conn.recv(<span class="number">1000</span>)  <span class="comment"># Should be ready</span></span><br><span class="line">    <span class="keyword">if</span> data:</span><br><span class="line">        print(<span class="string">'echoing'</span>, repr(data), <span class="string">'to'</span>, conn)</span><br><span class="line">        conn.send(data)  <span class="comment"># Hope it won't block</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'closing'</span>, conn)</span><br><span class="line">        sel.unregister(conn)</span><br><span class="line">        conn.close()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 服务端</span></span><br><span class="line">sock = socket.socket()</span><br><span class="line">sock.bind((<span class="string">'localhost'</span>, <span class="number">1234</span>))</span><br><span class="line">sock.listen(<span class="number">100</span>)</span><br><span class="line">sock.setblocking(<span class="literal">False</span>)</span><br><span class="line">sel.register(sock, selectors.EVENT_READ, accept) <span class="comment"># 注册accept回调</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:       <span class="comment"># 事件循环</span></span><br><span class="line">    events = sel.select()</span><br><span class="line">    <span class="keyword">for</span> key, mask <span class="keyword">in</span> events:</span><br><span class="line">        callback = key.data</span><br><span class="line">        callback(key.fileobj, mask)</span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/16/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><span class="page-number current">17</span><a class="page-number" href="/page/18/">18</a><span class="space">&hellip;</span><a class="page-number" href="/page/36/">36</a><a class="extend next" rel="next" href="/page/18/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">外心人D</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
