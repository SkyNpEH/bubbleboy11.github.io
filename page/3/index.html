<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<meta name="hexo-config" content="{&quot;hostname&quot;:&quot;bubbleboy11.github.io&quot;,&quot;root&quot;:&quot;/&quot;,&quot;images&quot;:&quot;/images&quot;,&quot;scheme&quot;:&quot;Muse&quot;,&quot;version&quot;:&quot;8.3.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:true,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:false,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;}}">
<meta name="description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:type" content="website">
<meta property="og:title" content="外心人D的博客">
<meta property="og:url" content="https://bubbleboy11.github.io/page/3/index.html">
<meta property="og:site_name" content="外心人D的博客">
<meta property="og:description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="外心人D">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://bubbleboy11.github.io/page/3/">



<meta name="hexo-config-page" content="{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:true,&quot;isPost&quot;:false,&quot;lang&quot;:&quot;zh-CN&quot;}">
<meta name="hexo-config-calendar" content="">
<script data-pjax src="/js/load-config.js"></script>
  <title>外心人D的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="外心人D的博客" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">外心人D的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">外心人D</p>
  <div class="site-description" itemprop="description">本博客大多内容为慕课和网上博客，并非原创</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">179</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">32</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/04/02/lu-you-wang-ding-dan-xiang-xi-xin-xi-ye-mian-de-zhan-shi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/02/lu-you-wang-ding-dan-xiang-xi-xin-xi-ye-mian-de-zhan-shi/" class="post-title-link" itemprop="url">旅游网订单详细信息页面的展示</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-04-01 22:51:44" itemprop="dateCreated datePublished" datetime="2021-04-01T22:51:44Z">2021-04-01</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:45" itemprop="dateModified" datetime="2021-04-02T12:24:45Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%85%E6%B8%B8%E7%BD%91%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">旅游网项目</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>我的订单中的订单详细信息页面的展示。<br>1、 点击全部订单可以跳转到我的订单页面，包括所有的订单，点击订单详情可以跳转到订单详情页，<br>该页面中包括导航条(包括返回按钮及当前订单的状态)、订单信息(包括订单号和下单时间)、订单明细(包括下单的商品快照，会显示商品图片、商品标题、数量、价格及备注信息)、订单总计(总共几件商品及价格合计)、对应的按钮</p>
<p>实现订单详细信息接口<br> 实现订单详细信息页面<br> 完成订单详细信息页面展示<br> 实现页面间的跳转、订单删除功能</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/04/02/lu-you-wang-wo-de-ding-dan-lie-biao-jie-kou-lian-diao/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/02/lu-you-wang-wo-de-ding-dan-lie-biao-jie-kou-lian-diao/" class="post-title-link" itemprop="url">旅游网我的订单列表接口联调</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-04-01 17:20:44" itemprop="dateCreated datePublished" datetime="2021-04-01T17:20:44Z">2021-04-01</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:46" itemprop="dateModified" datetime="2021-04-02T12:24:46Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%85%E6%B8%B8%E7%BD%91%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">旅游网项目</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="我的订单列表接口联调"><a href="#我的订单列表接口联调" class="headerlink" title="我的订单列表接口联调"></a>我的订单列表接口联调</h2><h4 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li><p>第一步，完成页面间的跳转<br><code>src\views\Mine.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 个人中心 --&gt;</span><br><span class="line">  &lt;div class="page-mine"&gt;</span><br><span class="line">    &lt;!-- 订单的菜单列表 --&gt;</span><br><span class="line">    &lt;van-row class="user-links"&gt;</span><br><span class="line">      &lt;van-col span="6"&gt;</span><br><span class="line">        &lt;router-link</span><br><span class="line">          :to="{name: 'OrderList', params: {status: constants.ORDER_STATUS_ALL}}"&gt;</span><br><span class="line">          &lt;van-icon name="records" /&gt;</span><br><span class="line">          &lt;span&gt;全部订单&lt;/span&gt;</span><br><span class="line">        &lt;/router-link&gt;</span><br><span class="line">      &lt;/van-col&gt;</span><br><span class="line">      &lt;van-col span="6"&gt;</span><br><span class="line">        &lt;router-link</span><br><span class="line">          :to="{name: 'OrderList', params: {status: constants.ORDER_STATUS_PAY}}"&gt;</span><br><span class="line">          &lt;van-icon name="pending-payment" /&gt;</span><br><span class="line">          &lt;span&gt;待支付&lt;/span&gt;</span><br><span class="line">        &lt;/router-link&gt;</span><br><span class="line">      &lt;/van-col&gt;</span><br><span class="line">      &lt;van-col span="6"&gt;</span><br><span class="line">        &lt;router-link</span><br><span class="line">          :to="{name: 'OrderList', params: {status: constants.ORDER_STATUS_DONE}}"&gt;</span><br><span class="line">          &lt;van-icon name="tosend" /&gt;</span><br><span class="line">          &lt;span&gt;已完成&lt;/span&gt;</span><br><span class="line">        &lt;/router-link&gt;</span><br><span class="line">      &lt;/van-col&gt;</span><br><span class="line">      &lt;van-col span="6"&gt;</span><br><span class="line">        &lt;router-link</span><br><span class="line">          :to="{name: 'OrderList', params: {status: constants.ORDER_STATUS_CANCEL}}"&gt;</span><br><span class="line">          &lt;van-icon name="logistics" /&gt;</span><br><span class="line">          &lt;span&gt;已取消&lt;/span&gt;</span><br><span class="line">        &lt;/router-link&gt;</span><br><span class="line">      &lt;/van-col&gt;</span><br><span class="line">    &lt;/van-row&gt;</span><br><span class="line">    &lt;!-- 底部导航 --&gt;</span><br><span class="line">    &lt;TripFooter/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>第二步，配置接口地址及请求参数</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> OrderApis = {</span><br><span class="line">  <span class="comment">// 订单列表</span></span><br><span class="line">  orderListUrl: apiHost + <span class="string">'/order/order/list/'</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> {</span><br><span class="line">  OrderApis</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>第三步，处理通过ajax拿到数据返回，填充到页面</p>
</li>
</ul>
<p><code>src\views\order\List.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 我的订单列表页面 --&gt;</span><br><span class="line">  &lt;div class="page-order-list"&gt;</span><br><span class="line">    &lt;!-- 订单按状态切换 --&gt;</span><br><span class="line">    &lt;van-tabs v-model="status" @click="tabChange"&gt;</span><br><span class="line">      &lt;van-tab</span><br><span class="line">        v-for="(value, key, index) in constants.ORDER_STATUS"</span><br><span class="line">        :title="value"</span><br><span class="line">        :name="key"</span><br><span class="line">        :key="index"&gt;&lt;/van-tab&gt;</span><br><span class="line">    &lt;/van-tabs&gt;</span><br><span class="line">    &lt;!-- 订单记录 --&gt;</span><br><span class="line">    &lt;div class="order-list"&gt;</span><br><span class="line">      &lt;div class="order-item" v-for="item in dataList" :key="item.sn"&gt;</span><br><span class="line">        &lt;div class="order-head"&gt;</span><br><span class="line">          &lt;div class="order-num"&gt;订单号：{{ item.sn }}&lt;/div&gt;</span><br><span class="line">          &lt;div class="order-status text-warning"&gt;{{ constants.ORDER_STATUS[item.status] }}&lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class="order-body"&gt;</span><br><span class="line">          &lt;div class="left"&gt;</span><br><span class="line">            &lt;van-image width="100" height="100" :src="item.item_first.flash_img" /&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class="right"&gt;</span><br><span class="line">            &lt;div class="title"&gt;{{ item.item_first.flash_name }}&lt;/div&gt;</span><br><span class="line">            &lt;div class="remark"&gt;{{ item.item_first.remark }}&lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class="order-footer"&gt;</span><br><span class="line">          &lt;div&gt;总共{{ item.buy_count }}件商品 合计 ￥{{ item.buy_amount }}&lt;/div&gt;</span><br><span class="line">          &lt;van-button round size="small" type="warning"&gt;删除订单&lt;/van-button&gt;</span><br><span class="line">          &lt;van-button round size="small" type="info"&gt;订单详情&lt;/van-button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import { OrderApis } from '@/utils/apis'</span><br><span class="line">import { ajax } from '@/utils/ajax'</span><br><span class="line">import * as constants from '@/utils/constants'</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      status: 0,</span><br><span class="line">      // 订单列表</span><br><span class="line">      dataList: [],</span><br><span class="line">      constants</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    /**</span><br><span class="line">     * 加载订单列表</span><br><span class="line">     */</span><br><span class="line">    getDataList () {</span><br><span class="line">      ajax.get(OrderApis.orderListUrl, {</span><br><span class="line">        params: {</span><br><span class="line">          status: this.status</span><br><span class="line">        }</span><br><span class="line">      }).then(({ data }) =&gt; {</span><br><span class="line">        this.dataList = data.objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>


<ul>
<li>第四步，用<code>watch</code>监听路由的变化，从个人中心点击订单列表的数据处理，点击全部、待支付、已完成、已取消都能跳转<br>每一次路由变化之后，重新调用调用接口，把数据渲染出来<br><code>src\views\order\List.vue</code><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 我的订单列表页面 --&gt;</span><br><span class="line">  &lt;div class="page-order-list"&gt;</span><br><span class="line">    &lt;!-- 订单按状态切换 --&gt;</span><br><span class="line">    &lt;van-tabs v-model="status" @click="tabChange"&gt;</span><br><span class="line">      &lt;van-tab</span><br><span class="line">        v-for="(value, key, index) in constants.ORDER_STATUS"</span><br><span class="line">        :title="value"</span><br><span class="line">        :name="key"</span><br><span class="line">        :key="index"&gt;&lt;/van-tab&gt;</span><br><span class="line">    &lt;/van-tabs&gt;</span><br><span class="line">    &lt;!-- 订单记录 --&gt;</span><br><span class="line">    &lt;div class="order-list"&gt;</span><br><span class="line">      &lt;div class="order-item" v-for="item in dataList" :key="item.sn"&gt;</span><br><span class="line">        &lt;div class="order-head"&gt;</span><br><span class="line">          &lt;div class="order-num"&gt;订单号：{{ item.sn }}&lt;/div&gt;</span><br><span class="line">          &lt;div class="order-status text-warning"&gt;{{ constants.ORDER_STATUS[item.status] }}&lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class="order-body"&gt;</span><br><span class="line">          &lt;div class="left"&gt;</span><br><span class="line">            &lt;van-image width="100" height="100" :src="item.item_first.flash_img" /&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class="right"&gt;</span><br><span class="line">            &lt;div class="title"&gt;{{ item.item_first.flash_name }}&lt;/div&gt;</span><br><span class="line">            &lt;div class="remark"&gt;{{ item.item_first.remark }}&lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class="order-footer"&gt;</span><br><span class="line">          &lt;div&gt;总共{{ item.buy_count }}件商品 合计 ￥{{ item.buy_amount }}&lt;/div&gt;</span><br><span class="line">          &lt;van-button round size="small" type="warning"&gt;删除订单&lt;/van-button&gt;</span><br><span class="line">          &lt;van-button round size="small" type="info"&gt;订单详情&lt;/van-button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import { OrderApis } from '@/utils/apis'</span><br><span class="line">import { ajax } from '@/utils/ajax'</span><br><span class="line">import * as constants from '@/utils/constants'</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      status: 0,</span><br><span class="line">      // 订单列表</span><br><span class="line">      dataList: [],</span><br><span class="line">      constants</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  watch: {</span><br><span class="line">    $route () {</span><br><span class="line">      this.loadData()</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    /**</span><br><span class="line">     * tab点击之后，重新去获取数据</span><br><span class="line">     */</span><br><span class="line">    tabChange (name, value) {</span><br><span class="line">      console.log(name, value)</span><br><span class="line">      this.$router.push({name: 'OrderList', params: { status: name }})</span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * 加载页面的数据</span><br><span class="line">     */</span><br><span class="line">    loadData () {</span><br><span class="line">      // 订单状态</span><br><span class="line">      this.status = this.$route.params.status</span><br><span class="line">      // 清空数据</span><br><span class="line">      this.dataList = []</span><br><span class="line">      // 加载数据列表</span><br><span class="line">      this.getDataList()</span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * 加载订单列表</span><br><span class="line">     */</span><br><span class="line">    getDataList () {</span><br><span class="line">      ajax.get(OrderApis.orderListUrl, {</span><br><span class="line">        params: {</span><br><span class="line">          status: this.status</span><br><span class="line">        }</span><br><span class="line">      }).then(({ data }) =&gt; {</span><br><span class="line">        this.dataList = data.objects</span><br><span class="line">      })</span><br><span class="line">    },</span><br><span class="line">    goBack () {</span><br><span class="line">      this.$router.go(-1)</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  mounted () {</span><br><span class="line">    this.loadData()</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/04/01/lu-you-wang-men-piao-zhi-fu-jie-kou-lian-diao/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/01/lu-you-wang-men-piao-zhi-fu-jie-kou-lian-diao/" class="post-title-link" itemprop="url">旅游网门票支付接口联调</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-04-01 15:29:44" itemprop="dateCreated datePublished" datetime="2021-04-01T15:29:44Z">2021-04-01</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 16:20:15" itemprop="dateModified" datetime="2021-04-02T16:20:15Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%85%E6%B8%B8%E7%BD%91%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">旅游网项目</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="门票支付接口联调"><a href="#门票支付接口联调" class="headerlink" title="门票支付接口联调"></a>门票支付接口联调</h2><h4 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li>第一步，阅读接口文档</li>
<li>第二步，配置接口地址<br>在填写订单提交之后跳转订单支付页面，会把流水id从url传递到订单支付页面，显示订单下面的门票的信息，通过ajax的http的get请求获取订单的详细信息，通过ajax的post请求点击立即支付，跳转到我的订单列表<br><code>src\utils\apis.js</code><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> SightApis = {</span><br><span class="line">  <span class="comment">// 订单详情、订单支付、订单删除、订单取消</span></span><br><span class="line">  orderDetailUrl: apiHost + <span class="string">'/order/order/detail/#{sn}/'</span>,</span><br><span class="line">}</span><br><span class="line"><span class="keyword">export</span> {</span><br><span class="line">  OrderApis</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p><code>src\views\order\Pay.vue</code></p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 订单确认及支付 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-order-pay"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 订单号 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">"订单号"</span> <span class="attr">:value</span>=<span class="string">"sn"</span> <span class="attr">class</span>=<span class="string">"order-mum"</span> /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 描述信息 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"order-info"</span> <span class="attr">v-for</span>=<span class="string">"item in orderDetail.items"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:key</span>=<span class="string">"item.pk"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>{{ item.flash_name }}<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">"clock-o"</span> /&gt;</span> {{ item.remark }}<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- &lt;div class="tips"&gt;短信接收&lt;/div&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">"arrow"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- //描述信息 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 提交表单 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">van-submit-bar</span> <span class="attr">:price</span>=<span class="string">"orderDetail.buy_amount * 100"</span> <span class="attr">button-text</span>=<span class="string">"立即支付"</span> @<span class="attr">submit</span>=<span class="string">"onSubmit"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { OrderApis } <span class="keyword">from</span> <span class="string">'@/utils/apis'</span></span><br><span class="line"><span class="keyword">import</span> { ajax } <span class="keyword">from</span> <span class="string">'@/utils/ajax'</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> constants <span class="keyword">from</span> <span class="string">'@/utils/constants'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> {</span><br><span class="line">  data () {</span><br><span class="line">    <span class="keyword">return</span> {</span><br><span class="line">      <span class="comment">// 订单的流水号</span></span><br><span class="line">      sn: <span class="string">''</span>,</span><br><span class="line">      <span class="comment">// 订单的信息</span></span><br><span class="line">      orderDetail: {}</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取订单的详细信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    getOrderDetail () {</span><br><span class="line">      <span class="comment">// SightApis.ticketDetailUrl的#{sn}替换为通过created函数里面从url中动态传递过来的sn</span></span><br><span class="line">      <span class="keyword">const</span> url = OrderApis.orderDetailUrl.replace(<span class="string">'#{sn}'</span>, <span class="built_in">this</span>.sn)</span><br><span class="line">      ajax.get(url).then(<span class="function">(<span class="params">{ data }</span>) =&gt;</span> {</span><br><span class="line">        <span class="built_in">this</span>.orderDetail = data</span><br><span class="line">      })</span><br><span class="line">    },</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 确认支付</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    onSubmit () {</span><br><span class="line">      <span class="built_in">this</span>.$dialog.confirm({</span><br><span class="line">        title: <span class="string">'温馨提示'</span>,</span><br><span class="line">        message: <span class="string">`确认支付<span class="subst">${<span class="built_in">this</span>.orderDetail.buy_amount}</span>吗？`</span></span><br><span class="line">      }).then(<span class="function">() =&gt;</span> {</span><br><span class="line">        <span class="keyword">const</span> url = OrderApis.orderDetailUrl.replace(<span class="string">'#{sn}'</span>, <span class="built_in">this</span>.sn)</span><br><span class="line">        <span class="comment">// 调用支付接口</span></span><br><span class="line">        ajax.post(url).then(<span class="function">() =&gt;</span> {</span><br><span class="line">          <span class="comment">// 提示语</span></span><br><span class="line">          <span class="built_in">this</span>.$notify({</span><br><span class="line">            type: <span class="string">'success'</span>,</span><br><span class="line">            message: <span class="string">'支付成功, 已为您跳转到订单列表'</span></span><br><span class="line">          })</span><br><span class="line">          <span class="comment">// 跳转到我的订单列表</span></span><br><span class="line">          <span class="built_in">this</span>.$router.replace({ <span class="attr">name</span>: <span class="string">'OrderList'</span>, <span class="attr">params</span>: { <span class="attr">status</span>: constants.ORDER_STATUS_ALL}})</span><br><span class="line">        })</span><br><span class="line">      })</span><br><span class="line">    },</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 后退</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    goBack () {</span><br><span class="line">      <span class="built_in">this</span>.$dialog.confirm({</span><br><span class="line">        title: <span class="string">'温馨提示'</span>,</span><br><span class="line">        message: <span class="string">'您还没有支付，确认放弃支付吗？'</span></span><br><span class="line">      }).then(<span class="function">() =&gt;</span> {</span><br><span class="line">        <span class="built_in">this</span>.$router.go(<span class="number">-1</span>)</span><br><span class="line">        <span class="comment">// on confirm</span></span><br><span class="line">      })</span><br><span class="line">    },</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 取消订单</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    onCancelOrder () {</span><br><span class="line">      <span class="built_in">this</span>.$dialog.confirm({</span><br><span class="line">        title: <span class="string">'温馨提示'</span>,</span><br><span class="line">        message: <span class="string">'确认取消该订单？'</span></span><br><span class="line">      }).then(<span class="function">() =&gt;</span> {</span><br><span class="line">        <span class="comment">// TODO 调用接口on confirm</span></span><br><span class="line">        <span class="built_in">this</span>.$router.go(<span class="number">-1</span>)</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    <span class="comment">// 组件被挂载或创建的时候获取订单流水号</span></span><br><span class="line">    <span class="built_in">this</span>.sn = <span class="built_in">this</span>.$route.params.sn</span><br><span class="line">    <span class="comment">// 获取订单信息</span></span><br><span class="line">    <span class="built_in">this</span>.getOrderDetail()</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>第三步，使用axios获取数据</li>
<li>第四步，将数据设置到模型层</li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/04/01/lu-you-wang-men-piao-xiang-xi-xin-xi-jie-kou-lian-diao/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/01/lu-you-wang-men-piao-xiang-xi-xin-xi-jie-kou-lian-diao/" class="post-title-link" itemprop="url">门票详细信息接口联调</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-04-01 11:19:44" itemprop="dateCreated datePublished" datetime="2021-04-01T11:19:44Z">2021-04-01</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:45" itemprop="dateModified" datetime="2021-04-02T12:24:45Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%85%E6%B8%B8%E7%BD%91%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">旅游网项目</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="门票详细信息接口联调"><a href="#门票详细信息接口联调" class="headerlink" title="门票详细信息接口联调"></a>门票详细信息接口联调</h1><h4 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li>第一步，阅读接口文档</li>
<li>第二步，配置接口地址<br><code>src\utils\apis.js</code><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> SightApis = {</span><br><span class="line">  <span class="comment">// 门票详情</span></span><br><span class="line">  ticketDetailUrl: apiHost + <span class="string">'/sight/ticket/detail/#{id}/'</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> {</span><br><span class="line">  SightApis</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p><code>src\components\sight\TicketTips.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 门票的预订须知弹框内容 --&gt;</span><br><span class="line">  &lt;div class="ticket-tips-box"&gt;</span><br><span class="line">    &lt;h3&gt;预订须知&lt;/h3&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h4&gt;有效期&lt;/h4&gt;</span><br><span class="line">      &lt;p&gt;{{ ticketDetail.expire_date }} 日内有效&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h4&gt;退改政策&lt;/h4&gt;</span><br><span class="line">      &lt;p&gt;{{ ticketDetail.return_policy }}&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h4&gt;发票&lt;/h4&gt;</span><br><span class="line">      &lt;p v-if="ticketDetail.has_invoice"&gt;我司提供发票&lt;/p&gt;</span><br><span class="line">      &lt;p v-else&gt;不提供发票&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h4&gt;预订须知&lt;/h4&gt;</span><br><span class="line">      &lt;div v-html="ticketDetail.tips" v-if="ticketDetail.tips"&gt;&lt;/div&gt;</span><br><span class="line">      &lt;div v-else&gt;</span><br><span class="line">        暂无</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h4&gt;入园方式&lt;/h4&gt;</span><br><span class="line">      &lt;p&gt;{{ ticketDetail.entry_way }}&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div v-if="ticketDetail.remark"&gt;</span><br><span class="line">      &lt;h4&gt;备注信息&lt;/h4&gt;</span><br><span class="line">      &lt;p&gt;{{ ticketDetail.remark }}&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default {</span><br><span class="line">  props: ['ticketDetail']</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<p><code>src\views\order\Submit.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 填写订单 --&gt;</span><br><span class="line">  &lt;div class="page-order-submit"&gt;</span><br><span class="line">    &lt;!-- 页面导航 --&gt;</span><br><span class="line">    &lt;van-nav-bar title="填写订单"</span><br><span class="line">      left-text="返回"</span><br><span class="line">      left-arrow</span><br><span class="line">      @click-left="goBack"/&gt;</span><br><span class="line">    &lt;!-- 描述信息 --&gt;</span><br><span class="line">    &lt;div class="order-info"&gt;</span><br><span class="line">      &lt;div class="left"&gt;</span><br><span class="line">        &lt;h3&gt;{{ ticketDetail.name }}&lt;/h3&gt;</span><br><span class="line">        &lt;div class="tips"&gt;{{ ticketDetail.desc }}&lt;/div&gt;</span><br><span class="line">        &lt;div class="tags"&gt;</span><br><span class="line">          &lt;span&gt;</span><br><span class="line">            &lt;van-icon name="clock-o" /&gt;明日可定</span><br><span class="line">          &lt;/span&gt;</span><br><span class="line">          &lt;span&gt;</span><br><span class="line">            &lt;van-icon name="clock-o" /&gt;条件退</span><br><span class="line">          &lt;/span&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class="right"&gt;</span><br><span class="line">        &lt;div class="text-warning"&gt;￥{{ ticketDetail.sell_price }}/张&lt;/div&gt;</span><br><span class="line">        &lt;van-button plain hairline type="info"</span><br><span class="line">          size="mini"</span><br><span class="line">          @click="showPopup=true"&gt;预订须知&lt;/van-button&gt;</span><br><span class="line">        &lt;van-popup</span><br><span class="line">          v-model="showPopup"</span><br><span class="line">          closeable</span><br><span class="line">          position="bottom"</span><br><span class="line">          :style="{ height: '80%' }"</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;TicketTips :ticketDetail="ticketDetail"/&gt;</span><br><span class="line">        &lt;/van-popup&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //描述信息 --&gt;</span><br><span class="line">    &lt;!-- 提交表单 --&gt;</span><br><span class="line">    &lt;van-form @submit="onSubmit" class="form-box"&gt;</span><br><span class="line">      &lt;van-cell-group class="form-group"&gt;</span><br><span class="line">        &lt;van-cell title="选择出行日期"</span><br><span class="line">          :value="form.play_date"</span><br><span class="line">          @click="showCalendar = true" /&gt;</span><br><span class="line">        &lt;van-calendar v-model="showCalendar" @confirm="onConfirm" /&gt;</span><br><span class="line">      &lt;/van-cell-group&gt;</span><br><span class="line">      &lt;van-cell-group class="form-group"&gt;</span><br><span class="line">        &lt;van-cell title="购买数量"&gt;</span><br><span class="line">          &lt;van-stepper v-model="form.buy_count" integer min="1"/&gt;</span><br><span class="line">        &lt;/van-cell&gt;</span><br><span class="line">      &lt;/van-cell-group&gt;</span><br><span class="line">      &lt;van-cell-group class="form-group"&gt;</span><br><span class="line">        &lt;van-field</span><br><span class="line">          v-model="form.to_user"</span><br><span class="line">          type="text"</span><br><span class="line">          label="收件人"</span><br><span class="line">          placeholder="输入收件人"</span><br><span class="line">          :rules="[{ required: true, message: '请输入收件人' }]"</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;van-field</span><br><span class="line">          v-model="form.to_phone"</span><br><span class="line">          type="text"</span><br><span class="line">          label="手机号码"</span><br><span class="line">          placeholder="输入手机号码"</span><br><span class="line">          :rules="[{ required: true, message: '请输入手机号码' }]"</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/van-cell-group&gt;</span><br><span class="line">      &lt;van-submit-bar :price="totalPrice" button-text="提交订单"/&gt;</span><br><span class="line">    &lt;/van-form&gt;</span><br><span class="line">    &lt;!-- //提交表单 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import { OrderApis, SightApis } from '@/utils/apis'</span><br><span class="line">import { ajax } from '@/utils/ajax'</span><br><span class="line">import { mapState } from 'vuex'</span><br><span class="line">import TicketTips from '@/components/sight/TicketTips'</span><br><span class="line">export default {</span><br><span class="line">  components: {</span><br><span class="line">    TicketTips</span><br><span class="line">  },</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      // 门票ID</span><br><span class="line">      id: '',</span><br><span class="line">      // 预订须知弹框显示</span><br><span class="line">      showPopup: false,</span><br><span class="line">      // 日期选择弹框</span><br><span class="line">      showCalendar: false,</span><br><span class="line">      // 门票的详细信息</span><br><span class="line">      ticketDetail: {},</span><br><span class="line">      form: {</span><br><span class="line">        play_date: '',</span><br><span class="line">        buy_count: 1,</span><br><span class="line">        to_user: '',</span><br><span class="line">        to_phone: ''</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  computed: {</span><br><span class="line">    /**</span><br><span class="line">     * 计算总价</span><br><span class="line">     */</span><br><span class="line">    totalPrice () {</span><br><span class="line">      return this.ticketDetail.sell_price * this.form.buy_count * 100</span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * 从vuex读取手机号码</span><br><span class="line">     */</span><br><span class="line">    ...mapState({</span><br><span class="line">      phoneNum: state =&gt; state.user.username,</span><br><span class="line">      nickname: state =&gt; state.user.nickname</span><br><span class="line">    })</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    /**</span><br><span class="line">     * 门票详情</span><br><span class="line">     */</span><br><span class="line">    getTicketDetail () {</span><br><span class="line">      // SightApis.ticketDetailUrl的#{id}替换为通过created函数里面从url中动态传递过来的id</span><br><span class="line">      const url = SightApis.ticketDetailUrl.replace('#{id}', this.id)</span><br><span class="line">      ajax.get(url).then(({ data }) =&gt; {</span><br><span class="line">        this.ticketDetail = data</span><br><span class="line">      })</span><br><span class="line">    },</span><br><span class="line">    onSubmit () {</span><br><span class="line">      console.log('提交表单')</span><br><span class="line">      // ajax接口的调用</span><br><span class="line">      ajax.post(OrderApis.ticketSubmitUrl, {</span><br><span class="line">        ticket_id: this.id, // 通过url传递动态参数</span><br><span class="line">        ...this.form</span><br><span class="line">      }).then(({ data }) =&gt; {</span><br><span class="line">        // 提示用户</span><br><span class="line">        this.$notify({</span><br><span class="line">          type: 'success',</span><br><span class="line">          message: '提交成功，请支付'</span><br><span class="line">        })</span><br><span class="line">        // 跳转到待支付的页面，会把流水id从url传递到支付页面，防止点击后退的时候再去重复提交一个相同的订单</span><br><span class="line">        this.$router.replace({ name: 'OrderPay', params: { sn: data.sn } })</span><br><span class="line">      })</span><br><span class="line">    },</span><br><span class="line">    formatDate (date) {</span><br><span class="line">      return `${date.getFullYear()}-${date.getMonth() + 1}-${date.getDate()}`</span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * 选择日期</span><br><span class="line">     */</span><br><span class="line">    onConfirm (date) {</span><br><span class="line">      // 隐藏日历弹框</span><br><span class="line">      this.showCalendar = false</span><br><span class="line">      // 保存数据</span><br><span class="line">      this.form.play_date = this.formatDate(date)</span><br><span class="line">    },</span><br><span class="line">    goBack () {</span><br><span class="line">      this.$router.go(-1)</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    // 门票ID</span><br><span class="line">    this.id = this.$route.params.id</span><br><span class="line">    this.form.to_user = this.nickname || ''</span><br><span class="line">    this.form.to_phone = this.phoneNum || ''</span><br><span class="line">    // 获取门票信息</span><br><span class="line">    this.getTicketDetail()</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>第三步，使用axios获取数据</li>
<li>第四步，将数据设置到模型层</li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/01/08/zip/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/01/08/zip/" class="post-title-link" itemprop="url">Python zip</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-01-07 16:21:41" itemprop="dateCreated datePublished" datetime="2021-01-07T16:21:41Z">2021-01-07</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-10 02:30:55" itemprop="dateModified" datetime="2021-04-10T02:30:55Z">2021-04-10</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>zip的用法</p>
<ol>
<li>解压<br>传入的data为batch个元组,即batch个(iamges,captions) 对儿<br>images,captions=zip(data)<br>表示zip(data)=(batch 个image,batch 个 caption)</li>
<li>压缩<br>data=zip(images,captions)</li>
</ol>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">b = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">c = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br><span class="line">zipped = zip(a, b)  <span class="comment"># 返回一个对象</span></span><br><span class="line">print(zipped)  <span class="comment"># &lt;zip object at 0x0000015578597FC0&gt;</span></span><br><span class="line"></span><br><span class="line">print(list(zipped))  <span class="comment"># list() 转换为列表</span></span><br><span class="line"><span class="comment"># [(1, 4), (2, 5), (3, 6)]</span></span><br><span class="line"></span><br><span class="line">print(list(zip(a, c)))  <span class="comment"># 元素个数与最短的列表一致</span></span><br><span class="line"><span class="comment"># [(1, 4), (2, 5), (3, 6)]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 与 zip 相反，zip(*) 可理解为解压，返回二维矩阵式</span></span><br><span class="line">a1, a2 = zip(*zip(a, b))</span><br><span class="line">print(list(a1))</span><br><span class="line"><span class="comment"># [1, 2, 3]</span></span><br><span class="line">print(list(a2))</span><br><span class="line"><span class="comment"># [4, 5, 6]</span></span><br><span class="line"></span><br><span class="line">print(zip(*zip(a, b)))  <span class="comment"># &lt;zip object at 0x000001D12224A540&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br><span class="line">b = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">d = {}</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">    d[a[i]] = b[i]</span><br><span class="line">print(d)  <span class="comment"># {'a': 1, 'b': 2, 'c': 3}</span></span><br><span class="line"></span><br><span class="line">d = {k: v <span class="keyword">for</span> k, v <span class="keyword">in</span> zip(a, b)}  <span class="comment"># 字典比循环简单</span></span><br><span class="line">print(d)  <span class="comment"># {'a': 1, 'b': 2, 'c': 3}</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 把元组("a","b")和元组(1,2)，变为字典{"a":1,"b":2}</span></span><br><span class="line">a, b = (<span class="string">"a"</span>, <span class="string">"b"</span>), (<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">z = zip(a, b)</span><br><span class="line">print(z)</span><br><span class="line"><span class="comment"># [("a", 1), ("b", 2)]</span></span><br><span class="line"></span><br><span class="line">c = dict(z)</span><br><span class="line">print(c)</span><br><span class="line"><span class="comment"># Out[8]: {'a': 1, 'b': 2}</span></span><br><span class="line"></span><br><span class="line">d = dict(zip((<span class="string">"a"</span>, <span class="string">"b"</span>), (<span class="number">1</span>, <span class="number">2</span>)))</span><br><span class="line">print(d)</span><br><span class="line"><span class="comment"># Out[4]: {'a': 1, 'b': 2}</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># zip() 函数用于将可迭代的对象作为参数，将对象中对应的元素打包成一个个元组，然后返回由这些元组组成的列表。</span></span><br><span class="line"><span class="comment"># 如果各个迭代器的元素个数不一致，则返回列表长度与最短的对象相同，利用 * 号操作符，可以将元组解压为列表。</span></span><br><span class="line">print(<span class="string">'-----'</span>)</span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">b = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">c = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br><span class="line">zipped = zip(a, b)  <span class="comment"># 打包为元组的列表</span></span><br><span class="line">print(zipped)</span><br><span class="line">print(list(zipped))</span><br><span class="line"><span class="comment"># [(1, 4), (2, 5), (3, 6)]</span></span><br><span class="line">p = zip(a, c)  <span class="comment"># 元素个数与最短的列表一致</span></span><br><span class="line">print(p)</span><br><span class="line">print(list(p))</span><br><span class="line"><span class="comment"># [(1, 4), (2, 5), (3, 6)]</span></span><br><span class="line">q = zip(zipped)  <span class="comment"># 与 zip 相反，zipped 可理解为解压，返回二维矩阵式</span></span><br><span class="line">print(list(q))</span><br><span class="line"><span class="comment"># []</span></span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/cpython-gil/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/cpython-gil/" class="post-title-link" itemprop="url">CPython GIL</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-11 03:57:24" itemprop="dateModified" datetime="2021-04-11T03:57:24Z">2021-04-11</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="GIL-Global-Interpreter-Lock-全局解释器锁"><a href="#GIL-Global-Interpreter-Lock-全局解释器锁" class="headerlink" title="GIL Global Interpreter Lock (全局解释器锁)"></a>GIL Global Interpreter Lock (全局解释器锁)</h3><ul>
<li>这个GIL并不是python的特性，他是在Cpython解释器里引入的一个概念，而在其他的语言编写的解释器里就没有这个GIL</li>
<li>CPython GIL 就是 Cpython解释器的全局解释锁。</li>
</ul>
<h4 id="全局锁是主要的作用影响"><a href="#全局锁是主要的作用影响" class="headerlink" title="全局锁是主要的作用影响"></a>全局锁是主要的作用影响</h4><ul>
<li>因为多线程的编程方式，使得线程之间数据的一致性和状态同步难以把控，为了解决数据不能同步的问题，设计了GIL全局解释器锁。</li>
<li>由于官方的Cpython解释器的内存管理并不是线程安全的（如果有多个线程话它可能会同时去修改同一个对象，这样可能会出现一些问题），因此为了支持多线程编程。</li>
<li>保护多线程情况下对Python对象的访问</li>
<li>Python 官方解释器 的每个线程要获得执行权限</li>
</ul>
<ul>
<li>Python 的多个线程不能同时使用 多个CPU核心执行，只在单核CPU系统中工作，不存在真正的并发</li>
</ul>
<ul>
<li>有了GIL，保证在同一时刻，一个解释器进程下只有一个线程在运行、执行字节码。Cpython使用简单的锁机制避免多线程同时执行字节码</li>
<li>在Cpython解释器中，同一进程中假如有多个线程运行，当python代码有一个线程开始访问解释器的时候，一个线程在运行python程序的时候会霸占python解释器（加了一把锁），GIL会把这个线程给锁上，<br>此时此刻使该进程内的其他线程无法运行，无法对解释器的资源进行访问，需要等这个线程分配的时间到了、该线程运行完后这个线程把GIL释放掉，其他线程才能运行。如果线程运行过程中遇到耗时操作，则解释器锁解开，使其他线程运行。所以在多线程中，线程的运行仍是有先后顺序的，并不是同时进行。其实这无疑也是一个单线程。<br>这类似于给线程加锁 <code>threading.Lock().acquire() </code>，解锁 <code>threading.Lock().release()</code> 一样。</li>
<li>单个进程内的并发任务：如果你需要在单个进程内继续使用并发的特性，可以考虑使用<code>threading</code>模块，不能利用多核CPU，<br>如果想要充分地使用多核CPU的资源，在python中大部分情况需要使用多进程<code>multiprocessing</code>模块。</li>
</ul>
<h4 id="首先区分CPU和IO密集程序"><a href="#首先区分CPU和IO密集程序" class="headerlink" title="首先区分CPU和IO密集程序"></a>首先区分CPU和IO密集程序</h4><ul>
<li>一般程序分为CPU密集还有IO密集，<ul>
<li>CPU密集：把大量时间花在计算上面，磁盘硬盘读写，难以利用多核优势</li>
<li>IO密集：把大量时间花费在了等待上面。(比如传输、文件操作，网络爬虫)<br>在等待时间中CPU是不需要工作的，那你在此期间提供双CPU资源也是利用不上的，那么为什么多线程会对IO密集型代码有用呢？这时因为python碰到等待会释放GIL供新的线程使用，实现了线程间的切换。<br>IO期间会释放GIL，对IO密集程序影响不大<br>解释图：这个图里面有三个线程Thread1，Thread2，Thread3，在处理网络请求的过程中，虽然一个时间只能执行一个线程，但是在等待网络请求的时候来释放全局解释锁切换到不同线程Run运行，这就是对IO密集的程序会小一些。</li>
</ul>
</li>
</ul>
<h3 id="如何规避GIL影响"><a href="#如何规避GIL影响" class="headerlink" title="如何规避GIL影响"></a>如何规避GIL影响</h3><ul>
<li>CPU密集可以使用多进程+进程池来充分利用多核，2个CPU干活肯定比一个CPU快很多。<br>用cython编写一些扩展来转换成cython代码。</li>
<li>（cython不是Cpython解释器，它是一个用来把python程序转换成C代码一个扩展）</li>
<li>IO密集型任务：使用多线程 / 协程。原因是一个线程在IO时被阻塞，会被切换到另一个线程，线程切换后，I/O 操作仍然在进行，线程 1 在进行 I/O 操作时，线程 2 可以获得 CPU 资源进行计算，虽然增加了切换成本，却提高了效率。</li>
<li>通过<code>pypy</code>解释器来执行python脚本不含有GIL</li>
</ul>
<h3 id="GIL实现"><a href="#GIL实现" class="headerlink" title="GIL实现"></a>GIL实现</h3><p>解释图：每隔一段时间我们尝试去释放当前线程的锁，然后让其它线程尝试去获取锁并且去执行</p>
<h3 id="GIL执行顺序"><a href="#GIL执行顺序" class="headerlink" title="GIL执行顺序"></a>GIL执行顺序</h3><ol>
<li>设置GIL</li>
<li>切换进一个线程去运行</li>
<li>执行下面操作之一：</li>
</ol>
<ul>
<li>指定数量的字节码指令</li>
<li>线程主动让出控制权（可以调用<code>time.sleep(0)</code>来完成）</li>
</ul>
<ol start="4">
<li>把线程设置回睡眠状态（切换出线程）</li>
<li>解锁GIL</li>
<li>重复上述步骤</li>
</ol>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 单线程版</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CountDown</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">        n -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    n = <span class="number">3000000</span></span><br><span class="line">    start_time = time.perf_counter()</span><br><span class="line">    CountDown(n)</span><br><span class="line">    end_time = time.perf_counter()</span><br><span class="line">    print(<span class="string">"n = {}，单线程版耗时{}"</span>.format(n, end_time-start_time))</span><br><span class="line">    <span class="comment"># 多线程版</span></span><br><span class="line">    start_time = time.perf_counter()</span><br><span class="line">    t1 = Thread(target = CountDown, args = [n//<span class="number">2</span>])</span><br><span class="line">    t2 = Thread(target = CountDown, args = [n//<span class="number">2</span>])</span><br><span class="line">    t1.start()</span><br><span class="line">    t2.start()</span><br><span class="line">    t1.join()</span><br><span class="line">    t2.join()</span><br><span class="line">    end_time = time.perf_counter()</span><br><span class="line">    print(<span class="string">"n = {}，多线程版耗时{}"</span>.format(n, end_time-start_time))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 对象引用计数</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">        a = []</span><br><span class="line">        b = a</span><br><span class="line">        print(sys.getrefcount(a))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 线程安全</span></span><br><span class="line">        n = <span class="number">0</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">            <span class="keyword">global</span> n</span><br><span class="line">            n += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        threads = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">            t = threading.Thread(target = foo)</span><br><span class="line">            threads.append(t)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">            t.start()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> threads:</span><br><span class="line">            t.join()</span><br><span class="line"></span><br><span class="line">        print(n)</span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/csrf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/csrf/" class="post-title-link" itemprop="url">CSRF</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:46" itemprop="dateModified" datetime="2021-04-02T12:24:46Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/django/" itemprop="url" rel="index"><span itemprop="name">django</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>CSRF：Cross-site request forgery 跨站请求伪造<br>利用网站对已认证的权限去执行未授权的命令的一种恶意攻击<br>攻击者它们会利用登录过的用户在浏览器中的认证信息，欺骗用户的浏览器去访问以你的身份在一个自己曾经认证过的网站上模拟发送请求，，然后做了一些没有经过你授权的一些行为，比发邮件，发消息，甚至财产操作如转账和购买商品。<br>由于浏览器曾经认证过，所以被访问的网站会认为是真正的用户操作而去运行。</p>
<p>这利用了web中用户身份验证的一个漏洞：简单的身份验证只能保证请求发自某个用户的浏览器，却不能保证请求本身是用户自愿发出的或者批准发送的</p>
<ol>
<li>用户C打开浏览器，访问受信任网站A，输入用户名和密码请求登录网站A；</li>
<li>在用户信息通过验证后，网站A产生Cookie信息并返回给浏览器，此时用户登录网站A成功，可以正常发送请求到网站A；</li>
<li>用户未退出网站A之前，在同一浏览器中，打开一个TAB页访问网站B；</li>
<li>网站B接收到用户请求后，返回一些攻击性代码，并发出一个请求要求访问第三方站点A；</li>
<li>浏览器在接收到这些攻击性代码后，根据网站B的请求，在用户不知情的情况下携带Cookie信息，向网站A发出请求。网站A并不知道该请求其实是由B发起的，所以会根据用户C的Cookie信息以C的权限处理该请求，导致来自网站B的恶意代码被执行。</li>
</ol>
<p>Csrf 是利用网站本身的漏洞，比如一个网站a用cookie就可以登录，不需要用户重新输入用户名和密码。那么我们就可以利用csrf攻击，携带cookie去登录网站a，进行钱的转账<br>Xss是在网站a里面注入恶意的脚本，我们一访问这个网站a，那么就执行恶意的代码</p>
<p>Csrf是需要登录的，xss是不需要进行登录的。</p>
<p>2.CSRF产生的条件<br>要完成一个 CSRF攻击，需要具备两个条件<br>受害者已经登录到目标网站并且没有退出( 保持登录状态 ）<br>受害者访问了攻击者发布的链接或者表单按钮<br>二者必须缺一不可</p>
<p>3.如何防范 CSRF？使用CSRF保护（针对同步提交，比如注册页面）<br>    在使用Get请求的时候非常容易伪造链接，所以尽量不要在GET请求里有任务数据修改操作。目前所有Python主流的web 框架所采用的的方式令牌同步。</p>
<p>令牌同步(Synchronizer token pattern , 简称STP)：在用户请求的表单中嵌入一个隐藏的<code>csrf_token</code>，服务端验证其是否与cookie中的一致(基于同源策略其他网站是无法获取cookie中的<code>csrf_token</code>)。黑客是拿不到你cookie中的 <code>csrftoken</code>值的，前提是网站本身没有 xss漏洞。</p>
<p>如果是 js 提交需要先从cookie获取csrf_token作为 X-CSRFToken请求头提交<br>    1. 在MIDDLEWARE设置中激活CSRF中间件<br>django.middleware.csrf.CsrfViewMiddleware<br>    2. </p><form>元素中使用<code>csrf_token</code>标签（POST请求)<br>Html<br>    1    <code>&lt;form class="xxx" method="post" action="."&gt;</code><br>    2    <code>{% csrf_token %}</code><br>    3. 选择合适的渲染方式<br>视图函数中，确保使用RequestContext来渲染（或者render()函数）</form><p></p>
<p>其他：检测来源HTTP Referer(容易被伪造)；验证码方式(安全但是繁琐)</p>
<p>开启使用CSRF保护之后，浏览器源码会生成一个隐藏的表单域。这个表单中自动生成了唯一的value值（每一次request都会有不同的value值），提交表单时候会将其一并提交，因为value值唯一，就不会有重复提交的情况。</p>
<p>图解：左边是用户，右边是需要登陆的网站。一个用户A通过自己的身份验证，去登陆网站SNS，网站会返回一个cookie值Cookie: sid=1234567890用来标识这个用户。然后中间一个攻击者给你发一个链接或者给你一个图片你可能会对它进行一个点击，比如发给你一个图<code>&lt;img src="http://example.com/msg?q=你好"&gt;</code>误导你来去点击，这个链接是发送评论的请求地址，如果你点击这个地址它就会以你的名义来发送这个你好。这个时候假如你误点这个图片就会触发这个链接的操作，然后你就会携带你的Cookie去请求SNS网站。这个时候你就会发现你实际上并没有想去发送你好这个评论。但是你通过攻击者留下的链接陷阱点进去之后然后你就误发这个评论。</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/django-zhong-kuo-zhan-yong-hu-mo-xing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/django-zhong-kuo-zhan-yong-hu-mo-xing/" class="post-title-link" itemprop="url">扩展Django中的用户模型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:45" itemprop="dateModified" datetime="2021-04-02T12:24:45Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/django/" itemprop="url" rel="index"><span itemprop="name">django</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="扩展Django中的用户模型"><a href="#扩展Django中的用户模型" class="headerlink" title="扩展Django中的用户模型"></a>扩展Django中的用户模型</h3><p>是对ORM抽象模型的应用</p>
<h4 id="对用户进行扩展"><a href="#对用户进行扩展" class="headerlink" title="对用户进行扩展"></a>对用户进行扩展</h4><ul>
<li><p>思考如下场景如何实现</p>
<ul>
<li>Django内置的用户模型满足不了需求怎么办？</li>
<li>要用户模型添加头像字段怎么办？</li>
</ul>
</li>
<li><p>两种方式解决用户问题</p>
<ul>
<li><p>方式1：使用OneToOneField对用户进行扩展</p>
</li>
<li><p>方式2：替换现有的用户模型</p>
<ul>
<li>步骤一：配置用户模型，告诉django框架<br><code>setting.py</code>    <figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AUTH_USER_MODEL = <span class="string">'accounts.User'</span></span><br></pre></td></tr></tbody></table></figure></li>
<li>步骤二：继承自<code>AbstractUser</code>抽象模型，不会生成对应的数据表</li>
</ul>
<p><code>accounts\models.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> AbstractUser</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>(<span class="params">AbstractUser</span>):</span></span><br><span class="line">```    </span><br><span class="line">    - 步骤三：添加字段，同步模型到数据库</span><br><span class="line">```bash</span><br><span class="line">python manage.py check</span><br><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py makemigrate</span><br></pre></td></tr></tbody></table></figure>
<p>数据库生成表格<br><code>account_user</code>和<code>account_user_group</code>和<code>account_user_user_permissions</code></p>
</li>
</ul>
</li>
<li><p>创建普通用户 命令行输入命令</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py shell  // django控制台</span><br></pre></td></tr></tbody></table></figure>
<p>或者pycharm的<code>Python Console</code><br>引入用户</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> accounts.models <span class="keyword">import</span> User</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>使用命令行创建超级管理员</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;python manage.py createsuperuser</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>获取用户对象</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">user = User.objects.create_user(<span class="string">'john'</span>,<span class="string">'john@example.com'</span>,<span class="string">'johnpassword'</span>)</span><br><span class="line">user = User.objects.create_user(<span class="string">'admin'</span>,<span class="string">'admin@example.com'</span>,<span class="string">'123456'</span>)</span><br><span class="line">u = User.objects.get(username=<span class="string">'admin'</span>)</span><br><span class="line">u = User.objects.get(username=<span class="string">'13500000000'</span>)</span><br><span class="line">u.check_password(<span class="string">'123456'</span>)</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/gunicorn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/gunicorn/" class="post-title-link" itemprop="url">Gunicorn</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:45" itemprop="dateModified" datetime="2021-04-02T12:24:45Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/django/" itemprop="url" rel="index"><span itemprop="name">django</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Gunicorn：Python WSGI HTTP Server.<br>纯 Python 编写的高性能的 WSGI Server</p>
<p>pre-fork 预先分配多个 worker 进程处理请求(master-slave)。master-slave方式：一个master负责去管理多个worker进程，比如那个worker超时了把它重启，worker负责处理客服端的用户请求。</p>
<p>多钟 worker 支持：Sync 同步worker / Async(Gevent) 基于gevent的异步worker/ Tornado / AsyncIO。一般需要支持比较高的并发的时候，可以采用基于gevent的异步worker。</p>
<p>图解：使用Gunicorn来去部署 web的一种方式，首先客户端的请求先到Nginx这一层，Nginx负责反向代理，它就又把请求直接转发给Gunicorn。Gunicorn通过Pre-fork预先fork一堆worker进程，然后把请求转给worker进程处理请求。master进程它不会负责去处理请求，它只是负责监控和重启worker进程。</p>
<p>2.Gunicorn的代码示例</p>
<figure class="highlight cmake"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip <span class="keyword">install</span> gunicorn     <span class="comment"># 安装gunicorn</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建文件 myapp.py, 添加内容如下</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">app</span>(<span class="params">environ, start_response</span>):</span>  <span class="comment"># 一个web应用</span></span><br><span class="line">    data = <span class="string">b'Hello, World!\n'</span></span><br><span class="line">    start_response( <span class="string">"200 OK"</span>, [</span><br><span class="line">        (<span class="string">"Content-Type"</span>, <span class="string">"text/plain"</span>),</span><br><span class="line">        (<span class="string">"Content-Length"</span>, str(len(data))</span><br><span class="line">    ])</span><br><span class="line">    <span class="keyword">return</span> iter([data])</span><br><span class="line">``` </span><br><span class="line">```shell </span><br><span class="line">$ gunicorn -w <span class="number">4</span> myapp:app  <span class="comment"># 使用gunicorn指定4个worker启动 web应用</span></span><br></pre></td></tr></tbody></table></figure>
<p>由于gunicorn部署个启动都非常容易，所以很多公司都使用 Gunicorn来作为 WSGI server。</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/git-bash-cmd-pei-zhi-dai-li/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/git-bash-cmd-pei-zhi-dai-li/" class="post-title-link" itemprop="url">Git Bash, CMD配置代理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:45" itemprop="dateModified" datetime="2021-04-02T12:24:45Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Markdown/" itemprop="url" rel="index"><span itemprop="name">Markdown</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="方法一-pip-linux配置文件换成清华源"><a href="#方法一-pip-linux配置文件换成清华源" class="headerlink" title="方法一 pip linux配置文件换成清华源"></a>方法一 pip linux配置文件换成清华源</h3><p>linux:<br>修改 ~/.pip/pip.conf (没有就创建一个)，文件夹要加“.”，表示是隐藏文件夹)，内容如下：</p>
<figure class="highlight pgsql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">global</span>]</span><br><span class="line">timeout = <span class="number">6000</span></span><br><span class="line"><span class="keyword">index</span>-url = https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line"><span class="keyword">trusted</span>-host = pypi.tuna.tsinghua.edu.cn</span><br></pre></td></tr></tbody></table></figure>

<p>windows:<br>直接在user目录中创建一个pip目录，如：<code>C:\Users\xx\pip</code>，在pip 目录下新建文件<code>pip.ini</code>，内容如下</p>
<figure class="highlight pgsql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">global</span>]</span><br><span class="line">timeout = <span class="number">6000</span></span><br><span class="line"><span class="keyword">index</span>-url = https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line"><span class="keyword">trusted</span>-host = pypi.tuna.tsinghua.edu.cn</span><br></pre></td></tr></tbody></table></figure>

<p>在安装python库，在网络不好的情况会遇到<br>raise ReadTimeoutError(self._pool, None, ‘Read timed out.’)<br>ReadTimeoutError: HTTPSConnectionPool(host=’files.pythonhosted.org’, port=443): Read timed out.</p>
<ul>
<li>pycharm-setting-proxy-manual-127.0.0.1 prot 7890</li>
</ul>
<h3 id="ping的协议不是https，是ICMP协议，不是TCP-UDP协议"><a href="#ping的协议不是https，是ICMP协议，不是TCP-UDP协议" class="headerlink" title="ping的协议不是https，是ICMP协议，不是TCP/UDP协议"></a>ping的协议不是https，是ICMP协议，不是TCP/UDP协议</h3><p>不要输入<code>ping www.google.comping</code>,<br>Ping无法走代理。<br>如果你坚持要能Ping通才行，请考虑常规VPN（PPTP/L2PT/IPSec等）。</p>
<p>设置代理基本思路 : 配置梯子的 ip : port ,梯子会为通过此端口的流量加密混淆 , 将配置端口的命令以某种格式写入到配置文件中实现长久代理</p>
<figure class="highlight plain"><figcaption><span>-vv</span><a target="_blank" rel="noopener" href="http://www.google.com```，用这条命令来验证，查看响应数据即可,有则说明成功">link</a></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">```curl -I www.google.com``` , 测试连接是否成功的 看状态码是否为 200</span><br><span class="line">失败时```curl: (7) Failed to connect to www.google.com port 80: Timed out```</span><br><span class="line"></span><br><span class="line">直接打开CFW-setting—port点击terminal图标，点击端口是设置端口</span><br><span class="line">速度</span><br><span class="line"></span><br><span class="line">### Windows 下给cmd配置代理</span><br><span class="line">```sh</span><br><span class="line"># 设置本地代理的端口号 7890 为你实际的端口号</span><br><span class="line">set http_proxy=http://127.0.0.1:7890</span><br><span class="line">set https_proxy=http://127.0.0.1:7890</span><br><span class="line"></span><br><span class="line"># 设置代理的用户名和密码（Clash For Windows不需要）</span><br><span class="line"># HTTP</span><br><span class="line">set http_proxy_user=username</span><br><span class="line">set http_proxy_pass=password</span><br><span class="line"></span><br><span class="line"># HTTPS</span><br><span class="line">set https_proxy_user=username</span><br><span class="line">set https_proxy_pass=password</span><br><span class="line"></span><br><span class="line"># 如果需要恢复本地代理（清除代理）</span><br><span class="line">set http_proxy=</span><br><span class="line">set https_proxy=</span><br></pre></td></tr></tbody></table></figure>
<h3 id="Windows-下给终端Git-Bash，配置代理"><a href="#Windows-下给终端Git-Bash，配置代理" class="headerlink" title="Windows 下给终端Git Bash，配置代理"></a>Windows 下给终端Git Bash，配置代理</h3><ul>
<li><p>命令行配置</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置本地代理的端口号 7890 为你实际的端口号</span></span><br><span class="line"><span class="built_in">export</span> http_proxy=http://127.0.0.1:7890</span><br><span class="line"><span class="built_in">export</span> https_proxy=http://127.0.0.1:7890</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>配置文件</p>
<blockquote>
<p>每次新建一个终端会话时,默认让终端去走代理,这样就不需要每次都复制拷贝一下了, 代理程序去智能分流(国内 IP 直连,国外走代理)，避免了连接国内 IP 地址时“绕远”.</p>
</blockquote>
<ul>
<li>假设 Git 默认路径为 <code>C:\Program Files\Git</code><br>那么配置文件路径为<br><code>C:\Program Files\Git\etc\bash.bashrc</code></li>
</ul>
</li>
</ul>
<ul>
<li>或者 ~/.gitconfig中添加<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[http]</span><br><span class="line">    proxy = http://127.0.0.1:7890</span><br><span class="line">[https]</span><br><span class="line">    proxy = https://127.0.0.1:7890</span><br></pre></td></tr></tbody></table></figure>


</li>
</ul>
<p>git配置ssh协议代理<br>linux目录 : <code>~/.ssh/config</code> (没有就自己新建一个,注意没有后缀)<br>进入 ssh 配置目录<br><code>cd ~/.ssh</code><br>编辑 config 文件,如果没有那就新建一个 config 文件<br><code>touch config</code><br><code>vi config</code></p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">  ProxyCommand <span class="string">"C:\Program Files\Git\mingw64\bin\connect.exe"</span> -H 127.0.0.1:7890 %h %p</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Host *</span><br><span class="line">    ProxyCommand nc -X 5 -x localhost:7890 %h %p</span><br><span class="line"><span class="comment"># 第一行代表所有的 ssh 的主机</span></span><br><span class="line"><span class="comment"># 第二行代表让所有的 ssh 的主机在连接的时候,通过你本地的端口为 7890 的 socks5 代理去连接,一般来讲,本地的 socks5 都是由翻墙工具提供,</span></span><br><span class="line"><span class="comment">#诸如 Surge  ClashX 或者 Ssr,所以,7891这个端口需要换成对应的服务端口即可</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight plain"><figcaption><span>```-S```为socks5代理</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">以后不管是在用 git 进行 push 和 pull 操作还是 ssh 连接服务器的时候,均可获得畅快体验,</span><br><span class="line"></span><br><span class="line">### npm配置代理</span><br><span class="line">- 命令行配置</span><br><span class="line">- 文件配置</span><br><span class="line">```~/.npmrc```随便哪一行添加下面的命令</span><br><span class="line">```sh</span><br><span class="line">proxy=http://127.0.0.1:7890</span><br><span class="line">https-proxy=http://127.0.0.1:7890</span><br></pre></td></tr></tbody></table></figure>

<h3 id="在-vscode-中添加-git-bash"><a href="#在-vscode-中添加-git-bash" class="headerlink" title="在 vscode 中添加 git bash"></a>在 vscode 中添加 git bash</h3><p>在 vscode <code>setting.json</code>末尾添加</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//使用Git Bash的配置</span><br><span class="line"><span class="string">"terminal.integrated.shell.windows"</span>: <span class="string">"C:\\Program Files\\Git\\bin\\bash.exe"</span>,</span><br><span class="line"><span class="string">"terminal.integrated.shellArgs.windows"</span>: [<span class="string">"--login"</span>,<span class="string">"-i"</span>]</span><br></pre></td></tr></tbody></table></figure>

<h3 id="Windows-下给终端PowerShell配置代理-env-https-proxy-“127-0-0-1-8080”"><a href="#Windows-下给终端PowerShell配置代理-env-https-proxy-“127-0-0-1-8080”" class="headerlink" title="Windows 下给终端PowerShell配置代理 env:https_proxy = “127.0.0.1:8080”"></a>Windows 下给终端PowerShell配置代理 env:https_proxy = “127.0.0.1:8080”</h3><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># <span class="doctag">NOTE:</span> registry keys for IE 8, may vary for other versions</span></span><br><span class="line"><span class="variable">$regPath</span> = <span class="string">'HKCU:\Software\Microsoft\Windows\CurrentVersion\Internet Settings'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> Clear-Proxy</span><br><span class="line">{</span><br><span class="line">    Set-ItemProperty -Path <span class="variable">$regPath</span> -Name ProxyEnable -Value 0</span><br><span class="line">    Set-ItemProperty -Path <span class="variable">$regPath</span> -Name ProxyServer -Value <span class="string">''</span></span><br><span class="line">    Set-ItemProperty -Path <span class="variable">$regPath</span> -Name ProxyOverride -Value <span class="string">''</span></span><br><span class="line"></span><br><span class="line">    [Environment]::SetEnvironmentVariable(<span class="string">'http_proxy'</span>, <span class="variable">$null</span>, <span class="string">'User'</span>)</span><br><span class="line">    [Environment]::SetEnvironmentVariable(<span class="string">'https_proxy'</span>, <span class="variable">$null</span>, <span class="string">'User'</span>)</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> Set-Proxy</span><br><span class="line">{</span><br><span class="line">    <span class="variable">$proxy</span> = <span class="string">'http://example.com'</span></span><br><span class="line"></span><br><span class="line">    Set-ItemProperty -Path <span class="variable">$regPath</span> -Name ProxyEnable -Value 1</span><br><span class="line">    Set-ItemProperty -Path <span class="variable">$regPath</span> -Name ProxyServer -Value <span class="variable">$proxy</span></span><br><span class="line">    Set-ItemProperty -Path <span class="variable">$regPath</span> -Name ProxyOverride -Value <span class="string">'&lt;local&gt;'</span></span><br><span class="line"></span><br><span class="line">    [Environment]::SetEnvironmentVariable(<span class="string">'http_proxy'</span>, <span class="variable">$proxy</span>, <span class="string">'User'</span>)</span><br><span class="line">    [Environment]::SetEnvironmentVariable(<span class="string">'https_proxy'</span>, <span class="variable">$proxy</span>, <span class="string">'User'</span>)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="在-idea-中添加-git-bash"><a href="#在-idea-中添加-git-bash" class="headerlink" title="在 idea 中添加 git bash"></a>在 idea 中添加 git bash</h3><p>setting-tools-terminal-application settiing-shell path<br><code>"C:\\Program Files\\Git\\bin\\bash.exe" --login -i</code></p>
<p>就是两条命令，前两条。<br>要点<br>一定要加 <code>http://</code>，直接写域名或者 IP 不行。<br>http 和 https 都要设置。</p>
<h3 id="linux-配置终端代理"><a href="#linux-配置终端代理" class="headerlink" title="linux 配置终端代理"></a>linux 配置终端代理</h3><p>推荐使用qv2r*y<br>archlinux 下载 :</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S v2r*y</span><br><span class="line">sudo pacman -S qv2r*y</span><br></pre></td></tr></tbody></table></figure>

<p>配置代理 :</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> http_proxy=http://127.0.0.1:7890;<span class="built_in">export</span> https_proxy=http://127.0.0.1:7890</span><br></pre></td></tr></tbody></table></figure>
<p>添加到当前 shell 的配置文件中,<br>比如 zsh 的配置文件为家目录下的<code>~/.zshrc</code></p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置本地代理的端口号 7890 为你实际的端口号</span></span><br><span class="line"><span class="built_in">export</span> http_proxy=http://127.0.0.1:7890</span><br><span class="line"><span class="built_in">export</span> https_proxy=http://127.0.0.1:7890</span><br><span class="line"><span class="built_in">export</span> all_proxy=socks5://127.0.0.1:7891</span><br></pre></td></tr></tbody></table></figure>

<p>VM虚拟机配置共享主机，访问外网<br>查看是否启动VM服务(win+R)输入:<code>services.msc</code><br>代理工具设置允许来自局域网的访问：<br>5、VMware可以设置为NAT模式，或者桥接（桥接需要编辑虚拟网络编辑器–更改设置–添加网络-选择桥接模式–选择实体网卡即可），建议使用NAT简单</p>
<p>6、设置网络浏览器中的代理设置，设置的IP为主机的IP，端口号默认为7890<br>则浏览器即可使用主机的网络访问外网</p>
<p>、设置虚拟机中的终端设置临时代理：</p>
<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> http_proxy=http://主机IP:7890</span><br><span class="line"><span class="built_in">export</span> https_proxy=http://主机IP:7890</span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>
<script src="/js/comments.js"></script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">外心人D</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
