<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<meta name="hexo-config" content="{&quot;hostname&quot;:&quot;bubbleboy11.github.io&quot;,&quot;root&quot;:&quot;/&quot;,&quot;images&quot;:&quot;/images&quot;,&quot;scheme&quot;:&quot;Muse&quot;,&quot;version&quot;:&quot;8.3.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:true,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:false,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;}}">
<meta name="description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:type" content="website">
<meta property="og:title" content="外心人D的博客">
<meta property="og:url" content="https://bubbleboy11.github.io/page/18/index.html">
<meta property="og:site_name" content="外心人D的博客">
<meta property="og:description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="外心人D">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://bubbleboy11.github.io/page/18/">



<meta name="hexo-config-page" content="{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:true,&quot;isPost&quot;:false,&quot;lang&quot;:&quot;zh-CN&quot;}">
<meta name="hexo-config-calendar" content="">
<script data-pjax src="/js/load-config.js"></script>
  <title>外心人D的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="外心人D的博客" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">外心人D的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">外心人D</p>
  <div class="site-description" itemprop="description">本博客大多内容为慕课和网上博客，并非原创</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">204</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">36</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/jin-zhi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/jin-zhi/" class="post-title-link" itemprop="url">进制</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:46" itemprop="dateModified" datetime="2021-04-02T12:24:46Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>python整数类型为Unifying Long Integers，无限长整数类型，<br>没有 32 / 64 位 int long 等不同长度等概念，但肯定是大于 32 位</p>
<p>八进制：包括0-7的数字</p>
<p>十六进制表示：包括0-9的数字，及字母a-f，A-F，a表示10</p>
<p>Python 中浮点数的运算存在误差<br>计算机底层运算的时候操作的是二进制，<br>当带小数点的十进制转换成二进制的时候可能存在小数部分乘不尽的情况</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">1.2</span> - <span class="number">1.0</span>)  <span class="comment"># 0.19999999999999996</span></span><br><span class="line">print(<span class="number">0.1</span> + <span class="number">0.2</span>)  <span class="comment"># 0.30000000000000004</span></span><br><span class="line">print(<span class="number">0.1</span> + <span class="number">2</span>)  <span class="comment"># 2.1</span></span><br><span class="line">print(<span class="number">0.1</span> * <span class="number">2</span>)  <span class="comment"># 0.2</span></span><br><span class="line"></span><br><span class="line">print(<span class="number">1.2</span> - <span class="number">1.0</span> == <span class="number">0.2</span>)  <span class="comment"># False</span></span><br><span class="line">print(type(<span class="number">2</span> / <span class="number">2</span>))  <span class="comment"># &lt;class 'float'&gt;</span></span><br><span class="line"></span><br><span class="line">print(float(<span class="number">1</span>))   <span class="comment"># 1.0</span></span><br></pre></td></tr></tbody></table></figure>

<p>python中<code>0b</code>(数字0和小写字母B前缀)代表二进制数字</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">0b101</span>)  <span class="comment"># 5  </span></span><br><span class="line">print(<span class="number">0b11</span>)  <span class="comment"># 3  </span></span><br></pre></td></tr></tbody></table></figure>

<p>java中以<code>0</code>开头代表八进制数字，如：037，056<br>python中<code>0o</code>(数字0和小写字母O前缀)代表八进制数字，</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">0o11</span>)  <span class="comment"># 9  </span></span><br><span class="line">print(<span class="number">0o110</span>)  <span class="comment"># 72  </span></span><br></pre></td></tr></tbody></table></figure>

<p>java中以<code>0x</code>或<code>0X</code>开头代表十六进制数字，如：0x12，0xabcf，0XABCF<br>python中<code>0x</code>(数字0和小写字母X前缀)代表十六进制数字</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">0x101</span>)  <span class="comment"># 257   </span></span><br><span class="line">print(<span class="number">0x1F</span>)  <span class="comment"># 31</span></span><br><span class="line">print(<span class="number">0x1f</span>)  <span class="comment"># 31</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plain"><figcaption><span>代表不同类型数据转换为10进制数字</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">```oct()```  代表不同类型数据转换为8进制数字</span><br><span class="line"></span><br><span class="line">```hex(x)```，将不同类型进制整数转换为以“0x”为前缀的小写十六进制数的字符串。如果 x 不是 Python int 对象，则必须定义返回整数的 __index__() 方法。</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">print(hex(1))  # 0x1 补码</span><br><span class="line">print(hex(-1))  # -0x1 负号 + 原码 （Python 特色，Java 会直接输出补码）</span><br><span class="line"></span><br><span class="line">print(hex(3), type(hex(3)))  # 0x3 &lt;class 'str'&gt;</span><br><span class="line">print(hex(0b11))  # 0x3  将2进制数字转换为2=16进制</span><br></pre></td></tr></tbody></table></figure>

<p>如果要将整数转换为大写或小写的十六进制字符串，并可选择有无“0x”前缀，则可以使用如下方法：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'%#x'</span> % <span class="number">3</span>, <span class="string">'%x'</span> % <span class="number">3</span>, <span class="string">'%X'</span> % <span class="number">3</span>, )</span><br><span class="line"><span class="comment"># 0x3 3 3</span></span><br><span class="line"></span><br><span class="line">print(format(<span class="number">3</span>, <span class="string">'#x'</span>), format(<span class="number">3</span>, <span class="string">'x'</span>), format(<span class="number">3</span>, <span class="string">'X'</span>))</span><br><span class="line"><span class="comment"># 0x3 3 3</span></span><br><span class="line">print(f'{3:#x}', f'{3:x}', f'{3:X}')</span><br><span class="line"><span class="comment"># 0x3 3 3</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'%#x'</span> % <span class="number">-3</span>, <span class="string">'%x'</span> % <span class="number">-3</span>, <span class="string">'%X'</span> % <span class="number">-3</span>, )</span><br><span class="line"><span class="comment"># -0x3 -3 -3</span></span><br><span class="line"></span><br><span class="line">print(format(<span class="number">-3</span>, <span class="string">'#x'</span>), format(<span class="number">-3</span>, <span class="string">'x'</span>), format(<span class="number">-3</span>, <span class="string">'X'</span>))</span><br><span class="line"><span class="comment"># -0x3 -3 -3</span></span><br><span class="line">print(f'{-3:#x}', f'{-3:x}', f'{-3:X}')</span><br><span class="line"><span class="comment"># -0x3 -3 -3</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plain"><figcaption><span>将一个不同类型进制整数转变为一个前缀为“0b”的二进制数的字符串。结果是一个合法的 Python 表达式。</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">如果 x 不是 Python 的 ```int``` 对象，那它需要定义 ```__index__()``` 方法返回一个整数。</span><br><span class="line">bin一个正数（十进制表示），输出的是它的原码的二进制表示</span><br><span class="line">bin一个负数（十进制表示），输出的是它的原码的二进制表示加上个负号，而不是补码的形式。</span><br><span class="line">```python</span><br><span class="line">print(bin(3), type(bin(3)))  # 0b11 &lt;class 'str'&gt;</span><br><span class="line">print(bin(-3))  # -0b11</span><br></pre></td></tr></tbody></table></figure>

<p>对数值进行与操作就获得补码形式的二进制表示 </p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">print(bin(<span class="number">-3</span> &amp; <span class="number">0b111</span>))  </span><br><span class="line"><span class="comment"># 0b101</span></span><br><span class="line">print(bin(<span class="number">-3</span> &amp; <span class="number">0b1111111111111111</span>))</span><br><span class="line"><span class="comment"># 0b1111111111111101</span></span><br><span class="line">---</span><br><span class="line">title: HTML</span><br><span class="line">date: <span class="number">2020</span><span class="number">-08</span><span class="number">-20</span> <span class="number">16</span>:<span class="number">21</span>:<span class="number">41</span></span><br><span class="line">author: 外心人D</span><br><span class="line">toc: true</span><br><span class="line">mathjax: false</span><br><span class="line">summary: 爱编程</span><br><span class="line">categories: Markdown</span><br><span class="line">tags:</span><br><span class="line">  - Leetcode</span><br><span class="line">  - 剑指offer</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line">print(bin(<span class="number">-5</span>))</span><br><span class="line"><span class="comment"># -0b101</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">-5</span> &amp; <span class="number">0b1111</span>))  </span><br><span class="line"><span class="comment"># 0b1011</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">-5</span> &amp; <span class="number">0b11111</span>))  </span><br><span class="line"><span class="comment"># 0b11011</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">-5</span> &amp; <span class="number">0b1111111111111111</span>))</span><br><span class="line"><span class="comment"># 0b1111111111111011</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># bin一个负数（十六进制表示），输出的是对应的二进制表示。</span></span><br><span class="line">print(bin(<span class="number">-3</span> &amp; <span class="number">0xffffffff</span>))</span><br><span class="line"><span class="comment"># 0b11111111111111111111111111111101</span></span><br><span class="line">print(bin(<span class="number">0xfffffffd</span>))</span><br><span class="line"><span class="comment"># 0b11111111111111111111111111111101</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">0o7</span>))  <span class="comment"># 0b111 将8进制数字转换为2进制</span></span><br><span class="line">print(bin(<span class="number">0xE</span>))  <span class="comment"># 0b1110 将16进制数字转换为2进制</span></span><br></pre></td></tr></tbody></table></figure>

<p>If prefix “0b” is desired or not, you can use either of the following ways.<br>如果不一定需要前缀“0b”，还可以使用如下的方法。<br>用format字符串获取一个int的binary表示：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">```f"{a:030b}"```：将a转换成binary的str，并在前面补0使其总位数是30。</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line">format(14, '#b'), format(14, 'b')</span><br><span class="line"># ('0b1110', '1110')</span><br><span class="line">f'{14:#b}', f'{14:b}'</span><br><span class="line"># ('0b1110', '1110')</span><br></pre></td></tr></tbody></table></figure>

<p>4bit有符号整型， 其数值范围为[-8， 7]<br>-2 + 3 可以通过补码计算 1110 + 0011 =(1) 0001</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span></span><br><span class="line">+   <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">-----------</span><br><span class="line">(<span class="number">1</span>) <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> # 注意溢出</span><br></pre></td></tr></tbody></table></figure>

<p>python 由于不知道符号位具体是第几位，因此需要进行的操作是</p>
<ol>
<li>将输入数字转化成无符号整数</li>
<li>计算无符号整数相加并的到结果</li>
<li>讲结果根据范围判定，映射为有符号整型</li>
</ol>
<p>转化为4bit无符号整数</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a &amp;= <span class="number">0xF</span> <span class="comment"># a = a &amp; 0b1111 = 1110 = 14</span></span><br><span class="line">b &amp;= <span class="number">0xF</span> <span class="comment"># b = 0011 = 3</span></span><br></pre></td></tr></tbody></table></figure>

<p>原码：直接将一个数值转化为二进制，其首位代表符号，<code>0</code> 为正， <code>1</code> 为负<br>正数：原码 = 反码 = 补码<br>负数反码：原码最高位符号位不变，其余为取反<br>负数补码：负数反码+1，即 符号位不变，各位取反再加 1</p>
<h4 id="补码特性："><a href="#补码特性：" class="headerlink" title="补码特性："></a>补码特性：</h4><p>1、一个负整数（或原码）与其补数（或补码）相加，和为模。<br>2、对一个整数的补码再求补码，等于该整数自身。<br>3、补码的正零与负零表示方法相同</p>
<ul>
<li>Python 负数的存储：<ul>
<li>获取负数的补码：<br>将整数与 0xffffffff 相与，<br>可理解为该数从 32 位开始到最高位全部置零，最高位为0为正数<br>从无限长度变为一个 32 位内二进制可以表示的正整数<br>一直循环左移并不会存在溢出的现象，模拟其他语言的32位溢出机制。<br>一个负整数（或原码）与其补数（或补码）相加，和为模。2 的32 次方 是模。<br>那么就是 2 的32 次方 然后 + n  这是在取一个负数的补码<br>就相当于  n &amp; 0xffffffff<br>高位第一位的数字取决于此数字是正数还是负数，是正数则为 0 ，是负数则为 1</li>
</ul>
</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(hex(<span class="number">1</span> &amp; <span class="number">0xffffffff</span>))  <span class="comment"># 0x1 正数补码</span></span><br><span class="line">print(hex(<span class="number">-1</span> &amp; <span class="number">0xffffffff</span>))  <span class="comment"># 0xffffffff 负数补码</span></span><br><span class="line">print(<span class="number">-1</span> &amp; <span class="number">0xffffffff</span>)  <span class="comment"># 4294967295（Python 将其认为正数）</span></span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>返回前数字还原 补码转原码：<br>若补码 a 为负数（第 32位是 1），<br>a ^ 0xffffffff 运算将 1 至 32 位按位取反；<br>~ 运算是将所有位的数字会取反；<br>因此， ~(a ^ 0xffffffff) 是将低的 1 至 32 位不变。<br>32 位以上的位取反，即 32位以上所有位全部置 1了，<br>对于32位的数字来说最高位是1则说明此数为负数<br>把这个负数补码恢复到 超过32位的 python 存储负数的形式，</li>
</ul>
<p>如果不对负数特殊处理，那么负数的前32位里的最高位还可能存在 0，最后输出的是大于32位的正数</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/di-gui/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/di-gui/" class="post-title-link" itemprop="url">HTML</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:45" itemprop="dateModified" datetime="2021-04-02T12:24:45Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Markdown/" itemprop="url" rel="index"><span itemprop="name">Markdown</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>“””<br>在递归过程中，，函数可能会有多个位置将自身作为子例程调用<br>每当递归函数调用自身时，它都会将给定的问题拆解为子问题。<br>递归调用继续进行，直到到子问题无需进一步递归就可以解决的地步。</p>
<p>为了确保递归函数不会导致无限循环，它应具有以下属性：</p>
<ul>
<li>一个简单的基本案例（basic case）（一般情况），<br>能够不使用递归来产生答案的终止方案，必须要有终止条件，</li>
<li>一组规则，也称作递推关系（recurrence relation），可将所有其他情况拆分到基本案例。<br>不断调用自身，直到遇到终止条件后进行回溯，最终返回答案。</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span>(<span class="params">x</span>):</span></span><br><span class="line">    print(x)</span><br><span class="line">    func1(x - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        print(x)</span><br><span class="line">        func2(x + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func3</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        print(x)</span><br><span class="line">        func3(x - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func4</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        func4(x - <span class="number">1</span>)</span><br><span class="line">        print(x)</span><br></pre></td></tr></tbody></table></figure>
<p>func3和func4是递归，x为正整数，func3会连续输出x到1，func4会输出1 到x</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printReverse</span>(<span class="params">str</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> str:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    printReverse(str+<span class="number">1</span>)</span><br><span class="line">    print()</span><br></pre></td></tr></tbody></table></figure>

<p>高斯求和</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 循环</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum_number</span>(<span class="params">n</span>):</span></span><br><span class="line">    total = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">        total += i</span><br><span class="line">    <span class="keyword">return</span> total</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(sum_number(<span class="number">10</span>))  <span class="comment"># 5</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 递归</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum_number</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> n + sum_number(n - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(sum_number(<span class="number">10</span>))  <span class="comment"># 55</span></span><br></pre></td></tr></tbody></table></figure>

<p>基本情况：sum_number(0) = 0<br>其它情形: sum_number(n) = n + sum_number</p>
<p>sum_number(n-1)又是一次sum_number函数的调用，<br>不过参数的值变成了n-1，<br>要得sum_number(n)到的值就必须等待sum_number(n-1)的值被计算出来，<br>同样要得到sum_number(n-1)的值必须等待sum_number(n-2)的值，<br>如此一路推算下去，直到sum_number(0)，<br>因为if语句的存在，它不需要等待sum_number(-1)的计算了，而是直接给出结果0。<br>参数值由 10 9 8 7 6 5 4 3 2 1 0<br>sun_number(1)=1+sun_number(0)=1<br>sun_number(2)=2+sun_number(1)=2+1+sun_number(0)=2+1+0=3<br>sun_number(3)=3+sun_number(2)=3+3=6<br>….<br>然后程序一路返回，直到回到最初的sum_number(n)，并给出最终结果。<br>“””</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 求阶乘</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">F</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">or</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="comment"># 对应基本情形</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> F(n - <span class="number">1</span>) * n  <span class="comment"># 对应递归情形</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(F(<span class="number">4</span>))  <span class="comment"># 24</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string"> F(0) = 1, F(1) = 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">其它情形: F(n) = F(n-1) * n</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算s=a+aa+aaa+aaaa+aa...a，其中 a是一个数字。</span></span><br><span class="line"><span class="comment"># 例如2+22+222+2222+22222(此时共有5个数相加)，几个数相加由键盘控制。</span></span><br><span class="line"><span class="comment"># 其中，a 以及 n 由用户输入，但是我们在这里就直接给定了。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sss</span>(<span class="params">a, n</span>):</span></span><br><span class="line">    <span class="comment"># 这里我说明一下，直接用input函数得到的就是字符串，除非你已经做了转换</span></span><br><span class="line">    <span class="comment"># 所以,我们设定a、n都是字符串</span></span><br><span class="line">    n = int(n)  <span class="comment"># 转换</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> int(a)</span><br><span class="line">    <span class="keyword">return</span> sss(a, n - <span class="number">1</span>) + int(a * n)  <span class="comment"># 请思考这里a*n</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">"""基本情形：sss(a, 1) = a</span></span><br><span class="line"><span class="string">sss(a, 2) = a+aa=sss(a, 1)+aa</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">其它情形:</span></span><br><span class="line"><span class="string">sss(a, n) = sss(a, n-1) + a...a(共n项)""</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">print(sss(<span class="string">'2'</span>, <span class="string">'1'</span>))  <span class="comment"># 2</span></span><br><span class="line">print(sss(<span class="string">'2'</span>, <span class="string">'2'</span>))  <span class="comment"># 24</span></span><br><span class="line">print(<span class="string">'-----'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line">n = int(input(<span class="string">"请输入层数n："</span>))  <span class="comment"># &lt;class 'int'&gt;</span></span><br><span class="line">a = int(input(<span class="string">"请输入数字a："</span>))  <span class="comment"># &lt;class 'int'&gt;</span></span><br><span class="line"></span><br><span class="line">Tn = <span class="number">0</span>  <span class="comment"># 初始化数字叠加后的值</span></span><br><span class="line">Sn = []  <span class="comment"># 创建一个空列表，以便接收叠加后的数值</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(n):  <span class="comment"># 此处的循环表示，n为几，i就循环几次，</span></span><br><span class="line">    <span class="comment"># 也就是，层数为几，下面的循环体就执行几次</span></span><br><span class="line">    Tn = Tn + a  <span class="comment"># 将循环的值赋值给Tn</span></span><br><span class="line">    <span class="comment"># print("数字叠加后值为：", Tn)  # 打印出数字叠加后的值</span></span><br><span class="line">    Sn.append(Tn)  <span class="comment"># 将数字叠加后的值依次添加到Sn这个空的列表中</span></span><br><span class="line">    <span class="comment"># print("创建的数列为：", Sn)  # 打印出列表Sn中的所有值</span></span><br><span class="line">    a = a * <span class="number">10</span>  <span class="comment"># 为下一个数做循环准备</span></span><br><span class="line">print(<span class="string">"创建的数列为："</span>, Sn)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 法一</span></span><br><span class="line"><span class="comment"># sum_ = reduce(lambda x, y: x + y, Sn)  # 计算Sn的值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 法二</span></span><br><span class="line">sum_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Sn:</span><br><span class="line">    sum_ += i</span><br><span class="line">print(<span class="string">"计算的和为："</span>, sum_)  <span class="comment"># 打印出Sn的值</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = input(<span class="string">"a:"</span>)  <span class="comment"># &lt;class 'str'&gt;</span></span><br><span class="line">n = int(input(<span class="string">"n:"</span>))  <span class="comment"># &lt;class 'int'&gt;</span></span><br><span class="line">ls = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">    ls.append(i * a)  <span class="comment"># 字符串乘一个数</span></span><br><span class="line">sum = <span class="number">0</span></span><br><span class="line">print(ls)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ls:</span><br><span class="line">    sum += eval(i)  <span class="comment"># 字符串表达式</span></span><br><span class="line">print(sum)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getNum</span>(<span class="params">a, count</span>):</span></span><br><span class="line">    list1 = []</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    a = str(a)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, count + <span class="number">1</span>):</span><br><span class="line">        list1.append(int(a * i))</span><br><span class="line">        print(list1[i - <span class="number">1</span>], end=<span class="string">" "</span>)</span><br><span class="line">        <span class="keyword">if</span> i &lt; count:</span><br><span class="line">            print(<span class="string">"+"</span>, end=<span class="string">" "</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> list1:</span><br><span class="line">        res += j</span><br><span class="line">    print(<span class="string">"="</span>, res)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">getNum(<span class="number">2</span>, <span class="number">2</span>)  <span class="comment"># 2 + 22 = 24</span></span><br></pre></td></tr></tbody></table></figure>

<p>判断用户输入的数组的逆序数。<br>定义：OP(seq, n)为序列seq中前n项的逆序数</p>
<p>基本情形:<br>OP(seq[1…n], 1) = 0，对于只有一个元素的集合，逆序数必然只有0<br>其它情形:<br>OP(seq[1…n], n) = OP(seq[1…n, n-1] + F(n)，其中，F(n)是n关于seq[1…n-1]的逆序数.</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">OP</span>(<span class="params">seq, n</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="comment"># 不为0</span></span><br><span class="line">    Fn = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> seq[n - <span class="number">1</span>] &lt; seq[i]:</span><br><span class="line">            Fn += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> OP(seq, n - <span class="number">1</span>) + Fn</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = [<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">print(OP(s, len(s)))  <span class="comment"># 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># n=5 n-1-1=3</span></span><br><span class="line"><span class="comment"># 当i=0,seq[4]=1&lt;seq[0]=5</span></span><br><span class="line"><span class="comment"># 当i=1,seq[4]=1&lt;seq[1]=4</span></span><br><span class="line"><span class="comment"># 当i=2,seq[4]=1&lt;seq[2]=3</span></span><br><span class="line"><span class="comment"># 当i=3,seq[4]=1&lt;seq[3]=2</span></span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/luo-ji-yun-suan-fu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/luo-ji-yun-suan-fu/" class="post-title-link" itemprop="url">HTML</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:46" itemprop="dateModified" datetime="2021-04-02T12:24:46Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Markdown/" itemprop="url" rel="index"><span itemprop="name">Markdown</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>逻辑运算优先 not&gt;and&gt;or<br>0被认为是False，非0表示True</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">10</span></span><br><span class="line">b = <span class="number">20</span></span><br><span class="line"><span class="comment"># 布尔"与" x and y</span></span><br><span class="line"><span class="comment"># 如果 x 为 False，返回 False，</span></span><br><span class="line"><span class="comment"># x 为 True， 返回 y 的计算值。</span></span><br><span class="line"><span class="comment"># 同真取最后一个真，有假取第一个假。</span></span><br><span class="line"><span class="keyword">if</span> (a <span class="keyword">and</span> b):  <span class="comment"># (a and b) 返回 20</span></span><br><span class="line">    print(<span class="string">"1.变量 a 和 b 都为 true"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"1.变量 a 和 b 有一个不为 true"</span>)</span><br><span class="line"><span class="comment"># 1.变量 a 和 b 都为 true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 布尔"或"     x or y</span></span><br><span class="line"><span class="comment"># 如果x是True，它返回x的值，</span></span><br><span class="line"><span class="comment"># x 为False，它返回y的计算值</span></span><br><span class="line"><span class="comment"># 同假取最后一个假，有真取第一个真。</span></span><br><span class="line"><span class="keyword">if</span> (a <span class="keyword">or</span> b):  <span class="comment"># (a or b) 返回 10</span></span><br><span class="line">    print(<span class="string">"2.变量 a 和 b 都为 true，或其中一个变量为 true"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"2.变量 a 和 b 都不为 true"</span>)</span><br><span class="line"><span class="comment"># 2.变量 a 和 b 都为 true，或其中一个变量为 true</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'a'</span> &gt; <span class="string">'b'</span>)</span><br><span class="line"><span class="comment"># False 'a' 的 ASCII 码比 ‘b’ 小</span></span><br><span class="line">print(<span class="string">'a'</span> &gt; <span class="string">'b'</span> <span class="keyword">or</span> <span class="string">'c'</span>)  <span class="comment"># c</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改变量 a 的值</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> (a <span class="keyword">and</span> b):</span><br><span class="line">    print(<span class="string">"3.变量 a 和 b 都为 true"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"3.变量 a 和 b 有一个不为 true"</span>)</span><br><span class="line"><span class="comment"># 3.变量 a 和 b 有一个不为 true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (a <span class="keyword">or</span> b):</span><br><span class="line">    print(<span class="string">"4.变量 a 和 b 都为 true，或其中一个变量为 true"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"4.变量 a 和 b 都不为 true"</span>)</span><br><span class="line"><span class="comment"># 4.变量 a 和 b 都为 true，或其中一个变量为 true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 布尔"非" not x ，取反</span></span><br><span class="line"><span class="comment"># 如果 x 为 True，返回 False 。</span></span><br><span class="line"><span class="comment"># 如果 x 为 False，返回 True。</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> (a <span class="keyword">and</span> b):</span><br><span class="line">    print(<span class="string">"5.变量 a 和 b 都为 false，或其中一个变量为 false"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"5.变量 a 和 b 都为 true"</span>)</span><br><span class="line"><span class="comment"># 5.变量 a 和 b 都为 false，或其中一个变量为 false</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x = <span class="literal">True</span></span><br><span class="line">y = <span class="literal">False</span></span><br><span class="line">z = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> x <span class="keyword">or</span> y <span class="keyword">and</span> z:</span><br><span class="line">    print(<span class="string">"yes"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"no"</span>)</span><br><span class="line"><span class="comment"># yes</span></span><br><span class="line">print(<span class="string">'----'</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="keyword">not</span> <span class="number">0.1</span>)  <span class="comment"># False</span></span><br><span class="line">print(<span class="keyword">not</span> <span class="string">''</span>)  <span class="comment"># True</span></span><br><span class="line">print(<span class="keyword">not</span> <span class="string">'0'</span>)  <span class="comment"># False</span></span><br><span class="line">print(<span class="keyword">not</span> [])  <span class="comment"># True</span></span><br><span class="line">print(<span class="keyword">not</span> [<span class="number">1</span>, <span class="number">2</span>])  <span class="comment"># False</span></span><br><span class="line">print(bool(<span class="literal">None</span>))  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line">x = <span class="literal">True</span></span><br><span class="line">y = <span class="literal">False</span></span><br><span class="line">z = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> x <span class="keyword">or</span> y:</span><br><span class="line">    print(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">elif</span> <span class="keyword">not</span> x <span class="keyword">or</span> <span class="keyword">not</span> y <span class="keyword">and</span> z:</span><br><span class="line">    print(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">elif</span> <span class="keyword">not</span> x <span class="keyword">or</span> y <span class="keyword">or</span> <span class="keyword">not</span> y <span class="keyword">and</span> x:</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="number">4</span>)</span><br><span class="line"><span class="comment"># not x or y or not y and x就可以这么理解</span></span><br><span class="line"><span class="comment"># 假 or 假 or 真 and 真</span></span><br><span class="line"><span class="comment"># 假 or 假 or 真</span></span><br><span class="line"><span class="comment"># 假 or 真</span></span><br><span class="line"><span class="comment"># 真</span></span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/bi-bao/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/bi-bao/" class="post-title-link" itemprop="url">闭包</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-24 14:25:02" itemprop="dateModified" datetime="2021-04-24T14:25:02Z">2021-04-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Markdown/" itemprop="url" rel="index"><span itemprop="name">Markdown</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="闭包-Closure-‘kləʊʒə"><a href="#闭包-Closure-‘kləʊʒə" class="headerlink" title="闭包 Closure /‘kləʊʒə/"></a>闭包 Closure /‘kləʊʒə/</h3><ul>
<li>绑定了外部作用域的变量的函数</li>
<li>即使程序离开外部作用域，如果闭包仍然可见，绑定变量不会销毁</li>
<li>每次运行外部函数都会重新创建闭包</li>
<li>自由变量：不在当前函数定义的变量。</li>
<li>外函数outer中定义了内函数inner，<br>内部函数inner引用外部函数outer的自由变量，<br>当外部函数outer返回内部函数名inner时，即外函数的返回值是内函数的引用，<br>相关参数和变量都保存在返回的函数中<br>这样就构成了一个闭包。即使外部函数结束了，但只要内部函数还在引用外部函数的变量，外部变量它就依然存在。</li>
</ul>
<h4 id="外函数返回了内函数的引用："><a href="#外函数返回了内函数的引用：" class="headerlink" title="外函数返回了内函数的引用："></a>外函数返回了内函数的引用：</h4><p>当进行a=1的时候，实际上在内存当中有一个地方存了值1，<br>然后用a这个变量名存了1所在内存位置的引用。<br>引用就好像c语言里的指针，可以把引用理解成地址。<br>a只不过是一个变量名字，a里面存的是1这个数值所在的地址，就是a里面存了数值1的引用。</p>
<p>相同的道理，在python中定义一个函数def demo():的时候，<br>内存当中会开辟一些空间，存下这个函数的代码、内部的局部变量等等。<br>这个demo只不过是一个变量名字，它里面存了这个函数所在位置的引用而已。<br>我们还可以进行x = demo， y = demo， 这样的操作就相当于，<br>把demo里存的东西赋值给x和y，这样x 和y 都指向了demo函数所在的引用，<br>在这之后我们可以用x() 或者 y() 来调用我们自己创建的demo() ，<br>调用的实际上根本就是一个函数，x、y和demo三个变量名存了同一个函数的引用。</p>
<p>对于闭包，在外函数outer中 最后return inner，<br>我们在调用外函数 demo = outer() 的时候，<br>outer返回了inner，inner是一个函数的引用，这个引用被存入了demo中。<br>所以接下来我们再进行demo() 的时候，相当于运行了inner函数。<br>一个函数，如果函数名后紧跟一对括号，相当于现在我就要调用这个函数，<br>如果不跟括号，相当于只是一个函数的名字，里面存了函数所在位置的引用，那它可以被到处传递，并且可以赋值给别的变量而不去执行它。</p>
<p>2 外函数把临时变量绑定给内函数：<br>一般情况下，如果一个函数结束，函数的内部所有东西都会释放掉，<br>还给内存，临时局部变量都会消失。<br>如果没有在函数中引用全局变量，或者仅引用局部变量，<br>在内函数给局部变量赋值python认为是一个局部变量，不能引用外部函数的环境变量，<br>都不会形成闭包</p>
<p>但是闭包是一种特殊情况，发现有自己的临时变量将来会在内部函数中用到，<br>自己在结束的时候，返回内函数的同时，会把外函数的临时变量绑定给了内部函数，<br>所以外函数已经结束了，调用内函数的时候仍然能够使用外函数的临时变量。</p>
<p>python中一切都是对象，虽然函数我们只定义了一次，<br>但是外函数在运行的时候，<br>实际上是按照里面代码执行的，<br>外函数里创建了一个函数，每次调用外函数，<br>它都创建一个代码、功能一样的内函数，<br>但是却创建了不同的对象，并且把每次传入的临时变量数值绑定给内函数，再把内函数引用返回。</p>
<p>特性：自由变量会和闭包函数同时存在，即闭包函数和外部变量会同时存在。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="comment"># a和b都是外函数的临时变量</span></span><br><span class="line">    b = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>():</span></span><br><span class="line">        print(a + b)  <span class="comment"># 在内函数中 用到了外函数的临时变量</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> inner  <span class="comment"># 外函数的返回值是内函数的引用和环境变量</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">        调用外函数传入参数5</span></span><br><span class="line"><span class="string">        此时外函数两个临时变量 a是5 b是10 ，</span></span><br><span class="line"><span class="string">        并创建了内函数，然后把内函数的引用返回存给了demo</span></span><br><span class="line"><span class="string">        外函数结束的时候发现内部函数将会用到自己的临时变量，</span></span><br><span class="line"><span class="string">        这两个临时变量就不会释放，会绑定给这个内部函数</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    demo = outer(<span class="number">5</span>)</span><br><span class="line">    <span class="comment"># demo存了外函数的返回值，也就是inner函数的引用，这里相当于执行inner函数</span></span><br><span class="line">    demo()  <span class="comment"># 15</span></span><br><span class="line"></span><br><span class="line">    demo2 = outer(<span class="number">7</span>)</span><br><span class="line">    demo2()  <span class="comment"># 17</span></span><br></pre></td></tr></tbody></table></figure>
<p>两次调用外部函数outer，分别传入的值是5和7。<br>内部函数只定义了一次，我们发现调用的时候，内部函数是能识别外函数的临时变量是不一样的。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>(<span class="params">y</span>):</span></span><br><span class="line">        <span class="keyword">nonlocal</span> x</span><br><span class="line">        x += y</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = outer(<span class="number">10</span>)</span><br><span class="line">print(a(<span class="number">1</span>))  <span class="comment"># 11</span></span><br><span class="line">print(a(<span class="number">3</span>))  <span class="comment"># 14，不是13</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span>():</span></span><br><span class="line">    fs = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">f</span>():</span></span><br><span class="line">            <span class="keyword">return</span> i * i</span><br><span class="line"></span><br><span class="line">        fs.append(f)</span><br><span class="line">    <span class="keyword">return</span> fs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f1, f2, f3 = count()</span><br><span class="line">print(f1())  <span class="comment"># 9</span></span><br><span class="line">print(f2())  <span class="comment"># 9</span></span><br><span class="line">print(f3())  <span class="comment"># 9</span></span><br><span class="line">print(f1.__closure__)  <span class="comment"># 判断是否为闭包</span></span><br><span class="line"><span class="comment"># (&lt;cell at 0x00000254B86EB910: int object at 0x00007FFE087E96E0&gt;,)</span></span><br><span class="line">print(f1.__closure__[<span class="number">0</span>].cell_contents)  <span class="comment"># 环境变量 3</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">是开启一个函数执行过后消亡，但是闭包变量实际上只有一份，每次开启内函数都在使用同一份闭包变量x</span><br><span class="line">why f1(), f2(), f3() returns <span class="number">9</span>, <span class="number">9</span>, <span class="number">9</span> rather than <span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>?</span><br><span class="line">原因就在于返回的函数引用了变量i，但它并非立刻执行。</span><br><span class="line">等到<span class="number">3</span>个函数都返回时，它们所引用的变量i已经变成了<span class="number">3</span>，因此最终结果为<span class="number">9</span></span><br></pre></td></tr></tbody></table></figure>

<p>修改闭包变量<br>要修改全局数据的时候有两种方法:<br>1 global 声明全局变量，声明变量n非内部函数的局部变量，否则内部函数只能引用，<br>       一旦修改会视其为局部变量，报错“局部变量在赋值之前被引用”。<br>         外函数的环境变量没被改变<br>2 全局变量是可变类型数据的时候可以修改 闭包更好<br>在闭包内函数中想修改闭包变量（外函数绑定给内函数的局部变量）的时候：<br>嵌套函数修改上层变量同样需要的关键字nonlocal 关键字声明<br>表示这个变量不是局部变量空间的变量，需要向上一层变量空间找这个变量。<br>闭包的环境变量可以记忆上次调用的状态，外函数的环境变量没被改变<br>使用闭包的过程中，一旦外函数被调用一次返回了内函数的引用，<br>虽然每次调用内函数，<br>是开启一个函数执行过后消亡，但是闭包变量实际上只有一份，<br>每次开启内函数都在使用同一份闭包变量</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">a</span>):</span>  <span class="comment"># outer是外部函数 a和b都是外函数的临时变量</span></span><br><span class="line">    b = <span class="number">10</span>  <span class="comment"># a和b都是闭包变量</span></span><br><span class="line">    c = [a]  <span class="comment"># 这里对应修改闭包变量的方法2</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>():</span>  <span class="comment"># inner是内函数</span></span><br><span class="line">        <span class="comment"># 内函数中想修改闭包变量</span></span><br><span class="line">        <span class="comment"># 方法1 nonlocal关键字声明不是局部变量</span></span><br><span class="line">        <span class="keyword">nonlocal</span> b</span><br><span class="line">        b += <span class="number">1</span></span><br><span class="line">        print(b)</span><br><span class="line">        <span class="comment"># 方法二，把闭包变量修改成可变数据类型 比如列表</span></span><br><span class="line">        c[<span class="number">0</span>] += <span class="number">1</span></span><br><span class="line">        print(c[<span class="number">0</span>])</span><br><span class="line">        print(b)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 外函数的返回值是内函数的引用</span></span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    demo = outer(<span class="number">5</span>)</span><br><span class="line">    demo()</span><br><span class="line">    <span class="comment"># 11</span></span><br><span class="line">    <span class="comment"># 6</span></span><br><span class="line">    <span class="comment"># 11</span></span><br><span class="line">print(<span class="string">'----------'</span>)</span><br><span class="line"></span><br><span class="line">利用闭包返回一个计数器函数，每次调用它返回递增整数：</span><br><span class="line">在内函数中，分别对闭包变量进行了修改，</span><br><span class="line">打印出来的结果也确实是修改之后的结果。</span><br><span class="line">以上两种方法就是内函数修改闭包变量的方法。</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_counter</span>():</span>  <span class="comment"># 是外部函数</span></span><br><span class="line">    i = <span class="number">0</span>  <span class="comment"># i都是闭包变量</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">counter</span>():</span>  <span class="comment"># 内函数</span></span><br><span class="line">        <span class="keyword">nonlocal</span> i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> counter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试:</span></span><br><span class="line">counterA = create_counter()</span><br><span class="line">print(counterA(), counterA(), counterA(), counterA(), counterA())  <span class="comment"># 1 2 3 4 5</span></span><br><span class="line">counterB = create_counter()</span><br><span class="line"><span class="keyword">if</span> [counterB(), counterB(), counterB(), counterB()] == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]:</span><br><span class="line">    print(<span class="string">'测试通过!'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'测试失败!'</span>)</span><br><span class="line"><span class="comment"># 测试通过!</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createCounter</span>():</span></span><br><span class="line">    i = [<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">counter</span>():</span></span><br><span class="line">        i[<span class="number">0</span>] = i[<span class="number">0</span>] + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> i[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> counter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试:</span></span><br><span class="line">counterA = createCounter()</span><br><span class="line">print(counterA(), counterA(), counterA(), counterA(), counterA())  <span class="comment"># 1 2 3 4 5</span></span><br><span class="line">counterB = createCounter()</span><br><span class="line"><span class="keyword">if</span> [counterB(), counterB(), counterB(), counterB()] == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]:</span><br><span class="line">    print(<span class="string">'测试通过!'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'测试失败!'</span>)</span><br><span class="line"><span class="comment"># 测试通过!</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cache</span>(<span class="params">func</span>):</span>  <span class="comment"># 定义装饰器，cache是外层函数</span></span><br><span class="line">    store = {} <span class="comment"># 外部变量</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">    @wraps(func)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_</span>(<span class="params">n</span>):</span>     <span class="comment"># 闭包函数</span></span><br><span class="line">        <span class="keyword">if</span> n <span class="keyword">in</span> store:</span><br><span class="line">            <span class="keyword">return</span> store[n]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res = func(n)</span><br><span class="line">            store[n] = res</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">return</span> _</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 用装饰器的方式记录前面的结果    </span></span><br><span class="line"><span class="meta">@cache </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span>(<span class="params">n</span>):</span>       <span class="comment"># 斐波那契数列</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> fib(n - <span class="number">1</span>) + fib(n - <span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/mian-xiang-dui-xiang-bian-cheng-oop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/mian-xiang-dui-xiang-bian-cheng-oop/" class="post-title-link" itemprop="url">面向对象编程OOP</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-14 05:24:48" itemprop="dateModified" datetime="2021-04-14T05:24:48Z">2021-04-14</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>面向对象编程 Object Oriented Programming（OOP）<br>面向对象的设计思想是 描述现实世界<br>把对象作为基本单元，把对象抽象成类(Class)，包含成员(属性)和方法(用来操作成员)。<br>根据Class创建Instance。</p>
<p>面向对象三大特点：</p>
<ul>
<li>封装：对外部隐藏有关对象工作原理的细节，提供一些可以被外界访问的属性的方法</li>
<li>继承：使用现有类的所有功能，并在无需重新编写原来的类的情况下对这些功能进行扩展</li>
<li>多态：子类重写父类方法</li>
</ul>
<p>Python 中使用类来实现。过程式编程(函数)，OOP(类)<br>(object)，表示该类是从哪个类继承下来的，<br>默认继承object类，可不写<br>创建类</p>
<p>每个实例化的对象当使用完成之后，都会被内存官家回收，我们普通的进程也会伴随着创建与关闭的过程<br>Python严格要求方法需要有实例才能被调用，这种限制其实就是Python所谓的绑定概念</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params">object</span>):</span> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age</span>):</span>  <span class="comment"># 构造方法用来初始化成员(属性)</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        </span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">print_name</span>(<span class="params">self</span>)：          # 操作成员(<span class="params">属性</span>)的类的方法</span></span><br><span class="line"><span class="function">         <span class="title">print</span>(<span class="params"><span class="string">'my name is {}'</span>.format(<span class="params">self.name</span>)</span>)</span></span><br></pre></td></tr></tbody></table></figure>
<pre><code>变量名前加单下划线表示的是 protected 类型的变量，即保护类型只能允许其本身与子类进行访问，如：self._sex = 0  。

变量名前加双下划线表示的是 私有类型(private)的变量, 只能是允许这个类本身进行访问了。如：self.__foo = 0。

Python在名称前后加双下划线表示的是特殊方法（魔术方法），一般是系统定义名字，如：def __len__(self): .....。
</code></pre>
<p>2.classmethod / staticmethod区别  (它们两个经常被用作类方法的装饰器)</p>
<ul>
<li><p>都可以通过 Class.method() 的方式调用</p>
</li>
<li><p>类方法：定义加@classmethod，类方法关联的是类，通常用来操作类变量，第一个形参是 cls，cls代表的是调用的类，类方法不会被自动调用，（也可以是别的，建议cls）<br>类方法可以通过类名.方法名()和实例名.方法名()两种方法进行调用<br>在类方法中访问类变量，用cls.变量名访问；<br>可以用类也可以用对象调用类方法（但是不建议用对象调用类方法，毕竟逻辑不符），<br>在类方法中不可以访问实例变量。</p>
</li>
<li><p><code>staticmethod</code> 静态方法，使用起来和普通函数一样，只不过放在类里去组织<br>类的静态方法可以通过类名.方法名()调用<br>类的静态方法可以通过实例名.方法名()调用<br>staticmethod是代码组织的需要，完全可以放到类之外<br>并没有引用当前类的任何东西，可以把staticmethod理解为本来该放到外面的函数只是给塞到类里。其实跟类并没有什么关系，相当于给了它一个作用范围，让它可以在类里面去使用</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Persion</span>:</span></span><br><span class="line">    Country = <span class="string">'China'</span>   <span class="comment"># class var</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod        </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_country</span>(<span class="params">cls</span>):</span>   </span><br><span class="line">        print(cls.Country)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">join_name</span>(<span class="params">first_name, last_name</span>):</span></span><br><span class="line">        <span class="keyword">return</span> last_name + first_name    <span class="comment"># last_name 姓</span></span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, x, y</span>):</span></span><br><span class="line">        self.x = x</span><br><span class="line">        self.y = y</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'点的位置:({0}, {1})'</span>.format(self.x, self.y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    p = Point(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">    print(p)  <span class="comment"># 点的位置:(1, 2)</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDate</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="string">"""自己实现的日期类"""</span></span><br><span class="line">    source = <span class="string">'ioomc'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, month, day</span>):</span></span><br><span class="line">        <span class="string">"""构造方法"""</span></span><br><span class="line">        self.month = month</span><br><span class="line">        self.day = day</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show_info</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""展示日期详情"""</span></span><br><span class="line">        print(<span class="string">'月份: {0}; 日期: {1}'</span>.format(self.month, self.day))</span><br><span class="line">        print(<span class="string">'实例方法访问类的属性: {0}'</span>.format(self.source))</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validate_month</span>(<span class="params">month</span>):</span></span><br><span class="line">        <span class="string">"""静态方法，验证我们的月份是否合法"""</span></span><br><span class="line">        month = int(month)</span><br><span class="line">        print(<span class="string">'类的属性: {}'</span>.format(MyDate.source))</span><br><span class="line">        <span class="comment"># return month &gt;= 1 and month &lt;= 12</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> &lt;= month &lt;= <span class="number">12</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    my_date = MyDate(<span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 实例方法的调用</span></span><br><span class="line">    my_date.show_info()</span><br><span class="line">    <span class="comment"># 月份: 5; 日期: 20</span></span><br><span class="line">    <span class="comment"># 实例方法访问类的属性: ioomc</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 静态方法的调用</span></span><br><span class="line">    print(MyDate.validate_month(<span class="string">'15'</span>))</span><br><span class="line">    <span class="comment"># 类的属性: ioomc</span></span><br><span class="line">    <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line">    print(my_date.validate_month(<span class="string">'11'</span>))</span><br><span class="line">    <span class="comment"># 类的属性: ioomc</span></span><br><span class="line">    <span class="comment"># True</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, score</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.score = score</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_score</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">'%s: %s'</span> % (self.name, self.score))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bart = Student(<span class="string">'Bart Simpson'</span>, <span class="number">59</span>)</span><br><span class="line">lisa = Student(<span class="string">'Lisa Simpson'</span>, <span class="number">87</span>)</span><br><span class="line">bart.print_score()  <span class="comment"># Bart Simpson: 59</span></span><br><span class="line">lisa.print_score()  <span class="comment"># Lisa Simpson: 87</span></span><br></pre></td></tr></tbody></table></figure>

<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python3-he-python2-chai-yi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python3-he-python2-chai-yi/" class="post-title-link" itemprop="url">Python3和python2差异</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:45" itemprop="dateModified" datetime="2021-04-02T12:24:45Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Python关键字</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> keyword</span><br><span class="line">print(keyword.kwlist)</span><br><span class="line"><span class="comment"># ['False', 'None', 'True', 'and', 'as', 'assert', 'break', 'class', 'continue', 'def', 'del',</span></span><br><span class="line"><span class="comment"># 'elif', 'else', 'except', 'finally', 'for', 'from', 'global', 'if', 'import', 'in', 'is', 'lambda',</span></span><br><span class="line"><span class="comment"># 'nonlocal', 'not', 'or', 'pass', 'raise', 'return', 'try', 'while', 'with', 'yield']</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="print"><a href="#print" class="headerlink" title="print"></a>print</h3><p>python2中是关键字。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python2的打印 print</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> <span class="string">'b'</span></span><br><span class="line">b</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'a'</span>, <span class="string">'b'</span>) <span class="comment"># 打印的是a和b合并成tuple对象</span></span><br><span class="line">(<span class="string">'a'</span>, <span class="string">'b'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>python3成为函数就支持传入不同参数，比如不同换行符end或者分隔符sep</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3的打印 print()</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'b'</span>)</span><br><span class="line">b</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'a'</span>, <span class="string">'b'</span>,sep=<span class="string">'|'</span> ) <span class="comment"># sep:分隔符，end:换行符</span></span><br><span class="line">a|b</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'a'</span>, <span class="string">'b'</span>)</span><br><span class="line">a b</span><br></pre></td></tr></tbody></table></figure>

<p>计算机是 以字节为单位 来 存储和传输数据的，</p>
<blockquote>
<p>一个字节 由 8位二进制数字表示，最多可以表示从0到255，一共256个字符。</p>
</blockquote>
<p>Python中字符串的类型只有两种（str，bytes）文本字符串和字节字符串。<br>其中文本字符串类型被命名为str，内部采用Unicode字符集（兼容ASCII码），<br>而字节字符串则直接用来表示原始的字节序列（用print函数来打印字节字符串时，若字节在ascii码范围内，则显示为ascii码对应的字符，其余的则直接显示为16进制数），该类型被命名为bytes。</p>
<p>有三种前缀</p>
<ul>
<li><p>无前缀<br>一般英文字符在使用各种编码下, 基本都可以正常解析, 所以一般不带u；<br>但是中文, 必须表明所需编码, 否则一旦编码转换就会出现乱码。</p>
</li>
<li><p>前缀u/U:<br>一个具体的unicode字符表示法<code>\uxxxx</code>，<code>\u</code>会自动去寻找后面4位16进制数，然后去Unicode字符集寻找对应的字符来显式输出。<br>不是仅仅是针对中文, 可以针对任何的字符串，代表是对字符串进行unicode编码。</p>
</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义变量存放unicode编码表示的字符</span></span><br><span class="line"><span class="keyword">char</span> c = <span class="string">'\u005d'</span>;</span><br><span class="line">System.out.println(<span class="string">"c="</span> + c);  <span class="comment">// c=]</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>前缀b: bytes 文件操作模式会用到 可存储到文件或者传输到网络中</li>
</ul>
<h3 id="Python3"><a href="#Python3" class="headerlink" title="Python3"></a>Python3</h3><p>字符串str==unicode，是和人交互的，用来操作的，前缀带不带u，其实都一样。<br>每个字符用字符本身或者\u1234，来表示都可以，<br>后者则是直接是Unicode编码。但打印时都是打印字符本身。</p>
<p>想在py3里看字符，必须得是unicode编码，其它编码一律按bytes格式展示。<br>unicode是某种特定编码的字节流，是bytes的子集。这就意味着：所有的unicode都能放进bytes，但某些bytes无法放进unicode。<br>不是utf-8，utf-8编码的是bytes</p>
<p>字节串bytes!=str：计算机自己能理解的“语言”是二进制数，最小的信息标识是二进制位，给计算机传输或者保存的 字节是将unicode编码后的utf或gbk字节串，bytes是(py2.x)的str<br>不能print，直接print你decode出来的那个str就行了，不需要再encode</p>
<h3 id="python2"><a href="#python2" class="headerlink" title="python2"></a>python2</h3><p>字符串有两种字符串类型unicode，str和是python3中的byte，<br>bytes==str<br>unicode!=str</p>
<p>python里写入文件出现乱码通常都是因为编码导致的。很多人说我已经encode设置为utf-8了呀，怎么还会出现乱码呢？<br>其实这里涉及到2个编码的问题<br>1、字符串的编码，比如我们爬虫返回的text的编码<br>2、文件的编码<br>要想不出现编码，必须保证文字的编码和文件的编码一致。</p>
<p>编码和解码就是Python中str和bytes这两种字符串类型之间的互相转换。</p>
<p><code>str.encode(encoding='UTF-8', errors='strict')</code><br>以指定的编码格式编码，把str类型的字符串转换为bytes字符串，字符对应的若干十六进制数，</p>
<figure class="highlight plain"><figcaption><span>如```\xc9```，代表两位16进制，一个字节</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">- encoding -- 要使用的编码</span><br><span class="line">   - ```utf-8``` ```UTF8``` 用三个十六进制 3个字节 来表示一个中文字符，</span><br><span class="line"></span><br><span class="line">   - ```gbk```编码中文用 二个十六进制 2个字节Bytes 来表示一个中文字符，</span><br><span class="line">每个bytes，即8位bit的第一个位作为标志位，</span><br><span class="line">标志位为1则表示是中文字符，如果标志位为0则表示为英文字符</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line">import sys</span><br><span class="line">print(sys.platform)  # win32</span><br><span class="line">print(sys.getdefaultencoding())  # utf-8</span><br><span class="line"># 平台默认选择的就是utf-8编码方式。</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>errors – 设置不同错误的处理方案。默认为 ‘strict’，意为编码错误引起一个UnicodeError。 其他可能得值有 ‘ignore’, ‘replace’, ‘xmlcharrefreplace’, ‘backslashreplace’ 以及通过 codecs.register_error() 注册的任何值。<br>该方法返回编码后的字符串，它是一个 bytes 对象。</li>
</ul>
<p><code>bytes.decode(encoding="utf-8", errors="strict")</code><br>以指定的编码格式解码 bytes 对象。</p>
<ul>
<li>encoding – 要使用的编码，默认编码为 ‘utf-8’。</li>
<li>errors – 设置不同错误的处理方案。默认为 ‘strict’,意为编码错误引起一个UnicodeError。<br>其他可能得值有 ‘ignore’, ‘replace’, ‘xmlcharrefreplace’, ‘backslashreplace’ 以及通过 codecs.register_error() 注册的任何值。</li>
</ul>
<p>从文件中读入文字信息， 从网络上接收 文字信息，获取的数据通常是使用某种字符编码后的 字节串</p>
<p>当python解释器执行到产生字符串的代码时（例如x=’上’），<br>会申请新的内存地址，然后将’上’编码成文件开头指定的编码格式</p>
<p>想看x在内存中的真实格式，可以将其放入列表中再打印，<br>而不要直接打印，因为直接print()会自动转换编码，</p>
<p>字符串编码转换</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python2 编码</span></span><br><span class="line"><span class="comment"># coding:gbk</span></span><br><span class="line">x=<span class="string">'上'</span></span><br><span class="line">y=<span class="string">'下'</span></span><br><span class="line">print([x,y]) <span class="comment"># ['\xc9\xcf', '\xcf\xc2']</span></span><br><span class="line">print(type(x),type(y)) <span class="comment"># (&lt;type 'str'&gt;, &lt;type 'str'&gt;)</span></span><br><span class="line"><span class="comment"># c9cf总共4位16进制数，</span></span><br><span class="line"><span class="comment"># 一个16进制 4个比特位</span></span><br><span class="line"><span class="comment"># 4个16进制数则是16个比特位，即2个Bytes</span></span><br><span class="line"></span><br><span class="line">x=<span class="string">'上'</span>.decode(<span class="string">'gbk'</span>)</span><br><span class="line">y=<span class="string">'下'</span>.decode(<span class="string">'gbk'</span>)</span><br><span class="line">print([x,y]) <span class="comment">#[u'\u4e0a', u'\u4e0b']</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">u'中文'</span> <span class="comment"># python2中定义包含中文字符串必须加U前缀</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(s)</span><br><span class="line">&lt;type <span class="string">'unicode'</span>&gt;</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3 编码</span></span><br><span class="line">string = <span class="string">u'中文'</span>  </span><br><span class="line"><span class="comment"># 加u，'中文'也会被以unicode形式保存新的内存空间中</span></span><br><span class="line">print(string, type(string), len(string))  <span class="comment"># 中文 &lt;class 'str'&gt; 2</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">'中文'</span>  </span><br><span class="line"><span class="comment"># 无需加u，'中文'也会被以unicode形式保存新的内存空间中</span></span><br><span class="line">print(s, type(s), type(s), len(s))  <span class="comment"># 中文 &lt;class 'str'&gt; 2</span></span><br><span class="line"></span><br><span class="line">print(string == s)  <span class="comment"># True</span></span><br><span class="line">print(string <span class="keyword">is</span> s)  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 Unicode 编码格式字符串转换成 UTF-8</span></span><br><span class="line">print(s.encode(), type(s.encode()), len(s.encode()))  <span class="comment"># 默认UTF-8</span></span><br><span class="line"><span class="comment"># b'\xe4\xb8\xad\xe6\x96\x87' &lt;class 'bytes'&gt; 6</span></span><br><span class="line"><span class="comment"># utf-8是多字节编码，你的\xe4\xb8\xad合起来是一个字符，</span></span><br><span class="line"><span class="comment"># 而unicode里面，\xe4, \xb8, \xad各自是一个字符，</span></span><br><span class="line"><span class="comment"># 相当于\u00e4, \u00b8, \u00ad，所以当然是乱码了</span></span><br><span class="line"></span><br><span class="line">print(s.encode(encoding=<span class="string">"UTF8"</span>, type(s.encode()), len(s.encode())),</span><br><span class="line">      type(s.encode(encoding=<span class="string">"UTF-8"</span>)))</span><br><span class="line"><span class="comment"># b'\xe4\xb8\xad\xe6\x96\x87' &lt;class 'bytes'&gt;</span></span><br><span class="line"></span><br><span class="line">print(s.encode(encoding=<span class="string">"UTF-8"</span>, type(s.encode()), len(s.encode())),</span><br><span class="line">      type(s.encode(encoding=<span class="string">"UTF-8"</span>)))</span><br><span class="line"><span class="comment"># b'\xe4\xb8\xad\xe6\x96\x87' &lt;class 'bytes'&gt;</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">b'\xe4\xb8\xad\xe6\x96\x87'</span>.decode(<span class="string">"UTF-8"</span>),\</span><br><span class="line">    type(<span class="string">b'\xe4\xb8\xad\xe6\x96\x87'</span>.decode(<span class="string">"UTF-8"</span>)),len(<span class="string">b'\xe4\xb8\xad\xe6\x96\x87'</span>.decode(<span class="string">"UTF-8"</span>)))</span><br><span class="line"><span class="comment"># 中文 &lt;class 'str'&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 Unicode 编码格式字符串 转换成 GBK 编码</span></span><br><span class="line">print(s.encode(<span class="string">"GBK"</span>), type(s.encode(<span class="string">"GBK"</span>)), len(s.encode(<span class="string">"GBK"</span>)))</span><br><span class="line"><span class="comment"># b'\xd6\xd0\xce\xc4' &lt;class 'bytes'&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 GBK 编码格式字符串 转化成 Unicode</span></span><br><span class="line">print(<span class="string">b'\xd6\xd0\xce\xc4'</span>.decode(<span class="string">'GBK'</span>),\</span><br><span class="line">    type(<span class="string">b'\xd6\xd0\xce\xc4'</span>.decode(<span class="string">'GBK'</span>, <span class="string">'strict'</span>)),len(<span class="string">b'\xd6\xd0\xce\xc4'</span>.decode(<span class="string">'GBK'</span>, <span class="string">'strict'</span>)))</span><br><span class="line"><span class="comment"># 中文 &lt;class 'str'&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 只有ascii字符集中的字符，三种编码方式得到的结果才完全一致。</span></span><br><span class="line">print(<span class="string">'abc'</span>.encode())  <span class="comment"># b'abc'</span></span><br><span class="line">print(<span class="string">'abc'</span>.encode(<span class="string">'GBK'</span>))  <span class="comment"># b'abc'</span></span><br><span class="line">print(<span class="string">'abc'</span>.encode(<span class="string">'latin-1'</span>))  <span class="comment"># b'abc'</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> 大写(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> s.upper()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(大写(<span class="string">'abc'</span>))  <span class="comment"># 'ABC'</span></span><br></pre></td></tr></tbody></table></figure>

<p>如果**<em>type(text) is str**</em>，<br>那么<code>text.encode(‘latin1’).decode(‘unicode_escape’)</code></p>
<p>如果**<em>type(text) is bytes**</em>，<br>那么<code>text.decode('unicode_escape')</code></p>
<h3 id="unicode-escape-unicode-escape-的解码与编码规则，"><a href="#unicode-escape-unicode-escape-的解码与编码规则，" class="headerlink" title="unicode_escape unicode-escape 的解码与编码规则，"></a>unicode_escape unicode-escape 的解码与编码规则，</h3><p>编码用unicode数字字符串表示字符</p>
<p>解码碰到\会去掉一个\，编码的时候会添上一个,<br>所以就解释了b’\uxxxx’就是b’\uxxxx’ ，<br>因为\u的情况下面，根本不可能出现一个\的情况。<br>所以总的思路是出现’\uxxxx’的字符串，首先通过一种常规的字符编码方式utf8 gbc随便你，<br>转换成b’\uxxxx’的形式，然后再通过’unicode_escape’的编码解码，变成’\uxxxx’的形式，</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'中文'</span>.encode(<span class="string">'unicode_escape'</span>))</span><br><span class="line"><span class="comment"># b'\\u4e2d\\u6587'</span></span><br><span class="line">print(<span class="string">'中文'</span>.encode(<span class="string">'unicode-escape'</span>))</span><br><span class="line"><span class="comment"># b'\\u4e2d\\u6587'</span></span><br><span class="line">print(type(<span class="string">'中文'</span>.encode(<span class="string">'unicode_escape'</span>)), len(<span class="string">'中文'</span>.encode(<span class="string">'unicode_escape'</span>)))</span><br><span class="line"><span class="comment"># &lt;class 'bytes'&gt; 12</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 一个反斜杠 unicode转义数字 写字符串</span></span><br><span class="line">print(<span class="string">'\u4e2d\u6587'</span>, type(<span class="string">'\u4e2d\u6587'</span>), len(<span class="string">'\u4e2d\u6587'</span>))</span><br><span class="line"><span class="comment"># 中文 &lt;class 'str'&gt; 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Python的字符串中应该不会出现'\uxxxx'的字符。</span></span><br><span class="line"><span class="comment"># 如果出现了，那应该是'\\uxxxx'注意前面应该是两个反斜杠，直接把\u的反斜杠转义了</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">r'\u5bb6'</span>)  <span class="comment"># \u5bb6 </span></span><br><span class="line">print(<span class="string">b'\u5bb6'</span>)  <span class="comment"># b'\\u5bb6'</span></span><br><span class="line">print(<span class="string">b'\u5bb6'</span>.decode(<span class="string">'unicode_escape'</span>))  <span class="comment"># 家</span></span><br><span class="line">print(<span class="string">'\u5bb6'</span>)  <span class="comment"># 家</span></span><br><span class="line">print(<span class="string">'\\u5bb6'</span>)  <span class="comment"># \u5bb6</span></span><br><span class="line">print(<span class="string">'\\u5bb6'</span>.encode())  <span class="comment"># b'\\u5bb6'</span></span><br><span class="line">print(<span class="string">'\\u5bb6'</span>.encode().decode())  <span class="comment"># \u5bb6</span></span><br><span class="line">print(<span class="string">'\\u5bb6'</span>.encode().decode(<span class="string">'unicode_escape'</span>))  <span class="comment"># 家</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'\\u5bb6'</span>.encode(<span class="string">'unicode_escape'</span>))  <span class="comment"># b'\\\\u5bb6'</span></span><br><span class="line">print(<span class="string">'\\u5bb6'</span>.encode(<span class="string">'unicode_escape'</span>).decode(<span class="string">'unicode_escape'</span>))  <span class="comment"># \u5bb6</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">b = <span class="string">b'apple'</span></span><br><span class="line">print(b, type(b))</span><br><span class="line"><span class="comment"># b'apple' &lt;class 'bytes'&gt;</span></span><br><span class="line">print(b[<span class="number">0</span>])  <span class="comment"># 97</span></span><br><span class="line">print(b[<span class="number">1</span>:])  <span class="comment"># b'pple'</span></span><br><span class="line">print(list(b))  <span class="comment"># [97, 112, 112, 108, 101]</span></span><br><span class="line"></span><br><span class="line">userInputTag = [<span class="string">"\xe5\x8f\xa4\xe8\xbf\xb9"</span>, <span class="string">"\xe5\xbb\xba\xe7\xad\x91"</span>]</span><br><span class="line">print(userInputTag[<span class="number">0</span>].encode(<span class="string">'latin-1'</span>).decode(<span class="string">'utf-8'</span>), type(userInputTag[<span class="number">0</span>]))</span><br><span class="line"><span class="comment"># 古迹 &lt;class 'str'&gt;</span></span><br></pre></td></tr></tbody></table></figure>


<h3 id="除法变化"><a href="#除法变化" class="headerlink" title="除法变化"></a>除法变化</h3><p>Python3除号返回浮点数，<br>Python2中直接截断并且返回整数，像是C语言的除法</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python2中除法</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">5</span>/<span class="number">2</span></span><br><span class="line"><span class="number">2</span>  <span class="comment"># 会做整数截断，只保留整数值 </span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3中除法</span></span><br><span class="line">print(<span class="number">5</span>/<span class="number">2</span>)  <span class="comment"># 2.5  float的值</span></span><br><span class="line">print(<span class="number">5</span>//<span class="number">2</span>)  <span class="comment"># 2 实现python2一样除法</span></span><br><span class="line">print(<span class="number">-5</span>//<span class="number">2</span>)  <span class="comment"># -3 实现python2一样除法</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="类型注解-type-hint-。"><a href="#类型注解-type-hint-。" class="headerlink" title="类型注解(type hint)。"></a>类型注解(type hint)。</h3><p>给变量添加类型提示<br>IDE可以根据它检查类型是否一致。<br>解释器运行时，并不会做检查</p>
<p>Once compiled, a function’s annotations are available via the function’s <strong>annotations</strong> attribute.<br>This attribute is a mutable dictionary,s<br>There is a special key in the <strong>annotations</strong> mapping, “return”.<br>This key is present only if an annotation was supplied for the function’s return value.<br>如果该函数上没有注释，或者该函数是从lambda表达式创建的，则__annotations__是一个空的可变字典。<br>第一行输出中的__annotations__是函数的保留属性，保存的是函数声明中的注释内容，</p>
<p>使用dir(fucntionName)的时候，多了一个__annotations__的属性annotations：注解; 评注; 注文; 释文</p>
<p>Python 3 extends the feature by allowing you to attach metadata<br>to functions describing their parameters and return values<br>为了标注 输入参数参数和返回值的类型。<br>“-&gt;” 函数返回值的类型建议符，<br>类型建议符并非强制规定和检查，也就是说即使传入的实际参数与建议参数不符，也不会报错。<br>-&gt; str 意思即是提醒函数使用者返回值会是一个str型。<br>:后面是建议传入的参数类型，</p>
<p>使用第三方工具mypy实现类型检查，消除一些代码错误</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># name:str 表示输入的name的值是str类型, -&gt; st 表示返回值是str类型</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">name: str</span>) -&gt; str:</span>  <span class="comment"># 起到提示作用，并没有实现真正类型检查</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'hello '</span> + name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(hello(<span class="string">'Ashe'</span>))</span><br><span class="line"><span class="comment"># hello Ashe</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">greeting</span>(<span class="params">name: str</span>) -&gt; str:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Hello '</span> + name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(greeting.__annotations__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span>(<span class="params">a: <span class="string">'x'</span>, b: <span class="number">5</span> + <span class="number">6</span>, c: list</span>) -&gt; max(2, 9):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(foo.__annotations__)</span><br><span class="line"><span class="comment"># {'a': 'x', 'b': 11, 'c': &lt;class 'list'&gt;, 'return': 9}</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">twoSum</span>(<span class="params">num1: int, num2: int = <span class="number">100</span></span>) -&gt; int:</span></span><br><span class="line">    sum = num1 + num2</span><br><span class="line">    <span class="keyword">return</span> sum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">'-----'</span>)</span><br><span class="line">print(dir(twoSum))</span><br><span class="line"><span class="comment"># output: ['__annotations__', '__call__', '__class__', '__closure__', ... ]</span></span><br><span class="line">print(twoSum.__annotations__)</span><br><span class="line"><span class="comment"># {'num1': &lt;class 'int'&gt;, 'num2': &lt;class 'int'&gt;, 'return': &lt;class 'int'&gt;}</span></span><br><span class="line">print(twoSum(<span class="number">1</span>, <span class="number">2</span>))  <span class="comment"># 3</span></span><br><span class="line">print(twoSum(<span class="number">1</span>))  <span class="comment"># 101</span></span><br><span class="line">print(twoSum(<span class="string">'I love '</span>, <span class="string">'python'</span>))  <span class="comment"># I love python</span></span><br><span class="line"><span class="comment"># print(twoSum('python'))  # TypeError: can only concatenate str (not "int") to str</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">第二行输出是正常用法。</span></span><br><span class="line"><span class="string">第三行输出验证了：注释内容后可以跟等号"=",意思为未传入实参时，该参数获得的默认值</span></span><br><span class="line"><span class="string">第四行输出则验证了该解释说明符并非强制检查，我们传入了两个str实参，</span></span><br><span class="line"><span class="string">并不会报错，而是继续进行函数中的加法运算。</span></span><br><span class="line"><span class="string">如果传入的两个实参无法进行函数中规定的运算，则会正常报错。</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kinetic_energy</span>(<span class="params">m: <span class="string">'in KG'</span>, v: <span class="string">'in M/S'</span></span>) -&gt; 'Joules':</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> / <span class="number">2</span> * m * v ** <span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(kinetic_energy.__annotations__)</span><br><span class="line"><span class="comment"># {'m': 'in KG', 'v': 'in M/S', 'return': 'Joules'}</span></span><br><span class="line">print(<span class="string">'{:,} {}'</span>.format(kinetic_energy(<span class="number">20</span>, <span class="number">3000</span>),</span><br><span class="line">                       kinetic_energy.__annotations__[<span class="string">'return'</span>]))</span><br><span class="line"><span class="comment"># 90,000,000.0 Joules</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Annotations are dictionaries</span></span><br><span class="line"><span class="comment"># There is a special key in the __annotations__ mapping, "return".</span></span><br><span class="line"><span class="comment"># This key is present only if an annotation was supplied for the function's return value.</span></span><br><span class="line">rd = {<span class="string">'type'</span>: float, <span class="string">'units'</span>: <span class="string">'Joules'</span>, <span class="string">'docstring'</span>: <span class="string">'Given mass and velocity returns kinetic energy in Joules'</span>}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>() -&gt; rd:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(f.__annotations__[<span class="string">'return'</span>][<span class="string">'type'</span>])</span><br><span class="line"><span class="comment"># &lt;class 'float'&gt;</span></span><br><span class="line">print(f.__annotations__[<span class="string">'return'</span>][<span class="string">'units'</span>])</span><br><span class="line"><span class="comment"># 'Joules'</span></span><br><span class="line">print(f.__annotations__[<span class="string">'return'</span>][<span class="string">'docstring'</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 'Given mass and velocity returns kinetic energy in Joules'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># you can use function attributes to validate called values:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">validate</span>(<span class="params">func, locals</span>):</span></span><br><span class="line">    <span class="keyword">for</span> var, test <span class="keyword">in</span> func.__annotations__.items():</span><br><span class="line">        value = locals[var]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            pr = test.__name__ + <span class="string">': '</span> + test.__docstring__</span><br><span class="line">        <span class="keyword">except</span> AttributeError:</span><br><span class="line">            pr = test.__name__</span><br><span class="line">        msg = <span class="string">'{}=={}; Test: {}'</span>.format(var, value, pr)</span><br><span class="line">        <span class="keyword">assert</span> test(value), msg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">between</span>(<span class="params">lo, hi</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_between</span>(<span class="params">x</span>):</span></span><br><span class="line">        <span class="keyword">return</span> lo &lt;= x &lt;= hi</span><br><span class="line"></span><br><span class="line">    _between.__docstring__ = <span class="string">'must be between {} and {}'</span>.format(lo, hi)</span><br><span class="line">    <span class="keyword">return</span> _between</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x: between(<span class="params"><span class="number">3</span>, <span class="number">10</span></span>), y: lambda _y: isinstance(<span class="params">_y, int</span>)</span>):</span></span><br><span class="line">    validate(f, locals())</span><br><span class="line">    print(x, y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f(<span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment"># AssertionError: x==2; Test: _between: must be between 3 and 10</span></span><br><span class="line">f(<span class="number">3</span>, <span class="number">2.1</span>)</span><br><span class="line"><span class="comment"># AssertionError: y==2.1; Test: &lt;lambda&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="优化的-super-方便直接调用父类函数"><a href="#优化的-super-方便直接调用父类函数" class="headerlink" title="优化的 super() 方便直接调用父类函数"></a>优化的 super() 方便直接调用父类函数</h3><pre><code>  super().eat()  # 直接就可以调用父类，像什么 self 都不必传递
</code></pre>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">'hello'</span>)</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>(<span class="params">Base</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># py2，显示调用父类方法</span></span><br><span class="line">        <span class="keyword">return</span> super(C, self).hello()</span><br><span class="line"> </span><br><span class="line">c = C()</span><br><span class="line">c.hello()   <span class="comment"># hello</span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C2</span>(<span class="params">Base</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># py3，显示调用父类方法</span></span><br><span class="line">        <span class="keyword">return</span> super().hello()</span><br><span class="line"> </span><br><span class="line">c2 = C2()</span><br><span class="line">c2.hello()  <span class="comment"># hello</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="高级解包操作"><a href="#高级解包操作" class="headerlink" title="高级解包操作"></a>高级解包操作</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python2中无解包操作</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a, b, c = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a,b,c</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a, b, *c = range(<span class="number">10</span>)  </span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span></span><br><span class="line">    a, b, *c = range(<span class="number">10</span>)</span><br><span class="line">          ^</span><br><span class="line">SyntaxError: invalid syntax</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3中解包操作</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a, b, *c = range(<span class="number">10</span>)  </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c</span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]  <span class="comment"># 剩下的元素全部赋值给c</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a, b, *_ = range(<span class="number">5</span>)  <span class="comment"># 丢弃2,3,4元素</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="限定关键字参数"><a href="#限定关键字参数" class="headerlink" title="限定关键字参数"></a>限定关键字参数</h3><p>当参数特别多的时候，想把后面参数指定名字进行传入，<br>限定关键字参数需要指定参数名传参，<br>关键字参数实际就是传入值得时候指定值的参数名字，</p>
<p>Keyword only arguments 关键字参数<br>根据参数名来传入参数值，则无须遵守定义形参的顺序，<br>以param = value的方式传递数据</p>
<p>使用关键字参数好处 :<br>①关键字参数顺序也可以不按函数声明参数的顺序。可以防止参数的位置顺序搞混<br>②清晰地指出了参数值，有助于提高程序的可读性</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">a, b, *, c</span>):</span></span><br><span class="line">    <span class="comment"># python3中支持语法，要显示转入c的值，前面加一个参数*号就行。</span></span><br><span class="line">    <span class="keyword">return</span> a + b + c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># c = 3 就是限定关键字参数方式</span></span><br><span class="line">print(add(<span class="number">1</span>, <span class="number">2</span>, c=<span class="number">3</span>))</span><br></pre></td></tr></tbody></table></figure>


<h3 id="Chained-exception-连接异常-。"><a href="#Chained-exception-连接异常-。" class="headerlink" title="Chained exception(连接异常)。"></a>Chained exception(连接异常)。</h3><p>Python3重新抛出异常不会丢失栈信息，有 raise from 保留异常栈信息<br>python2重新抛出异常会丢失栈信息、原来的 traceback 信息</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```python</span><br><span class="line">import shutil</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def mycopy(source, dest):</span><br><span class="line">    # Python3中支持 raise from保留异常栈信息</span><br><span class="line">    try:</span><br><span class="line">        shutil.copy2(source, dest)</span><br><span class="line">    except OSError: # python2中raise会丢失原来的 traceback信息</span><br><span class="line">        raise NotImplementedError("automatic sudo injection") from OSError</span><br><span class="line">        # 这样会把所有栈信息抛出，有利于去排错</span><br><span class="line">  </span><br><span class="line">mycopy('old', 'new')</span><br><span class="line">输出结果：</span><br><span class="line"># OSError</span><br><span class="line"> </span><br><span class="line"># The above exception was the direct cause of the following exception:</span><br><span class="line"> </span><br><span class="line"># Traceback (most recent call last):</span><br><span class="line">#   File "chain_exception.py", line 12, in &lt;module&gt;</span><br><span class="line">#     mycopy('old', 'new')</span><br><span class="line">#   File "chain_exception.py", line 9, in mycopy</span><br><span class="line">#     raise NotImplementedError("automatic sudo injection") from OSError</span><br><span class="line"># NotImplementedError: automatic sudo injection</span><br></pre></td></tr></tbody></table></figure>


<h3 id="一切都是返回迭代对象-range-zip-map-dict-values-etc-are-all-iterators。"><a href="#一切都是返回迭代对象-range-zip-map-dict-values-etc-are-all-iterators。" class="headerlink" title="一切都是返回迭代对象 range, zip, map, dict.values, etc, are.all iterators。"></a>一切都是返回迭代对象 range, zip, map, dict.values, etc, are.all iterators。</h3><p>python2中range和map返回的都是列表，当这个列表非常大时候会非常消耗内存，<br>python3中很多内置函数之前返回列表的现在返回是迭代器，迭代器是”惰性加载”的，这样会省很多内存<br>如果我们需要显示得到一个列表时候，我么就需要list进行强转一下)，返回列表会消耗大的内存</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python2中</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>range(<span class="number">10</span>)</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]  <span class="comment"># 返回列表</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(type(range(<span class="number">10</span>)))</span><br><span class="line">&lt;type <span class="string">'list'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(xrange(<span class="number">10</span>))</span><br><span class="line">xrange(<span class="number">10</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">100</span>):print(i) </span><br><span class="line"><span class="comment"># python2中xrange返回可迭代对象，python3中没有xrange函数</span></span><br><span class="line"> </span><br><span class="line">---------------------------------------------------------------</span><br><span class="line"><span class="comment"># python3中</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>range(<span class="number">10</span>)</span><br><span class="line">range(<span class="number">0</span>, <span class="number">10</span>)  <span class="comment"># 返回软加载可迭代对象</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(type(range(<span class="number">10</span>)))</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">range</span>'&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">print</span>(<span class="params">list(<span class="params">range(<span class="params"><span class="number">10</span></span>)</span>)</span>)</span></span><br><span class="line">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]  </span><br><span class="line"> </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):print(i， end=<span class="string">' '</span>)   <span class="comment"># end默认值是'\n'换行，置空表示水平输出</span></span><br><span class="line">...</span><br><span class="line"><span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span></span><br></pre></td></tr></tbody></table></figure>
<p>python3中不再使用dict.iteritems() ，直接使用dict.items()方法就可以返回可迭代对象。</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python-chang-yong-nei-zhi-suan-fa-he-shu-ju-jie-gou/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python-chang-yong-nei-zhi-suan-fa-he-shu-ju-jie-gou/" class="post-title-link" itemprop="url">Python常用内置算法和数据结构</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-12 09:58:07" itemprop="dateModified" datetime="2021-04-12T09:58:07Z">2021-04-12</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Python常用内置算法和数据结构"><a href="#Python常用内置算法和数据结构" class="headerlink" title="Python常用内置算法和数据结构"></a>Python常用内置算法和数据结构</h1><table>
<thead>
<tr>
<th>数据结构/算法</th>
<th>语言内置</th>
<th>内置库</th>
</tr>
</thead>
<tbody><tr>
<td>线性结构</td>
<td>list(列表)/tuple(元祖)</td>
<td>array(数组，不常用)/collections.namedtuple</td>
</tr>
<tr>
<td>链式结构</td>
<td></td>
<td>collections.deque(双端队列)</td>
</tr>
<tr>
<td>字典结构</td>
<td>dict(字典)</td>
<td>collections.Counter(计数器)/OrderedDict(有序字典)/defaultdict</td>
</tr>
<tr>
<td>集合结构</td>
<td>set(集合)/frozenset(不可变集合)</td>
<td></td>
</tr>
<tr>
<td>排序算法</td>
<td>sorted</td>
<td></td>
</tr>
<tr>
<td>二分算法</td>
<td></td>
<td>bisect模块</td>
</tr>
<tr>
<td>堆算法</td>
<td></td>
<td>heapq模块</td>
</tr>
<tr>
<td>缓存算法</td>
<td></td>
<td>functools.lru_cache(Least Recent Used, python3)</td>
</tr>
</tbody></table>
<p>有序数据类型：字符串，列表，元组，集合，字典<br>一般情况下，有序数据类型，可以索引，切片，连接，重复<br>但字典除外，因为d[key]=value</p>
<h3 id="frozenset固定集合"><a href="#frozenset固定集合" class="headerlink" title="frozenset固定集合"></a>frozenset固定集合</h3><p>是不可变、无序的，含有唯一元素的不可迭代的集合，<br>作用：固定集合可以作为字典的键，还可以作为字典的值</p>
<figure class="highlight plain"><figcaption><span>frozenset([iterable])``` 固定集合的构造函数</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">iterable -- 可迭代的对象，比如列表、字典、元组等等。</span><br><span class="line">用可迭代对象创建一个固定的、不能再添加或删除任何元素的集合，返回新的 frozenset 对象，</span><br><span class="line">如果不提供任何参数，默认会生成空的固定集合</span><br><span class="line"></span><br><span class="line">为什么需要冻结的集合（即不可变的集合）呢？因为在集合的关系中，有集合的中的元素是另一个集合的情况，但是普通集合（set）本身是可变的，那么它的实例就不能放在另一个集合中（set中的元素必须是不可变类型）。</span><br><span class="line"></span><br><span class="line">所以，frozenset提供了不可变的集合的功能，当集合不可变时，它就满足了作为集合中的元素的要求，就可以放在另一个集合中了。</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">&gt;&gt;&gt;a = frozenset(range(10))     # 生成一个新的不可变集合</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">frozenset([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span><br><span class="line">&gt;&gt;&gt; b = frozenset('runoob') </span><br><span class="line">&gt;&gt;&gt; b</span><br><span class="line">frozenset(['b', 'r', 'u', 'o', 'n'])   # 创建不可变集合</span><br></pre></td></tr></tbody></table></figure>

<h3 id="collections是Python内建的一个集合模块，提供的一些内置数据结构拓展，"><a href="#collections是Python内建的一个集合模块，提供的一些内置数据结构拓展，" class="headerlink" title="collections是Python内建的一个集合模块，提供的一些内置数据结构拓展，"></a><code>collections</code>是Python内建的一个集合模块，提供的一些内置数据结构拓展，</h3><p>力扣提交时环境中已经有<code>import collections</code></p>
<h3 id="namedtuple"><a href="#namedtuple" class="headerlink" title="namedtuple()"></a>namedtuple()</h3><p>factory function for creating tuple subclasses with named fields<br>创建命名元组子类的工厂函数  具名元组<br>接受类型的名称和属性列表创建一个自定义的 tuple 对象，并且规定了tuple元素的个数，<br>并可以用属性而不是索引来引用tuple的某个元素。<br>作用场景：通过下标不太可读通过属性名称变得比较可读。<br>它具备tuple的不变性</p>
<p>tuple可以表示一个元组，是不可变的集合,例如一个点的二维坐标就可以这样表示成p=(1,2)<br>但是，(1,2)很难看出这个tuple是用来表示一个坐标的</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line">Point = collections.namedtuple(<span class="string">'Point'</span>, <span class="string">'x,y'</span>)  <span class="comment"># 定义一个tuple对象</span></span><br><span class="line">p = Point(<span class="number">1</span>, <span class="number">2</span>)  <span class="comment"># 给x赋值1，y赋值2</span></span><br><span class="line">print(p.x)  <span class="comment"># 1</span></span><br><span class="line">print(p.y)  <span class="comment"># 2</span></span><br><span class="line">print(p[<span class="number">0</span>])  <span class="comment"># 1</span></span><br><span class="line">print(p[<span class="number">1</span>])  <span class="comment"># 2</span></span><br><span class="line">print(p.x == p[<span class="number">0</span>])  <span class="comment"># True</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>deque /dek/<br>list-like container with fast appends and pops on either end<br>类似列表(list)的容器，实现了在两端快速添加(append)和弹出(pop)<br>是为了高效实现插入和删除操作的双向列表，<br>deque可以方便实现 queue (队列 ) / stack (栈)。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line">de = collections.deque()  <span class="comment"># 定义deque对象</span></span><br><span class="line">print(de)  <span class="comment"># deque([])</span></span><br><span class="line">de.append(<span class="number">1</span>)  <span class="comment"># 右边添加1元素</span></span><br><span class="line">de.appendleft(<span class="number">0</span>)  <span class="comment"># 左边添加0元素</span></span><br><span class="line">print(de)  <span class="comment"># deque([0, 1])</span></span><br><span class="line">de.pop()  <span class="comment"># 1 输出右边元素</span></span><br><span class="line">de.popleft()  <span class="comment"># 0 输出左边元素</span></span><br><span class="line">print(de)  <span class="comment"># deque([])</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>Counter<br>dict subclass for counting hashable objects<br>字典的子类，提供了可哈希对象的计数功能，值是一个字典</p>
</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> collections</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c = collections.Counter()   <span class="comment"># 定义Counter对象</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c = collections.Counter(<span class="string">'abcab'</span>) <span class="comment"># 统计字符数目</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c</span><br><span class="line">Counter({<span class="string">'a'</span>: <span class="number">2</span>, <span class="string">'b'</span>: <span class="number">2</span>, <span class="string">'c'</span>: <span class="number">1</span>})   <span class="comment"># 值是一个字典，a是有2个，b是有2个，c是有1个</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c[<span class="string">'a'</span>]  <span class="comment"># 统计字符串每个字符个数</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c.most_common() <span class="comment"># 获取从大到小每个字符数量</span></span><br><span class="line">[(<span class="string">'a'</span>, <span class="number">2</span>), (<span class="string">'b'</span>, <span class="number">2</span>), (<span class="string">'c'</span>, <span class="number">1</span>)]</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> ch <span class="keyword">in</span> <span class="string">'programming'</span>:</span><br><span class="line">      c[ch]=c[ch]+<span class="number">1</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c</span><br><span class="line">Counter({<span class="string">'g'</span>:<span class="number">2</span>,<span class="string">'m'</span><span class="number">2</span>,<span class="string">'r'</span>:<span class="number">2</span>,<span class="string">'a'</span>:<span class="number">1</span>,<span class="string">'i'</span>:<span class="number">1</span>,<span class="string">'o'</span>:<span class="number">1</span>,<span class="string">'n'</span>:<span class="number">1</span>,<span class="string">'p'</span>:<span class="number">1</span>})</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>OrderedDict<br>dict subclass that remembers the order entries were added<br>字典的子类，保存了他们被添加的顺序，key 顺序是第一次插入的顺序。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> collections</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>od = collections.OrderedDict()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>od[<span class="string">'c'</span>] = <span class="string">'c'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>od[<span class="string">'a'</span>] = <span class="string">'a'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>od[<span class="string">'b'</span>] = <span class="string">'b'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(od.keys())</span><br><span class="line">[<span class="string">'c'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>]   <span class="comment"># key的顺序是第一次插入的顺序。</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>defaultdict<br>dict subclass that calls a factory function to supply missing values<br>defaultdict字典的子类，提供了一个工厂函数，为字典查询提供一个默认值</p>
</li>
</ul>
<figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> collections</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dd = collections.defaultdict(int) <span class="comment"># 第一个参数必须是可调用的，否则为None</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dd[<span class="string">'a'</span>]  <span class="comment"># 不存在的key默认为0</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dd[<span class="string">'b'</span>] += <span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dd</span><br><span class="line">defaultdict(&lt;class 'int'&gt;, {'a': 0, 'b': 1})</span><br></pre></td></tr></tbody></table></figure>

<h3 id="Python-dict-set-底层都是哈希表"><a href="#Python-dict-set-底层都是哈希表" class="headerlink" title="Python dict/set 底层都是哈希表"></a>Python dict/set 底层都是哈希表</h3><ul>
<li>哈希表的实现原理, 底层其实就是一个数组, 通过哈希函数把相应的元素映射到一个数组槽里面。</li>
<li>根据哈希函数快速定位一个元素，平均查找时间复杂度O(1)，查找和插入的速度极快，不会随着key的增加而变慢；二分查找</li>
<li>不断加入元素会引起哈希表重新开辟空间，拷贝之前元素到新数组，需要占用大量的内存，内存浪费多。</li>
<li>dict是用来存储键值对（key-value）结构的数据的，</li>
<li>set没有存储对应的value，其实也是存储的键值对，只是默认键和值是相同的,</li>
</ul>
<p>dict是python中的一个可变的数据类型，用{}表示，dict curly bracket 花括号<br>dict的key必须是不可变的数据类型对象，同一个字典中的键必须唯一，如果出现多个相同的键，则最新的键会被记住<br>而value的数据类型可以任意</p>
<p>新版哈希表结构：</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Indices</span><br><span class="line">----------------------------------------------------</span><br><span class="line">None | index | None | None | index | None | index ...</span><br><span class="line">----------------------------------------------------</span><br><span class="line"></span><br><span class="line">Entries</span><br><span class="line">--------------------</span><br><span class="line">hash0   key0  value0</span><br><span class="line">---------------------</span><br><span class="line">hash1   key1  value1</span><br><span class="line">---------------------</span><br><span class="line">hash2   key2  value2</span><br><span class="line">---------------------</span><br><span class="line"><span class="code">        ...</span></span><br><span class="line">---------------------</span><br></pre></td></tr></tbody></table></figure>

<p>集合并不支持索引操作，因为集合本质上是一个哈希表，和列表不一样。所以，同样不可以放入可变对象，<br>因为无法判断两个可变对象是否相等，<br>也就无法保证set内部“不会有重复元素”。</p>
<p>dict根据key来计算value的存储位置，<br>如果每次计算相同的key得出的结果不同，那dict内部就完全混乱了。<br>这个通过key计算位置的算法称为哈希算法（Hash）</p>
<p>{0, 1, 2} set 无序，不能通过索引访问，不重复，用来去重<br>set() 创建一个空集合，<br>{}新建一个空字典<br>{} - {}求两个集合的差集，去掉相同的元素，以前面集合为标准，从一个集合里面去掉后面集合特有的元素<br>{} &amp; {}求两个集合的交集，找两个集合的公有元素<br>{} | {}求两个集合的并集，把两个集合合并在一起，按照从前往后的顺序，去掉相同的元素</p>
<ul>
<li>CPython解释器使用二次探查解决哈希冲突问题</li>
</ul>
<p>哈希冲突<br>当插入一个Entry&lt;k,v&gt;时，将key经过hash计算出的下标中已经存在另一个Entry&lt;k,v&gt;，这时就会产生哈希冲突。哈希冲突主要是是由于哈希函数产生的哈希值是有限的</p>
<p>解决哈希冲突的常用方法有</p>
<ul>
<li>链接法：元素key冲突之后使用一个链表填充相同key 的元素</li>
<li>开放寻址法(探查法) 又分为线性探查和二次探查等，冲突之后根据一种方式(二次探查)寻找下一个可用的槽。( 探查是一次还是二次看使用函数是一次还是二次的)，</li>
</ul>
<p>哈希扩容：HashMap的初始值是16（1,&lt;&lt;4）,负载因子0.75（听说这个值是经过大量实践算出来的，这个值设定最合理），初始值16指的是数组的长度（1&lt;&lt;4是2的4次方，这样写计算机执行更快），当数组的容量达到12（16*0.75）时，这时开始扩容，扩容为32（1&lt;&lt;5即2的5次方），每次扩容按照2的倍数递增，扩容是为了减少hash碰撞，让链表的数据更少（最好链表上就一个数据，即为数组的下标数据）</p>
<p>当前数据存储的数量（即size()）大小必须大于等于阈值；<br>当前加入的数据是否发生了hash冲突，满足这两个条件就会哈希扩容。</p>
<p>dict则为了快速查找使用了一种特别的方法，哈希表，<br>采用哈希函数从key计算得到一个数字<br>（哈希函数有个特点：对于不同的key，有很大的概率得到的哈希值也不同），<br>然后直接把value存储到这个数字所对应的地址上，<br>比如key=’ABC’，value=10，经过哈希函数得到key对应的哈希值为123，<br>那么就申请一个有1000个地址（从0到999）的内存，<br>然后把10存放在地址为123的地方。<br>对于key=’BCD’，value=20，得到key的哈希值为234，<br>那么就把20存放在地址为234的地方。<br>对于这样的表查找起来是非常方便的。只要给出key，计算得到哈希值，<br>然后直接到对应的地址去找value就可以了。<br>无论有几个元素，都可以直接找到value，无需遍历整个表。<br>不过虽然dict查找速度快，但内存浪费严重，你看我们只存储了两个元素，都要申请一个长度为1000的内存。<br>3.现在你知道为啥key要用不可变对象了吧？因为不可变对象是常量，每次的哈希值算出来都是固定的，这样就不会出错。比如key=’ABC’，value=10，存储地址为123，假设我突发奇想，把key改成’BCD’，那么当查找’BCD’的value的时候就会去234的地址找，但那里啥也没有，这就乱套了。</p>
<blockquote>
<p>Dictionary key 必须是不可变的</p>
</blockquote>
<h3 id="Python中list-tuple区别"><a href="#Python中list-tuple区别" class="headerlink" title="Python中list/tuple区别"></a>Python中list/tuple区别</h3><ul>
<li><p>都是线性结构、支持下标访问</p>
</li>
<li><p>list是可变对象，查找和删除的时间复杂度是O(n)，添加的时间复杂度是O(1)<br>没有办法作为字典的key，因为list有可能因为添加新的元素而导致内存地址的更换<br>list既可以当栈、也可以当队列，通过数组实现，而不是链表；<br>因此，每当执行 insert(0, val) 操作时，<br>需要将元素都向后移动一位才可插入，复杂度 O(N) ；<br>这和insert方法不同，是根据索引值来判断插入到链表的哪个位置。</p>
</li>
<li><p>tuple是保存的引用不可变，你没法替换这个对象，但是如果它本身就是一个可变对象，是可以修改这个引用指向的可变对象，比如tuple中包容可变对象，如果tuple里面保存一个list，list本身还是可变的。 parenthese 圆括号，有序的 不变的顺序表<br>可以作为字典的key，可以用在字符串格式化中。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">print((), type(()))</span><br><span class="line"><span class="comment"># () &lt;class 'tuple'&gt; 空元组</span></span><br><span class="line">print((<span class="number">3</span>), type((<span class="number">3</span>)))</span><br><span class="line"><span class="comment"># 3 &lt;class 'int'&gt;</span></span><br><span class="line">print((<span class="number">3</span>, ), type((<span class="number">3</span>,)))</span><br><span class="line"><span class="comment"># (3,) &lt;class 'tuple'&gt; 只有一个元组元素后面要加逗号</span></span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p>1.list和tuple其实是用链表顺序存储的，也就是前一个元素中存储了下一个元素的位置，这样只要找到第一个元素的位置就可以顺藤摸瓜找到所有元素的位置，所以list的名字其实就是个指针，指向list的第一个元素的位置。list的插入和删除等可以直接用链表的方式进行，比如我要在第1个元素和第2个元素中间插入一个元素，那么直接在链表的最后面（我们假设这个list只有两个元素，那么也就是在第3个元素的位置上）插入这个元素，然后把第一个元素指针指向这个元素（第3个位置），然后再把新插入的元素的指针指向原来的第2个元素，这样插入操作就完成了。读取这个list的时候，先用list的名字（就是个指针，指向第1个元素的位置）找到第一个元素，然后用第1一个元素的指针找到第2个元素（位置3），然后用第2个元素的指针找到第3个元素（位置2），以此类推。所以list的顺序和内存中的实际顺序其实不一定完全对应。这种存储方式占用空间小，浪费内存很少。<br>因为要按照链表一个一个找下去，查找和插入的时间随着元素的增加而增加；</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">s = set([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">print(s)  <span class="comment"># {1, 2, 3}   </span></span><br><span class="line">s.add(<span class="number">4</span>)</span><br><span class="line">print(s)  <span class="comment"># {1, 2, 3, 4}</span></span><br><span class="line">s.remove(<span class="number">4</span>)</span><br><span class="line">print(s)  <span class="comment"># {1, 2, 3}   </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t = ([<span class="number">1</span>], <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">print(t[<span class="number">0</span>])  <span class="comment"># [1]</span></span><br><span class="line">t[<span class="number">0</span>].append(<span class="number">1</span>)</span><br><span class="line">print(t)</span><br><span class="line"><span class="comment"># ([1, 1], 2, 3)  # 第一个列表对象元素虽然改变，但它依然是这个列表对象</span></span><br><span class="line"></span><br><span class="line">print(t[<span class="number">2</span>])  <span class="comment"># 3，不可变对象</span></span><br><span class="line">t[<span class="number">2</span>] = <span class="number">3</span>  <span class="comment"># TypeError: 'tuple' object does not support item assignment</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">t = (<span class="number">1</span>, <span class="string">'23'</span>, [<span class="number">123</span>, <span class="string">'abc'</span>], (<span class="string">'python'</span>, <span class="string">'learn'</span>))</span><br><span class="line">tls = list(t)  <span class="comment">#tuple--&gt;list</span></span><br><span class="line">print(tls)</span><br><span class="line"><span class="comment"># [1, '23', [123, 'abc'], ('python', 'learn')]</span></span><br><span class="line"></span><br><span class="line">t_tuple = tuple(tls)  <span class="comment">#list--&gt;tuple</span></span><br><span class="line">print(t_tuple)</span><br><span class="line"><span class="comment"># (1, '23', [123, 'abc'], ('python', 'learn'))</span></span><br></pre></td></tr></tbody></table></figure>

<p>常用函数<br>list<br><code>min(list_name)</code> <code>max(list_name)</code> <code>sum(list_name)</code><br><code>len(list_name)</code></p>
<p><code>list.index(x[, start[, end]])</code><br>从列表中找出某个值第一个匹配项的索引位置。<br>x– 查找的对象。<br>start– 可选，查找的起始位置。<br>end– 可选，查找的结束位置。<br>返回：查找对象的索引位置，如果没有找到对象则抛出异常。</p>
<figure class="highlight plain"><figcaption><span>start, end)```返回开始的索引值，没找到则抛出异常。</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```py</span><br><span class="line">list1 = ['Google', 'Runoob', 'Taobao']</span><br><span class="line">print('Google 索引值为', list1.index('Google'))</span><br><span class="line"># Google 索引值为 0</span><br><span class="line">print('Runoob 索引值为', list1.index('Runoob'))</span><br><span class="line"># Runoob 索引值为 1</span><br><span class="line"></span><br><span class="line">print('Taobao 索引值为', list1.index('Taobao'))</span><br><span class="line"># Taobao 索引值为 2</span><br><span class="line"></span><br><span class="line"># 从指定位置开始搜索</span><br><span class="line">print('Runoob 索引值为', list1.index('Runoob', 1))</span><br><span class="line"># Runoob 索引值为 1</span><br><span class="line"># print('Runoob 索引值为', list1.index('Runoob', 2))</span><br><span class="line"># ValueError: 'Runoob' is not in list</span><br><span class="line"></span><br><span class="line">list1 = ['Google', 'Runoob', 'Taobao']</span><br><span class="line">list2 = ['Runoob', 'Taobao', 'Google']</span><br><span class="line">dic = {}</span><br><span class="line">for i in range(len(list2)):</span><br><span class="line">    dic[list2[i]] = i</span><br><span class="line">    print(dic)</span><br><span class="line"># {'Runoob': 0}</span><br><span class="line"># {'Runoob': 0, 'Taobao': 1}</span><br><span class="line"># {'Runoob': 0, 'Taobao': 1, 'Google': 2}</span><br><span class="line"># {'Runoob': 0, 'Taobao': 1, 'Google': 2}</span><br><span class="line"></span><br><span class="line">print(list1[0])  # Google</span><br><span class="line">i = dic[list1[0]]</span><br><span class="line">print(i)  # 2</span><br><span class="line"></span><br><span class="line">x = dict()</span><br><span class="line">print(x)  # {}</span><br><span class="line"></span><br><span class="line">dict2 = {val: idx for idx, val in enumerate(list2)}</span><br><span class="line">print(dict2)</span><br><span class="line"># {'Runoob': 0, 'Taobao': 1, 'Google': 2}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plain"><figcaption><span>根据值移除元素</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">```del a[索引号]```</span><br><span class="line">```list.pop([index=-1])```移除列表中指定索引号一个元素（默认最后一个元素），并且返回该元素的值。</span><br><span class="line">```python</span><br><span class="line">list1 = ['Google', 'Runoob', 'Taobao', "Yahoo"]</span><br><span class="line">list1.pop()  # 括号里没有参数，表示删除list数组中最后一个元素</span><br><span class="line">print("列表现在为 : ", list1)</span><br><span class="line"># 列表现在为 :  ['Google', 'Runoob', 'Taobao']</span><br><span class="line">list_pop = list1.pop(1)</span><br><span class="line">print("删除的项为 :", list_pop)</span><br><span class="line"># 删除的项为 : Runoob</span><br><span class="line">print("列表现在为 : ", list1)</span><br><span class="line"># 列表现在为 :  ['Google', 'Taobao']</span><br><span class="line">print("删除的项为 :", list1.pop(0), "，列表现在为 : ", list1)</span><br><span class="line"># 删除的项为 : Google ，列表现在为 :  ['Taobao']</span><br></pre></td></tr></tbody></table></figure>

<p><code> .sort(key=lambda x: x[0], reverse=True)</code><br><code> .sort(key=lambda x:(-x[1],x[0],x[2]))</code><br><code> .sort(key=lambda x:(-x[1],x[0],x[2]))</code><br>默认是升序，加个符号变降序，可做多级排序。</p>
<figure class="highlight plain"><figcaption><span>不在本地做排序</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```.reverse()```函数用于反向列表中元素。不能将字符串反转。</span><br><span class="line">```.reversed()```函数是返回序列seq的反向访问的迭代子。参数可以是列表，元组，字符串</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line"># 组织列表 sort() 永久性排序 abcde正向或逆向顺序排序</span><br><span class="line">che = ["motuo", "qiche", "zixingche", 'huoche']</span><br><span class="line"></span><br><span class="line"># 倒着打印列表  永久性的修改顺序 也可以随时改回来</span><br><span class="line">che = ["motuo", "qiche", "zixingche", 'huoche']</span><br><span class="line"># 倒着打印</span><br><span class="line">che.reverse()</span><br><span class="line">print(che)</span><br><span class="line"># ['huoche', 'zixingche', 'qiche', 'motuo']</span><br><span class="line"># 再次倒着改回</span><br><span class="line">che.reverse()</span><br><span class="line">print(che)</span><br><span class="line"># ['motuo', 'qiche', 'zixingche', 'huoche']</span><br><span class="line"></span><br><span class="line"># "iloveChina".reverse()  # 直接将字符串用reverse异常，reverse适用于list(列表)</span><br><span class="line">a= "ilovechina"[::-1] </span><br><span class="line">print(a)</span><br><span class="line">b = ''.join(reversed('ilovechina'))</span><br><span class="line">print(b)</span><br></pre></td></tr></tbody></table></figure>

<p>元素 in list_name<br><code>.append</code><br><code>.insert(序号，内容)</code><br>函数参数是可以是任意一个元素，<br>作用是在列表的最后添加上这个新元素。</p>
<p>变量<br><code>float(‘inf’)</code></p>
<p>字典</p>
<figure class="highlight plain"><figcaption><span>查询字典的键</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">```.values()``` 查询字典的值</span><br><span class="line">```.items()``` 返回的是元组</span><br><span class="line"></span><br><span class="line">```dict.get(key, default=None)``` 查询某个键是否存在，</span><br><span class="line">key -- 字典中要查找的键。</span><br><span class="line">default -- 如果指定键的值不存在时，返回该默认值。</span><br><span class="line">返回指定键的值，如果值不在字典中或不存在此键，返回默认值None。</span><br><span class="line">可以在get()方法中添加信息避免出现None</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line"># 字典的查询</span><br><span class="line">dict1 = {'name': 'Ashe', 'age': 18, 'male': '男'}</span><br><span class="line">print(dict1.keys())  # dict_keys(['name', 'age', 'male'])</span><br><span class="line">print(dict1.values())  # dict_values(['Ashe', 18, '男'])</span><br><span class="line">print(dict1.items())  </span><br><span class="line"># dict_items([('name', 'Ashe'), ('age', 18), ('male', '男')])</span><br><span class="line"></span><br><span class="line"># 判断key是否在字典里</span><br><span class="line">print('name' in dict1)  # True，效率高</span><br><span class="line">print('name' in dict1.keys())  # True 效率低，要先生成遍历字典的所有内容一个列表，这样字典的优势就没有了</span><br><span class="line"></span><br><span class="line"># 打印dict1的键</span><br><span class="line">for i in dict1.keys():</span><br><span class="line">    print(i)</span><br><span class="line">    # name</span><br><span class="line">    # age</span><br><span class="line">    # male</span><br><span class="line"></span><br><span class="line"># 打印dict的值</span><br><span class="line">for v in dict1.values():</span><br><span class="line">    print(v)  #Ashe 18 男</span><br><span class="line">    # Ashe</span><br><span class="line">    # 18</span><br><span class="line">    # 男</span><br></pre></td></tr></tbody></table></figure>

<p>打印字典的键值：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">dict1 = {<span class="string">'name'</span>: <span class="string">'Ashe'</span>, <span class="string">'age'</span>: <span class="number">18</span>, <span class="string">'male'</span>: <span class="string">'男'</span>}</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dict1.items():</span><br><span class="line">    print(i)</span><br><span class="line">    <span class="comment"># ('name', 'Ashe')</span></span><br><span class="line">    <span class="comment"># ('age', 18)</span></span><br><span class="line">    <span class="comment"># 'male', '男')</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> dict1.items():</span><br><span class="line">    print(k, v)</span><br><span class="line">    <span class="comment"># name Ashe</span></span><br><span class="line">    <span class="comment"># age 18</span></span><br><span class="line">    <span class="comment"># male 男</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dict1 = {<span class="string">'name'</span>: <span class="string">'Ashe'</span>, <span class="string">'age'</span>: <span class="number">18</span>, <span class="string">'male'</span>: <span class="string">'男'</span>}</span><br><span class="line">print(dict1.get(<span class="string">'name'</span>))  <span class="comment"># Ashe</span></span><br><span class="line">print(dict1.get(<span class="string">'address'</span>))  <span class="comment"># None</span></span><br><span class="line">print(dict1.get(<span class="string">'address'</span>, <span class="string">'没有此键'</span>))  <span class="comment"># 没有此键</span></span><br><span class="line">print(dict1.get(<span class="string">'name'</span>, <span class="string">'age'</span>))  <span class="comment"># Ashe</span></span><br><span class="line">print(dict1.get(<span class="string">'age'</span>, <span class="string">'name'</span>))  <span class="comment"># 18</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">a = {<span class="string">'x'</span>: <span class="number">1</span>}</span><br><span class="line">print(a[<span class="string">'x'</span>])  <span class="comment"># 1</span></span><br><span class="line"><span class="comment"># print(a[1]) # KeyError:1</span></span><br><span class="line">b = {(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>): <span class="string">'test'</span>}</span><br><span class="line">print(b[(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)])  <span class="comment"># test</span></span><br><span class="line"><span class="comment"># c = {[1, 2, 3]: 'test'}</span></span><br><span class="line"><span class="comment"># print(c[[1, 2, 3]])  # TypeError: unhashable type: 'list'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(a.keys())  <span class="comment"># dict_keys(['x'])</span></span><br><span class="line">print(a.values())  <span class="comment"># dict_values([1])</span></span><br><span class="line">print(b.keys())  <span class="comment"># dict_keys([(1, 2, 3)])</span></span><br><span class="line">print(b.values())  <span class="comment"># dict_values(['test'])</span></span><br><span class="line"></span><br><span class="line">print(a.get(<span class="string">'x'</span>))  <span class="comment"># 1</span></span><br><span class="line">print(a.get(<span class="string">'x'</span>, <span class="number">4</span>))  <span class="comment"># 1 指定的键的值不存在，返回默认值</span></span><br><span class="line">print(a.get(<span class="number">4</span>))  <span class="comment"># None 指定的键的值不存在，返回默认值None</span></span><br><span class="line"></span><br><span class="line">print(b.get((<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)))  <span class="comment"># test</span></span><br><span class="line">print(b.get(<span class="string">'y'</span>))  <span class="comment"># None，指定键的值不存在时，返回该默认值None。</span></span><br><span class="line">print(b.get(<span class="string">'y'</span>, <span class="number">2</span>))  <span class="comment"># 2，如果指定键的值不存在时，返回该默认值2。</span></span><br></pre></td></tr></tbody></table></figure>

<p>dict有两种增加的方法<br>如果没有的键值对，则进行添加，如果有，则将值进行覆盖</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dict1={<span class="string">'name'</span>:<span class="string">'Ashe'</span>,<span class="string">'age'</span>:<span class="number">18</span>,<span class="string">'male'</span>:<span class="string">'男'</span>}</span><br><span class="line">print(dict1)</span><br><span class="line">dict1[<span class="string">'high'</span>]=<span class="number">185</span></span><br><span class="line">print(dict1)  <span class="comment"># {'name': 'Ashe', 'age': 18, 'male': '男', 'high': 185}</span></span><br><span class="line">dict1[<span class="string">'age'</span>]=<span class="number">16</span></span><br><span class="line">print(dict1) <span class="comment">#  {'name': 'Ashe', 'age': 16, 'male': '男', 'high': 185}</span></span><br></pre></td></tr></tbody></table></figure>

<p>如果有键值对，不做任何改变，没有键值对，才进行添加</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">dict1 = {<span class="string">'name'</span>: <span class="string">'Ashe'</span>, <span class="string">'age'</span>: <span class="number">18</span>, <span class="string">'male'</span>: <span class="string">'男'</span>}</span><br><span class="line">dict1.setdefault(<span class="string">"weight"</span>)</span><br><span class="line">print(dict1)</span><br><span class="line"><span class="comment"># {'name': 'Ashe', 'age': 16, 'male': '男', 'high': 185, 'weight': None}</span></span><br><span class="line">dict1.setdefault(<span class="string">'weight'</span>, <span class="string">'65kg'</span>)</span><br><span class="line">print(dict1)</span><br><span class="line"><span class="comment"># {'name': 'Ashe', 'age': 16, 'male': '男', 'high': 185, 'weight': None}</span></span><br><span class="line">dict1.setdefault(<span class="string">'address'</span>, <span class="string">'北京'</span>)</span><br><span class="line">print(dict1)</span><br><span class="line"><span class="comment"># {'name': 'Ashe', 'age': 16, 'male': '男', 'high': 185, 'weight': None, 'address': '北京'}</span></span><br><span class="line">dict1.setdefault(<span class="string">'address'</span>, <span class="string">'桂林'</span>)</span><br><span class="line">print(dict1)</span><br><span class="line"><span class="comment"># {'name': 'Ashe', 'age': 16, 'male': '男', 'high': 185, 'weight': None, 'address': '北京'}</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">```py</span><br><span class="line">delDict={'name': 'Ashe', 'age': 16, 'male': '男', 'high': 185, 'weight': None, 'address': '北京'}</span><br><span class="line">print(delDict.pop('age'))  # 16</span><br><span class="line">print(delDict)  #{'name': 'Ashe', 'male': '男', 'high': 185, 'weight': None, 'address': '北京'}</span><br><span class="line">print(delDict.pop('职业','没有此键'))  #没有此键</span><br><span class="line"></span><br><span class="line">del a['x']  # 删除key</span><br><span class="line">print(a['y'])  # 2</span><br></pre></td></tr></tbody></table></figure>

<p><code>pop(key[,default])</code><br>删除字典给定键 key 所对应的值，返回值为被删除的值。<br>key: 要删除的键值<br>default: 如果没有 key，返回 default 值</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">site = {<span class="string">'name'</span>: <span class="string">'菜鸟教程'</span>, <span class="string">'alexa'</span>: <span class="number">10000</span>, <span class="string">'url'</span>: <span class="string">'www.runoob.com'</span>}</span><br><span class="line">pop_obj = site.pop(<span class="string">'name'</span>)</span><br><span class="line">print(pop_obj)  <span class="comment"># 菜鸟教程</span></span><br><span class="line"></span><br><span class="line">dict1 = {<span class="number">1</span>: <span class="string">"a"</span>, <span class="number">2</span>: [<span class="number">1</span>, <span class="number">2</span>]}</span><br><span class="line">print(dict1.pop(<span class="number">1</span>), dict1)</span><br><span class="line"><span class="comment"># a {2: [1, 2]}</span></span><br><span class="line">print(dict1.pop(<span class="number">3</span>, <span class="string">"nokey"</span>), dict1)  <span class="comment"># 设置默认值，必须添加，否则报错</span></span><br><span class="line"><span class="comment"># nokey {2: [1, 2]}</span></span><br><span class="line">print(dict1.pop(<span class="number">3</span>), dict1)  <span class="comment"># 没用设置默认值，报错</span></span><br><span class="line"><span class="comment"># Traceback (most recent call last):</span></span><br><span class="line"><span class="comment">#   print(dict1.pop(3), dict1)</span></span><br><span class="line"><span class="comment"># KeyError: 3</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">```py</span><br><span class="line">delDict = {</span><br><span class="line">    'name': 'Ashe',</span><br><span class="line">    'age': 16,</span><br><span class="line">    'male': '男',</span><br><span class="line">    'high': 185,</span><br><span class="line">    'weight': None,</span><br><span class="line">    'address': '北京'</span><br><span class="line">}</span><br><span class="line">print(delDict.pop('age'))  # 16</span><br><span class="line">print(delDict)</span><br><span class="line"># {'name': 'Ashe', 'male': '男', 'high': 185, 'weight': None, 'address': '北京'}</span><br><span class="line">print(delDict.pop('职业', '没有此键'))  # 没有此键</span><br><span class="line"></span><br><span class="line">print(delDict.popitem())  </span><br><span class="line"># ('address', '北京') 随机删除，返回值是删除的键值对</span><br><span class="line">print(delDict)  </span><br><span class="line"># {'name': 'Ashe', 'male': '男', 'high': 185, 'weight': None}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">```py</span><br><span class="line">delDict = {'name': 'Ashe', 'male': '男', 'high': 185, 'weight': None}</span><br><span class="line">del delDict['name']</span><br><span class="line">print(delDict)  # {'male': '男', 'high': 185, 'weight': None}</span><br><span class="line"></span><br><span class="line"># 使用del清空列表</span><br><span class="line">del delDict</span><br><span class="line">print(delDict)  # NameError: name 'delDict' is not defined</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```py</span><br><span class="line">delDict = {'name': 'Ashe', 'male': '男', 'high': 185, 'weight': None}</span><br><span class="line">print(delDict.clear())  # None</span><br><span class="line">print(delDict)  # {}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改字典</span></span><br><span class="line">x = {<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="number">2</span>}</span><br><span class="line">y = {<span class="string">'c'</span>: <span class="number">3</span>, <span class="string">'d'</span>: <span class="number">4</span>}</span><br><span class="line">x.update(y)  <span class="comment"># 这里注意我是直接改变的x变量，具体根据程序逻辑来定，可以用其它变量接受。</span></span><br><span class="line">print(x)  <span class="comment"># {'a': 1, 'b': 2, 'c': 3, 'd': 4}</span></span><br><span class="line"></span><br><span class="line">x = {<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="number">2</span>}</span><br><span class="line">y = {<span class="string">'a'</span>: <span class="number">3</span>, <span class="string">'d'</span>: <span class="number">4</span>}</span><br><span class="line">x.update(y)  <span class="comment"># 这里注意我是直接改变的x变量，具体根据程序逻辑来定，可以用其它变量接受。</span></span><br><span class="line">print(x)  <span class="comment"># {'a': 3, 'b': 2, 'd': 4}</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字典合并的方法</span></span><br><span class="line">print(<span class="string">'===='</span>)</span><br><span class="line">x = {<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="number">2</span>}</span><br><span class="line">y = {<span class="string">'c'</span>: <span class="number">3</span>, <span class="string">'d'</span>: <span class="number">4</span>}</span><br><span class="line"><span class="comment"># 法一</span></span><br><span class="line">z = {}</span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> x.items():</span><br><span class="line">    z[k] = v</span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> y.items():</span><br><span class="line">    z[k] = v</span><br><span class="line">print(z)</span><br><span class="line"><span class="comment"># {'a': 1, 'b': 2, 'c': 3, 'd': 4}</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 法二</span></span><br><span class="line">q = {**x, **y}</span><br><span class="line">print(q)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'^^^^^^^'</span>)</span><br><span class="line">a = {<span class="string">"A"</span>: <span class="number">1</span>, <span class="string">"B"</span>: <span class="number">2</span>}</span><br><span class="line">b = {<span class="string">"A"</span>: <span class="number">3</span>, <span class="string">"D"</span>: <span class="number">4</span>}</span><br><span class="line"></span><br><span class="line">print({**a, **b})</span><br><span class="line"><span class="comment"># {'A': 3, 'B': 2, 'D': 4}  # 这里取的是b中的A，即b覆盖了a</span></span><br><span class="line">print(<span class="string">'-----'</span>)</span><br><span class="line">print(dict(a, **b))</span><br><span class="line"><span class="comment"># {'A': 3, 'B': 2, 'D': 4}</span></span><br></pre></td></tr></tbody></table></figure>


<p>字符串</p>
<figure class="highlight plain"><figcaption><span>beg</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">```py</span><br><span class="line">str = "this is string example....wow!!!"</span><br><span class="line">print(str.startswith('this'))  </span><br><span class="line"># True 字符串是否以 this 开头</span><br><span class="line">print(str.startswith('string', 8))  </span><br><span class="line"># True 从第九个字符开始的字符串是否以 string 开头</span><br><span class="line">print(str.startswith('this', 2, 4))  </span><br><span class="line"># False 从第2个字符开始到第四个字符结束的字符串是否以 this 开头</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plain"><figcaption><span>beg</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">beg -- 开始索引，默认为0。</span><br><span class="line">```py</span><br><span class="line">info = 'abca'</span><br><span class="line">print(info.find('a'))  # 0 从下标0开始，查找在字符串里第一个出现的子串</span><br><span class="line">print(info.find('a', 1))  # 3 从下标1开始，查找在字符串里第一个出现的子串</span><br><span class="line">print(info.find('3'))  # -1 查找不到</span><br><span class="line"></span><br><span class="line">str1 = "Runoob example....wow!!!"</span><br><span class="line">str2 = "exam"</span><br><span class="line"></span><br><span class="line">print(str1.find(str2))  # 7</span><br><span class="line">print(str1.find(str2, 5))  # 7  第2个参数5，表示从素引5的位置开始往后查找</span><br><span class="line">print(str1.find(str2, 10))  # -1</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plain"><figcaption><span>方法用于截掉字符串左边的空格或指定字符。</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">```str.rstrip([chars])``` 方法用于截掉字符串右边的空格或指定字符。</span><br><span class="line"></span><br><span class="line">从左到右移除字符串的指定字符，</span><br><span class="line">```.strip()```无字符集参数或为 None 时 去除首位空格</span><br><span class="line">匹配时不是按照整个字符串匹配的，而是一个个匹配的。</span><br><span class="line">移除所有属于字符集子串的字符一旦不属于则停止移除并返回字符串副本。</span><br><span class="line"></span><br><span class="line">chars --指定截取的字符。</span><br><span class="line">返回截掉字符串左边的空格或指定字符后生成的新字符串。</span><br><span class="line"></span><br><span class="line">```.strip().strip(‘-a’)```去除首位空格和字符</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line">str = "     this is string example....wow!!!     "</span><br><span class="line">print(str.lstrip())</span><br><span class="line"># this is string example....wow!!!</span><br><span class="line"></span><br><span class="line">str = "88888888this is string example....wow!!!8888888"</span><br><span class="line">print(str.lstrip('8'))</span><br><span class="line"># this is string example....wow!!!8888888</span><br><span class="line"></span><br><span class="line">print('www.example.com'.lstrip('we.'))</span><br><span class="line"># xample.com</span><br><span class="line">print('www.example.com'.lstrip('we'))</span><br><span class="line"># '.example.com'</span><br><span class="line"></span><br><span class="line">print('www.example.com'.lstrip('e'))</span><br><span class="line"># 'www.example.com'</span><br><span class="line"></span><br><span class="line">print('www.example.com'.lstrip('cmowz.'))</span><br><span class="line"># 'example.com'</span><br><span class="line"></span><br><span class="line">print('www.example.com'.lstrip('cmoz.'))</span><br><span class="line"># 'www.example.com'</span><br><span class="line"></span><br><span class="line">message = "\tpython xue xi\t"</span><br><span class="line"># 每个单词的首字母大写的写法</span><br><span class="line">print(message.title())</span><br><span class="line"># 单词全部大写的写法</span><br><span class="line">print(message.upper())  </span><br><span class="line"># 单词全部小写的写法</span><br><span class="line">print(message.lower())  </span><br><span class="line"># 去除字符串前面的空白</span><br><span class="line">print(message.lstrip())</span><br><span class="line"># 去除字符串后面的空白</span><br><span class="line">print(message.rstrip())</span><br><span class="line"># 去除字符串两边的空白</span><br><span class="line">print(message.strip())</span><br><span class="line">#         Python Xue Xi</span><br><span class="line">#         PYTHON XUE XI</span><br><span class="line">#         python xue xi</span><br><span class="line"># python xue xi        </span><br><span class="line">#         python xue xi</span><br><span class="line"># python xue xi    </span><br></pre></td></tr></tbody></table></figure>

<p>S[:3]+S[5:] 拼接字符串，去除某个字符</p>
<figure class="highlight plain"><figcaption><span>替换字符</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```re.sub(‘a’,’b’,s)``` 替换字符</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```ord(a)```它以一个字符（长度为1）作为参数，返回对应的 ASCII 数值(返回值是对应的十进制整数)，或者 Unicode 数值，</span><br><span class="line">如果所给的 Unicode 字符超出了你的 Python 定义范围，则会引发一个 TypeError 的异常。</span><br><span class="line">因为python里不像C++那样两个字符相减可以求出ASCII数值差</span><br><span class="line"></span><br><span class="line">```chr(a)``` 函数（对于8位的ASCII字符串）或 unichr() 函数（对于Unicode对象）的配对函数 是ord的逆过程，将ASCII值转化成该编码对应的字符</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line">print(ord(' '), type(ord(' ')))  # 32 &lt;class 'int'&gt; 空格的ascii码</span><br><span class="line">print(ord('0'))  # 48</span><br><span class="line">print(ord('1'))  # 49</span><br><span class="line">print(ord('2'))  # 50</span><br><span class="line">print(ord('2'), type(ord('2')))  # 50  &lt;class 'int'&gt;</span><br><span class="line">print(ord('3'))  # 51</span><br><span class="line"># print(ord('10')) TypeError: ord() expected a character, but string of length 2 found</span><br><span class="line">print(ord('A'))  # 65</span><br><span class="line">print(ord('B'))  # 66</span><br><span class="line">print(ord('C'))  # 67</span><br><span class="line">print(ord('a'))  # 97</span><br><span class="line">print(ord('b'))  # 98</span><br><span class="line">print(ord('c'))  # 99</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">print(chr(<span class="number">32</span>))  <span class="comment"># 空格</span></span><br><span class="line">print(chr(<span class="number">50</span>), type(chr(<span class="number">50</span>)))  <span class="comment"># 2  &lt;class 'str'&gt;</span></span><br><span class="line">print(chr(<span class="number">65</span>))  <span class="comment"># A</span></span><br><span class="line">print(chr(<span class="number">97</span>))  <span class="comment"># a</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plain"><figcaption><span>方法返回"标题化"的字符串，就是说所有单词的首个字母转化为大写，其余字母均为小写</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">返回"标题化"的字符串,就是说所有单词的首字母都转化为大写。</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line">str = "this is string example from runoob....wow!!!"</span><br><span class="line">print(str.title())</span><br><span class="line"># This Is String Example From Runoob....Wow!!! </span><br></pre></td></tr></tbody></table></figure>

<p>非字母后的第一个字母将转换为大写字母：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">txt = <span class="string">"hello b2b2b2 and 3g3g3g"</span></span><br><span class="line">print(txt.title())  <span class="comment"># Hello B2B2B2 And 3G3G3G</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>str.split(str="", num=string.count(str))</code><br>通过指定分隔符对字符串进行切片，不是对列表对象切片<br>返回分割后的字符串列表。<br>如果第二个参数 num 有指定值，则分割为 num+1 个子字符串。<br>str – 分隔符，默认为所有的空字符，包括空格、换行(\n)、制表符(\t)等。<br>num – 分割次数。默认为 -1, 即分隔所有。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="string">"http://www.baidu.com/python/image/123456.jpg"</span></span><br><span class="line">print(url.split())  <span class="comment"># 以空格为分隔符</span></span><br><span class="line"><span class="comment"># ['http://www.baidu.com/python/image/123456.jpg']</span></span><br><span class="line">print(url.split(<span class="string">"/"</span>))  <span class="comment"># 以“/” 进行分隔</span></span><br><span class="line"><span class="comment"># ['http:', '', 'www.baidu.com', 'python', 'image', '123456.jpg']</span></span><br><span class="line">print(url.split(<span class="string">'/'</span>, <span class="number">1</span>))  <span class="comment"># 以 / 为分隔符，分割为2个字符串列表</span></span><br><span class="line"><span class="comment"># ['http:', '/www.baidu.com/python/image/123456.jpg']</span></span><br><span class="line">print(url.split(<span class="string">"/"</span>)[<span class="number">-1</span>])  <span class="comment"># 分隔符分割后列表最后一个元素(字符串类型），图片名称的获取</span></span><br><span class="line"><span class="comment"># 123456.jpg</span></span><br><span class="line">print(url.split(<span class="string">"/"</span>)[<span class="number">0</span>])  <span class="comment"># 分隔符分割后列表第一个元素(字符串类型）</span></span><br><span class="line"><span class="comment"># http:</span></span><br><span class="line">print(url[<span class="number">1</span>:<span class="number">-1</span>], type(url[<span class="number">1</span>:<span class="number">-1</span>]))  <span class="comment"># 切片，去除第一个和最后一个元素</span></span><br><span class="line"><span class="comment"># ttp://www.baidu.com/python/image/123456.jp &lt;class 'str'&gt;</span></span><br><span class="line">print(url[<span class="number">1</span>:<span class="number">-1</span>].split(<span class="string">"/"</span>)[<span class="number">0</span>])  <span class="comment"># 列表第一个元素(字符串类型）</span></span><br><span class="line"><span class="comment"># ttp:</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">"[http://www.baidu.com/python/image/123456.jpg]"</span></span><br><span class="line">print(url[:], type(url[:]))</span><br><span class="line"><span class="comment"># [http://www.baidu.com/python/image/123456.jpg] &lt;class 'str'&gt;</span></span><br><span class="line">print(url[:].split(<span class="string">"/"</span>)[<span class="number">0</span>])  <span class="comment"># 列表第一个元素(字符串类型）</span></span><br><span class="line"><span class="comment"># [http:</span></span><br><span class="line"></span><br><span class="line">data = <span class="string">'[1, 2, 3, null, 4, 5, null]'</span></span><br><span class="line">print(data[<span class="number">1</span>:<span class="number">-1</span>], type(data[<span class="number">1</span>:<span class="number">-1</span>]))</span><br><span class="line"><span class="comment"># 1, 2, 3, null, 4, 5, null &lt;class 'str'&gt;</span></span><br><span class="line">print(data[<span class="number">1</span>:<span class="number">-1</span>].split(<span class="string">','</span>), type(data[<span class="number">1</span>:<span class="number">-1</span>].split(<span class="string">','</span>)))</span><br><span class="line"><span class="comment"># ['1', ' 2', ' 3', ' null', ' 4', ' 5', ' null'] &lt;class 'list'&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>str.splitlines([keepends])</code><br>按照行(‘\r’, ‘\r\n’, \n’)分隔，返回一个包含各行作为元素的列表，<br>keepends – 在输出结果里是否去掉换行符(‘\r’, ‘\r\n’, \n’)，<br>默认为 <code>False</code>，不包含换行符，<br>如果为 <code>True</code>，则保留换行符。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'ab c\n\nde fg\rkl\r\n'</span>.splitlines())</span><br><span class="line"><span class="comment"># ['ab c', '', 'de fg', 'kl']</span></span><br><span class="line">print(<span class="string">'ab c\n\nde fg\rkl\r\n'</span>.splitlines(<span class="literal">True</span>))</span><br><span class="line"><span class="comment"># ['ab c\n', '\n', 'de fg\r', 'kl\r\n']</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="39-sep-39-join-seq"><a href="#39-sep-39-join-seq" class="headerlink" title="'sep'.join(seq)"></a><code>'sep'.join(seq)</code></h3><p>以sep作为分隔符，将seq所有的元素合并成一个新的字符串<br>将字符串、元组、列表中的元素以指定的字符(分隔符)连接生成一个新的字符串</p>
<p>参数说明<br>sep：分隔符。string（字符串），可以为空<br>seq：要连接的元素列表、字符串、元组、字典<br>返回值：返回一个以分隔符sep连接各个元素后生成的字符串</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对字符串进行操作</span></span><br><span class="line">print(<span class="string">':'</span>.join(<span class="string">"hello good boy "</span>))</span><br><span class="line"><span class="comment"># h:e:l:l:o: :g:o:o:d: :b:o:y:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用字符串把字符串列表里的字符串连接起来</span></span><br><span class="line"><span class="comment"># 用空字符串''隔开</span></span><br><span class="line">print(<span class="string">''</span>.join([<span class="string">"hello"</span>, <span class="string">"world"</span>, <span class="string">"!"</span>]))  <span class="comment"># helloworld!</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用' '隔开，用空格</span></span><br><span class="line">print(<span class="string">' '</span>.join([<span class="string">"hello"</span>, <span class="string">"world"</span>, <span class="string">"!"</span>]))  <span class="comment"># hello world !</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用'-'隔开</span></span><br><span class="line">print(<span class="string">'-'</span>.join([<span class="string">"hello"</span>, <span class="string">"world"</span>, <span class="string">"!"</span>]))  <span class="comment"># hello-world-!</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对元组进行操作</span></span><br><span class="line">seq3 = (<span class="string">'hello'</span>, <span class="string">'good'</span>, <span class="string">'boy'</span>)</span><br><span class="line">print(<span class="string">':'</span>.join(seq3))</span><br><span class="line"><span class="comment"># hello:good:boy</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对字典进行操作</span></span><br><span class="line">seq4 = {<span class="string">'hello'</span>: <span class="number">1</span>, <span class="string">'good'</span>: <span class="number">2</span>, <span class="string">'boy'</span>: <span class="number">3</span>}</span><br><span class="line">print(<span class="string">':'</span>.join(seq4))</span><br><span class="line"><span class="comment"># hello:good:boy</span></span><br></pre></td></tr></tbody></table></figure>

<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/vue-shi-zhan-xiang-mu-da-jian/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/vue-shi-zhan-xiang-mu-da-jian/" class="post-title-link" itemprop="url">Vue实战项目搭建</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-04 15:09:22" itemprop="dateModified" datetime="2021-04-04T15:09:22Z">2021-04-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%85%E6%B8%B8%E7%BD%91%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">旅游网项目</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="项目的搭建"><a href="#项目的搭建" class="headerlink" title="项目的搭建"></a>项目的搭建</h3><ul>
<li>项目公共的配置（ajax配置、项目结构、目录等）</li>
<li>前后端通信方式（接口规范、错误码等）</li>
</ul>
<h3 id="开发的流程"><a href="#开发的流程" class="headerlink" title="开发的流程"></a>开发的流程</h3><ul>
<li>【前端】实现页面（组件）</li>
<li>【前端】使用假数据，或者是mock数据</li>
<li>【后端】模型分析，建模</li>
<li>【后端】实现接口</li>
<li>【前/后端】接口文档编写</li>
<li>【前/后端】接口联调(对接)</li>
</ul>
<h3 id="实战项目搭建"><a href="#实战项目搭建" class="headerlink" title="实战项目搭建"></a>实战项目搭建</h3><p>操作步骤</p>
<ul>
<li>第一步，使用Vue CLI 搭建项目</li>
<li>第二步，准备好静态资源（图片资源）</li>
<li>第三步，调整生产项目结构</li>
</ul>
<p>项目结构</p>
<ul>
<li>公共的样式<br><code>src/assets/common.less</code></li>
<li>公共js（工具函数、接口地址、配置文件），方便管理api请求的各种逻辑<figure class="highlight less"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 接口地址配置 对后端进行请求</span></span><br><span class="line"><span class="selector-tag">src</span>/<span class="selector-tag">utils</span>/<span class="selector-tag">apis</span><span class="selector-class">.js</span></span><br><span class="line"><span class="comment">// 常量配置</span></span><br><span class="line"><span class="selector-tag">src</span>/<span class="selector-tag">utils</span>/<span class="selector-tag">constants</span><span class="selector-class">.js</span></span><br><span class="line"><span class="comment">// 工具函数</span></span><br><span class="line"><span class="selector-tag">src</span>/<span class="selector-tag">utils</span>/<span class="selector-tag">filters</span><span class="selector-class">.js</span></span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p>首页拆解<br>操作步骤</p>
<ul>
<li>第一步，分析首页的结构</li>
<li>第二步，新建页面</li>
<li>第三步，新建对应组件</li>
</ul>
<p>首页组件拆分</p>
<ul>
<li>标题</li>
<li>轮播图（Banner图）</li>
<li>本周推荐</li>
<li>精选景点</li>
<li>底部导航<br>如果组件很多地方都用到过，应该放在<code>/src/component/common</code><br>如果只有某一个页面用到，应该放在<code>/src/component/home</code></li>
</ul>
<h3 id="为何不能在Vue-js中使用AJAX"><a href="#为何不能在Vue-js中使用AJAX" class="headerlink" title="为何不能在Vue.js中使用AJAX"></a>为何不能在Vue.js中使用AJAX</h3><ul>
<li>Ajax是通过浏览器后台与服务器通信的技术</li>
<li>jQuery 中的AJAX只是基于jQuery的实现</li>
<li>在Vue.js中使用jQuery不能充分利用Vue.js的特性</li>
</ul>
<h3 id="axios异步请求库"><a href="#axios异步请求库" class="headerlink" title="axios异步请求库"></a>axios异步请求库</h3><ul>
<li>基于Promise的HTTP库</li>
<li>支持Node.js和浏览器</li>
<li>浏览器：XMLHttpRequest</li>
<li>Node.js：http</li>
</ul>
<p>对axios进行全局配置可提升代码的可维护性</p>
<h3 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h3><ul>
<li>一种异步编程解决方案</li>
<li>Promise其实一直都在，只是在ES6时，才被并入标准库</li>
</ul>
<h3 id="处理回调"><a href="#处理回调" class="headerlink" title="处理回调"></a>处理回调</h3><ul>
<li><code>then</code>函数的使用<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> {</span><br><span class="line"><span class="comment">// 业务逻辑</span></span><br><span class="line">resolve(<span class="number">1</span>);</span><br><span class="line">}).then(<span class="function"><span class="params">res</span> =&gt;</span> {</span><br><span class="line"><span class="comment">// 你的代码1</span></span><br><span class="line">}) .then(<span class="function"><span class="params">res</span> =&gt;</span> {</span><br><span class="line"><span class="comment">// 你的代码2</span></span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h3 id="处理异常"><a href="#处理异常" class="headerlink" title="处理异常"></a>处理异常</h3><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">```js</span><br><span class="line">new Promise((resolve, reject) =&gt; {</span><br><span class="line">    // 业务逻辑</span><br><span class="line">    reject(throw new Error('It is my fault'))</span><br><span class="line">    }) .then(res =&gt; {</span><br><span class="line">        // 正常的逻辑代码</span><br><span class="line">    }).catch(err =&gt; {</span><br><span class="line">        // 产生异常后执行的代码</span><br><span class="line">    })</span><br></pre></td></tr></tbody></table></figure>

<p>如何安装</p>
<ul>
<li>方式一：引用JS<br><code>&lt;script src="./axios.min.js"&gt;&lt;/script&gt;</code></li>
<li>方式二：使用npm/cnpm/yarn安装<br><code>npm install axios -S</code></li>
</ul>
<h3 id="使用npm-cnpm安装"><a href="#使用npm-cnpm安装" class="headerlink" title="使用npm/cnpm安装"></a>使用npm/cnpm安装</h3><ul>
<li><p>安装到dependencies（生产环境依赖）<br><code>npm install axios --save</code><br>或者<code>npm install axios -S</code></p>
</li>
<li><p>安装到devDependencies（开发环境依赖）<br><code>npm install axios --save-dev</code><br>或者<code>npm install axios -D</code></p>
</li>
</ul>
<h3 id="如何使用axios"><a href="#如何使用axios" class="headerlink" title="如何使用axios"></a>如何使用axios</h3><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">axios.get(url[, config])</span><br><span class="line">axios.delete(url[, config])</span><br><span class="line">axios.head(url[, config])</span><br><span class="line">axios.options(url[, config])</span><br><span class="line">axios.post(url[, data[, config]])</span><br><span class="line">axios.put(url[, data[, config]])</span><br><span class="line">axios.patch(url[, data[, config]])</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>GET请求</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">axios.get(<span class="string">'/user'</span>, {</span><br><span class="line">    params: {</span><br><span class="line">        ID: <span class="number">12345</span></span><br><span class="line">    }</span><br><span class="line">})</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">})</span><br><span class="line">.catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>POST请求</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">axios.post(<span class="string">'/user'</span>, {</span><br><span class="line">    firstName: <span class="string">'Fred'</span>,</span><br><span class="line">    lastName: <span class="string">'Flintstone'</span></span><br><span class="line">})</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">})</span><br><span class="line">.catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h3 id="请求响应拦截"><a href="#请求响应拦截" class="headerlink" title="请求响应拦截"></a>请求响应拦截</h3><h4 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h4><ul>
<li>设置自定义请求头</li>
<li>默认携带上次的cookie</li>
<li>添加loading动画（请求发起前显示、完成后隐藏）</li>
<li>统一的错误处理</li>
</ul>
<h4 id="实现方法"><a href="#实现方法" class="headerlink" title="实现方法"></a>实现方法</h4><ul>
<li>创建axios的实例<br><code>const ajax = axios.create(options)</code></li>
<li>常用参数<ul>
<li><code>headers</code>: 设置请求头</li>
<li><code>timeout</code>: 超时的毫秒数</li>
<li><code>data</code>: POST/PUT/PATCH请求的数据</li>
<li><code>params</code>: URL中的参数</li>
<li><code>responseType</code>: 默认为json</li>
</ul>
</li>
</ul>
<h4 id="设置自定义请求头"><a href="#设置自定义请求头" class="headerlink" title="设置自定义请求头"></a>设置自定义请求头</h4><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ajax = axios.create({</span><br><span class="line">headers: {</span><br><span class="line">source: <span class="string">'h5'</span>,</span><br><span class="line"><span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span></span><br><span class="line">}</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<h4 id="默认携带上次的cookie"><a href="#默认携带上次的cookie" class="headerlink" title="默认携带上次的cookie"></a>默认携带上次的cookie</h4><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ajax = axios.create({</span><br><span class="line">    withCredentials: <span class="literal">true</span></span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<h4 id="添加loading动画"><a href="#添加loading动画" class="headerlink" title="添加loading动画"></a>添加loading动画</h4><ul>
<li><p> 请求拦截</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">axios.interceptors.request.use(<span class="function"><span class="keyword">function</span> (<span class="params">config</span>) </span>{</span><br><span class="line"><span class="comment">// 在发送请求之前做些什么</span></span><br><span class="line"><span class="keyword">return</span> config</span><br><span class="line">}, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>{</span><br><span class="line"><span class="comment">// 对请求错误做些什么</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p> 响应拦截</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">axios.interceptors.response.use(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>{</span><br><span class="line"><span class="comment">// 对响应数据做点什么</span></span><br><span class="line"><span class="keyword">return</span> response</span><br><span class="line">}, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>{</span><br><span class="line"><span class="comment">// 对响应错误做点什么</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h4 id="统一的错误处理"><a href="#统一的错误处理" class="headerlink" title="统一的错误处理"></a>统一的错误处理</h4><ul>
<li>400<br>参数错误提示</li>
<li>401<br>未登录，跳转到登录页面</li>
<li>500/504<br>服务器正忙，网络异常/请求超时</li>
</ul>
<h3 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h3><p>前后端联调，涉及最多的就是跨域的问题，<br>出于安全考虑，浏览器要求你的网站不能执行/访问其它网站的资源</p>
<ul>
<li>如何认定为“其它的网站”：<br>通常需要遵循同源策略，即“协议、域名/主机、端口”三者都相同</li>
</ul>
<ul>
<li><p>跨域的影响</p>
<ul>
<li>浏览器本地存储无法使用<br>（Cookie、LocalStorage 和 IndexDB）</li>
<li>DOM对象 、JS 对象无法获取</li>
<li>AJAX无法使用</li>
</ul>
</li>
<li><p>跨域问题解决</p>
<ul>
<li>利用HTML标签的特性<br>script、a、iframe、img、link等</li>
<li>在前端使用代理解决</li>
<li>在服务器端解决<br>CORS(Cross-Origin Resource Sharing)——跨域资源共享，通过添加响应头信息来解决</li>
</ul>
</li>
</ul>
<h4 id="在Vue-js中解决跨域问题"><a href="#在Vue-js中解决跨域问题" class="headerlink" title="在Vue.js中解决跨域问题"></a>在Vue.js中解决跨域问题</h4><ul>
<li>添加配置文件<code>vue.config.js</code><br>添加配置项<br>参数解释</li>
<li> <code>target</code>目标地址</li>
<li> <code>changeOrigin</code>变更请求头中设置的host</li>
<li> <code>pathRewrite</code>URL重写规则<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue.config.js</span></span><br><span class="line"><span class="comment">// Node.js里面的模块</span></span><br><span class="line"><span class="built_in">module</span>.exports = {</span><br><span class="line">  <span class="comment">// http://localhost:8080/api/test</span></span><br><span class="line">  <span class="comment">// =&gt;</span></span><br><span class="line">  <span class="comment">// http://localhost:8000/test</span></span><br><span class="line">  <span class="comment">// 在Vue.js中解决跨域问题</span></span><br><span class="line">  devServer: {</span><br><span class="line">    proxy: {</span><br><span class="line">      <span class="string">'/api'</span>: {</span><br><span class="line">        target: <span class="string">'http://django.t.mukewang.com'</span>,    <span class="comment">// 这个地址的服务器要启动才能访问 </span></span><br><span class="line">        changeOrigin: <span class="literal">true</span>,</span><br><span class="line">        pathRewrite: {</span><br><span class="line">          <span class="string">'^/api'</span>: <span class="string">''</span>   <span class="comment">// 重写的URL，空字符表示把/api字符串去掉</span></span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p>使用axios获取数据</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Home.vue</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> {</span><br><span class="line">  name: <span class="string">'Home'</span>,</span><br><span class="line">  components: {</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    <span class="comment">// ajax.get('http://django.t.mukewang.com/api/system/slider/list/?types=11').then(resp =&gt; {</span></span><br><span class="line">    <span class="comment">// 未登录访问用户信息</span></span><br><span class="line">    <span class="comment">// ajax.get('http://django.t.mukewang.com/api/accounts/user/detail/').then(resp =&gt; {</span></span><br><span class="line">    <span class="comment">// ajax.get('http://localhost:8080/api/system/slider/list/?types=11').then(resp =&gt; {</span></span><br><span class="line">    <span class="comment">// ajax.get('http://localhost:9527/hello/world/').then(resp =&gt; {</span></span><br><span class="line">    ajax.get(<span class="string">'http://localhost:8080/test/hello/world/'</span>).then(<span class="function"><span class="params">resp</span> =&gt;</span> {</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'返回的结果：'</span>, resp)</span><br><span class="line">    }).catch(<span class="function"><span class="params">err</span> =&gt;</span> {</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'请求出错：'</span>, err)</span><br><span class="line">    })</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="在Django中解决跨域问题"><a href="#在Django中解决跨域问题" class="headerlink" title="在Django中解决跨域问题"></a>在Django中解决跨域问题</h4><ul>
<li><p> 第一步：安装第三方模块 <code>django-cors-headers</code>来解决</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; pip install django-cors-headers</span><br></pre></td></tr></tbody></table></figure></li>
<li><p> 第二步：配置django的<code>setting.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [<span class="string">'corsheaders'</span>,]</span><br><span class="line"></span><br><span class="line">MIDDLEWARE_CLASSES = [</span><br><span class="line"><span class="string">'django.middleware.security.SecurityMiddleware'</span>,</span><br><span class="line"><span class="string">'django.contrib.sessions.middleware.SessionMiddleware'</span>,</span><br><span class="line"><span class="string">'corsheaders.middleware.CorsMiddleware'</span>,</span><br><span class="line"><span class="string">'django.middleware.common.CommonMiddleware'</span>,</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>第三步：添加白名单</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># setting.py</span></span><br><span class="line">CORS_ORIGIN_WHITELIST = (</span><br><span class="line"><span class="string">'http://127.0.0.1:8080'</span>,</span><br><span class="line"><span class="string">'http://localhost:8080'</span>,</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p>第五步：可选配置</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># setting.py</span></span><br><span class="line"><span class="comment"># 允许哪些请求头</span></span><br><span class="line">CORS_ALLOW_HEADERS = (<span class="string">'source'</span>, <span class="string">'icode'</span>)</span><br><span class="line"><span class="comment"># 允许携带cookie</span></span><br><span class="line">CORS_ALLOW_CREDENTIALS = <span class="literal">True</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 支持跨域配置开始</span></span><br><span class="line">CORS_ORIGIN_ALLOW_ALL = <span class="literal">True</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="VantUI"><a href="#VantUI" class="headerlink" title="VantUI"></a>VantUI</h3><ul>
<li>开源免费</li>
<li>轻量、可靠的移动端 Vue 组件库</li>
</ul>
<h4 id="Vant组件库"><a href="#Vant组件库" class="headerlink" title="Vant组件库"></a>Vant组件库</h4><ul>
<li>基础组件<br>按钮、图标、布局、提示信息等</li>
<li>表单组件<br>日历、复选框、时间选择、输入框、评分等</li>
<li>反馈组件<br>弹出框、加载、下拉菜单、消息提示、下拉刷新、滚动加载等</li>
<li>展示组件<br>进度条、倒计时、分割线、懒加载、列表等</li>
<li>导航组件<br>宫格、索引、导航栏、分页、多标签页等</li>
<li>业务组件<br>地址编辑、联系人、优惠券、提交订单、SKU选择框等</li>
</ul>
<h3 id="开始使用"><a href="#开始使用" class="headerlink" title="开始使用"></a>开始使用</h3><ul>
<li><p>第一步：安装<br><code>&gt;&gt; cnpm install vant -S</code></p>
</li>
<li><p>第二步：手动按需导入组件</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Button <span class="keyword">from</span> <span class="string">'vant/lib/button'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'vant/lib/button/style'</span>;</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> {</span><br><span class="line">  name: <span class="string">'Home'</span>,</span><br><span class="line">  components: {</span><br><span class="line">    <span class="string">'v-button'</span>: Button</span><br><span class="line">    <span class="comment">// Button: Button</span></span><br><span class="line">  }</span><br><span class="line">}  </span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>第二步：导入全部组件，全局引用<br><code>main.js</code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span>;</span><br><span class="line"><span class="keyword">import</span> Vant <span class="keyword">from</span> <span class="string">'vant'</span>;  <span class="comment">// VantUI组件库</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'vant/lib/index.css'</span>;</span><br><span class="line"></span><br><span class="line">Vue.use(Vant);  <span class="comment">// 把VantUI当做一个插件，在Vue中使用</span></span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h3 id="轮播图组件开发"><a href="#轮播图组件开发" class="headerlink" title="轮播图组件开发"></a>轮播图组件开发</h3><h4 id="开发步骤"><a href="#开发步骤" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li>第一步，查找Vant中可以使用的组件</li>
<li>第二步，实现组件模板部分<br><code>\src\components\common\Banner.vue</code><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 首页的轮播图 --&gt;</span><br><span class="line">  &lt;div class="home-banner-box"&gt;</span><br><span class="line">    &lt;van-swipe class="my-swipe" :autoplay="3000" indicator-color="white"&gt;</span><br><span class="line">      &lt;van-swipe-item v-for="item in bannerList"</span><br><span class="line">        :key="item.id"&gt;</span><br><span class="line">        &lt;img :src="item.img_url" alt=""&gt;</span><br><span class="line">      &lt;/van-swipe-item&gt;</span><br><span class="line">    &lt;/van-swipe&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>
<code>Home.vue</code><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class="page-home"&gt;</span><br><span class="line">    &lt;!-- banner图 --&gt;</span><br><span class="line">    &lt;Banner/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 引入组件</span><br><span class="line">import Banner from '@/components/home/Banner'</span><br><span class="line"></span><br><span class="line">export default {</span><br><span class="line">  name: 'Home',</span><br><span class="line">  components: {</span><br><span class="line">    // banner图</span><br><span class="line">    Banner,</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure></li>
<li>第三步，模型层准备数据，通过接口的方式从django服务器获取<br><code>\src\components\common\Banner.vue</code><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import { ajax } from '@/utils/ajax'</span><br><span class="line">import { SystemApis } from '@/utils/apis'</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      bannerList: []</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    /**</span><br><span class="line">     * 获取轮播图的数据</span><br><span class="line">     */</span><br><span class="line">    getDataList () {</span><br><span class="line">      ajax.get(SystemApis.sliderListUrl).then(res =&gt; {</span><br><span class="line">        console.log('res:', res)</span><br><span class="line">        this.bannerList = res.data.objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    // 从接口获取数据</span><br><span class="line">    this.getDataList()</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure></li>
<li>第四步，模拟数据，实现轮播效果</li>
</ul>
<h3 id="热门推荐组件开发"><a href="#热门推荐组件开发" class="headerlink" title="热门推荐组件开发"></a>热门推荐组件开发</h3><h4 id="开发步骤-1"><a href="#开发步骤-1" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li><p>第一步，查找Vant中可以使用的组件</p>
</li>
<li><p>第二步，完成布局，实现组件模板部分<br><code>\src\components\common\Hot.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 热门景点 --&gt;</span><br><span class="line">  &lt;div class="home-hot-box"&gt;</span><br><span class="line">    &lt;!-- 顶上导航 --&gt;</span><br><span class="line">    &lt;van-cell</span><br><span class="line">      title="热门推荐"</span><br><span class="line">      icon="/static/home/hot/fire.png"</span><br><span class="line">      is-link</span><br><span class="line">      title-style="text-align:left"</span><br><span class="line">      value="全部榜单" /&gt;</span><br><span class="line">    &lt;!-- // 顶上导航 --&gt;</span><br><span class="line">    &lt;!-- 景点列表 --&gt;</span><br><span class="line">    &lt;div class="box-main"&gt;</span><br><span class="line">      &lt;a href="#" class="hot-item"</span><br><span class="line">        v-for="item in dataList"</span><br><span class="line">        :key="item.id"&gt;</span><br><span class="line">        &lt;div class="img"&gt;</span><br><span class="line">          &lt;span&gt;&lt;/span&gt;</span><br><span class="line">          &lt;img :src="item.main_img" alt=""&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;!-- ellipsis 省略号 意思是超过一定长度变成省略号 --&gt;</span><br><span class="line">        &lt;h5 class="van-ellipsis"&gt;{{ item.name }}&lt;/h5&gt;</span><br><span class="line">        &lt;div class="line-price"&gt;</span><br><span class="line">          &lt;span class="price"&gt;￥{{ item.min_price }}&lt;/span&gt;起</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //景点列表 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>
<p><code>Home.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class="page-home"&gt;</span><br><span class="line">    &lt;!-- 热门推荐景点 --&gt;</span><br><span class="line">    &lt;Hot/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 引入组件</span><br><span class="line">import Hot from '@/components/home/Hot'</span><br><span class="line"></span><br><span class="line">export default {</span><br><span class="line">  name: 'Home',</span><br><span class="line">  components: {</span><br><span class="line">    // 热门推荐景点</span><br><span class="line">    Hot,</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>第三步，模型层准备数据<br><code>\src\components\common\Hot.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import { ajax } from '@/utils/ajax'</span><br><span class="line">import { SightApis } from '@/utils/apis'</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      dataList: []</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    /**</span><br><span class="line">     * 查热门景点</span><br><span class="line">     */</span><br><span class="line">    getDataList () {</span><br><span class="line">      ajax.get(SightApis.sightListUrl, {</span><br><span class="line">        params: {</span><br><span class="line">          is_hot: 1</span><br><span class="line">        }</span><br><span class="line">      }).then(({ data }) =&gt; {</span><br><span class="line">        this.dataList = data.objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    // 查询获取接口数据</span><br><span class="line">    this.getDataList()</span><br><span class="line">    // this.dataList = [</span><br><span class="line">    //   {id: 1, img: '/static/home/hot/h1.jpg', name: '景点名称', price: 65},</span><br><span class="line">    //   {id: 2, img: '/static/home/hot/h2.jpg', name: '景点名称景点名称', price: 65},</span><br><span class="line">    //   {id: 3, img: '/static/home/hot/h3.jpg', name: '景点名称', price: 65},</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>第四步，添加假数据，实现效果</p>
</li>
</ul>
<h3 id="景点列表组件开发"><a href="#景点列表组件开发" class="headerlink" title="景点列表组件开发"></a>景点列表组件开发</h3><h4 id="开发步骤-2"><a href="#开发步骤-2" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li>第一步，分析组件的复用情况</li>
<li>第二步，新建组件文件，实现组件内容<br><code>\src\components\common\ListSight.vue</code><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 精选景点 --&gt;</span><br><span class="line">  &lt;div class="home-fine-box"&gt;</span><br><span class="line">    &lt;!-- 顶上导航 --&gt;</span><br><span class="line">    &lt;van-cell</span><br><span class="line">      title="精选景点"</span><br><span class="line">      icon="location-o"</span><br><span class="line">      is-link</span><br><span class="line">      title-style="text-align:left"</span><br><span class="line">      value="更多" /&gt;</span><br><span class="line">    &lt;!-- // 顶上导航 --&gt;</span><br><span class="line">    &lt;!-- 景点的列表 --&gt;</span><br><span class="line">    &lt;div class="box-main"&gt;</span><br><span class="line">      &lt;!-- ```src\components\common\ListSight.vue```子组件的 --&gt;</span><br><span class="line">      &lt;sight-item v-for="item in dataList"</span><br><span class="line">        :key="item.id"</span><br><span class="line">        :item="item"/&gt;&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //景点的列表 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure></li>
<li>第三步，设置props,从父组件传递数据<br><code>\src\components\common\ListSight.vue</code><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">export default {</span><br><span class="line">  props: ['item']</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h3 id="精选景点组件开发"><a href="#精选景点组件开发" class="headerlink" title="精选景点组件开发"></a>精选景点组件开发</h3><h4 id="开发步骤-3"><a href="#开发步骤-3" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li>第一步，查找Vant中可以使用的组件</li>
<li>第二步，完成布局，实现组件模板部分</li>
</ul>
<p><code>\src\components\common\Fine.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 精选景点 --&gt;</span><br><span class="line">  &lt;div class="home-fine-box"&gt;</span><br><span class="line">    &lt;!-- 顶上导航 --&gt;</span><br><span class="line">    &lt;van-cell</span><br><span class="line">      title="精选景点"</span><br><span class="line">      icon="location-o"</span><br><span class="line">      is-link</span><br><span class="line">      title-style="text-align:left"</span><br><span class="line">      value="更多" /&gt;</span><br><span class="line">    &lt;!-- // 顶上导航 --&gt;</span><br><span class="line">    &lt;!-- 景点的列表 --&gt;</span><br><span class="line">    &lt;div class="box-main"&gt;</span><br><span class="line">      &lt;!-- ```src\components\common\ListSight.vue```子组件的 --&gt;</span><br><span class="line">      &lt;sight-item v-for="item in dataList"</span><br><span class="line">        :key="item.id"</span><br><span class="line">        :item="item"/&gt;&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //景点的列表 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>
<p><code>Home.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class="page-home"&gt;</span><br><span class="line">    &lt;!-- 精选景点 --&gt;</span><br><span class="line">    &lt;Fine/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 引入组件</span><br><span class="line">import Fine from '@/components/home/Fine'</span><br><span class="line"></span><br><span class="line">export default {</span><br><span class="line">  name: 'Home',</span><br><span class="line">  components: {</span><br><span class="line">    // 精选景点</span><br><span class="line">    Fine,</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><p>第三步，模型层准备数据,从父组件传递数据<br><code>\src\components\common\Fine.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import { ajax } from '@/utils/ajax'</span><br><span class="line">import { SightApis } from '@/utils/apis'</span><br><span class="line">import SightItem from '@/components/common/ListSight'</span><br><span class="line">export default {</span><br><span class="line">  components: {</span><br><span class="line">    SightItem</span><br><span class="line">  },</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      dataList: []</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    /**</span><br><span class="line">     * 查精选景点</span><br><span class="line">     */</span><br><span class="line">    getDataList () {</span><br><span class="line">      ajax.get(SightApis.sightListUrl, {</span><br><span class="line">        params: {</span><br><span class="line">          is_top: 1</span><br><span class="line">        }</span><br><span class="line">      }).then(({ data }) =&gt; {</span><br><span class="line">        this.dataList = data.objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    this.getDataList()</span><br><span class="line">    // this.dataList = [</span><br><span class="line">    //   {id: 1, name: '景点名称', score: 5, price: 98},</span><br><span class="line">    //   {id: 2, name: '景点名称', score: 4.5, price: 98},</span><br><span class="line">    //   {id: 3, name: '景点名称', score: 4, price: 98},</span><br><span class="line">    // ]</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>第四步，添加假数据，实现效果</p>
</li>
</ul>
<h3 id="页面底部组件开发"><a href="#页面底部组件开发" class="headerlink" title="页面底部组件开发"></a>页面底部组件开发</h3><h4 id="开发步骤-4"><a href="#开发步骤-4" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li>第一步，查找Vant中可以使用的组件</li>
<li>第二步，完成布局，实现组件模板部分<br><code>\src\components\common\Footer.vue</code><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 底部导航（公共组件） --&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;van-tabbar v-model="active"&gt;</span><br><span class="line">      &lt;van-tabbar-item name="home" icon="wap-home-o"&gt;首页&lt;/van-tabbar-item&gt;</span><br><span class="line">      &lt;van-tabbar-item name="search" icon="search"&gt;搜索&lt;/van-tabbar-item&gt;</span><br><span class="line">      &lt;van-tabbar-item name="mine" icon="user-o"&gt;我的&lt;/van-tabbar-item&gt;</span><br><span class="line">    &lt;/van-tabbar&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>
<code>Home.vue</code><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class="page-home"&gt;</span><br><span class="line">    &lt;!-- 热门推荐景点 --&gt;</span><br><span class="line">    &lt;Hot/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 引入组件</span><br><span class="line">import TripFooter from '@/components/common/Footer'</span><br><span class="line"></span><br><span class="line">export default {</span><br><span class="line">  name: 'Home',</span><br><span class="line">  components: {</span><br><span class="line">    // 底部导航</span><br><span class="line">    TripFooter</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure></li>
<li>第三步，模型层准备数据<br><code>\src\components\common\Footer.vue</code><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      active: 'home'</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure></li>
<li>第四步，模拟从不同的菜单进入效果</li>
</ul>
<h3 id="模型设计"><a href="#模型设计" class="headerlink" title="模型设计"></a>模型设计</h3><ul>
<li>系统模块（公共的、可服用）：轮播图、用户反馈</li>
<li>景点模块：景点、景点详情、景点评论</li>
<li>用户模块：用户、用户详细信息、登录历史</li>
<li>订单模块：订单、订单明细、支付相关</li>
</ul>
<h3 id="设计轮播图ORM模型"><a href="#设计轮播图ORM模型" class="headerlink" title="设计轮播图ORM模型"></a>设计轮播图ORM模型</h3><h4 id="开发步骤-5"><a href="#开发步骤-5" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li><p>第一步，分析并设计数据库模型<br>创建app</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp system</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>第二步，完成ORM模型编码<br><code>system/model.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Slider</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    name = models.CharField(<span class="string">'名称'</span>, max_length=<span class="number">32</span>)</span><br><span class="line">    desc = models.CharField(<span class="string">'描述'</span>, max_length=<span class="number">32</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    types = models.SmallIntegerField(<span class="string">'展现的位置'</span>, default=<span class="number">10</span>)</span><br><span class="line">    img = models.ImageField(<span class="string">'图片地址'</span>, max_length=<span class="number">255</span>, upload_to=<span class="string">'%Y%m/slider'</span>)</span><br><span class="line">    reorder = models.SmallIntegerField(<span class="string">'排序字段'</span>, default=<span class="number">0</span>, help_text=<span class="string">'数字越大越靠前'</span>)</span><br><span class="line">    start_time = models.DateTimeField(<span class="string">'生效开始时间'</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    end_time = models.CharField(<span class="string">'生效结束时间'</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    target_url = models.CharField(<span class="string">'跳转的地址'</span>, max_length=<span class="number">255</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    is_valid = models.BooleanField(<span class="string">'是否有效'</span>, default=<span class="literal">True</span>)</span><br><span class="line">    created_at = models.DateTimeField(<span class="string">'创建时间'</span>, auto_now_add=<span class="literal">True</span>)</span><br><span class="line">    updated_at = models.DateTimeField(<span class="string">'修改时间'</span>, auto_now=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">'system_slider'</span></span><br><span class="line">        ordering = [<span class="string">'-reorder'</span>]</span><br></pre></td></tr></tbody></table></figure>
<p><code>system/setting.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [<span class="string">'system.apps.SystemConfig'</span>,]</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>第三步，检测ORM模型</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">python manage.py check</span><br><span class="line">``` </span><br><span class="line">- 第四步，模型同步</span><br><span class="line">```bash</span><br><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py migrate</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line"><span class="comment">### 设计轮播图查询接口</span></span><br><span class="line"><span class="comment">#### 开发步骤</span></span><br><span class="line">- 第一步，设计接口返回标准</span><br><span class="line">   - 定义接口的返回结构</span><br><span class="line">   - 接口的错误信息约定</span><br><span class="line">- 第二步，编写接口代码</span><br><span class="line">```system/views.py```</span><br><span class="line">```python</span><br><span class="line">from django import http</span><br><span class="line">from django.http import HttpResponse</span><br><span class="line">from django.shortcuts import render</span><br><span class="line"></span><br><span class="line">from system.models import Slider</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def slider_list(request):</span><br><span class="line">    <span class="string">""</span><span class="string">" 轮播图接口</span></span><br><span class="line"><span class="string">    {</span></span><br><span class="line"><span class="string">        "</span>meta<span class="string">": {},</span></span><br><span class="line"><span class="string">        "</span>objects<span class="string">": []</span></span><br><span class="line"><span class="string">    }</span></span><br><span class="line"><span class="string">    "</span><span class="string">""</span></span><br><span class="line">    data = {</span><br><span class="line">        <span class="string">'meta'</span>: {</span><br><span class="line"></span><br><span class="line">        },</span><br><span class="line">        <span class="string">'objects'</span>: []</span><br><span class="line">    }</span><br><span class="line">    queryset = Slider.objects.filter(is_valid=True)</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> queryset:</span><br><span class="line">        data[<span class="string">'objects'</span>].append({</span><br><span class="line">            <span class="string">'id'</span>: item.id,</span><br><span class="line">            <span class="string">'img_url'</span>: item.img.url,</span><br><span class="line">            <span class="string">'target_url'</span>: item.target_url,</span><br><span class="line">            <span class="string">'name'</span>: item.name</span><br><span class="line">        })</span><br><span class="line">    <span class="comment"># return HttpResponse(data)</span></span><br><span class="line">    <span class="built_in">return</span> http.JsonResponse(data)</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p><code>system/url.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> system <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'slider/list/'</span>, views.slider_list, name=<span class="string">"slider_list"</span>),</span><br><span class="line">]</span><br><span class="line">```  </span><br><span class="line">```trip/url.py```</span><br><span class="line">```python</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path, include</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),</span><br><span class="line">    <span class="comment"># 系统模块</span></span><br><span class="line">    path(<span class="string">'system/'</span>, include(<span class="string">'system.urls'</span>)),</span><br><span class="line">]</span><br><span class="line">``` </span><br><span class="line">- 第三步，模拟HTTP请求，测试验证接口</span><br><span class="line"></span><br><span class="line"><span class="comment">### 设计景点ORM模型</span></span><br><span class="line"><span class="comment">#### 开发步骤</span></span><br><span class="line">- 第一步，分析并设计模型</span><br><span class="line">景点简单信息、景点详细信息</span><br><span class="line">```py</span><br><span class="line">python manage.py startapp sight</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><p>第二步，完成ORM模型编码<br><code>sight/model.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sight</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    <span class="string">""" 景点基础信息 """</span></span><br><span class="line"></span><br><span class="line">    name = models.CharField(<span class="string">'名称'</span>, max_length=<span class="number">64</span>)</span><br><span class="line">    desc = models.CharField(<span class="string">'描述'</span>, max_length=<span class="number">256</span>)</span><br><span class="line">    main_img = models.ImageField(<span class="string">'主图'</span>, upload_to=<span class="string">'%Y%m/sight/'</span>, max_length=<span class="number">256</span>)</span><br><span class="line">    banner_img = models.ImageField(<span class="string">'详情主图'</span>, upload_to=<span class="string">'%Y%m/sight/'</span>, max_length=<span class="number">256</span>)</span><br><span class="line">    content = models.TextField(<span class="string">'详细'</span>)</span><br><span class="line">    score = models.FloatField(<span class="string">'评分'</span>, default=<span class="number">5</span>)</span><br><span class="line">    min_price = models.FloatField(<span class="string">'最低价格'</span>, default=<span class="number">0</span>)</span><br><span class="line">    province = models.CharField(<span class="string">'省份'</span>, max_length=<span class="number">32</span>)</span><br><span class="line">    city = models.CharField(<span class="string">'市区'</span>, max_length=<span class="number">32</span>)</span><br><span class="line">    area = models.CharField(<span class="string">'区/县'</span>, max_length=<span class="number">32</span>, null=<span class="literal">True</span>)</span><br><span class="line">    town = models.CharField(<span class="string">'乡镇'</span>, max_length=<span class="number">32</span>, null=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    is_top = models.BooleanField(<span class="string">'是否为精选景点'</span>, default=<span class="literal">False</span>)</span><br><span class="line">    is_hot = models.BooleanField(<span class="string">'是否为热门景点'</span>, default=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    is_valid = models.BooleanField(<span class="string">'是否有效'</span>, default=<span class="literal">True</span>)</span><br><span class="line">    created_at = models.DateTimeField(<span class="string">'创建时间'</span>, auto_now_add=<span class="literal">True</span>)</span><br><span class="line">    updated_at = models.DateTimeField(<span class="string">'修改时间'</span>, auto_now=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table =<span class="string">'sight'</span></span><br><span class="line">        ordering = [<span class="string">'-updated_at'</span>]</span><br></pre></td></tr></tbody></table></figure>
<p><code>sight/setting.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [<span class="string">'sight.apps.SightConfig'</span>,]</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>第三步，检测ORM模型</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python manage.py check</span><br><span class="line">```  </span><br><span class="line">- 第四步，模型同步</span><br><span class="line">```bash</span><br><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h3 id="设计景点列表API接口"><a href="#设计景点列表API接口" class="headerlink" title="设计景点列表API接口"></a>设计景点列表API接口</h3><h4 id="开发步骤-6"><a href="#开发步骤-6" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li>第一步，设计接口返回内容及字段</li>
<li>第二步，编写接口代码（查数据、分页）<br><code>sight/views.py</code><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> http</span><br><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Q</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"><span class="keyword">from</span> django.views.generic <span class="keyword">import</span> ListView</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sight.models <span class="keyword">import</span> Sight</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SightListView</span>(<span class="params">ListView</span>):</span></span><br><span class="line">    <span class="string">""" 景点列表 """</span></span><br><span class="line">    <span class="comment"># 每页放5条数据</span></span><br><span class="line">    paginate_by = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">""" 重写查询方法 """</span></span><br><span class="line">        query = Q(is_valid=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># 1. 热门景点</span></span><br><span class="line">        is_hot = self.request.GET.get(<span class="string">'is_hot'</span>, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> is_hot:</span><br><span class="line">            query = query &amp; Q(is_hot=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># 2. 精选景点</span></span><br><span class="line">        is_top = self.request.GET.get(<span class="string">'is_top'</span>, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> is_top:</span><br><span class="line">            query = query &amp; Q(is_top=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># TODO 3. 景点名称搜索</span></span><br><span class="line">        queryset = Sight.objects.filter(query)</span><br><span class="line">        <span class="keyword">return</span> queryset</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">render_to_response</span>(<span class="params">self, context, **response_kwargs</span>):</span></span><br><span class="line">        page_obj = context[<span class="string">'page_obj'</span>]</span><br><span class="line">        data = {</span><br><span class="line">            <span class="string">'meta'</span>: {</span><br><span class="line">                <span class="string">'total_count'</span>: page_obj.paginator.count,</span><br><span class="line">                <span class="string">'page_count'</span>: page_obj.paginator.num_pages,</span><br><span class="line">                <span class="string">'current_page'</span>: page_obj.number,</span><br><span class="line">            },</span><br><span class="line">            <span class="string">'objects'</span>: []</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> page_obj.object_list:</span><br><span class="line">            data[<span class="string">'objects'</span>].append({</span><br><span class="line">                <span class="string">'id'</span>: item.id,</span><br><span class="line">                <span class="string">'name'</span>: item.name,</span><br><span class="line">                <span class="string">'main_img'</span>: item.main_img.url,</span><br><span class="line">                <span class="string">'score'</span>: item.score,</span><br><span class="line">                <span class="string">'province'</span>: item.province,</span><br><span class="line">                <span class="string">'min_price'</span>: item.min_price,</span><br><span class="line">                <span class="string">'city'</span>: item.city,</span><br><span class="line">                <span class="comment"># TODO 评论数量暂时无法获取</span></span><br><span class="line">                <span class="string">'comment_count'</span>: <span class="number">0</span></span><br><span class="line">            })</span><br><span class="line">        <span class="keyword">return</span> http.JsonResponse(data)</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p><code>sight/url.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> system <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    <span class="comment"># 景点列表接口</span></span><br><span class="line">    path(<span class="string">'sight/list/'</span>, views.SightListView.as_view(), name=<span class="string">"sight_list"</span>),</span><br><span class="line">]</span><br><span class="line">```  </span><br><span class="line">```trip/url.py```</span><br><span class="line">```python</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path, include</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),</span><br><span class="line">    <span class="comment"># 景点相关的URL</span></span><br><span class="line">    path(<span class="string">'sight/'</span>, include(<span class="string">'sight.urls'</span>))</span><br><span class="line">]</span><br><span class="line">``` </span><br><span class="line">- 第三步，模拟HTTP请求，测试验证接口</span><br><span class="line">```bash</span><br><span class="line">python manage.py runserver</span><br></pre></td></tr></tbody></table></figure>

<h3 id="接口文档编写"><a href="#接口文档编写" class="headerlink" title="接口文档编写"></a>接口文档编写</h3><ul>
<li>第一步，学习Markdown语法，可以生成html结构的文档</li>
<li>第二步，编写文档公共部分</li>
<li>第三步，编写接口文档</li>
</ul>
<h3 id="轮播图接口数据获取-接口联调"><a href="#轮播图接口数据获取-接口联调" class="headerlink" title="轮播图接口数据获取(接口联调)"></a>轮播图接口数据获取(接口联调)</h3><h4 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li><p>第一步，阅读接口文档</p>
</li>
<li><p>第二步，配置接口地址<br><code>src\utils\apis.js</code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 存放项目中所有的接口地址</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> apiHost = <span class="string">'http://localhost:8080/api'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用户账户相关的接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> AccountsApis = {</span><br><span class="line">  loginUrl: <span class="string">'/'</span>,</span><br><span class="line">  logoutUrl: <span class="string">''</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 系统模块的接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> SystemApis = {</span><br><span class="line">  <span class="comment">// 轮播图列表</span></span><br><span class="line">  sliderListUrl: apiHost + <span class="string">'/system/slider/list/'</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> {</span><br><span class="line">  AccountsApis,</span><br><span class="line">  SystemApis</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p><code>vue.config.js</code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Node.js里面的模块</span></span><br><span class="line"><span class="built_in">module</span>.exports = {</span><br><span class="line">  <span class="comment">// http://localhost:8080/api/system/slider/list/</span></span><br><span class="line">  <span class="comment">// =&gt;</span></span><br><span class="line">  <span class="comment">// http://127.0.0.1:8080/system/slider/list/</span></span><br><span class="line">  <span class="comment">// 在Vue.js中解决跨域问题</span></span><br><span class="line">  devServer: {</span><br><span class="line">    proxy: {</span><br><span class="line">      <span class="string">'/api'</span>: {  <span class="comment">// 从/api开头 代理到目标地址</span></span><br><span class="line">        target: <span class="string">'http://127.0.0.1:8000/'</span>,  <span class="comment">// 这个地址的服务器要启动才能访问 </span></span><br><span class="line">        changeOrigin: <span class="literal">true</span>,</span><br><span class="line">        pathRewrite: {</span><br><span class="line">          <span class="string">'^/api'</span>: <span class="string">''</span>   <span class="comment">//  重写URL，空字符表示把/api字符串去掉</span></span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>第三步，在组件中使用axios获取数据<br><code>src/components/home/Bannaer</code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { ajax } <span class="keyword">from</span> <span class="string">'@/utils/ajax'</span></span><br><span class="line"><span class="keyword">import</span> { SystemApis } <span class="keyword">from</span> <span class="string">'@/utils/apis'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> {</span><br><span class="line">  data () {</span><br><span class="line">    <span class="keyword">return</span> {</span><br><span class="line">      bannerList: []</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取轮播图的数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    getDataList () {</span><br><span class="line">      ajax.get(SystemApis.sliderListUrl).then(<span class="function"><span class="params">res</span> =&gt;</span> {</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'res:'</span>, res)</span><br><span class="line">        <span class="built_in">this</span>.bannerList = res.data.objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    <span class="comment">// 从接口获取数据</span></span><br><span class="line">    <span class="built_in">this</span>.getDataList()</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>


</li>
</ul>
<p>django项目的<code>trip/setting.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">STATIC_URL = <span class="string">'/static/'</span>  <span class="comment"># 静态文件的搜索地址</span></span><br><span class="line">MEDIA_URL = <span class="string">'http://localhost:8080/'</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>第四步，将数据设置到模型层<br>Vue组件<code>Banner.vue</code>的模板里的数据<code>img_id</code>和<code>img_url</code>是调用django的视图<code>system/view.py</code>里面的<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 首页的轮播图 --&gt;</span><br><span class="line">  &lt;div class="home-banner-box"&gt;</span><br><span class="line">    &lt;van-swipe class="my-swipe" :autoplay="3000" indicator-color="white"&gt;</span><br><span class="line">      &lt;van-swipe-item v-for="item in bannerList"</span><br><span class="line">        :key="item.id"&gt;</span><br><span class="line">        &lt;img :src="item.img_url" alt=""&gt;</span><br><span class="line">      &lt;/van-swipe-item&gt;</span><br><span class="line">    &lt;/van-swipe&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h3 id="景点列表接口数据获取"><a href="#景点列表接口数据获取" class="headerlink" title="景点列表接口数据获取"></a>景点列表接口数据获取</h3><h4 id="实现步骤-1"><a href="#实现步骤-1" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li>第一步，阅读接口文档</li>
<li>第二步，配置接口地址<br><code>src\utils\apis.js</code><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 景点模块</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> SightApis = {</span><br><span class="line">  <span class="comment">// 景点列表</span></span><br><span class="line">  sightListUrl: apiHost + <span class="string">'/sight/sight/list/'</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> {</span><br><span class="line">  SightApis</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<code>vue.config.js</code><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">``</span><span class="string">`</span></span><br><span class="line"><span class="string">- 第三步，使用axios获取数据</span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>js</span><br><span class="line">methods: {</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查热门景点</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    getDataList () {</span><br><span class="line">      ajax.get(SightApis.sightListUrl, {</span><br><span class="line">        params: {</span><br><span class="line">          is_hot: <span class="number">1</span></span><br><span class="line">        }</span><br><span class="line">      }).then(<span class="function">(<span class="params">{ data }</span>) =&gt;</span> {</span><br><span class="line">        <span class="built_in">this</span>.dataList = data.objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  }</span><br></pre></td></tr></tbody></table></figure></li>
<li>第四步，将数据设置到模型层，<br>Vue组件<code>Hot.vue</code>的模板里的数据<code>main_img</code>和<code>name</code>和<code>min_price</code>是调用django的视图<code>sight/view.py</code>里面的<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 热门景点 --&gt;</span><br><span class="line">  &lt;div class="home-hot-box"&gt;</span><br><span class="line">    &lt;!-- 顶上导航 --&gt;</span><br><span class="line">    &lt;van-cell</span><br><span class="line">      title="热门推荐"</span><br><span class="line">      icon="/static/home/hot/fire.png"</span><br><span class="line">      is-link</span><br><span class="line">      title-style="text-align:left"</span><br><span class="line">      value="全部榜单" /&gt;</span><br><span class="line">    &lt;!-- // 顶上导航 --&gt;</span><br><span class="line">    &lt;!-- 景点列表 --&gt;</span><br><span class="line">    &lt;div class="box-main"&gt;</span><br><span class="line">      &lt;a href="#" class="hot-item"</span><br><span class="line">        v-for="item in dataList"</span><br><span class="line">        :key="item.id"&gt;</span><br><span class="line">        &lt;div class="img"&gt;</span><br><span class="line">          &lt;span&gt;&lt;/span&gt;</span><br><span class="line">          &lt;img :src="item.main_img" alt=""&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;!-- ellipsis 省略号 意思是超过一定长度变成省略号 --&gt;</span><br><span class="line">        &lt;h5 class="van-ellipsis"&gt;{{ item.name }}&lt;/h5&gt;</span><br><span class="line">        &lt;div class="line-price"&gt;</span><br><span class="line">          &lt;span class="price"&gt;￥{{ item.min_price }}&lt;/span&gt;起</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //景点列表 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p>Vue组件<code>Fine.vue</code>的模板里的数据<code>is_top</code>和<code>name</code>和<code>min_price</code>是调用django的视图<code>sight/view.py</code>里面的</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import SightItem from '@/components/common/ListSight'</span><br><span class="line">export default {</span><br><span class="line">  components: {</span><br><span class="line">    SightItem</span><br><span class="line">  },</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      dataList: []</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    /**</span><br><span class="line">     * 查精选景点</span><br><span class="line">     */</span><br><span class="line">    getDataList () {</span><br><span class="line">      ajax.get(SightApis.sightListUrl, {</span><br><span class="line">        params: {</span><br><span class="line">          is_top: 1</span><br><span class="line">        }</span><br><span class="line">      }).then(({ data }) =&gt; {</span><br><span class="line">        this.dataList = data.objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    this.getDataList()</span><br><span class="line">    // this.dataList = [</span><br><span class="line">    //   {id: 1, name: '景点名称', score: 5, price: 98},</span><br><span class="line">    //   {id: 2, name: '景点名称', score: 4.5, price: 98},</span><br><span class="line">    //   {id: 3, name: '景点名称', score: 4, price: 98},</span><br><span class="line">    // ]</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<p><code>src\components\common\ListSight.vue</code>的<code>name</code>和<code>score</code>是调用<code>sight/view.py</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;a href="#" class="sight-item"&gt;</span><br><span class="line">    &lt;img :src="item.main_img" :alt="item.name"&gt;</span><br><span class="line">    &lt;div class="right"&gt;</span><br><span class="line">      &lt;h5&gt;{{ item.name }}&lt;/h5&gt;</span><br><span class="line">      &lt;van-rate v-model="item.score" readonly/&gt;</span><br><span class="line">      &lt;div class="tips"&gt;{{ item.comment_count }}人点评 | 100%满意&lt;/div&gt;</span><br><span class="line">      &lt;div class="tips light"&gt;{{ item.province }} - {{ item.city }}&lt;/div&gt;</span><br><span class="line">      &lt;div class="line-price"&gt;￥ {{ item.min_price }} 起&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/a&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/java-shu-ju-lei-xing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/java-shu-ju-lei-xing/" class="post-title-link" itemprop="url">java数据类型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-22 00:57:13" itemprop="dateModified" datetime="2021-04-22T00:57:13Z">2021-04-22</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>内置数据类型<br>Java语言提供了八种基本类型。六种数字类型（四个整数型，两个浮点型），一种字符类型，还有一种布尔型。</p>
<p>byte 字节型，在内存中占1个字节 8位、有符号的，以二进制补码表示的整数；<br>最小值是 -128（-2^7）；<br>最大值是 127（2^7-1）；<br>默认值是 0；<br>byte 类型用在大型数组中节约空间，主要代替整数，因为 byte 变量占用的空间只有 int 类型的四分之一；<br>例子：byte a = 100，byte b = -50。</p>
<p>short 短整型，2个字节 16个二进制位、有符号的以二进制补码表示的整数<br>7483647，默认值0<br>最小值是 -32768（-2^15）；<br>最大值是 32767（2^15 - 1）；<br>默认值是 0；<br>Short 数据类型也可以像 byte 那样节省空间。一个short变量是int型变量所占空间的二分之一；<br>例子：short s = 1000，short r = -20000。</p>
<p>int：整型，4个字节 32个二进制位、有符号的以二进制补码表示的整数；<br>整型变量默认为 int 类型；整型字面值默认情况下是int类型<br>最小值是 -2,147,483,648（-2^31）；<br>最大值是 2,147,483,647（2^31 - 1）；<br>默认值是 0 ；<br>例子：<code>int a = 100000</code><br>定义变量的同时对变量进行初始化<br>变量a和它的值在内存当中如何存储的？在内存的栈中开辟int类型大小的空间，把100这个整型字面值存储到开辟的空间中，变量名a看作是100所在的内存空间的别名，a就代表100</p>
<p>long：长整型，在内存中占8个字节，64个二进制位、有符号的以二进制补码表示的整数；<br>最小值是 -9,223,372,036,854,775,808（-2^63）；<br>最大值是 9,223,372,036,854,775,807（2^63 -1）；<br>默认值是 0L；<br>这种类型主要使用在需要比较大整数的系统上；</p>
<p>例子： long a = 100000L，Long b = -200000L，Long c = 0x1abcL。<br>长整型则在末尾加l或L，”L”理论上不分大小写，但是若写成”l”容易与数字”1”混淆，不容易分辩。所以最好大写。</p>
<p>数据表示范围依次增大。选择数据类型的时候可以参考表示范围来选取，但实际应用中，int和long是常用的数据类型，而byte和short使用较少，即使数值比较小一般也会使用int类型。<br>byte类型主要对二进制数据进行存储，在文件输入输出流部分将会使用，用于二进制数据的传输。<br>short类型在有的需求中会用到，比如：对于登录账号的状态表示，一般用0表示正常，1表示冻结，2表示已删除。这里的数值比较固定，值也比较小，可以使用short类型表示。</p>
<p>浮点数就是小数点在逻辑上是不固定的</p>
<p>float：数据类型是单精度浮点型，在内存中占4个字节，32位，精度是 7<del>8 位，符合IEEE 754标准的浮点数；用于存储带小数点的数字（与double的区别在于float类型有效小数点只有6</del>7位而且在内存中的占的位数也不同），<br>则需要在字面值后加f或F<br>默认值是 0.0f；<br>在储存大型浮点数组的时候可节省内存空间；<br>浮点数不能用来表示精确的值，如货币；<br>例子：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">float</span> f1 = <span class="number">234.5f</span></span><br><span class="line"><span class="keyword">float</span> f1 = <span class="number">234.5F</span></span><br><span class="line"><span class="comment">// 后面不加d或者f表示double，double比float数据表示范围大</span></span><br><span class="line"><span class="keyword">float</span> f1 = <span class="number">234.5</span> <span class="comment">// java: 不兼容的类型: 从double转换到float可能会有损失</span></span><br></pre></td></tr></tbody></table></figure>

<p>double 双精度浮点型，在内存中占8个字节 64 位，精度是 16~17 位，符合IEEE 754标准的浮点数；<br>用于存储带有小数点的数字，<br>浮点数（浮点型字面值）的默认类型为double类型；<br>后面不加d或者f表示double，也可以在值后加d或D<br>double类型同样不能表示精确的值，如货币；<br>默认值是 0.0d；<br>例子：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> d1 = <span class="number">123.4</span></span><br><span class="line"><span class="keyword">double</span> d2 = <span class="number">123.4d</span></span><br><span class="line"><span class="keyword">double</span> d3 = <span class="number">123.4D</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="科学计数法表示浮点数"><a href="#科学计数法表示浮点数" class="headerlink" title="科学计数法表示浮点数"></a>科学计数法表示浮点数</h3><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> x = <span class="number">1.23E5</span>;</span><br><span class="line">System.out.println(<span class="string">"x="</span> + x);  <span class="comment">// x=123000.0</span></span><br><span class="line"><span class="keyword">float</span> y = <span class="number">1.23e5f</span>;</span><br><span class="line">System.out.println(<span class="string">"y="</span> + y);  <span class="comment">// y=123000.0</span></span><br><span class="line"><span class="keyword">double</span> z = .<span class="number">2</span>;</span><br><span class="line">System.out.println(<span class="string">"z="</span> + z);  <span class="comment">// z=0.2</span></span><br></pre></td></tr></tbody></table></figure>

<p>boolean数据类型表示1个字节8位的信息；<br>只有两个取值：true 和 false；<br>这种类型只作为一种标志来记录 true/false 情况；<br>默认值是 false；<br>例子：<code>boolean one = true</code>。</p>
<p>二、浮点型的应用场景<br>浮点类型表示小数，包括float和double两种类型，具体使用哪种数据类型，也是可以按照表示范围进行选择。但double类型<br>使用相对较多。<br>应用场景主要是要求数据精度高、并且数据量大的情况，如：医学、化学、军事、天文等领域。<br>这里需要注意，浮点型因为其表示方式的原因，会产生精度丢失的问题，</p>
<p>精确计算<br>通过 BigDecimal 类，先将浮点型数据转换为 String 类型的数据，然后再进行相应的计算。<br>以下为利用 BigDecimal 类进行加法和减法运算的测试代码</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.imooc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        <span class="keyword">double</span> a = <span class="number">1.9</span>;</span><br><span class="line">        <span class="keyword">double</span> b = <span class="number">1.7</span>;</span><br><span class="line">        System.out.println(<span class="string">"直接进行减法运算，运算结果:\n"</span> + (a - b));</span><br><span class="line">        System.out.println(<span class="string">"利用 BigDecimal类的进行减法运算结果:\n"</span> + sub(a, b));</span><br><span class="line">        System.out.println();</span><br><span class="line">        System.out.println(<span class="string">"直接进行加法运算，运算结果:\n"</span> + (a + b));</span><br><span class="line">        System.out.println(<span class="string">"利用 BigDecimal类的进行加法运算结果:\n"</span> + add(a, b));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//利用 BigDecimal类的进行减法运算</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">sub</span><span class="params">(<span class="keyword">double</span> v1, <span class="keyword">double</span> v2)</span> </span>{</span><br><span class="line">        <span class="comment">//将浮点数转为 String类型</span></span><br><span class="line">        BigDecimal b1 = <span class="keyword">new</span> BigDecimal(Double.toString(v1));</span><br><span class="line">        BigDecimal b2 = <span class="keyword">new</span> BigDecimal(Double.toString(v2));</span><br><span class="line">        <span class="comment">//通过 BigDecimal类中 subtract方法完成减法运算,</span></span><br><span class="line">        <span class="comment">// 其中b1是被减数,b2是减数</span></span><br><span class="line">        <span class="keyword">double</span> b = b1.subtract(b2).doubleValue();</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//利用 BigDecimal类的进行加法运算</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">add</span><span class="params">(<span class="keyword">double</span> v1, <span class="keyword">double</span> v2)</span> </span>{</span><br><span class="line">        BigDecimal b1 = <span class="keyword">new</span> BigDecimal(Double.toString(v1));</span><br><span class="line">        BigDecimal b2 = <span class="keyword">new</span> BigDecimal(Double.toString(v2));</span><br><span class="line">        <span class="keyword">return</span> b1.add(b2).doubleValue();</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>char character类型是一个单一的占2个字节，16个二进制位 无符号Unicode 字符；<br>最小值是 \u0000（即为 0）；<br>最大值是 \uffff（即为65,535）；<br>char 数据类型可以储存任何字符；字符就是整数类型<br>例子：<code>char letter = 'A';</code>。</p>
<p>abstract 修饰抽象类。</p>
<p>break 一般用于循环里面作用是结束当前循环。 </p>
<p>case 用于swith里面。<br> continue 结束当天循环进入下次循环。 default 用于 swith case与<br>接口里。 do 用于循环，一般用于 do{循环内容}(判断条件)；<br>else 用于判断 if(条件){ } else if(条件){} else{}. extends 子类继承父<br>类。false 可以用于判断条件 也可以给boolean赋值。final 修饰的类不可被继承<br>方法不能被重新 变量不可变。 finally 用于try catch 的结尾 表示最终一定会执<br>行 也会不会的执行的情况例如在try catch 里面有return语句，死循环等 Syste<br>m.exit() 中止 守护线程等。</p>
<p>for 循环。<br>if 判断。 </p>
<p>implements 实现接口，一个类型可以实现多个接口。 import 导入。 native 修饰方<br>法为本地方法。 </p>
<p>interface 定义接口。<br>instan</p>
<p>常见的常量类型有<br>整型常量（int），浮点数常量（float）,布尔型常量（boolean），字符常量（char），<br>字符串常量（string），引用类型常量。<br>String&nbsp;是一种常见的引用数据类型，用来表示字符串，即多个字符。<br>例如系统中的用户名、密码、电子邮箱等。</p>
<p>格式化字符串字面值&nbsp;</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">'python'</span></span><br><span class="line">b=len(a)</span><br><span class="line">print('hah'+str(b))#hah6</span><br><span class="line">print(f<span class="string">'hah{b}'</span>)</span><br><span class="line">print(<span class="string">'hah{}'</span>.format(b))</span><br></pre></td></tr></tbody></table></figure>
<p>{&nbsp;&nbsp;}&nbsp;来标记变量将被替换的位置</p>
<h3 id="变量声明"><a href="#变量声明" class="headerlink" title="变量声明"></a>变量声明</h3><p>格式：<code>数据类型 变量名；</code></p>
<figure class="highlight plain"><figcaption><span>n;``` 声明整型变量n</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">```long count;``` 声明长整型变量count</span><br><span class="line"></span><br><span class="line">- 相同类型的数据变量可以一次定义多个，变量名之间用逗号隔开</span><br><span class="line">```float a,b1=1.23f;```a是float类型，但是没初始化，bfloat类型且初始化</span><br><span class="line"></span><br><span class="line">- 同方法内不可以重复定义相同的变量名</span><br><span class="line"></span><br><span class="line">### 使用“＝”运算符进行赋值</span><br><span class="line">“＝”叫作赋值运算符，将运算符右边的值赋给左边的变量。</span><br><span class="line">例：```int n;``` 定义int型变量n  </span><br><span class="line">```n=3;``` 将3赋值给n</span><br><span class="line">- 可以在定义变量的同时给变量赋值，即变量的初始化。</span><br><span class="line">例：```int n=3;```</span><br><span class="line">- 数据类型 变量名＝变量值</span><br><span class="line"></span><br><span class="line">变量定义</span><br><span class="line">```java</span><br><span class="line">int octal=037; //定义int类型变量存放八进制数据</span><br><span class="line">long longNumber=0xa2cdf3ffL; //定义变量存放十六进制长整型数据</span><br><span class="line">short shortNumber=123;  //定义变量存放短整型数据</span><br><span class="line">byte b=10; //定义变量存放byte类型数据</span><br></pre></td></tr></tbody></table></figure>

<h3 id="语句"><a href="#语句" class="headerlink" title="语句"></a>语句</h3><ul>
<li>以分号结束</li>
<li>不能换到一行写</li>
<li>单行注释，注释一行</li>
</ul>
<h3 id="数据类型分类"><a href="#数据类型分类" class="headerlink" title="数据类型分类"></a>数据类型分类</h3><ul>
<li><p>基本数据类型 </p>
</li>
<li><p>引用数据类型<br>存的是保存数据的空间地址，这个抽屉的钥匙，钥匙和抽屉一一对应</p>
<ul>
<li>类 class</li>
<li>接口 interface</li>
<li>数组</li>
</ul>
</li>
</ul>
<p>类定义的变量又叫对象</p>
<h3 id="按照作用范围分为"><a href="#按照作用范围分为" class="headerlink" title="按照作用范围分为:"></a>按照作用范围分为:</h3><ul>
<li>类级</li>
<li>对象实例级</li>
<li>方法级（局部变量，定义在主方法中）</li>
<li>块级</li>
</ul>
<h3 id="字面值是常量和变量实际表示的数值，都是有数据类型的"><a href="#字面值是常量和变量实际表示的数值，都是有数据类型的" class="headerlink" title="字面值是常量和变量实际表示的数值，都是有数据类型的"></a>字面值是常量和变量实际表示的数值，都是有数据类型的</h3><p>字面值是常量的一种</p>
<h3 id="字符型字面值"><a href="#字符型字面值" class="headerlink" title="字符型字面值"></a>字符型字面值</h3><p>用单引号内的只有一个单个字符表示，不能双引号<br>字符：单个字母，键盘上的，空格也是字符，算长度空格也算<br>如：<code>char ‘a’</code>，<code>char ‘b’</code>，<code>char ‘$’</code>，<br>不能写<code>char "a"</code></p>
<ul>
<li>如何定义字符型变量？<h4 id="类型转换分为"><a href="#类型转换分为" class="headerlink" title="类型转换分为"></a>类型转换分为</h4></li>
</ul>
<ol>
<li><p>自动类型转换（隐式）<br>数据所表示的数据范围小的转换位所表示的数据范围大的</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">       <span class="comment">// 定义一个变量存放字符'a'，字符a的值赋值字符变量a</span></span><br><span class="line">       <span class="keyword">char</span> a = <span class="string">'a'</span>;</span><br><span class="line">       System.out.println(<span class="string">"a="</span> + a);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// 整型赋值给char类型，如果字面值没有超出char类型所表示的数据范围，转换成它的ASCII值所对应的字符数据</span></span><br><span class="line"><span class="keyword">char</span> ascii_97 = <span class="number">97</span>;  <span class="comment">// a=a</span></span><br><span class="line">System.out.println(<span class="string">"ascii_97="</span> + ascii_97);  <span class="comment">// ascii_97=a</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>强制类型转换<br>如果A类型的数据表示范围比B类型大，则将A类型的值赋值给B类型，需要强制类型转换<br>格式<code>（数据类型） 数值</code><br><code>double d＝123.4;</code><br><code>float f=(float)d;</code></p>
</li>
</ol>
<p>如果字面值超出char类型所表示的数据范围，需要进行强制类型转换。</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> <span class="keyword">var</span> = (<span class="keyword">long</span>) <span class="number">1.9e8</span>;</span><br><span class="line">System.out.println(<span class="string">"var="</span> + <span class="keyword">var</span>);  <span class="comment">// var=190000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> z = <span class="keyword">var</span>;</span><br><span class="line">System.out.println(<span class="string">"z="</span> + z);  <span class="comment">// z=1.9E8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> ch = <span class="number">65535</span>;</span><br><span class="line"><span class="keyword">char</span> ch1 = (<span class="keyword">char</span>) <span class="number">65536</span>;</span><br><span class="line">System.out.println(<span class="string">"ch="</span> + ch);  <span class="comment">// ch=￿</span></span><br><span class="line">System.out.println(<span class="string">"ch1="</span> + ch1);  <span class="comment">// ch1=</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//char类型和int类型之间的转换</span></span><br><span class="line"><span class="keyword">char</span> c = (<span class="keyword">char</span>) <span class="number">65536</span>;</span><br><span class="line">System.out.println(<span class="string">"c="</span> + c);  <span class="comment">// c=</span></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">n = c;<span class="comment">//隐式类型转换</span></span><br><span class="line">System.out.println(<span class="string">"n="</span> + n);  <span class="comment">// n=0</span></span><br><span class="line">c = (<span class="keyword">char</span>) n;</span><br><span class="line">System.out.println(<span class="string">"c="</span> + c);  <span class="comment">// c=</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//整型和整型的类型转换问题</span></span><br><span class="line"><span class="keyword">long</span> l = <span class="number">987654321</span>;</span><br><span class="line"><span class="keyword">int</span> i = (<span class="keyword">int</span>) l;</span><br><span class="line">System.out.println(<span class="string">"i="</span> + i);</span><br><span class="line"></span><br><span class="line"><span class="comment">//整型和浮点型的类型转换问题</span></span><br><span class="line"><span class="keyword">int</span> x = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">long</span> y = x;</span><br><span class="line">x = (<span class="keyword">int</span>) y;</span><br><span class="line"><span class="keyword">float</span> f = <span class="number">100000000000000L</span>;</span><br><span class="line">System.out.println(<span class="string">"f="</span> + f);  <span class="comment">// f=1.0E14</span></span><br><span class="line"><span class="keyword">float</span> f1 = <span class="number">103948583923948L</span>;</span><br><span class="line">System.out.println(<span class="string">"f1="</span> + f1);  <span class="comment">// f1=1.03948585E14 数据丢失</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="字符串字面值"><a href="#字符串字面值" class="headerlink" title="字符串字面值"></a>字符串字面值</h3><ul>
<li>双引号引起来的0个或多个字符<br>字符串不属于基本数据类型，它是类，双引号的<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个空字符串</span></span><br><span class="line">String s1 = <span class="string">""</span>;</span><br><span class="line">System.out.println(<span class="string">"s1="</span> + s1);  <span class="comment">// s1=</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个包含空格的字符串</span></span><br><span class="line">String s5 = <span class="string">"Hello   imooc!"</span>;</span><br><span class="line">System.out.println(<span class="string">"s5="</span> + s5);  <span class="comment">// s4=Hello   imooc!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个字符串，内容是Hello</span></span><br><span class="line">String s2 = <span class="string">"Hello"</span>;</span><br><span class="line">System.out.println(<span class="string">"s2="</span> + s2);  <span class="comment">// s2=Hello</span></span><br><span class="line"><span class="comment">//定义一个unicode字符的字符串</span></span><br><span class="line">String s3 = <span class="string">"\u005d\u005f"</span>;</span><br><span class="line">System.out.println(<span class="string">"s3="</span> + s3);  <span class="comment">// s3=]_</span></span><br><span class="line"><span class="comment">//定义一个包含unicode字符和其他字符写在一起的字符串</span></span><br><span class="line">String s4 = <span class="string">"A\u005d\u005fB"</span>;</span><br><span class="line">System.out.println(<span class="string">"s4="</span> + s4);  <span class="comment">// s4=A]_B</span></span><br></pre></td></tr></tbody></table></figure>


</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="number">3</span> + <span class="string">"\t"</span> + <span class="number">5</span>);</span><br><span class="line"><span class="comment">// 3    5 双引号只有一个字符的字符串</span></span><br><span class="line">System.out.println(<span class="number">3</span> + <span class="string">'\t'</span> + <span class="number">5</span>);</span><br><span class="line"><span class="comment">// 17 双引号只有一个字符的字符串</span></span><br><span class="line">System.out.println(<span class="number">3</span> + <span class="string">"\t"</span> + <span class="number">5</span> + <span class="string">'\n'</span>);</span><br><span class="line"><span class="comment">// 3    5 双引号只有一个字符的字符串，字符串连接</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">System.out.println(<span class="number">3</span> + <span class="string">'\t'</span> + <span class="number">5</span> + <span class="string">'\n'</span>);  </span><br><span class="line"><span class="comment">// 27 字符就是整型，把字符都转换成整数，进行加法运算</span></span><br><span class="line">System.out.println(<span class="string">""</span> + <span class="number">3</span> + <span class="string">'\t'</span> + <span class="number">5</span> + <span class="string">'\n'</span>);  </span><br><span class="line"><span class="comment">// 3    5 最前面加一个空串，一开始就是做字符串连接</span></span><br><span class="line">System.out.println(<span class="string">'\n'</span> + <span class="number">3</span> + <span class="string">"\t"</span> + <span class="number">5</span>);  </span><br><span class="line"><span class="comment">// 13</span></span><br><span class="line">System.out.println(<span class="string">"\n"</span> + <span class="number">3</span> + <span class="string">"\t"</span> + <span class="number">5</span>);</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// 3    5</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="布尔类型字面值"><a href="#布尔类型字面值" class="headerlink" title="布尔类型字面值"></a>布尔类型字面值</h3><p>布尔值只能定义为true和false<br>例：<code>boolean b=true;</code></p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// FloatDemo.java</span></span><br><span class="line"><span class="keyword">package</span> com.imooc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FloatDemo</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        <span class="comment">//定义一个单精度浮点型变量，存放1234.328</span></span><br><span class="line">        <span class="keyword">float</span> f = <span class="number">1234.328f</span>;</span><br><span class="line">        System.out.println(<span class="string">"f="</span> + f);</span><br><span class="line">        <span class="comment">//f=1234.328</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//定义一个双精度浮点型变量，存放5623.465</span></span><br><span class="line">        <span class="keyword">double</span> d = <span class="number">5623.464</span>;</span><br><span class="line">        System.out.println(<span class="string">"d="</span> + d);</span><br><span class="line">        <span class="comment">//d=5623.464</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//将整型赋值给浮点型</span></span><br><span class="line">        <span class="keyword">double</span> d1 = <span class="number">123</span>;</span><br><span class="line">        System.out.println(<span class="string">"d1="</span> + d1);</span><br><span class="line">        <span class="comment">//d1=123.0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//变量间的赋值</span></span><br><span class="line">        <span class="keyword">double</span> d2 = d;</span><br><span class="line">        System.out.println(<span class="string">"d2="</span> + d2);</span><br><span class="line">        <span class="comment">//d2=5623.464</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//将单精度浮点型赋值给双精度</span></span><br><span class="line">        <span class="keyword">double</span> d3 = <span class="number">1.23f</span>;</span><br><span class="line">        System.out.println(<span class="string">"d3="</span> + d3);</span><br><span class="line">        <span class="comment">//d3=1.2300000190734863</span></span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>整数型的阈值 </p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrimitiveTypeTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        <span class="comment">// byte</span></span><br><span class="line">        System.out.println(<span class="string">"基本类型：byte 二进制位数："</span> + Byte.SIZE);</span><br><span class="line">        System.out.println(<span class="string">"包装类：java.lang.Byte"</span>);</span><br><span class="line">        System.out.println(<span class="string">"最小值：Byte.MIN_VALUE="</span> + Byte.MIN_VALUE);</span><br><span class="line">        System.out.println(<span class="string">"最大值：Byte.MAX_VALUE="</span> + Byte.MAX_VALUE);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// short</span></span><br><span class="line">        System.out.println(<span class="string">"基本类型：short 二进制位数："</span> + Short.SIZE);</span><br><span class="line">        System.out.println(<span class="string">"包装类：java.lang.Short"</span>);</span><br><span class="line">        System.out.println(<span class="string">"最小值：Short.MIN_VALUE="</span> + Short.MIN_VALUE);</span><br><span class="line">        System.out.println(<span class="string">"最大值：Short.MAX_VALUE="</span> + Short.MAX_VALUE);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// int</span></span><br><span class="line">        System.out.println(<span class="string">"基本类型：int 二进制位数："</span> + Integer.SIZE);</span><br><span class="line">        System.out.println(<span class="string">"包装类：java.lang.Integer"</span>);</span><br><span class="line">        System.out.println(<span class="string">"最小值：Integer.MIN_VALUE="</span> + Integer.MIN_VALUE);</span><br><span class="line">        System.out.println(<span class="string">"最大值：Integer.MAX_VALUE="</span> + Integer.MAX_VALUE);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// long</span></span><br><span class="line">        System.out.println(<span class="string">"基本类型：long 二进制位数："</span> + Long.SIZE);</span><br><span class="line">        System.out.println(<span class="string">"包装类：java.lang.Long"</span>);</span><br><span class="line">        System.out.println(<span class="string">"最小值：Long.MIN_VALUE="</span> + Long.MIN_VALUE);</span><br><span class="line">        System.out.println(<span class="string">"最大值：Long.MAX_VALUE="</span> + Long.MAX_VALUE);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// float</span></span><br><span class="line">        System.out.println(<span class="string">"基本类型：float 二进制位数："</span> + Float.SIZE);</span><br><span class="line">        System.out.println(<span class="string">"包装类：java.lang.Float"</span>);</span><br><span class="line">        System.out.println(<span class="string">"最小值：Float.MIN_VALUE="</span> + Float.MIN_VALUE);</span><br><span class="line">        System.out.println(<span class="string">"最大值：Float.MAX_VALUE="</span> + Float.MAX_VALUE);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// double</span></span><br><span class="line">        System.out.println(<span class="string">"基本类型：double 二进制位数："</span> + Double.SIZE);</span><br><span class="line">        System.out.println(<span class="string">"包装类：java.lang.Double"</span>);</span><br><span class="line">        System.out.println(<span class="string">"最小值：Double.MIN_VALUE="</span> + Double.MIN_VALUE);</span><br><span class="line">        System.out.println(<span class="string">"最大值：Double.MAX_VALUE="</span> + Double.MAX_VALUE);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// char</span></span><br><span class="line">        System.out.println(<span class="string">"基本类型：char 二进制位数："</span> + Character.SIZE);</span><br><span class="line">        System.out.println(<span class="string">"包装类：java.lang.Character"</span>);</span><br><span class="line">        <span class="comment">// 以数值形式而不是字符形式将Character.MIN_VALUE输出到控制台</span></span><br><span class="line">        System.out.println(<span class="string">"最小值：Character.MIN_VALUE="</span></span><br><span class="line">                + (<span class="keyword">int</span>) Character.MIN_VALUE);</span><br><span class="line">        <span class="comment">// 以数值形式而不是字符形式将Character.MAX_VALUE输出到控制台</span></span><br><span class="line">        System.out.println(<span class="string">"最大值：Character.MAX_VALUE="</span></span><br><span class="line">                + (<span class="keyword">int</span>) Character.MAX_VALUE);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight routeros"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">基本类型：byte 二进制位数：8</span><br><span class="line">包装类：java.lang.Byte</span><br><span class="line">最小值：Byte.<span class="attribute">MIN_VALUE</span>=-128</span><br><span class="line">最大值：Byte.<span class="attribute">MAX_VALUE</span>=127</span><br><span class="line"></span><br><span class="line">基本类型：short 二进制位数：16</span><br><span class="line">包装类：java.lang.Short</span><br><span class="line">最小值：Short.<span class="attribute">MIN_VALUE</span>=-32768</span><br><span class="line">最大值：Short.<span class="attribute">MAX_VALUE</span>=32767</span><br><span class="line"></span><br><span class="line">基本类型：int 二进制位数：32</span><br><span class="line">包装类：java.lang.Integer</span><br><span class="line">最小值：Integer.<span class="attribute">MIN_VALUE</span>=-2147483648</span><br><span class="line">最大值：Integer.<span class="attribute">MAX_VALUE</span>=2147483647</span><br><span class="line"></span><br><span class="line">基本类型：long 二进制位数：64</span><br><span class="line">包装类：java.lang.Long</span><br><span class="line">最小值：Long.<span class="attribute">MIN_VALUE</span>=-9223372036854775808</span><br><span class="line">最大值：Long.<span class="attribute">MAX_VALUE</span>=9223372036854775807</span><br><span class="line"></span><br><span class="line">基本类型：float 二进制位数：32</span><br><span class="line">包装类：java.lang.Float</span><br><span class="line">最小值：Float.<span class="attribute">MIN_VALUE</span>=1.4E-45</span><br><span class="line">最大值：Float.<span class="attribute">MAX_VALUE</span>=3.4028235E38</span><br><span class="line"></span><br><span class="line">基本类型：double 二进制位数：64</span><br><span class="line">包装类：java.lang.Double</span><br><span class="line">最小值：Double.<span class="attribute">MIN_VALUE</span>=4.9E-324</span><br><span class="line">最大值：Double.<span class="attribute">MAX_VALUE</span>=1.7976931348623157E308</span><br><span class="line"></span><br><span class="line">基本类型：char 二进制位数：16</span><br><span class="line">包装类：java.lang.Character</span><br><span class="line">最小值：Character.<span class="attribute">MIN_VALUE</span>=0</span><br><span class="line">最大值：Character.<span class="attribute">MAX_VALUE</span>=65535</span><br></pre></td></tr></tbody></table></figure>

<p>基本类型的创建：先去常量池中找是否存在该值，如果存在直接调取引用，如果不存在则先在常量池中创建该值，在调引用</p>
<p>所以，不可以创建一个空值给基本数据类型。</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/mock/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/mock/" class="post-title-link" itemprop="url">HTML</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:46" itemprop="dateModified" datetime="2021-04-02T12:24:46Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Markdown/" itemprop="url" rel="index"><span itemprop="name">Markdown</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>mock用来替代你测试应用的某一部分<br>好处<br>1：加快测试速度，如果你的应用是依赖于资源的，mock可以有效减少资源的占用<br>2：避免不必要的副作用</p>
<p>在单元测试进行的同时，就离不开mock模块的存在，初次接触这个概念的时候会有这样的疑问：把要测的东西都模拟掉了还测试什么呢？<br>　　但在，实际生产中的项目是非常复杂的，对其进行单元测试的时候，会遇到以下问题：<br>•接口的依赖<br>•外部接口调用<br>•测试环境非常复杂<br>单元测试应该只针对当前单元进行测试, 所有的内部或外部的依赖应该是稳定的, 已经在别处进行测试过的.使用mock 就可以对外部依赖组件实现进行模拟并且替换掉, 从而使得单元测试将焦点只放在当前的单元功能。<br>在这里插入图片描述<br>因为在为代码进行单元测试的同时，会发现该模块依赖于其他的模块，例如数据库，网络，或者第三方模块的存在，而我们对一个模块进行单元测试的目的，是测试当前模块正常工作，这样就要避开对其他模块的依赖，而mock主要作用便在于，专注于待测试的代码。而在但与测试中，如何灵活的使用mock模块是核心所在。下面便以mock为核心，结合最近所写的代码，阐述mock模块的使用。</p>
<p>这个例子，本来被调用的sum函数要执行很长时间为了加快测试进度，我们使用patch装饰器来直接mock sum函数</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> unittest <span class="keyword">import</span> TestCase</span><br><span class="line"><span class="keyword">from</span> unittest.mock <span class="keyword">import</span> patch</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span>(<span class="params">a, b</span>):</span></span><br><span class="line">    time.sleep(<span class="number">100</span>)  <span class="comment"># long running process</span></span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestCalculator</span>(<span class="params">TestCase</span>):</span></span><br><span class="line">    <span class="comment"># 用patch装饰器来mock对象</span></span><br><span class="line"><span class="meta">    @patch('__main__.sum', return_value=5)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_sum</span>(<span class="params">self, sum</span>):</span></span><br><span class="line">        self.assertEqual(sum(<span class="number">2</span>, <span class="number">3</span>), <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    unittest.main()</span><br><span class="line"><span class="comment"># ----------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># Ran 1 test in 0.001s</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># OK</span></span><br></pre></td></tr></tbody></table></figure>

<ol start="7">
<li>mock模块的使用<br>在mock模块中，两个常用的类型为Mock，MagicMock，两个类的关系是MagicMock继承自Mock，最重要的两个属性是return_value, side_effect。<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> mock <span class="keyword">import</span> Mock</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fake_obj = Mock()</span><br><span class="line">&gt;&gt;&gt;fake_obj.return_value = <span class="string">'This is a mock object'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fake_obj()</span><br><span class="line"><span class="string">'This is a mock object'</span></span><br></pre></td></tr></tbody></table></figure>

</li>
</ol>
<p>我们通过Mock()可以创建一个mock对象，通过renturn_value 指定它的返回值。即当下文出现fake_obj()会返回其return_value所指定的值。<br>也可以通过side_effect指定它的副作用，这个副作用就是当你调用这个mock对象是会调用的函数,也可以选择抛出一个异常，来对程序的错误状态进行测试。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;<span class="function"><span class="keyword">def</span> <span class="title">b</span>():</span></span><br><span class="line"><span class="meta">... </span>   <span class="keyword">print</span> <span class="string">'This is b'</span></span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt;fake_obj.side_effect = b</span><br><span class="line">&gt;&gt;&gt;fake_obj()</span><br><span class="line">This <span class="keyword">is</span> b</span><br><span class="line">&gt;&gt;&gt;fake_obj.side_effect = KeyError(<span class="string">'This is b'</span>)</span><br><span class="line">&gt;&gt;&gt;fake_obj()</span><br><span class="line">...</span><br><span class="line">KeyError: <span class="string">'This is b'</span></span><br></pre></td></tr></tbody></table></figure>
<p>如果要模拟一个对象而不是函数，你可以直接在mock对象上添加属性和方法，并且每一个添加的属性都是一个mock对象【注意，这种方式很有用】，也就是说可以对这些属性进行配置,并且可以一直递归的定义下去。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;fake_obj.fake_a.return_value = <span class="string">'This is fake_obj.fake_a'</span></span><br><span class="line">&gt;&gt;&gt;fake_obj.fake_a()</span><br><span class="line"><span class="string">'This is fake_obj.fake_a'</span></span><br></pre></td></tr></tbody></table></figure>
<p>上述代码片段中fake_obj是一个mock对象，而fake_obj.fake_a的这种形式使得fake_a变成了fake_obj的一个属性，作用是在fake_obj.fake_a()调用时会返回其return_value。<br>另外也可以通过为side_effect指定一个列表，这样在每次调用时会依次返回，如下：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>fake_obj = Mock(side_effect = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">&gt;&gt;&gt;fake_obj()</span><br><span class="line"><span class="number">1</span></span><br><span class="line">&gt;&gt;&gt;fake_obj()</span><br><span class="line"><span class="number">2</span></span><br><span class="line">&gt;&gt;&gt;fake_obj()</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></tbody></table></figure>
<p>7.1 函数的如何mock<br>在rbd_api.py文件中如下内容：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> DAO_PoolMgr</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">checkpoolstat</span>(<span class="params">pool_name</span>)</span></span><br><span class="line">  ret， poolstat = DAO_PoolMgr.DAO_query_ispoolok(pool_name)</span><br><span class="line"><span class="keyword">if</span> ret != MGR_COMMON.MONGO_SUCCESS:</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"><span class="keyword">if</span> poolstat <span class="keyword">is</span> <span class="literal">False</span>:</span><br><span class="line">    <span class="keyword">return</span> MGR_COMMON.POOL_STAT_ERROR</span><br><span class="line"><span class="keyword">return</span> MGR_COMMON.SUCCESS</span><br></pre></td></tr></tbody></table></figure>

<p>要为这个函数撰写单元测试，因为其有数据库的操作，因而就需要mock 出DAO_query_ispoolok操作。<br>因此，我们在test_rbd_api.py文件中可以这么写：因为DAO_query_ispoolok是类DAO_PoolMgr的操作，因此可以这么写</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">import</span> DAO_PoolMgr</span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">import</span> rbd_api <span class="keyword">as</span> rbdAPI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestAuxiliaryFunction</span>(<span class="params">unittest.TestCase</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.pool_name = <span class="string">"aaa"</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tearDown</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.pool_name = <span class="literal">None</span></span><br><span class="line"><span class="meta">    @mock.patch.object(DAO_PoolMgr, "DAO_query_ispoolok")</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_checkpoolstat</span>(<span class="params">self, mock_DAO_query_ispoolok</span>):</span></span><br><span class="line">        mock_DAO_query_ispoolok.return_value = (MGR_COMMON.POOL_STAT_ERROR, <span class="literal">None</span>)</span><br><span class="line">        self.<span class="keyword">assert</span>(rbdAPI.checkpoolstat(self.pool_name), MGR_COMMON.POOL_STAT_ERROR)</span><br><span class="line"></span><br><span class="line">        mock_DAO_query_ispoolok.return_value = (MGR_COMMON.SUCCESS, <span class="literal">False</span>)</span><br><span class="line">        self.<span class="keyword">assert</span>(rbdAPI.checkpoolstat(self.pool_name), MGR_COMMON.POOL_STAT_ERROR)</span><br><span class="line">        </span><br><span class="line">        mock_DAO_query_ispoolok.return_value = (MGR_COMMON.SUCCESS, <span class="literal">True</span>)</span><br><span class="line">        self.<span class="keyword">assert</span>(rbdAPI.checkpoolstat(self.pool_name), MGR_COMMON.SUCCESS)</span><br></pre></td></tr></tbody></table></figure>
<p>测试用例上的装饰器含义如下：<br>@mock.pathc.object(类名，“类中函数名”)，而如果想要忽略某个测试用例，则可以通过装饰器@unittest.skip(“原因”)<br>而对于另外一种情形则是在另外一个函数中调用了checkpoolstat函数。<br>如下rbd_api.py：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">checkpoolstat</span>():</span></span><br><span class="line">    ……</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Disk</span>(<span class="params">Resource</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span>  <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        ……</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params">self, pool, img</span>):</span></span><br><span class="line">        ret = rbd_api.checkpoolstat()</span><br><span class="line">        ……</span><br></pre></td></tr></tbody></table></figure>
<p>这样，我们在为delete函数撰写单元测试时，也可以在test_rbd_api.py中使用如下的方式：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rbd_api</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestDisk</span>(<span class="params">unittest.TestCase</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setup</span>():</span></span><br><span class="line">        …</span><br><span class="line">      <span class="function"><span class="keyword">def</span> <span class="title">teardown</span>():</span></span><br><span class="line">              …</span><br><span class="line"><span class="meta">      @mock.patch(“rbd_api.checkpoolstat”, Mock(return_value = True))</span></span><br><span class="line">      <span class="function"><span class="keyword">def</span> <span class="title">test_delete</span>():</span></span><br><span class="line">         <span class="comment"># rbd_api.checkpoolstat 已经成为一个mock对象了，调用时返回True</span></span><br><span class="line">            …</span><br></pre></td></tr></tbody></table></figure>
<p>此时的装饰器应该为</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@mock.patch(“模块名.函数名”)</span></span><br></pre></td></tr></tbody></table></figure>

<p>7.2 链式函数抛出异常<br>在rbd_api.py文件中，有一行代码如下：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ret = OpRBD(pool).flatten(img)</span><br></pre></td></tr></tbody></table></figure>
<p>类似这种链式调用的，在前一个函数中抛出异常，要怎么写？如下：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rbdServ.OpRBD = MagicMock()</span><br><span class="line">rbdServ.OpRBD(pool).side_effect = rados.Error(“Error: error connecting to the cluster: error code <span class="number">24</span>”)</span><br></pre></td></tr></tbody></table></figure>
<p>7.3 全局函数如何mock<br>例如在文件rbd_api.py中有全局函数checkpoolstat(pool)，它是一个全局函数，这样在进行单元测试的过程中，我们可能需要mock该函数。该函数的具体代码如下：</p>
<p>因此，我们在test_rbd_api.py文件中为该函数撰写单元测试，可以这么做。<br>在文件开始处导入该rbd_api模块。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rbd_api <span class="keyword">as</span> rbdAPI</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_patchInvalid_Parameter</span>(<span class="params">self</span>):</span></span><br><span class="line">    ……</span><br><span class="line">    rbdAPI.checkpoolstat.return_value = MGR_COMMON.POOL_STAT_ERROR</span><br><span class="line">    即可。</span><br></pre></td></tr></tbody></table></figure>
<p>7.4 链式调用正常<br>在rbd_api文件中有如下代码行：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ret = OpRBD(pool).flatten(img)</span><br></pre></td></tr></tbody></table></figure>
<p>在第一个函数未出现异常，在flatten函数中返回值可以在test_rbd_api.py文件中如下写代码：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rbdServ.OpRBD(pool).snap_rollback = MagicMock(return_value = RBD_COMMON.CODE_EXEC_SUCCESS_MODIFY)</span><br></pre></td></tr></tbody></table></figure>
<p>7.5 with子句mock</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">import</span> rados</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OpRBD</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        ...</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__del__</span>(<span class="params">self</span>):</span></span><br><span class="line">        ...</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">resize</span>(<span class="params">self, img, size</span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> rbd.Image(self.ioctx, img) <span class="keyword">as</span> image:</span><br><span class="line">                <span class="keyword">if</span> image.size() &lt; size:</span><br><span class="line">                    image.resize(size)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">return</span> RBD_COMMON.CODE_ARGUMENT_LESS_THAN_ORIGINAL</span><br><span class="line">        <span class="keyword">except</span> rbd.ImageNotFound <span class="keyword">as</span> exce1</span><br><span class="line">          print(exce1)</span><br><span class="line">          <span class="keyword">return</span> RBD_COMMON.CODE_IMAGE_NOT_FOUND</span><br></pre></td></tr></tbody></table></figure>
<p>由于是在with子句中要进行mock，在此简单的对with的知识点进行说明：<br>要使用 with 语句，首先要明白上下文管理器这一概念。有了上下文管理器，with 语句才能工作。<br>下面是一组与上下文管理器和with 语句有关的概念。</p>
<p>上下文管理协议（Context Management Protocol）：包含方法 enter() 和 exit()，支持<br>该协议的对象要实现这两个方法。<br>上下文管理器（Context Manager）：支持上下文管理协议的对象，这种对象实现了 enter() 和 exit() 方法。上下文管理器定义执行 with 语句时要建立的运行时上下文，<br>负责执行 with 语句块上下文中的进入与退出操作。通常使用 with 语句调用上下文管理器，也可以通过直接调用其方法来使用。<br>运行时上下文（runtime context）：由上下文管理器创建，通过上下文管理器的 enter() 和<strong>exit</strong>() 方法实现，enter() 方法在语句体执行之前进入运行时上下文，exit() 在语句体执行完后从运行时上下文退出。with 语句支持运行时上下文这一概念。<br>上下文表达式（Context Expression）：with 语句中跟在关键字 with 之后的表达式，该表达式要返回一个上下文管理器对象。<br>语句体（with-body）：with 语句包裹起来的代码块，在执行语句体之前会调用上下文管理器的 enter() 方法，执行完语句体之后会执行 exit() 方法。<br>出现异常时，如果 exit(type, value, traceback) 返回 False，则会重新抛出异常，让with 之外的语句逻辑来处理异常，这也是通用做法；如果返回 True，则忽略异常，不再对异常进行处理。因此，在对with子句进行mock时，要具有两个函数，exit, enter，并且如果在with语句体重抛出异常并被with之外的代码进行捕获异常，要使得__exit__返回False，因此可以撰写测试代码如下：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">import</span> rados</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OpRBD</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__del__</span>(<span class="params">self</span>):</span></span><br><span class="line">        ...</span><br><span class="line">    </span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">resize</span>(<span class="params">self, img, size</span>):</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">with</span> rbd.Image(self.ioctx, img) <span class="keyword">as</span> image:</span><br><span class="line">                    <span class="keyword">if</span> image.size() &lt; size:</span><br><span class="line">                        image.resize(size)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">return</span> RBD_COMMON.CODE_ARGUMENT_LESS_THAN_ORIGINAL</span><br><span class="line">            <span class="keyword">except</span> rbd.ImageNotFound <span class="keyword">as</span> exce1</span><br><span class="line">                print(exce1)</span><br><span class="line">                <span class="keyword">return</span> RBD_COMMON.CODE_IMAGE_NOT_FOUND</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">TestOpRBD</span>(<span class="params">unittest.TestCase</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">setUp</span>(<span class="params">self</span>):</span></span><br><span class="line">            ...</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">tearDown</span>(<span class="params">self</span>):</span></span><br><span class="line">            ...</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">test_resize</span>(<span class="params">self</span>):</span></span><br><span class="line">            fake_image = Mock()</span><br><span class="line">            fake_image.__enter__ = Mock(return_value = fake_image)</span><br><span class="line">            fake_image.__exit__ = Mock(return_value = <span class="literal">True</span>)</span><br><span class="line">            rbd.Image = Mock(return_value = fake_image)</span><br><span class="line">            size = <span class="number">1073741824L</span> / <span class="number">2</span></span><br><span class="line">            fake_image.size = Mock(return_value = <span class="number">1073741824L</span>)</span><br><span class="line">            fake_image.resize = Mock(return_value = <span class="literal">None</span>)</span><br><span class="line">            self.assertEqual(self.opRBD.resize(self.img, size), RBD_COMMON.CODE_ARGUMENT_LESS_THAN_ORIGINAL)</span><br><span class="line">            </span><br><span class="line">            size = <span class="number">2</span> * <span class="number">1073741824L</span></span><br><span class="line">            self.assertEqual(self.opRBD.resize(self.img, size), RBD_COMMON.CODE_EXEC_SUCCESS_MODIFY)</span><br><span class="line">            rbd.Image = Mock(side_effect = rbd.ImageNotFound(<span class="string">"%s image not found!"</span> %self.img))</span><br><span class="line">            self.assertEqual(self.resize(self.img, size), RBD_COMMON.CODE_IMAGE_NOT_FOUND)</span><br><span class="line">```    </span><br><span class="line"></span><br><span class="line"><span class="number">7.6</span> 连续mock</span><br><span class="line">在rbd_api文件中有一个OpRados类的内容如下：</span><br><span class="line">```py</span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">import</span> rados</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OpRados</span>:</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">          self.cluster = rados.Rados(conffile=rconf[<span class="string">'conffile'</span>])</span><br><span class="line">          self.cluster.connect()</span><br><span class="line">     </span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">__del__</span>(<span class="params">self</span>):</span></span><br><span class="line">          self.cluster.shutdown()</span><br><span class="line">     </span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">lists</span>(<span class="params">self</span>):</span></span><br><span class="line">          <span class="keyword">return</span> util.return_format(RBD_COMMON.CODE_EXEC_SUCCESS_GET, <span class="string">""</span>, self.cluster.list_pools())</span><br><span class="line"></span><br><span class="line">为该类写单元测试，具体代码如下：</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">import</span> rados</span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">from</span> mock <span class="keyword">import</span> Mock</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestOpRados</span>(<span class="params">unittest.TestCase</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span>(<span class="params">self</span>)：</span></span><br><span class="line">        fake_Rados = Mock()</span><br><span class="line">        fake_Rados.connect = Mock(return_value = <span class="literal">None</span>)</span><br><span class="line">        fake_Rados.shutdown = Mock(return_value = <span class="literal">None</span>)</span><br><span class="line">        fake_Rados.list_pools = Mock(return_value = [<span class="string">"sqh"</span>, <span class="string">"sqh1"</span>])</span><br><span class="line">        <span class="comment"># 注意：此处要使得rados.Rados()调用返回fake_Rados.</span></span><br><span class="line">        <span class="comment"># 如果写成rados.Rados = fake_Rados,只能使得self.cluster重新生成一个Mock对象</span></span><br><span class="line">        <span class="comment"># 无法有效的控制为fake_Rados所添加的属性。</span></span><br><span class="line">        rados.Rados = Mock(return_value = fake_Rados)</span><br><span class="line">        self.opRados = OpRados()</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tearDown</span>(<span class="params">self</span>):</span></span><br><span class="line">        fake_Rados = <span class="literal">None</span></span><br><span class="line">        self.opRados = <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_list</span>(<span class="params">self</span>):</span></span><br><span class="line">        return_list = [<span class="string">"sqh"</span>, <span class="string">"sqh1"</span>]</span><br><span class="line">        self.assertEqual(self.opRados.lists(), util.return_format(RBD_COMMON.CODE_EXEC_SUCCESS_GET,  <span class="string">""</span>, return_list))</span><br></pre></td></tr></tbody></table></figure>
<p>7.7 Flask API 接口的模拟调用<br>有三个文件：rbd_app.py文件内容如下：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">from</span> flask imort Flask</span><br><span class="line"><span class="keyword">from</span> flask.ext <span class="keyword">import</span> restful</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">api = restful.Api(app)</span><br><span class="line"></span><br><span class="line">api_version = <span class="string">"/v1.0"</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## Actually setup the Api resource ruting here</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">api.add_resource(rbd_api.Disk, api_version+<span class="string">"pools/&lt;pool&gt;/disks/&lt;img&gt;"</span>)</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == __main__:</span><br><span class="line">    <span class="keyword">from</span> gevent.wsgi <span class="keyword">import</span> WSGIServer</span><br><span class="line">    http_server = WSGIServer((<span class="string">'0.0.0.0'</span>, <span class="number">4806</span>), app)</span><br><span class="line">    http_server.serve_forever()</span><br></pre></td></tr></tbody></table></figure>

<p>rbd_api.py文件中Disk类内容如下：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> flask_restful <span class="keyword">import</span> reqparse, Resource</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Disk</span>(<span class="params">Resource</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self, pool, img</span>):</span></span><br><span class="line">        ret, rbd_info = DAO_query_rbd_info(pool, img)</span><br><span class="line">        ...</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span>(<span class="params">self, pool, img</span>):</span></span><br><span class="line">        parser = reqparser.RequestParser()</span><br><span class="line">        <span class="comment"># action: create\copy\clone</span></span><br><span class="line">        parser.add_argument(<span class="string">'action'</span>, type=str)</span><br><span class="line">        parser.add_argument(<span class="string">'src_pool'</span>, type=str)</span><br><span class="line">        parser.add_argument(<span class="string">'src_rbd'</span>, type=str)</span><br><span class="line">        parser.add_argument(<span class="string">'src_snap'</span>, type=str)</span><br><span class="line">        parser.add_argument(<span class="string">'size'</span>, type=str)</span><br><span class="line">        parser.add_argument(<span class="string">'unit'</span>, type=str)</span><br><span class="line">        </span><br><span class="line">        action = args.get(<span class="string">'action'</span>)</span><br><span class="line">        <span class="keyword">if</span> action == <span class="string">"create"</span>:</span><br><span class="line">            size = args.get(<span class="string">'size'</span>)</span><br><span class="line">            unit = args.get(<span class="string">'unit'</span>)</span><br><span class="line">            ...</span><br><span class="line">        <span class="keyword">elif</span> action == <span class="string">'copy'</span>:</span><br><span class="line">            src_pool = args.get(<span class="string">'src_pool'</span>)</span><br><span class="line">            src_rbd = args.get(<span class="string">'src_rbd'</span>)</span><br><span class="line">            ...</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> ...</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params">self, pool, img</span>):</span></span><br><span class="line">        ...</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put</span>(<span class="params">self, pool, img</span>):</span></span><br><span class="line">        parser = reqparser.RequestParser()</span><br><span class="line">        parser.add_argument(<span class="string">'rb_snap'</span>, type=str)</span><br><span class="line">        parser.add_argument(<span class="string">'action'</span>, type=str)</span><br><span class="line">        args = parser.parse_args()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> action == <span class="string">"flatten"</span>:</span><br><span class="line">            ...</span><br><span class="line">        <span class="keyword">elif</span> action == <span class="string">"rollback"</span>:</span><br><span class="line">            snap = args.get(<span class="string">"rb_snap"</span>)</span><br><span class="line">            ...</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> ...</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">patch</span>(<span class="params">self, pool, img</span>):</span></span><br><span class="line">        parser = reqparse.RequestParser()</span><br><span class="line">        parser.add_argument(<span class="string">"action"</span>, type=srt)</span><br><span class="line">        parser.add_argument(<span class="string">"name"</span>, type=str)</span><br><span class="line">        parser.add_argument(<span class="string">"size"</span>, type=float)</span><br><span class="line">        parser.add_argument(<span class="string">"unit"</span>, type=str)</span><br><span class="line">        args = parser.parse_args()</span><br><span class="line">        action = args.get(<span class="string">'action'</span>)</span><br><span class="line">        <span class="keyword">if</span> action == <span class="string">"resize"</span>:</span><br><span class="line">            size = args.get(<span class="string">'size'</span>)</span><br><span class="line">            unit = args.get(<span class="string">'unit'</span>)</span><br><span class="line">            ....</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> ...</span><br></pre></td></tr></tbody></table></figure>
<p>在test_rbd_api.py中卫Disk类撰写单元测试</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rbd_app <span class="keyword">import</span> app</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestDisk</span>(<span class="params">uniitest.TestCase</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.disk = Disk()</span><br><span class="line">        self.content_type = <span class="string">"application/json"</span></span><br><span class="line">        ...</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tearDown</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.disk = <span class="literal">None</span></span><br><span class="line">        self.content_type = <span class="literal">None</span></span><br><span class="line">        ...</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @mock.path.object(DAO_RBDMgr, "DAO_query_rbd_info")</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_get</span>(<span class="params">self, mock_DAO_query_rbd_info</span>):</span></span><br><span class="line">        rbd_info = {<span class="string">"pool_name"</span>:<span class="string">"sqh"</span>, <span class="string">"parent"</span>:{}, <span class="string">"image_size"</span>:<span class="number">1073741824L</span>,...}</span><br><span class="line">        mock_DAO_query_rbd_info.return_value = (RBD_COMMON.MONGO_SUCCESS, rbd_info)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">with</span> app.test_request_context(<span class="string">"/?pool_name=sqh&amp;image_name=sqh001"</span>):</span><br><span class="line">            pool = request.args.get(<span class="string">'pool_name'</span>)</span><br><span class="line">            img=request.args.get(<span class="string">'image_name'</span>)</span><br><span class="line">            self.assertEqual(selff.disk.get(pool, img), RBD_COMMON.http_return(RBD_COMMON.MONGO_SUCCESS))</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_post</span>(<span class="params">self</span>):</span></span><br><span class="line">        pool = <span class="string">"sqh"</span></span><br><span class="line">        img = <span class="string">"sqh001"</span></span><br><span class="line">        path_url = <span class="string">"v1.0/pools/%s/disks%s"</span> % (pool, img)</span><br><span class="line">        data = {<span class="string">"action"</span>:<span class="string">"create"</span>, <span class="string">"size"</span>:<span class="number">2</span>, <span class="string">"unit"</span>:<span class="string">"GB"</span>}</span><br><span class="line">        <span class="keyword">with</span> app.test_request_context(path_url, data=json.dumps(data), content_type=self.content_type):</span><br><span class="line">            self.assertEqual(self.disk.post(pool, img), RBD_COMMON.http_return(RBD_COMMON.CODE_EXEC_SUCCESS_GET))</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_delete</span>(<span class="params">self</span>):</span></span><br><span class="line">        pool = <span class="string">"sqh"</span></span><br><span class="line">        img = <span class="string">"sqh001"</span></span><br><span class="line">        path_url = <span class="string">"v1.0/pools/%s/disks%s"</span> % (pool, img)</span><br><span class="line">        <span class="keyword">with</span> app.test_request_context(path_url):</span><br><span class="line">            self.assertEqual(self.disk.delete(pool, img), RBD_COMMON.http_return(RBD_COMMON.CODE_EXEC_SUCCESS_DELETE))</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_put</span>(<span class="params">self</span>):</span></span><br><span class="line">        pool = <span class="string">"sqh"</span></span><br><span class="line">        img = <span class="string">"sqh001"</span></span><br><span class="line">        path_url = <span class="string">"v1.0/pools/%s/disks%s"</span> % (pool, img)</span><br><span class="line">        data = {<span class="string">"action"</span>:<span class="string">"rollback"</span>, <span class="string">"rb_snap"</span>:<span class="string">"sqh_snap"</span>}</span><br><span class="line">        <span class="keyword">with</span> app.test_request_context(path_url, data=json.dumps(data), content_type=self.content_type):</span><br><span class="line">            self.assertEqual(self.disk.put(pool, img), RBD_COMMON.http_return(RBD_COMMON.CODE_EXEC_SUCCESS_FLATTENING))</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_patch</span>(<span class="params">self</span>):</span></span><br><span class="line">        pool = <span class="string">"sqh"</span></span><br><span class="line">        img = <span class="string">"sqh001"</span></span><br><span class="line">        path_url = <span class="string">'v1.0/pools/%s/disks/%s'</span> %　(pool, img)</span><br><span class="line">        size = <span class="number">1073741824L</span></span><br><span class="line">        data = {<span class="string">"action"</span>:<span class="string">"resize"</span>, <span class="string">"size"</span>:size, <span class="string">"unit"</span>:<span class="string">"GB"</span>}</span><br><span class="line">        <span class="comment"># the action resize</span></span><br><span class="line">        <span class="keyword">with</span> app.test_request_context(path_url, data=json.dumps(data), content_type=self.content_type):</span><br><span class="line">            self.assertEqual(self.disk.patch(pool, img), RBD_COMMON.http_return(RBD_COMMON.CODE_EXEC_SUCCESS_MODIFY))</span><br></pre></td></tr></tbody></table></figure>
<p>7.7.1 Get请求</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@mock.path.object(DAO_RBDMgr, "DAO_query_rbd_info")</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_get</span>(<span class="params">self, mock_DAO_query_rbd_info</span>):</span></span><br><span class="line">        rbd_info = {<span class="string">"pool_name"</span>:<span class="string">"sqh"</span>, <span class="string">"parent"</span>:{}, <span class="string">"image_size"</span>:<span class="number">1073741824L</span>,...}</span><br><span class="line">        mock_DAO_query_rbd_info.return_value = (RBD_COMMON.MONGO_SUCCESS, rbd_info)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">with</span> app.test_request_context(<span class="string">"/?pool_name=sqh&amp;image_name=sqh001"</span>):</span><br><span class="line">            pool = request.args.get(<span class="string">'pool_name'</span>)</span><br><span class="line">            img=request.args.get(<span class="string">'image_name'</span>)</span><br><span class="line">            self.assertEqual(selff.disk.get(pool, img), RBD_COMMON.http_return(RBD_COMMON.MONGO_SUCCESS))</span><br><span class="line">``</span><br><span class="line"></span><br><span class="line">在为flask接口撰写单元测试时，最关键的是如何传递数据，</span><br><span class="line">我们在setUp函数中初始化Disk类的实例,即self.disk。在传递参数的时候通过调用app.test_request_context(“url”)。因为是restful的get请求，因而我们可以使用？param1=val1&amp;param2=val2的形式。</span><br><span class="line"></span><br><span class="line"><span class="number">7.7</span><span class="number">.2</span> Post请求</span><br><span class="line">在Post请求，我们需要传递动作的类型，即其他参数，在app.test_request_context函数中，传递了字符串url， data字典，HTTP请求头信息。</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_post</span>(<span class="params">self</span>):</span></span><br><span class="line">        pool = <span class="string">"sqh"</span></span><br><span class="line">        img = <span class="string">"sqh001"</span></span><br><span class="line">        path_url = <span class="string">"v1.0/pools/%s/disks%s"</span> % (pool, img)</span><br><span class="line">        data = {<span class="string">"action"</span>:<span class="string">"create"</span>, <span class="string">"size"</span>:<span class="number">2</span>, <span class="string">"unit"</span>:<span class="string">"GB"</span>}</span><br><span class="line">        <span class="keyword">with</span> app.test_request_context(path_url, data=json.dumps(data), content_type=self.content_type):</span><br><span class="line">            self.assertEqual(self.disk.post(pool, img), RBD_COMMON.http_return(RBD_COMMON.CODE_EXEC_SUCCESS_GET))</span><br><span class="line"></span><br><span class="line"><span class="number">7.7</span><span class="number">.3</span> Delete请求</span><br><span class="line">如post</span><br><span class="line"></span><br><span class="line"><span class="number">7.7</span><span class="number">.4</span> Put请求</span><br><span class="line">如post</span><br><span class="line"></span><br><span class="line"><span class="number">7.7</span><span class="number">.5</span> Patch请求</span><br><span class="line">如post</span><br><span class="line"></span><br><span class="line"><span class="number">8.</span> Python 单元测试环境安装</span><br><span class="line">因为在python2.*中，mock是单独的模块，因而我们需要单独安装mock模块才能够正常的使用。</span><br><span class="line">因此，我们首先要在rpm find 网站下载好pip，然后通过pip安装mock。</span><br><span class="line"></span><br><span class="line">http://rpmfind.net/linux/RPM/epel/<span class="number">7</span>/x86_64/Packages/p/python2-pip<span class="number">-8.1</span><span class="number">.2</span><span class="number">-5.</span>el7.noarch.html</span><br><span class="line">依赖于python-setuptools</span><br><span class="line"></span><br><span class="line">http://rpmfind.net/linux/RPM/centos/<span class="number">7.4</span><span class="number">.1708</span>/x86_64/Packages/python-setuptools<span class="number">-0.9</span><span class="number">.8</span><span class="number">-7.</span>el7.noarch.html</span><br><span class="line"></span><br><span class="line">mock的下载网址：</span><br><span class="line"></span><br><span class="line">https://pypi.python.org/pypi/mock/<span class="number">2.0</span><span class="number">.0</span></span><br><span class="line"></span><br><span class="line">下一章节要用的coverage，测试代码覆盖率，网址在：</span><br><span class="line"></span><br><span class="line">https://pypi.python.org/pypi/coverage/<span class="number">4.5</span><span class="number">.1</span></span><br><span class="line"></span><br><span class="line"><span class="number">9.</span> 使用coverage测试覆盖率</span><br><span class="line">在单元测试的过程中，应尽量使得单元都被覆盖过，因而需要使用专门的工具来进行测试代码覆盖率。以test_rbd_api.py为准</span><br><span class="line">测试的步骤如下：</span><br><span class="line">```py</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>coverage run test_rbd_api.py</span><br><span class="line">&gt;&gt;&gt;coverage report -m path/to/rbd_api.py</span><br></pre></td></tr></tbody></table></figure>
<p>即可查看代码覆盖程度。</p>
<p>很多时候开发人员和其他系统联调时，如果关联系统还没有开发完成，这时只能使用mock来模拟关联系统的返回<br>自动化测试也常常遇到同样的问题，为了验证关联系统不同的返回对被测对象的影响，需要mock关联系统的返回<br>一个例子</p>
<ul>
<li>被测对象从关联接口获得用户信息</li>
<li>在关联接口开发完成之前，只能使用mock来模拟关联接口的返回，完成对被测对象的测试</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> unittest <span class="keyword">import</span> TestCase</span><br><span class="line"><span class="keyword">from</span> unittest.mock <span class="keyword">import</span> patch</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_user_info</span>(<span class="params">uid</span>):</span></span><br><span class="line">        resp = requests.get(<span class="string">"http://api.server.com/user/{0}"</span>.format(uid))</span><br><span class="line">        <span class="keyword">return</span> resp.json()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestUserInfo</span>(<span class="params">TestCase</span>):</span></span><br><span class="line"><span class="meta">    @patch('__main__.User')</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_user_name</span>(<span class="params">self, MockUser</span>):</span></span><br><span class="line">        user = MockUser()</span><br><span class="line">        user.get_user_info.return_value = {</span><br><span class="line">            <span class="string">"user_id"</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="string">"name"</span>: <span class="string">"python"</span>,</span><br><span class="line">            <span class="string">"age"</span>: <span class="number">20</span></span><br><span class="line">        }</span><br><span class="line">        resp = user.get_user_info(<span class="number">1</span>)</span><br><span class="line">        self.assertEqual(resp.get(<span class="string">"name"</span>), <span class="string">"python"</span>)</span><br><span class="line">        self.assertEqual(resp.get(<span class="string">"age"</span>), <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    unittest.main()</span><br><span class="line"><span class="comment"># ----------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># Ran 1 test in 0.001s</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># OK</span></span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"><span class="keyword">from</span> unittest.mock <span class="keyword">import</span> MagicMock</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将要测试的排序函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sort</span>(<span class="params">arr</span>):</span></span><br><span class="line">    l = len(arr)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, l):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i + <span class="number">1</span>, l):</span><br><span class="line">            <span class="keyword">if</span> arr[i] &gt;= arr[j]:</span><br><span class="line">                tmp = arr[i]</span><br><span class="line">                arr[i] = arr[j]</span><br><span class="line">                arr[j] = tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 单元测试</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestSort</span>(<span class="params">unittest.TestCase</span>):</span></span><br><span class="line">    <span class="comment"># 以test开头的函数会被测试</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_sort</span>(<span class="params">self</span>):</span></span><br><span class="line">        arr = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">        sort(arr)</span><br><span class="line">        self.assertEqual(arr, [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># mock</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>(<span class="params">unittest.TestCase</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">m1</span>(<span class="params">self</span>):</span></span><br><span class="line">        val = self.m2()</span><br><span class="line">        self.m3(val)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">m2</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">m3</span>(<span class="params">self, val</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_m1</span>(<span class="params">self</span>):</span></span><br><span class="line">        a = A()</span><br><span class="line">        a.m2 = MagicMock(return_value=<span class="string">"custom_val"</span>)</span><br><span class="line">        a.m3 = MagicMock()</span><br><span class="line">        a.m1()</span><br><span class="line">        self.assertTrue(a.m2.called)</span><br><span class="line">        a.m3.assert_called_with(<span class="string">"custom_val"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">side_effect</span>(<span class="params">arg</span>):</span></span><br><span class="line">    <span class="keyword">if</span> arg &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    unittest.main()</span><br><span class="line">    mock = MagicMock()</span><br><span class="line">    mock.side_effect = side_effect</span><br><span class="line">    print(mock(<span class="number">1</span>))</span><br><span class="line">    print(mock(<span class="number">-2</span>))</span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/17/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><span class="page-number current">18</span><a class="page-number" href="/page/19/">19</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/">21</a><a class="extend next" rel="next" href="/page/19/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>
<script src="/js/comments.js"></script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">外心人D</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
