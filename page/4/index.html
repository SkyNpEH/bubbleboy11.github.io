<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<meta name="hexo-config" content="{&quot;hostname&quot;:&quot;bubbleboy11.github.io&quot;,&quot;root&quot;:&quot;/&quot;,&quot;images&quot;:&quot;/images&quot;,&quot;scheme&quot;:&quot;Muse&quot;,&quot;version&quot;:&quot;8.3.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:true,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:false,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;}}">
<meta name="description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:type" content="website">
<meta property="og:title" content="外心人D的博客">
<meta property="og:url" content="https://bubbleboy11.github.io/page/4/index.html">
<meta property="og:site_name" content="外心人D的博客">
<meta property="og:description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="外心人D">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://bubbleboy11.github.io/page/4/">



<meta name="hexo-config-page" content="{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:true,&quot;isPost&quot;:false,&quot;lang&quot;:&quot;zh-CN&quot;}">
<meta name="hexo-config-calendar" content="">
<script data-pjax src="/js/load-config.js"></script>
  <title>外心人D的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="外心人D的博客" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">外心人D的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">外心人D</p>
  <div class="site-description" itemprop="description">本博客大多内容为慕课和网上博客，并非原创</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">200</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">36</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/04/05/kong-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/05/kong-2/" class="post-title-link" itemprop="url">vue生命周期函数</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-04-04 16:21:41" itemprop="dateCreated datePublished" datetime="2021-04-04T16:21:41Z">2021-04-04</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-14 05:32:04" itemprop="dateModified" datetime="2021-04-14T05:32:04Z">2021-04-14</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>vue2生命周期函数<br>beforeCreate</p>
<p>created</p>
<p>beforeMount</p>
<p>mounted –&gt; beforeUpdate–&gt; updated</p>
<p>beforeDestory</p>
<p>destroyed</p>
<p>1.生命周期：<br>　　从Vue实例创建、运行、到销毁期间，伴随着的各种事件，这些事件统称为生命周期</p>
<p>2.生命周期函数分类：<br>创建期间的生命周期函数：<br>beforeCreate：实例刚在内存中被创建出来，此时还没有初始化好data和methods属性<br>created：实例已经在内存中创建出来，此时的data和methods以及创建完成，但是还没有开始编译模板<br>beforeMount：此时已经完成了模板的编译，但是还没有挂载到页面上<br>mounted：已经将编译好的模板，挂载到了页面指定的容器中显示<br>运行期间的生命周期函数：<br>beforeUpdate：状态更新之前执行此函数，此时data中的状态值是最新的，但是界面上显示的数据还是旧的，因为此时还没有开始重新渲染DOM节点<br>updated：实例更新完毕之后调用此函数，此时data中的状态值和界面上显示的数据，都已经完成了更新，界面已经被重新渲染好了<br>销毁期间的生命周期函数：<br>beforeDestory：实例销毁之前调用，在这一步，实例仍然完全可用<br>destroyed：Vue实例销毁之后调用。调用后，Vue实例指示的所有东西都会解绑定，所有的事件监听器会被移除，所有的子实例也会被销毁<br>vue3生命周期函数<br>beforeCreate –&gt; setup()</p>
<p>created –&gt; setup()</p>
<p>beforeMount –&gt; onBeforeMount</p>
<p>mounted –&gt; onMounted</p>
<p>beforeUpdate –&gt; onBeforeUpdate</p>
<p>update –&gt; onUpdated</p>
<p>beforeDestroy –&gt; onBeforeUnmount</p>
<p>destroyed –&gt; onUnmounted</p>
<p>errorCaptured –&gt; onErrorCaptured</p>
<p>特殊钩子函数配合keepalive使用</p>
<p>onActivated&nbsp; &nbsp;页面返回回退缓存页面调用</p>
<p>onDeactivated页面离开缓存回退页面调用</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/04/05/python-jin-cheng-jian-tong-xin-sheng-chan-zhe-xiao-fei-zhe-mo-xing-yu-dui-lie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/05/python-jin-cheng-jian-tong-xin-sheng-chan-zhe-xiao-fei-zhe-mo-xing-yu-dui-lie/" class="post-title-link" itemprop="url">python的进程间通信-生产者消费者模型与队列</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-04-04 16:21:41" itemprop="dateCreated datePublished" datetime="2021-04-04T16:21:41Z">2021-04-04</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-12 13:38:20" itemprop="dateModified" datetime="2021-04-12T13:38:20Z">2021-04-12</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="进程间通信-生产者消费者模型与队列"><a href="#进程间通信-生产者消费者模型与队列" class="headerlink" title="进程间通信-生产者消费者模型与队列"></a>进程间通信-生产者消费者模型与队列</h2><p>演示了生产者和消费者的场景。</p>
<ul>
<li>生产者生产货物，然后把货物放到一个队列之类的数据结构中，生产货物所要花费的时间无法预先确定。</li>
<li>消费者消耗生产者生产的货物的时间也是不确定的。<br>通过<code>queue</code>队列来实现进程间的通信</li>
</ul>
<p>下例中创建了两个线程，一个负责生成，一个负责消费，所生成的产品存放在queue里，实现了不同线程间沟通。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> Queue</span><br><span class="line"><span class="keyword">import</span> random, threading, time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生产者类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Producer</span>(<span class="params">threading.Thread</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, queue</span>):</span></span><br><span class="line">        threading.Thread.__init__(self, name=name)</span><br><span class="line">        self.queue = queue</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">5</span>):</span><br><span class="line">            print(<span class="string">"{} is producing {} to the queue!"</span>.format(self.getName(), i))</span><br><span class="line">            self.queue.put(i)</span><br><span class="line">            time.sleep(random.randrange(<span class="number">10</span>) / <span class="number">5</span>)</span><br><span class="line">        print(<span class="string">"%s finished!"</span> % self.getName())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 消费者类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span>(<span class="params">threading.Thread</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, queue</span>):</span></span><br><span class="line">        threading.Thread.__init__(self, name=name)</span><br><span class="line">        self.queue = queue</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">5</span>):</span><br><span class="line">            val = self.queue.get()</span><br><span class="line">            print(<span class="string">"{} is consuming {} in the queue."</span>.format(</span><br><span class="line">                self.getName(), val))</span><br><span class="line">            time.sleep(random.randrange(<span class="number">10</span>))</span><br><span class="line">        print(<span class="string">"%s finished!"</span> % self.getName())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    queue = Queue()</span><br><span class="line">    producer = Producer(<span class="string">'Producer'</span>, queue)</span><br><span class="line">    consumer = Consumer(<span class="string">'Consumer'</span>, queue)</span><br><span class="line"></span><br><span class="line">    producer.start()</span><br><span class="line">    consumer.start()</span><br><span class="line"></span><br><span class="line">    producer.join()</span><br><span class="line">    consumer.join()</span><br><span class="line">    print(<span class="string">'All threads finished!'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Producer <span class="keyword">is</span> producing <span class="number">1</span> to the queue!</span><br><span class="line">Consumer <span class="keyword">is</span> consuming <span class="number">1</span> <span class="keyword">in</span> the queue.</span><br><span class="line">Producer <span class="keyword">is</span> producing <span class="number">2</span> to the queue!</span><br><span class="line">Consumer <span class="keyword">is</span> consuming <span class="number">2</span> <span class="keyword">in</span> the queue.</span><br><span class="line">Producer <span class="keyword">is</span> producing <span class="number">3</span> to the queue!</span><br><span class="line">Consumer <span class="keyword">is</span> consuming <span class="number">3</span> <span class="keyword">in</span> the queue.</span><br><span class="line">Producer <span class="keyword">is</span> producing <span class="number">4</span> to the queue!</span><br><span class="line">Consumer <span class="keyword">is</span> consuming <span class="number">4</span> <span class="keyword">in</span> the queue.</span><br><span class="line">Producer finished!</span><br><span class="line">Consumer finished!</span><br><span class="line">All threads finished!</span><br></pre></td></tr></tbody></table></figure>



<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Queue</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Producer</span>(<span class="params">multiprocessing.Process</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, queue</span>):</span></span><br><span class="line">        super(Producer, self).__init__()</span><br><span class="line">        self.queue = queue</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">13</span>):</span><br><span class="line">            <span class="comment">#往队列添加内容</span></span><br><span class="line">            self.queue.put(i)</span><br><span class="line">            print(<span class="string">"生产者传递的消息为%s"</span> % (i))</span><br><span class="line">        <span class="keyword">return</span> self.queue</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span>(<span class="params">multiprocessing.Process</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, queue</span>):</span></span><br><span class="line">        super(Consumer, self).__init__()</span><br><span class="line">        self.queue = queue</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment">#获取队列内容</span></span><br><span class="line">        <span class="comment">#get会自动判断队列是否为空,如果是空， 跳出循环， 不会再去从队列获取数据;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            print(<span class="string">"进程获取消息为：%s"</span> % (self.queue.get()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    queue = Queue(maxsize=<span class="number">100</span>)</span><br><span class="line">    p = Producer(queue)</span><br><span class="line">    p.start()</span><br><span class="line">    c = Consumer(queue)</span><br><span class="line">    c.start()</span><br><span class="line">    p.join()</span><br><span class="line">    c.join(<span class="number">2</span>)</span><br><span class="line">    c.terminate()  <span class="comment">#终止进程</span></span><br><span class="line">    print(<span class="string">"进程间通信结束"</span>)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">生产者传递的消息为<span class="number">0</span></span><br><span class="line">生产者传递的消息为<span class="number">1</span></span><br><span class="line">进程获取消息为：<span class="number">0</span></span><br><span class="line">进程获取消息为：<span class="number">1</span></span><br><span class="line">生产者传递的消息为<span class="number">2</span></span><br><span class="line">进程获取消息为：<span class="number">2</span></span><br><span class="line">进程获取消息为：<span class="number">3</span></span><br><span class="line">生产者传递的消息为<span class="number">3</span></span><br><span class="line">生产者传递的消息为<span class="number">4</span></span><br><span class="line">进程获取消息为：<span class="number">4</span></span><br><span class="line">生产者传递的消息为<span class="number">5</span></span><br><span class="line">生产者传递的消息为<span class="number">6</span></span><br><span class="line">进程获取消息为：<span class="number">5</span></span><br><span class="line">生产者传递的消息为<span class="number">7</span></span><br><span class="line">进程获取消息为：<span class="number">6</span></span><br><span class="line">生产者传递的消息为<span class="number">8</span></span><br><span class="line">进程获取消息为：<span class="number">7</span></span><br><span class="line">生产者传递的消息为<span class="number">9</span></span><br><span class="line">进程获取消息为：<span class="number">8</span></span><br><span class="line">生产者传递的消息为<span class="number">10</span></span><br><span class="line">进程获取消息为：<span class="number">9</span></span><br><span class="line">生产者传递的消息为<span class="number">11</span></span><br><span class="line">进程获取消息为：<span class="number">10</span></span><br><span class="line">生产者传递的消息为<span class="number">12</span></span><br><span class="line">进程获取消息为：<span class="number">11</span></span><br><span class="line">进程获取消息为：<span class="number">12</span></span><br><span class="line">进程间通信结束</span><br></pre></td></tr></tbody></table></figure>

<h2 id="Lock版本生产者和消费者模式："><a href="#Lock版本生产者和消费者模式：" class="headerlink" title="Lock版本生产者和消费者模式："></a>Lock版本生产者和消费者模式：</h2><p>‘’’<br>生产者和消费者模式是多线程开发中经常见到的一种模式。<br>生产者的线程专门用来生产一些数据，然后存放到一个中间的变量中。<br>消费者再从这个中间的变量中取出数据进行消费。<br>但是因为要使用中间变量，中间变量经常是一些全局变量，因此需要使用锁来保证数据完整性。<br>使用threading.Lock锁实现的“生产者与消费者模式”的一个例子：<br>‘’’</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">gMoney = <span class="number">1000</span></span><br><span class="line">glock = threading.Lock()</span><br><span class="line"><span class="comment"># 记录生产者生产的次数，达到10次就不再生产</span></span><br><span class="line">gtime = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生产者</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Producer</span>(<span class="params">threading.Thread</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">global</span> gMoney</span><br><span class="line">        <span class="keyword">global</span> gtime</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            Money = random.randint(<span class="number">100</span>,<span class="number">1000</span>)</span><br><span class="line">            glock.acquire()</span><br><span class="line">            <span class="keyword">if</span> gtime &gt;= <span class="number">10</span>:</span><br><span class="line">                <span class="comment"># 解锁返回</span></span><br><span class="line">                glock.release()</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            gMoney += Money</span><br><span class="line">            print(<span class="string">'%s存入了%d元钱，还剩%d元钱'</span>%(threading.current_thread(),Money,gMoney))</span><br><span class="line">            time.sleep(<span class="number">0.5</span>)</span><br><span class="line">            gtime += <span class="number">1</span></span><br><span class="line">            glock.release()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 消费者</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Consumer</span>(<span class="params">threading.Thread</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">global</span> gMoney</span><br><span class="line">        <span class="keyword">global</span> gtime</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            Money = random.randint(<span class="number">100</span>, <span class="number">1000</span>)</span><br><span class="line">            glock.acquire()</span><br><span class="line">            <span class="keyword">if</span> gMoney &gt; Money:</span><br><span class="line">                gMoney -= Money</span><br><span class="line">                print(<span class="string">'%s消费了%d元钱，还剩%d元钱'</span> % (threading.current_thread(), Money, gMoney))</span><br><span class="line">                time.sleep(<span class="number">0.5</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 如果钱不够了，有可能是已经超过了次数，这时候就判断一下</span></span><br><span class="line">                <span class="keyword">if</span> gtime &gt;= <span class="number">10</span>:</span><br><span class="line">                    glock.release()</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                print(<span class="string">'%s消费了%d元钱，还剩%d元钱，不足！！！'</span> % (threading.current_thread(), Money, gMoney))</span><br><span class="line">            glock.release()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        c1 = Consumer(name=<span class="string">'消费者线程数%s'</span>%x)</span><br><span class="line">        c1.start()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        p1 = Producer(name=<span class="string">'生产者线程数%s'</span>%x)</span><br><span class="line">        p1.start()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure>

<h3 id="线程中的-Condition-条件对象"><a href="#线程中的-Condition-条件对象" class="headerlink" title="线程中的 Condition 条件对象"></a>线程中的 Condition 条件对象</h3><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">条件变量对象，使得一个线程等待另一个线程满足特定的“条件”，比如改变状态或某个数据值</span><br><span class="line">confition方法适合```生产-消费```的工作模型，消费者会等待生产者生产数据生消费者再对数据进行处理。</span><br><span class="line"></span><br><span class="line">- ```acquire()```：请求底层锁。</span><br><span class="line">- ```release()```：释放底层锁。</span><br><span class="line">- ```wait(timeout=None)```：等待直到被通知或发生超时。如果线程在调用此方法时没有获得锁，将会引发RuntimeError异常。</span><br><span class="line">- ```wait_for(predicate, timeout=None)```：等待，直到条件计算为真。</span><br><span class="line">- ```notify()```：默认唤醒一个等待这个条件的线程。</span><br><span class="line">- ```notify_all()```：唤醒所有正在等待这个条件的线程。</span><br><span class="line">```py</span><br><span class="line">import threading</span><br><span class="line">import logging</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">logging.basicConfig(</span><br><span class="line">    level=logging.DEBUG,</span><br><span class="line">    format='%(asctime)s %(levelname)s [%(threadName)s] %(message)s')</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Message:</span><br><span class="line">    def __init__(self, message):</span><br><span class="line">        self.message = message</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def consumer(cond, message):</span><br><span class="line">    with cond:</span><br><span class="line">        cond.wait()</span><br><span class="line">        logging.debug("consumer {0}".format(message.message))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def producer(cond, message):</span><br><span class="line">    with cond:</span><br><span class="line">        print('====')</span><br><span class="line">        time.sleep(2)</span><br><span class="line">        message.message = 'ha ha ha '</span><br><span class="line">        logging.debug("producer {0}".format(message.message))</span><br><span class="line">        cond.notify_all()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == '__main__':</span><br><span class="line">    message = Message(None)</span><br><span class="line">    cond = threading.Condition()</span><br><span class="line">    c1 = threading.Thread(target=consumer,</span><br><span class="line">                          args=(cond, message),</span><br><span class="line">                          name="consumer-1")</span><br><span class="line">    c1.start()</span><br><span class="line">    c2 = threading.Thread(target=consumer,</span><br><span class="line">                          args=(cond, message),</span><br><span class="line">                          name="consumer-2")</span><br><span class="line">    c2.start()</span><br><span class="line"></span><br><span class="line">    p = threading.Thread(target=producer,</span><br><span class="line">                         args=(cond, message),</span><br><span class="line">                         name="producer")</span><br><span class="line">    p.start()</span><br><span class="line"># ====</span><br><span class="line"># 2021-04-04 17:21:08,955 DEBUG [producer] producer ha ha ha</span><br><span class="line"># 2021-04-04 17:21:08,958 DEBUG [consumer-1] consumer ha ha ha</span><br><span class="line">2021-04-04 17:24:03,358 DEBUG [consumer-1] consumer ha ha ha</span><br><span class="line">2021-04-04 17:24:03,358 DEBUG [consumer-2] consumer ha ha ha</span><br></pre></td></tr></tbody></table></figure>

<p>定义了一个<code>producer</code>方法用于生产数据，<code>consumer</code>方法用于消费数据，当运行上边代码后，先是输出了<code>====</code>，再等待2秒后输出了 <code>2021-04-04 17:21:08,955 DEBUG [producer] producer ha ha ha</code>，接着跟着输出了<code>2021-04-04 17:24:03,358 DEBUG [consumer-1] consumer ha ha ha</code>和<code>2016-08-21 17:29:16,212 DEBUG [consumer-2] consumer ha ha ha</code></p>
<p>consumer线程是在producer线程运行之后才运行，即等待生产者生产数据。</p>
<p>用<code>event</code>实现一个生产线程和消费线程的通信：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">product_event = threading.Event()</span><br><span class="line">print(<span class="string">f"product_event state: <span class="subst">{product_event.is_set()}</span>"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">produce</span>():</span></span><br><span class="line">    print(<span class="string">"start produce ..."</span>)</span><br><span class="line">    time.sleep(<span class="number">5</span>)</span><br><span class="line">    print(<span class="string">"product produced."</span>)</span><br><span class="line">    product_event.set()</span><br><span class="line">    print(<span class="string">f"product_event state: <span class="subst">{product_event.is_set()}</span>"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">consume</span>():</span></span><br><span class="line">    print(<span class="string">"consumer start wait ..."</span>)</span><br><span class="line">    product_event.wait(timeout=<span class="number">10</span>)</span><br><span class="line">    print(<span class="string">f"product_event state: <span class="subst">{product_event.is_set()}</span>"</span>)</span><br><span class="line">    product_event.clear()</span><br><span class="line">    print(<span class="string">"product consumed."</span>)</span><br><span class="line">    print(<span class="string">f"product_event state: <span class="subst">{product_event.is_set()}</span>"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t_pro = threading.Thread(name=<span class="string">"producer"</span>, target=produce)</span><br><span class="line">t_con = threading.Thread(name=<span class="string">"consumer"</span>, target=consume)</span><br><span class="line"></span><br><span class="line">t_pro.start()</span><br><span class="line">t_con.start()</span><br><span class="line"><span class="comment"># product_event state: False</span></span><br><span class="line"><span class="comment"># start produce ...</span></span><br><span class="line"><span class="comment"># consumer start wait ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 等待10秒</span></span><br><span class="line"><span class="comment"># product produced.</span></span><br><span class="line"><span class="comment"># product_event state: True</span></span><br><span class="line"><span class="comment"># product_event state: True</span></span><br><span class="line"><span class="comment"># product consumed.</span></span><br><span class="line"><span class="comment"># product_event state: False</span></span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/04/04/django-yong-hu-guan-li/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/04/django-yong-hu-guan-li/" class="post-title-link" itemprop="url">django用户管理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-04-04 07:39:20 / 修改时间：06:16:46" itemprop="dateCreated datePublished" datetime="2021-04-04T07:39:20Z">2021-04-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%85%E6%B8%B8%E7%BD%91%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">旅游网项目</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="django用户管理"><a href="#django用户管理" class="headerlink" title="django用户管理"></a>django用户管理</h2><h2 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h2><h3 id="自定义用户管理类"><a href="#自定义用户管理类" class="headerlink" title="自定义用户管理类"></a>自定义用户管理类</h3><p><code>trip\accounts\admin.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyUserAdmin</span>():</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="继承自UserAdmin"><a href="#继承自UserAdmin" class="headerlink" title="继承自UserAdmin"></a>继承自<code>UserAdmin</code></h3><p><code>trip\accounts\admin.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.auth.admin <span class="keyword">import</span> UserAdmin</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyUserAdmin</span>(<span class="params">UserAdmin</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="配置列表显示字段、搜索字段"><a href="#配置列表显示字段、搜索字段" class="headerlink" title="配置列表显示字段、搜索字段"></a>配置列表显示字段、搜索字段</h3><p><code>trip\accounts\admin.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.contrib.auth.admin <span class="keyword">import</span> UserAdmin</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> accounts.models <span class="keyword">import</span> User</span><br><span class="line"><span class="comment"># Register your models here.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@admin.register(User)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyUserAdmin</span>(<span class="params">UserAdmin</span>):</span></span><br><span class="line">    <span class="string">""" 用户基础信息管理 """</span></span><br><span class="line">    <span class="comment"># 列表中显示的内容</span></span><br><span class="line">    list_display = (<span class="string">'username'</span>, <span class="string">'nickname'</span>, <span class="string">'is_active'</span>, <span class="string">'is_staff'</span>,</span><br><span class="line">                    <span class="string">'date_joined'</span>)</span><br><span class="line">    <span class="comment"># 搜索字段</span></span><br><span class="line">    search_fields = (</span><br><span class="line">        <span class="string">'username'</span>,</span><br><span class="line">        <span class="string">'nickname'</span>,</span><br><span class="line">    )</span><br></pre></td></tr></tbody></table></figure>

<h3 id="增加user表单列表增加显示昵称字段"><a href="#增加user表单列表增加显示昵称字段" class="headerlink" title="增加user表单列表增加显示昵称字段"></a>增加user表单列表增加显示昵称字段</h3><p><code>trip\accounts\admin.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.contrib.auth.admin <span class="keyword">import</span> UserAdmin</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> accounts.models <span class="keyword">import</span> User</span><br><span class="line"><span class="comment"># Register your models here.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@admin.register(User)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyUserAdmin</span>(<span class="params">UserAdmin</span>):</span></span><br><span class="line">    <span class="string">""" 用户基础信息管理 """</span></span><br><span class="line">    <span class="comment"># 新增的表单</span></span><br><span class="line">    add_fieldsets = UserAdmin.add_fieldsets + ((<span class="literal">None</span>, {</span><br><span class="line">        <span class="string">'fields'</span>: (<span class="string">'nickname'</span>, )</span><br><span class="line">    }), )</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2021/04/04/django-yong-hu-guan-li/0.png" alt="description"><br><img src="/2021/04/04/django-yong-hu-guan-li/1.png" alt="description"></p>
<h3 id="修改user表单列表增加显示昵称字段和头像"><a href="#修改user表单列表增加显示昵称字段和头像" class="headerlink" title="修改user表单列表增加显示昵称字段和头像"></a>修改user表单列表增加显示昵称字段和头像</h3><p><code>trip\accounts\admin.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.contrib.auth.admin <span class="keyword">import</span> UserAdmin</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> accounts.models <span class="keyword">import</span> User</span><br><span class="line"><span class="comment"># Register your models here.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@admin.register(User)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyUserAdmin</span>(<span class="params">UserAdmin</span>):</span></span><br><span class="line">    <span class="string">""" 用户基础信息管理 """</span></span><br><span class="line">    <span class="comment"># 修改的表单</span></span><br><span class="line">    fieldsets = UserAdmin.fieldsets + ((<span class="literal">None</span>, {</span><br><span class="line">        <span class="string">'fields'</span>: (<span class="string">'nickname'</span>, <span class="string">'avatar'</span>)</span><br><span class="line">    }), )</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2021/04/04/django-yong-hu-guan-li/2.png" alt="description"></p>
<h3 id="批量禁用-启用选中用户-商品"><a href="#批量禁用-启用选中用户-商品" class="headerlink" title="批量禁用/启用选中用户/商品"></a>批量禁用/启用选中用户/商品</h3><p>我们需要选择一批对象，然后执行某个操作。</p>
<ul>
<li><p>第一步：在相关的类中 定义操作函数 添加自定义方法 </p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">My</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">action_name</span>(<span class="params">modeladmin, request, queryset</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></tbody></table></figure></li>
<li><p>第二步：命名动作界面显示的操作名称</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aciton_name.short_description = <span class="string">'将选中的商品下线'</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>第三步：配置<code>ModelAdmin</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">    actions = [<span class="string">'action_name'</span>]</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p><code>trip\accounts\admin.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@admin.register(User)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyUserAdmin</span>(<span class="params">UserAdmin</span>):</span></span><br><span class="line">    <span class="string">""" 用户基础信息管理 """</span></span><br><span class="line">    actions = [<span class="string">'disable_user'</span>, <span class="string">'enable_user'</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">disable_user</span>(<span class="params">self, request, queryset</span>):</span></span><br><span class="line">        <span class="string">""" 批量禁用用户 """</span></span><br><span class="line">        queryset.update(is_active=<span class="literal">False</span>)</span><br><span class="line">    <span class="comment"># 命名动作界面显示的操作名称</span></span><br><span class="line">    disable_user.short_description = <span class="string">'批量禁用用户'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">enable_user</span>(<span class="params">self, request, queryset</span>):</span></span><br><span class="line">        <span class="string">""" 批量启用用户 """</span></span><br><span class="line">        queryset.update(is_active=<span class="literal">True</span>)</span><br><span class="line">    <span class="comment"># 命名动作界面显示的操作名称</span></span><br><span class="line">    enable_user.short_description = <span class="string">'批量启用用户'</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2021/04/04/django-yong-hu-guan-li/3.png" alt="description"></p>
<h4 id="法二"><a href="#法二" class="headerlink" title="法二"></a>法二</h4><p>另一种方法是单独建立一个定义函数，同时类中的actions引用该函数。<br>这样该定义函数就可以被其他的类也同时使用。</p>
<p>在公用的包中新增公用的自定义函数模块<code>admin_actions.py</code></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/04/04/edge-flag/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/04/edge-flag/" class="post-title-link" itemprop="url">edge flag</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-04-03 16:21:41" itemprop="dateCreated datePublished" datetime="2021-04-03T16:21:41Z">2021-04-03</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-21 11:29:42" itemprop="dateModified" datetime="2021-04-21T11:29:42Z">2021-04-21</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="edge-flag"><a href="#edge-flag" class="headerlink" title="edge flag"></a>edge flag</h3><ul>
<li>Parallel downloading</li>
<li>Global Media Controls</li>
<li>Global Media Controls Picture-in-Picture</li>
<li>Tab Hover Cards</li>
<li>tab groups</li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/04/03/django-zi-ding-yi-mo-xing-pei-zhi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/03/django-zi-ding-yi-mo-xing-pei-zhi/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-04-03 09:12:42" itemprop="dateCreated datePublished" datetime="2021-04-03T09:12:42Z">2021-04-03</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-04 06:17:14" itemprop="dateModified" datetime="2021-04-04T06:17:14Z">2021-04-04</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr>
<p>title: django自定义模型配置和表单界面<br>date: 2021-0-03 17:12:42<br>author: 外心人D<br>toc: true<br>mathjax: false<br>summary: 爱编程<br>categories: 旅游网项目<br>tags:<br> —  django</p>
<hr>
<p>isShowComment: true<br>isTimeLine: false<br>description:  </p>
<hr>
<h1 id="django自定义模型配置和表单界面"><a href="#django自定义模型配置和表单界面" class="headerlink" title="django自定义模型配置和表单界面"></a>django自定义模型配置和表单界面</h1><h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><h3 id="定制个性化的列表显示字段"><a href="#定制个性化的列表显示字段" class="headerlink" title="定制个性化的列表显示字段"></a>定制个性化的列表显示字段</h3><h3 id="自定义后台模型的表单验证"><a href="#自定义后台模型的表单验证" class="headerlink" title="自定义后台模型的表单验证"></a>自定义后台模型的表单验证</h3><p>从ORM模型直接创建一个表单<br><code>accounts\forms.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileEditForm</span>(<span class="params">forms.ModelForm</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息编辑 """</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = Profile</span><br><span class="line">        fields = (<span class="string">'real_name'</span>, <span class="string">'email'</span>, <span class="string">'phone_no'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">clean_age</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">""" 验证用户的年龄 """</span></span><br><span class="line">        age = self.cleaned_data[<span class="string">'age'</span>]</span><br><span class="line">        <span class="keyword">if</span> int(age) &gt;= <span class="number">120</span> <span class="keyword">or</span> int(age) &lt;= <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">raise</span> forms.ValidationError(<span class="string">'年龄只能在1-120之间'</span>)</span><br><span class="line">        <span class="keyword">return</span> age</span><br></pre></td></tr></tbody></table></figure>

<p><code>trip\accounts\admin.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> accounts.forms <span class="keyword">import</span> ProfileEditForm</span><br><span class="line"><span class="keyword">from</span> accounts.models <span class="keyword">import</span> Profile</span><br><span class="line"></span><br><span class="line"><span class="meta">@admin.register(Profile)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息表 """</span></span><br><span class="line">    <span class="comment"># 列表中显示的字段</span></span><br><span class="line">    list_display = (<span class="string">'format_username'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>, <span class="string">'created_at'</span>)</span><br><span class="line">    <span class="comment"># 关联的字段一次性查出，减少查询次数</span></span><br><span class="line">    <span class="comment"># 查询用户详细信息表需要在后台管理中展示用户基础信息表的内容</span></span><br><span class="line">    list_select_related = (<span class="string">'user'</span>, )</span><br><span class="line">    <span class="comment"># 表单中可以编辑的字段</span></span><br><span class="line">    fields = (<span class="string">'real_name'</span>, <span class="string">'email'</span>, <span class="string">'phone_no'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>)</span><br><span class="line">    <span class="comment"># 自定义表单验证</span></span><br><span class="line">    form = ProfileEditForm</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2021/04/03/django-zi-ding-yi-mo-xing-pei-zhi/5.png" alt="description"></p>
<h3 id="重写保存方法，执行其它业务逻辑"><a href="#重写保存方法，执行其它业务逻辑" class="headerlink" title="重写保存方法，执行其它业务逻辑"></a>重写保存方法，执行其它业务逻辑</h3><p><code>accounts\forms.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileEditForm</span>(<span class="params">forms.ModelForm</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息编辑 """</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        model = Profile</span><br><span class="line">        fields = (<span class="string">'real_name'</span>, <span class="string">'email'</span>, <span class="string">'phone_no'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">save</span>(<span class="params">self, commit=False</span>):</span></span><br><span class="line">        obj = super().save(commit)</span><br><span class="line">        <span class="comment"># 保存数据时做一些其他的业务逻辑处理</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> obj.source:</span><br><span class="line">            <span class="comment"># 对象的source字段存为web</span></span><br><span class="line">            obj.source = <span class="string">'web'</span></span><br><span class="line">            obj.save()</span><br><span class="line">        <span class="keyword">return</span> obj</span><br></pre></td></tr></tbody></table></figure>


<h3 id="限制可以编辑的模型字段"><a href="#限制可以编辑的模型字段" class="headerlink" title="限制可以编辑的模型字段"></a>限制可以编辑的模型字段</h3><ul>
<li><code>editable=False</code><br><code>accounts\models.py</code><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息 """</span></span><br><span class="line">    SEX_CHOICES = (</span><br><span class="line">        (<span class="number">1</span>, <span class="string">'男'</span>),</span><br><span class="line">        (<span class="number">0</span>, <span class="string">'女'</span>),</span><br><span class="line">    )</span><br><span class="line">    username = models.CharField(<span class="string">'用户名'</span>,</span><br><span class="line">                                max_length=<span class="number">64</span>,</span><br><span class="line">                                unique=<span class="literal">True</span>,</span><br><span class="line">                                editable=<span class="literal">False</span>)</span><br><span class="line">    user = models.OneToOneField(User,</span><br><span class="line">                                related_name=<span class="string">'profile'</span>,</span><br><span class="line">                                on_delete=models.CASCADE,</span><br><span class="line">                                editable=<span class="literal">False</span>)</span><br></pre></td></tr></tbody></table></figure>
<img src="/2021/04/03/django-zi-ding-yi-mo-xing-pei-zhi/1.png" alt="description"></li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息 """</span></span><br><span class="line">    SEX_CHOICES = (</span><br><span class="line">        (<span class="number">1</span>, <span class="string">'男'</span>),</span><br><span class="line">        (<span class="number">0</span>, <span class="string">'女'</span>),</span><br><span class="line">    )</span><br><span class="line">    username = models.CharField(<span class="string">'用户名'</span>,</span><br><span class="line">                                max_length=<span class="number">64</span>,</span><br><span class="line">                                unique=<span class="literal">True</span>,</span><br><span class="line">                                editable=<span class="literal">False</span>)</span><br><span class="line">    user = models.OneToOneField(User,</span><br><span class="line">                                related_name=<span class="string">'profile'</span>,</span><br><span class="line">                                on_delete=models.CASCADE,</span><br><span class="line">                                editable=<span class="literal">False</span>)</span><br></pre></td></tr></tbody></table></figure>


<ul>
<li><code>filed</code>/<code>exclude</code>——需要编辑/不需要编辑的字段列表<br><code>trip\accounts\admin.py</code><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> accounts.forms <span class="keyword">import</span> ProfileEditForm</span><br><span class="line"><span class="keyword">from</span> accounts.models <span class="keyword">import</span> Profile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@admin.register(Profile)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息表 """</span></span><br><span class="line">    list_display = (<span class="string">'format_username'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>, <span class="string">'created_at'</span>)</span><br><span class="line">    <span class="comment"># 关联的字段一次性查出，减少查询次数</span></span><br><span class="line">    list_select_related = (<span class="string">'user'</span>, )</span><br><span class="line">    <span class="comment"># 表单中可以编辑的字段</span></span><br><span class="line">    fields = (<span class="string">'real_name'</span>, <span class="string">'email'</span>, <span class="string">'phone_no'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>)</span><br></pre></td></tr></tbody></table></figure>
<img src="/2021/04/03/django-zi-ding-yi-mo-xing-pei-zhi/2.png" alt="description"></li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息 """</span></span><br><span class="line">    username = models.CharField(<span class="string">'用户名'</span>,</span><br><span class="line">                                max_length=<span class="number">64</span>,</span><br><span class="line">                                unique=<span class="literal">True</span>,</span><br><span class="line">                                editable=<span class="literal">False</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""setting.py installed_apps messages的提示的修改对象改成对应的中文用户名"""</span></span><br><span class="line">        <span class="keyword">return</span> self.username</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2021/04/03/django-zi-ding-yi-mo-xing-pei-zhi/3.png" alt="description"></p>
<p>取消外键检查<br><code>setting.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = {</span><br><span class="line"><span class="string">'default'</span>: {</span><br><span class="line">    ...         </span><br><span class="line">    <span class="string">'OPTIONS'</span>: {</span><br><span class="line">         <span class="string">"init_command"</span>: <span class="string">"SET foreign_key_checks = 0;"</span>,</span><br><span class="line">    },</span><br><span class="line"> }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>在Django的早期版本中，使用InnoDB存储引擎时，带有前向引用(即与尚未插入数据库的行的关系)的固定装置将无法加载。这是因为InnoDB偏离了SQL标准，立即检查外键约束，而不是将检查推迟到事务提交之后。这个问题在Django 1.4得到了解决。</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/04/03/admin-de-yi-xie-you-hua-pei-zhi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/03/admin-de-yi-xie-you-hua-pei-zhi/" class="post-title-link" itemprop="url">admin的一些优化配置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-04-02 17:46:44" itemprop="dateCreated datePublished" datetime="2021-04-02T17:46:44Z">2021-04-02</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-17 11:19:07" itemprop="dateModified" datetime="2021-04-17T11:19:07Z">2021-04-17</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%85%E6%B8%B8%E7%BD%91%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">旅游网项目</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="admin的一些优化配置"><a href="#admin的一些优化配置" class="headerlink" title="admin的一些优化配置"></a>admin的一些优化配置</h1><h2 id="本地化"><a href="#本地化" class="headerlink" title="本地化"></a>本地化</h2><ul>
<li><p>配置语言</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LANGUAGE_CODE = <span class="string">'zh-hans'</span></span><br></pre></td></tr></tbody></table></figure></li>
<li><p>配置时区</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TIME_ZONE = <span class="string">'Asia/Shanghai'</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>模型<br>修改在管理系统的显示名称，<code>apps.py</code>添加<code>verbose_name</code><br>模型也可以通过<code>verbose_name</code>修改显示的名称</p>
</li>
</ul>
<p><code>accounts\apps.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.apps <span class="keyword">import</span> AppConfig</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AccountsConfig</span>(<span class="params">AppConfig</span>):</span></span><br><span class="line">    name = <span class="string">'accounts'</span></span><br><span class="line">    verbose_name = <span class="string">'用户账户'</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2021/04/03/admin-de-yi-xie-you-hua-pei-zhi/admin%E7%9A%84%E4%B8%80%E4%BA%9B%E4%BC%98%E5%8C%96%E9%85%8D%E7%BD%AE.jpeg" alt="description"><br>表头就是模块名称的<code>verbose_name</code></p>
<p><code>accounts\models.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息 """</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">'accounts_user_profile'</span></span><br><span class="line">        verbose_name = <span class="string">'用户详细信息'</span></span><br><span class="line">        verbose_name_plural = <span class="string">'用户详细信息'</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2021/04/03/admin-de-yi-xie-you-hua-pei-zhi/1.jpeg" alt="description"><br><img src="/2021/04/03/admin-de-yi-xie-you-hua-pei-zhi/2.jpeg" alt="description"><br>表头就是模块名称的<code>verbose_name</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息 """</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">'accounts_user_profile'</span></span><br><span class="line">        verbose_name = <span class="string">'用户详细信息'</span></span><br><span class="line">        <span class="comment"># verbose_name_plural = '用户详细信息'</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2021/04/03/admin-de-yi-xie-you-hua-pei-zhi/3.jpeg" alt="description"><br>表头就是模块名称的<code>verbose_name</code></p>
<h2 id="查询速度优化"><a href="#查询速度优化" class="headerlink" title="查询速度优化"></a>查询速度优化</h2><h3 id="分析问题"><a href="#分析问题" class="headerlink" title="分析问题"></a>分析问题</h3><ul>
<li>减少每页的数据大小，比如分页；</li>
<li>减少SQL查询的次数，外键关联等一次性查询。<h3 id="解决思路"><a href="#解决思路" class="headerlink" title="解决思路"></a>解决思路</h3></li>
<li><code>list_per_page</code> 分页大小，默认每页100条</li>
<li><code>list_select_related</code> 外键关联查询优化</li>
<li><code>paginator</code> 分页器</li>
</ul>
<h2 id="字段格式化字段优化"><a href="#字段格式化字段优化" class="headerlink" title="字段格式化字段优化"></a>字段格式化字段优化</h2><h3 id="场景：指定方法将用户名、手机号等脱敏处理"><a href="#场景：指定方法将用户名、手机号等脱敏处理" class="headerlink" title="场景：指定方法将用户名、手机号等脱敏处理"></a>场景：指定方法将用户名、手机号等脱敏处理</h3><p>在定义的admin类中添加自定义方法，然后再将名称传入<code>list_display</code>。<br><code>accounts\admin.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> accounts.models <span class="keyword">import</span> Profile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@admin.register(Profile)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息表 """</span></span><br><span class="line">    <span class="comment"># 列表中显示的字段</span></span><br><span class="line">    list_display = (<span class="string">'format_username'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>, <span class="string">'created_at'</span>)</span><br><span class="line">    <span class="comment"># 每页显示5条数据</span></span><br><span class="line">    list_per_page = <span class="number">5</span></span><br><span class="line">    <span class="comment"># 关联的字段一次性查出，减少查询次数</span></span><br><span class="line">    <span class="comment"># 查询用户详细信息表需要在后台管理中展示用户基础信息表的内容</span></span><br><span class="line">    list_select_related = (<span class="string">'user'</span>, )</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">format_username</span>(<span class="params">self, obj</span>):</span></span><br><span class="line">        <span class="string">""" 用户名脱敏处理</span></span><br><span class="line"><span class="string">        :param obj: Profile</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> obj.username[:<span class="number">3</span>] + <span class="string">'***'</span></span><br><span class="line">    <span class="comment"># 修改列名</span></span><br><span class="line">    format_username.short_description = <span class="string">'用户名'</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2021/04/03/admin-de-yi-xie-you-hua-pei-zhi/0.png" alt="description"></p>
<h3 id="快捷搜索"><a href="#快捷搜索" class="headerlink" title="快捷搜索"></a>快捷搜索</h3><ul>
<li><code>list_filter</code>——快捷搜索字段，跟模型里选项<code>choices</code>相关的字段在后台页面增加过滤器<h4 id="场景：支持按用户性别快捷搜索"><a href="#场景：支持按用户性别快捷搜索" class="headerlink" title="场景：支持按用户性别快捷搜索"></a>场景：支持按用户性别快捷搜索</h4><code>accounts\models.py</code><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息 """</span></span><br><span class="line">    SEX_CHOICES = (</span><br><span class="line">        (<span class="number">1</span>, <span class="string">'男'</span>),</span><br><span class="line">        (<span class="number">0</span>, <span class="string">'女'</span>),</span><br><span class="line">    )</span><br><span class="line">    sex = models.SmallIntegerField(<span class="string">'性别'</span>, default=<span class="number">1</span>, choices=SEX_CHOICES)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">'accounts_user_profile'</span></span><br><span class="line">        verbose_name = <span class="string">'用户详细信息'</span></span><br><span class="line">        verbose_name_plural = <span class="string">'用户详细信息'</span></span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p><code>accounts\admin.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> accounts.models <span class="keyword">import</span> Profile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@admin.register(Profile)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息表 """</span></span><br><span class="line">    <span class="comment"># 列表中显示的字段</span></span><br><span class="line">    list_display = (<span class="string">'format_username'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>, <span class="string">'created_at'</span>)</span><br><span class="line">    <span class="comment"># 快捷搜索</span></span><br><span class="line">    list_filter = (<span class="string">'sex'</span>, )</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2021/04/03/admin-de-yi-xie-you-hua-pei-zhi/5.png" alt="description"></p>
<h3 id="关联搜索-在后台管理配置搜索条件"><a href="#关联搜索-在后台管理配置搜索条件" class="headerlink" title="关联搜索 在后台管理配置搜索条件"></a>关联搜索 在后台管理配置搜索条件</h3><ul>
<li><code>search_fields</code>——支持搜索的字段<h4 id="场景：：按用户名、昵称搜索用户"><a href="#场景：：按用户名、昵称搜索用户" class="headerlink" title="场景：：按用户名、昵称搜索用户"></a>场景：：按用户名、昵称搜索用户</h4><code>accounts_user_profile</code>表格里面没有<code>nickname</code>字段，<code>account_user</code>表才有<code>nickname</code>字段，1对1的关联关系，用<code>search_fields = ('username', 'user__nickname')</code><br><code>accounts\models.py</code><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>(<span class="params">AbstractUser</span>):</span></span><br><span class="line">    <span class="string">""" 用户模型 """</span></span><br><span class="line">    nickname = models.CharField(<span class="string">'昵称'</span>, max_length=<span class="number">32</span>, unique=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息 """</span></span><br><span class="line">    user = models.OneToOneField(User,</span><br><span class="line">                                related_name=<span class="string">'profile'</span>,</span><br><span class="line">                                on_delete=models.CASCADE)</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p><code>accounts\admin.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> accounts.models <span class="keyword">import</span> Profile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@admin.register(Profile)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileAdmin</span>(<span class="params">admin.ModelAdmin</span>):</span></span><br><span class="line">    <span class="string">""" 用户详细信息表 """</span></span><br><span class="line">    list_display = (<span class="string">'format_username'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>, <span class="string">'created_at'</span>)</span><br><span class="line">    <span class="comment"># 关联的字段一次性查出，减少查询次数</span></span><br><span class="line">    <span class="comment"># 查询用户详细信息表需要在后台管理中展示用户基础信息表的内容</span></span><br><span class="line">    list_select_related = (<span class="string">'user'</span>, )</span><br><span class="line">    <span class="comment"># 输入内容模糊匹配</span></span><br><span class="line">    search_fields = (<span class="string">'username'</span>, <span class="string">'user__nickname'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">format_username</span>(<span class="params">self, obj</span>):</span></span><br><span class="line">        <span class="string">""" 用户名脱敏处理</span></span><br><span class="line"><span class="string">        :param obj: Profile</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> obj.username[:<span class="number">3</span>] + <span class="string">'****'</span> + obj.username[<span class="number">-4</span>:]</span><br><span class="line">    <span class="comment"># 修改列名称</span></span><br><span class="line">    format_username.short_description = <span class="string">'用户名'</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2021/04/03/admin-de-yi-xie-you-hua-pei-zhi/6.png" alt="description"><br><img src="/2021/04/03/admin-de-yi-xie-you-hua-pei-zhi/7.png" alt="description"></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/04/02/django-jiang-mo-xing-tian-jia-dao-hou-tai-guan-li/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/02/django-jiang-mo-xing-tian-jia-dao-hou-tai-guan-li/" class="post-title-link" itemprop="url">Django将模型添加到后台管理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-04-02 15:20:44" itemprop="dateCreated datePublished" datetime="2021-04-02T15:20:44Z">2021-04-02</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-17 11:20:43" itemprop="dateModified" datetime="2021-04-17T11:20:43Z">2021-04-17</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%85%E6%B8%B8%E7%BD%91%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">旅游网项目</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Django将模型添加到后台管理"><a href="#Django将模型添加到后台管理" class="headerlink" title="Django将模型添加到后台管理"></a>Django将模型添加到后台管理</h1><h2 id="关于Django后台管理"><a href="#关于Django后台管理" class="headerlink" title="关于Django后台管理"></a>关于Django后台管理</h2><ul>
<li>框架自动生成的后台管理界面</li>
<li>从ORM模型中读取元数据，简单配置即可使用</li>
<li>功能强大，可用于对数据库中数据的管理</li>
<li>django admin 用来对数据的维护</li>
</ul>
<p>实现步骤</p>
<ul>
<li>第一步：框架部分的配置</li>
<li>步骤1：<code>INSTALLED_APPS</code>配置应用及依赖<br><code>trip\settings.py</code><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">'django.contrib.admin'</span>,</span><br><span class="line">    <span class="string">'django.contrib.auth'</span>,</span><br><span class="line">    <span class="string">'django.contrib.contenttypes'</span>,</span><br><span class="line">    <span class="string">'django.contrib.sessions'</span>,</span><br><span class="line">    <span class="string">'django.contrib.messages'</span>,</span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,</span><br><span class="line">    <span class="comment"># 用户账户</span></span><br><span class="line">    <span class="string">'accounts.apps.AccountsConfig'</span>,</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/04/02/django-jiang-mo-xing-tian-jia-dao-hou-tai-guan-li/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/04/02/lu-you-wang-shan-chu-ding-dan-jie-kou-lian-diao/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/02/lu-you-wang-shan-chu-ding-dan-jie-kou-lian-diao/" class="post-title-link" itemprop="url">旅游网删除订单接口联调</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-04-01 22:51:44" itemprop="dateCreated datePublished" datetime="2021-04-01T22:51:44Z">2021-04-01</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 15:55:59" itemprop="dateModified" datetime="2021-04-02T15:55:59Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%85%E6%B8%B8%E7%BD%91%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">旅游网项目</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="删除订单接口联调"><a href="#删除订单接口联调" class="headerlink" title="删除订单接口联调"></a>删除订单接口联调</h1><p>实现步骤</p>
<ul>
<li>第一步，阅读接口文档<br>在我的订单页面判断订单状态是否是已完成和已取消，有删除订单按钮，点击后弹框确认是否删除，<br>点击确认删除把订单在数据库中做逻辑删除，通过某一字段标记它是否已经删除，在前端通过这个字段进行控制该订单不会再我的订单页面列表显示，</li>
<li>第二步，配置接口地址</li>
</ul>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 我的订单列表页面 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-order-list"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 订单记录 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"order-list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"order-item"</span> <span class="attr">v-for</span>=<span class="string">"item in dataList"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:key</span>=<span class="string">"item.sn"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-show</span>=<span class="string">"item.sn"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"order-footer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">van-button</span> <span class="attr">round</span> <span class="attr">size</span>=<span class="string">"small"</span> <span class="attr">type</span>=<span class="string">"warning"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-if</span>=<span class="string">"item.status == constants.ORDER_STATUS_DONE || item.status == constants.ORDER_STATUS_CANCEL"</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">"deleteOrder(item)"</span>&gt;</span>删除订单<span class="tag">&lt;/<span class="name">van-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">van-button</span> <span class="attr">round</span> <span class="attr">size</span>=<span class="string">"small"</span> <span class="attr">type</span>=<span class="string">"info"</span>&gt;</span>订单详情<span class="tag">&lt;/<span class="name">van-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { OrderApis } <span class="keyword">from</span> <span class="string">'@/utils/apis'</span></span><br><span class="line"><span class="keyword">import</span> { ajax } <span class="keyword">from</span> <span class="string">'@/utils/ajax'</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> constants <span class="keyword">from</span> <span class="string">'@/utils/constants'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> {</span><br><span class="line">  data () {</span><br><span class="line">    <span class="keyword">return</span> {</span><br><span class="line">      status: <span class="number">0</span>,</span><br><span class="line">      <span class="comment">// 订单列表</span></span><br><span class="line">      dataList: [],</span><br><span class="line">      constants</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除订单</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    deleteOrder (item) {</span><br><span class="line">      <span class="comment">// 弹框确认</span></span><br><span class="line">      <span class="built_in">this</span>.$dialog.alert({</span><br><span class="line">        title: <span class="string">'温馨提示'</span>,</span><br><span class="line">        message: <span class="string">'删除订单将无法恢复，确认删除订单？'</span></span><br><span class="line">      }).then(<span class="function">() =&gt;</span> {</span><br><span class="line">        <span class="comment">// 调用接口 sn替换为传递过来item下面的sn</span></span><br><span class="line">        <span class="keyword">const</span> url = OrderApis.orderDetailUrl.replace(<span class="string">'#{sn}'</span>, item.sn)</span><br><span class="line">        ajax.delete(url).then(<span class="function"><span class="params">res</span> =&gt;</span> {</span><br><span class="line">          <span class="comment">// 告诉用户已经删除成功了</span></span><br><span class="line">          <span class="comment">// 隐藏界面上的显示</span></span><br><span class="line">          <span class="keyword">if</span> (res.status === <span class="number">201</span>) {</span><br><span class="line">            <span class="built_in">this</span>.$notify({</span><br><span class="line">              type: <span class="string">'success'</span>,</span><br><span class="line">              message: <span class="string">'删除成功'</span></span><br><span class="line">            })</span><br><span class="line">            <span class="comment">// 清空sn，该订单在已完成和已取消页面隐藏，display:none</span></span><br><span class="line">            item.sn = <span class="string">''</span></span><br><span class="line">          }</span><br><span class="line">        })</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>第三步，使用axios获取数据</li>
<li>第四步，将数据设置到模型层</li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/04/02/lu-you-wang-qu-xiao-ding-dan-jie-kou-lian-diao/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/02/lu-you-wang-qu-xiao-ding-dan-jie-kou-lian-diao/" class="post-title-link" itemprop="url">旅游网取消订单接口联调</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-04-01 22:51:44" itemprop="dateCreated datePublished" datetime="2021-04-01T22:51:44Z">2021-04-01</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:45" itemprop="dateModified" datetime="2021-04-02T12:24:45Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%85%E6%B8%B8%E7%BD%91%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">旅游网项目</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="取消订单接口联调"><a href="#取消订单接口联调" class="headerlink" title="取消订单接口联调"></a>取消订单接口联调</h1><h4 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li>第一步，完成页面间的跳转<br>从我的订单列表页面跳转到待支付的页面，<br>在我的订单页面判断订单状态是否是待支付状态有去支付按钮，，点击后弹框跳转时候绑定事件，</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 我的订单列表页面 --&gt;</span><br><span class="line">  &lt;div class="page-order-list"&gt;</span><br><span class="line">    &lt;!-- 订单记录 --&gt;</span><br><span class="line">    &lt;div class="order-list"&gt;</span><br><span class="line">      &lt;div class="order-item" v-for="item in dataList" :key="item.sn"&gt;</span><br><span class="line">        &lt;div class="order-footer"&gt;</span><br><span class="line">          &lt;van-button round size="small" type="warning"</span><br><span class="line">            v-if="item.status == constants.ORDER_STATUS_PAY"</span><br><span class="line">            @click="goPay(item)"&gt;去支付&lt;/van-button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      status: 0,</span><br><span class="line">      // 订单列表</span><br><span class="line">      dataList: [],</span><br><span class="line">      constants</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    /**</span><br><span class="line">     * 跳转到支付页面</span><br><span class="line">     */</span><br><span class="line">    goPay (item) {</span><br><span class="line">      this.$router.push({name: 'OrderPay', params: {sn: item.sn}})</span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * tab点击之后，重新去获取数据</span><br><span class="line">     */</span><br><span class="line">    tabChange (name, value) {</span><br><span class="line">      console.log(name, value)</span><br><span class="line">      this.$router.push({name: 'OrderList', params: { status: name }})</span><br><span class="line">    },</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>第二步，配置接口地址及请求参数<br>右上角点击取消订单按钮，点击确认把订单在数据库中做，该订单不会再我的订单页面显示，</p>
</li>
<li><p>第三步，处理数据返回，给用户一个提示，取消订单成功<br>状态码是201则已经取消成功，是201则已经被取消一次了，不能重复取消且有弹框<br><code>src\views\order\Pay.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 订单确认及支付 --&gt;</span><br><span class="line">    &lt;!-- 顶部导航 --&gt;</span><br><span class="line">    &lt;van-nav-bar</span><br><span class="line">      right-text="取消订单"</span><br><span class="line">      @click-right="onCancelOrder"</span><br><span class="line">    /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import { OrderApis } from '@/utils/apis'</span><br><span class="line">import { ajax } from '@/utils/ajax'</span><br><span class="line">import * as constants from '@/utils/constants'</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      // 订单的流水号</span><br><span class="line">      sn: '',</span><br><span class="line">      // 订单的信息</span><br><span class="line">      orderDetail: {}</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    /**</span><br><span class="line">     * 取消订单</span><br><span class="line">     */</span><br><span class="line">    onCancelOrder () {</span><br><span class="line">      this.$dialog.confirm({</span><br><span class="line">        title: '温馨提示',</span><br><span class="line">        message: '确认取消该订单？'</span><br><span class="line">      }).then(() =&gt; {</span><br><span class="line">        const url = OrderApis.orderDetailUrl.replace('#{sn}', this.sn)</span><br><span class="line">        // put方式调用接口</span><br><span class="line">        ajax.put(url).then(res =&gt; {</span><br><span class="line">          console.log(res)</span><br><span class="line">          // 给用户提示</span><br><span class="line">          if (res.status === 201) {</span><br><span class="line">            this.$notify({</span><br><span class="line">              type: 'success',</span><br><span class="line">              message: '订单已成功取消'</span><br><span class="line">            })</span><br><span class="line">          } else if (res.status === 200) {</span><br><span class="line">            this.$notify({</span><br><span class="line">              type: 'warning',</span><br><span class="line">              message: '订单已被取消，请勿重复操作'</span><br><span class="line">            })</span><br><span class="line">          }</span><br><span class="line">          // 回到上一个我的订单页面</span><br><span class="line">          this.$router.go(-1)</span><br><span class="line">        })</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>
</li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2021/04/02/lu-you-wang-ding-dan-xiang-xi-xin-xi-ye-mian-de-zhan-shi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/04/02/lu-you-wang-ding-dan-xiang-xi-xin-xi-ye-mian-de-zhan-shi/" class="post-title-link" itemprop="url">旅游网订单详细信息页面的展示</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-04-01 22:51:44" itemprop="dateCreated datePublished" datetime="2021-04-01T22:51:44Z">2021-04-01</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:45" itemprop="dateModified" datetime="2021-04-02T12:24:45Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%85%E6%B8%B8%E7%BD%91%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">旅游网项目</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>我的订单中的订单详细信息页面的展示。<br>1、 点击全部订单可以跳转到我的订单页面，包括所有的订单，点击订单详情可以跳转到订单详情页，<br>该页面中包括导航条(包括返回按钮及当前订单的状态)、订单信息(包括订单号和下单时间)、订单明细(包括下单的商品快照，会显示商品图片、商品标题、数量、价格及备注信息)、订单总计(总共几件商品及价格合计)、对应的按钮</p>
<p>实现订单详细信息接口<br> 实现订单详细信息页面<br> 完成订单详细信息页面展示<br> 实现页面间的跳转、订单删除功能</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>
<script src="/js/comments.js"></script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">外心人D</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
