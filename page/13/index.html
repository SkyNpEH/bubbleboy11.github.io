<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<meta name="hexo-config" content="{&quot;hostname&quot;:&quot;bubbleboy11.github.io&quot;,&quot;root&quot;:&quot;/&quot;,&quot;images&quot;:&quot;/images&quot;,&quot;scheme&quot;:&quot;Muse&quot;,&quot;version&quot;:&quot;8.3.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:true,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:false,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;}}">
<meta name="description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:type" content="website">
<meta property="og:title" content="外心人D的博客">
<meta property="og:url" content="https://bubbleboy11.github.io/page/13/index.html">
<meta property="og:site_name" content="外心人D的博客">
<meta property="og:description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="外心人D">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://bubbleboy11.github.io/page/13/">



<meta name="hexo-config-page" content="{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:true,&quot;isPost&quot;:false,&quot;lang&quot;:&quot;zh-CN&quot;}">
<meta name="hexo-config-calendar" content="">
<script data-pjax src="/js/load-config.js"></script>
  <title>外心人D的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="外心人D的博客" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">外心人D的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">外心人D</p>
  <div class="site-description" itemprop="description">本博客大多内容为慕课和网上博客，并非原创</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">246</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python-logging/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python-logging/" class="post-title-link" itemprop="url">python logging</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-20 08:38:30" itemprop="dateModified" datetime="2021-04-20T08:38:30Z">2021-04-20</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>日志记录配置<br>logging是一个python标准库<br>logging的四个部分（配置logging中很重要）：<br>    • logger——日志记录入口<br>logger的级别：<br>        ○ DEBUG：用于调试目的的底层系统信息<br>        ○ INFO: 普通的系统信息<br>        ○ WARNING： 警告，较小的问题，不影响执行顺序<br>        ○ ERROR: 错误，较大的问题<br>        ○ CRITICAL: 严重，致命的问题<br>logger记录内容：<br>        ○ django 记录所有内容<br>        ○ django.request 记录？（官方文档说是记录请求，但是使用后发现没有写入任何内容。。。<br>        ○ django.server 记录请求<br>        ○ django.template 记录与渲染模板相关的内容<br>        ○ django.db.backends 记录数据库操作<br>        ○ django.security.* 记录与安全相关的内容<br>    • Handler——决定处理logger中消息的方式<br>比如写入文件‘log_file’，控制台输出’console‘，发送邮件’mail_admins’等等<br>    • Filters——对日志进行条件控制<br>    • Formatters——日志记录的文本顺序（格式）<br>在view视图中写入logging的方法<br>确保切换到了debug模式，否则本地运行无法读取静态文件，服务器端运行则需要部署nginx。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import the logging library</span></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="comment"># Get an instance of a logger</span></span><br><span class="line"><span class="comment"># __name__对应django的记录模式，比如'django'等，也可以自定义，但是需要到设置中配置handler</span></span><br><span class="line">logger = logging.getLogger(__name__)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_view</span>(<span class="params">request, arg1, arg</span>):</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">if</span> bad_mojo:</span><br><span class="line">    <span class="comment"># Log an error message</span></span><br><span class="line">   logger.error(<span class="string">'Something went wrong!'</span>)</span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python-mongodb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python-mongodb/" class="post-title-link" itemprop="url">python mongodb</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-04 15:36:13" itemprop="dateModified" datetime="2021-05-04T15:36:13Z">2021-05-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p> pip3 install mongoengine</p>
<p>连接MongoDB</p>
<p> 方法一:简写</p>
<p> connect(‘students)</p>
<p> 方法二:指定端口和地址</p>
<p> connect(‘students’,host=’192.168.1.35’,port=27017)</p>
<p> 方法三:使用URI</p>
<p> connect(‘students’,host=’mongodb://localhost/students’)
 </p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python-random/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python-random/" class="post-title-link" itemprop="url">python random</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-09 09:32:48" itemprop="dateModified" datetime="2021-04-09T09:32:48Z">2021-04-09</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="random提供了生成随机数的工具"><a href="#random提供了生成随机数的工具" class="headerlink" title="random提供了生成随机数的工具"></a>random提供了生成随机数的工具</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">print(random.choice([<span class="string">'apple'</span>, <span class="string">'pear'</span>, <span class="string">'banana'</span>]))</span><br><span class="line"><span class="comment"># 'apple'</span></span><br><span class="line">print(random.sample(range(<span class="number">100</span>), <span class="number">10</span>))  <span class="comment"># sampling without replacement</span></span><br><span class="line"><span class="comment"># [30, 83, 16, 4, 8, 81, 41, 50, 18, 33]</span></span><br><span class="line">print(random.random())  <span class="comment"># random float 0~1</span></span><br><span class="line"><span class="comment"># 0.17970987693706186</span></span><br><span class="line">print(random.randrange(<span class="number">6</span>))  <span class="comment"># random integer chosen from range(6)</span></span><br><span class="line"><span class="comment"># 4</span></span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python3-xin-zeng-de-yu-fa-he-nei-zhi-ku/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python3-xin-zeng-de-yu-fa-he-nei-zhi-ku/" class="post-title-link" itemprop="url">python3新增的语法和内置库</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-11 04:22:16" itemprop="dateModified" datetime="2021-04-11T04:22:16Z">2021-04-11</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>① <code>yield from</code> 链接子生成器<br>② <code>asyncio</code>内置库， async/await原生协程支持异步编程<br>③ 新的内置库<code>enum</code>枚举库, mock库做单测试mock掉一些网络接口,  <code>ipaddress</code>处理IP地址库, <code>concurrent.futures</code>并发相关库等<br>④ python3把生成的pyc文件统一放到<code>__pycache__</code>文件夹下面。<br>⑤ 一些内置库的修改。urllib, selector等<br>⑥ 性能优化等</p>
<h3 id="兼容2-3的工具"><a href="#兼容2-3的工具" class="headerlink" title="兼容2/3的工具"></a>兼容2/3的工具</h3><pre><code>six模块
2to3等工具转换代码
__future__
</code></pre>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python-man/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python-man/" class="post-title-link" itemprop="url">python慢</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-01 03:02:29" itemprop="dateModified" datetime="2021-05-01T03:02:29Z">2021-05-01</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>py代码主要是干什么事情。通常的处理如果是干一些文件操作，网络操作，和c++差距人都感知不出来。性能敏感的代码可以用c++做成库去调用。其实很多Python的库核心都是c语言c加加写的，然后Python去调用它。Python qt库也是这样。</p>
<p>处理邮件，自动收发，回复邮件；包括操纵文档、PPT，python表示分分钟整理完成。</p>
<p>金融行业的可以用来量化投资，数据清洗</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python-mo-kuai/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python-mo-kuai/" class="post-title-link" itemprop="url">python模块</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-18 02:12:05" itemprop="dateModified" datetime="2021-05-18T02:12:05Z">2021-05-18</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li>模块是对内部逻辑的<strong>封装</strong>，只对外提供<strong>接口</strong></li>
<li>一个py文件就是一个模块，模块的名称就是不含.py后缀的文件名<br><code>import</code>关键字导入一个模块</li>
</ul>
<p>◆可维护性更强◆方便代码重用<br>python中模块是包含变量、函数、……代码块的文件；<br>包是存放多个文件/模块的文件夹，可以统一组织和管理多个python模块；<br>标准的包结构中包含一个特殊的文件[_init_py]。<br>两者的区别：包是一个文件夹，可以包含多个文件/模块，模块是一个文件</p>
<p>什么叫反射？<br>给定一个对象，返回该对象的所有属性和函数列表，<br>或给定对象和该对象的函数或者属性的名字，返回对象的函数或者属性实例。<br>dir函数就是反射的实现，<br>dir()函数:如果要获得一个对象的所有属性和方法，<br>dir() 函数一个排好序的字符串列表，内容是一个模块里定义过的名字。<br>返回的列表容纳了在一个模块里定义的所有模块，变量和函数</p>
<p>help——查看类，方法的帮助信息<br>__name__—当前模块的名称<br>__file__——文件全路径</p>
<p>当你导入一个模块，Python 解析器对模块位置的搜索顺序是：<br>1、当前目录（包）<br>2、如果不在当前目录，Python 则搜索在 shell 变量 PYTHONPATH 下的每个目录。（内置函数）<br>3、如果都找不到，Python会察看默认路径。<br>模块搜索路径存储在 system 模块的 sys.path 变量中。变量里包含当前目录，PYTHONPATH和由安装过程决定的默认目录。（环境变量）<br>PYTHONPATH 变量作为环境变量，PYTHONPATH 由装在一个列表里的许多目录组成。PYTHONPATH 的语法和 shell 变量 PATH 的一样。</p>
<p>导入模块时，只需要写模块名<br>只导入模块名时，引用模块中的函数时，格式是模块名.函数名</p>
<p>包python package<br>◆可以用来组织模块（可以包含其它模块的模块），包是一个分层次的文件目录结构，它定义了一个由模块及子包，和子包下的子包等组成的 Python 的应用环境。<br>◆目录（文件夹）必须包含文件_init.py，, 该文件的内容可以为空。<strong>init</strong>.py 用于标识当前文件夹是一个包。<br>◆模块重名问题解决</p>
<p>包Package的引用<br>·引入整个包：import module,还要确保该模块所在包中的_init__.py模块，写入具体要引入的模块名。<br>·只是引入所需要的属性和方法：from module.xx.xx import xx<br>在<em>init</em>.py为空的前提下，包的引入有三种，分别是<br>from 包名 import 模块名、<br>from 包名.模块名 import 函数名、<br>import 包名.模块名，利用as可以给模块或包指定别名</p>
<p>◆指定别名，导入不同包同名模块：from module.xx.xx import xx as renename<br>·引入所有：from module.xx.xx import * 不推荐，需要什么导入什么<br>导入包的本质就是执行该包下的<strong>init</strong>.py文件</p>
<p>在引入目录Directory中内容时，只可以引入该目录的子目录中的内容，也可以手动为Directory添加<em>init</em>.py使之可以像包一样引用</p>
<p>函数/变量描述<br>argv命令行参数，包括脚本名<br>getcwd返回当前所在的目录<br>modules一个字典，将模块名映射到加载的模块<br>path一个列表，包含要在其中查找模块的目录的名称<br>platform一个平台标识符，如sunos5或win32</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python-xu-ni-huan-jing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python-xu-ni-huan-jing/" class="post-title-link" itemprop="url">python虚拟环境与pip</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-16 10:18:35" itemprop="dateModified" datetime="2021-05-16T10:18:35Z">2021-05-16</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>关掉前面的base<br>conda deactivate 退出 conda base 环境</p>
<p>PyPi Python Package Index，一个Python库的托管平台，<a target="_blank" rel="noopener" href="https://pypi.org/">https://pypi.org/</a> </p>
<p>延长timeout时间</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip --default-timeout=100 install -i https://pypi.tuna.tsinghua.edu.cn/simple/ package</span><br><span class="line">pip --default-timeout=100 install --index-url https://pypi.tuna.tsinghua.edu.cn/simple/ package</span><br></pre></td></tr></tbody></table></figure>


<p>使⽤源码安装：下载安装包并解压，然后进⼊setup.py所在的⽬录，执⾏python setup.py install</p>
<ul>
<li><code>pip show 包名</code> 查看安装详情</li>
<li><code>pip uninstall 包名</code></li>
<li><code>pip list</code> 查看安装的包 列出安装的库</li>
<li><code>pip list --outdated</code> 列出有更新的库</li>
<li><code>pip install -U library_name</code> 升级库library_name</li>
<li><code>pip install --upgrade library_name</code> 升级库library_name</li>
</ul>
<p>任何应用程序通常需要设置安装所需并依赖一组类库来满足工作要求。<br>要求文件是指定和一次性安装包的依赖项具体一整套方法。</p>
<ul>
<li><p><code>pip freeze &gt; requirements.txt</code> 提取 生成将当前项目的pip类库列表生成 requirements.txt 文件，保存当前Python环境下所有类库包，其它包括那些你没有在当前项目中使用的类库。 </p>
</li>
<li><p><code>pip install -r requirements.txt</code> 安装requirements.txt提取的依赖</p>
</li>
<li><p><code>pip install --cache-dir . C:\abc\xadmin-master.zip</code></p>
</li>
<li><p><code>pip install *.whl</code>安装包名 通过.whl安装包安装 这种方式通常在直接pip安装出现异常时使用。<br>.whl安装包需在安装前下载好，下面推荐一个常用的.whl包下载网址：<a target="_blank" rel="noopener" href="https://www.lfd.uci.edu/~gohlke/pythonlibs/">https://www.lfd.uci.edu/~gohlke/pythonlibs/</a></p>
</li>
</ul>
<p><code>pip install 包名==版本号</code> 指定版本安装</p>
<p><code>pip install pipenv</code><br>在创建好的目录下执行<br>pip –python</p>
<ul>
<li><code>pipenv install 包名</code>，创建一个当前目录下面的虚拟环境，接着看项目里面有没有Pipfile文件，如果有会读取里面记录的依赖包，并且自动把所有的包安装到创建的虚拟环境中</li>
<li><code>pipenv shell</code> 进入</li>
<li><code>python -m pip install --upgrade pip</code></li>
<li><code>pipenv graph</code> 查看依赖包</li>
<li><code>exit</code> 退出</li>
<li><code>pipenv --env</code>查看虚拟环境的名字、文件的路径</li>
</ul>
<p>Python中的虚拟环境具有隔离性，<br>Python的虚拟环境可以使一个Python程序拥有独立的库library和解释器interpreter，<br>而不用与其他Python程序共享统一个library和interpreter，<br>主要应用于解决因为版本问题所引发的冲突问题</p>
<h4 id="virtualenv"><a href="#virtualenv" class="headerlink" title="virtualenv"></a>virtualenv</h4><p><code>pip install virtualenv</code><br>每一次使用都需要进入到虚拟环境目录的Scripts文件夹中<br><code>virtualenv firstenv</code> 创建一个名为firstenv的虚拟环境，在命令的当前目录文件夹会出现一个与刚新建的虚拟环境同名的文件夹，版本和环境变量版本一样<br><code>virtualenv -p C:\\Users\\rose\\AppData\\Local\\Programs\\Python\\Python38 secondenv</code> 创建一个名为firstenv的虚拟环境，在当前目录文件夹会出现一个与刚新建的虚拟环境同名的文件夹，版本和指定版本版本一样</p>
<p><code>activate</code>/<code>deactivate</code> 激活虚拟环境并进入/退出虚拟环境</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> 包名</span><br><span class="line">quit()</span><br></pre></td></tr></tbody></table></figure>


<h4 id="virtualenvwrapper"><a href="#virtualenvwrapper" class="headerlink" title="virtualenvwrapper"></a>virtualenvwrapper</h4><p>以在任意目录下进入已创建的虚拟环境中</p>
<ul>
<li><code>pip install virtualenvwrapper-win</code><br><code>mkvirtualenv secondenv</code> 创建一个名为secondenv的虚拟环境，且自动进入虚拟环境中<br>virtualenvwrapper默认将虚拟环境同一安装到C:\Envs这一目录中</li>
</ul>
<p>怎么virtualenvwrapper将虚拟环境同一安装到我们指定的目录中呢？那就要通过配置系统环境变量来实现了。</p>
<p>win配置环境变量<br>首先新建一个文件夹，专门弄用来存放virtualenvwrapper创建的虚拟环境，例如在D盘新建一个名为<code>virtualenvs</code>的文件夹。然后进行如下配置：<br>环境变量-&gt;新建系统变量，接下来如下图所示，变量名输入<code>WORKON_HOME</code>，变量值输入文件夹路径，即<code>D:\virtualenvs</code>，输入完成后点击确定，保存退出。</p>
<p>linux配置环境变量</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo find / -name virtualenvwrapper.sh</span><br><span class="line">查询结果</span><br><span class="line"></span><br><span class="line">vim ~/.bashrc</span><br><span class="line"><span class="built_in">export</span> WORKON_HOME=.virtualenvs</span><br><span class="line"><span class="built_in">source</span> 查询结果 </span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></tbody></table></figure>

<p><code>mkvirtualenv --python=C:\\Users\\rose\\AppData\\Local\\Programs\\Python\\Python38\\python.exe thirdenv</code><br><code>mkvirtualenv --python=/usr/bin/python fourenv</code><br>创建指定python版本的虚拟环境</p>
<p><code>workon</code> 无论在哪个目录下，列出当前指定的文件路径下的新建的虚拟环境。</p>
<ul>
<li><code>workon 虚拟环境名</code> 进入指定的虚拟环境，关掉之后进入：<br><code>deactivate</code> 退出虚拟环境</li>
<li><code>rmvirtualenv 环境名称</code> 删除虚拟环境：</li>
</ul>
<h3 id="venv-是Python-3-自带的创建虚拟环境的模块，不需要再单独安装-virtualenv"><a href="#venv-是Python-3-自带的创建虚拟环境的模块，不需要再单独安装-virtualenv" class="headerlink" title="venv 是Python 3 自带的创建虚拟环境的模块，不需要再单独安装 virtualenv"></a><code>venv</code> 是Python 3 自带的创建虚拟环境的模块，不需要再单独安装 virtualenv</h3><h3 id="pycharm中也集成了虚拟环境管理功能。"><a href="#pycharm中也集成了虚拟环境管理功能。" class="headerlink" title="pycharm中也集成了虚拟环境管理功能。"></a>pycharm中也集成了虚拟环境管理功能。</h3><p>pycharm新建一个Python项目，并在创建项目时建立虚拟环境：</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/redis/" class="post-title-link" itemprop="url">redis</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-11 05:10:57" itemprop="dateModified" datetime="2021-05-11T05:10:57Z">2021-05-11</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Redis是一种Key-Value存储结构的NoSQL非关系数据库存储服务系统</p>
<h2 id="Redis特性"><a href="#Redis特性" class="headerlink" title="Redis特性"></a>Redis特性</h2><h4 id="速度快"><a href="#速度快" class="headerlink" title="速度快"></a>速度快</h4><ul>
<li>数据存储在<strong>内存</strong>中 （主要原因）</li>
<li>C语言编写（50000行）</li>
<li>单线程模型</li>
</ul>
<h4 id="持久化"><a href="#持久化" class="headerlink" title="持久化"></a>持久化</h4><p>Redis所有数据存储在内存，对数据的更新将异步保存到磁盘上</p>
<h4 id="多种数据结构"><a href="#多种数据结构" class="headerlink" title="多种数据结构"></a>多种数据结构</h4><ul>
<li>字符串（string）</li>
<li>哈希表（hash tables）</li>
<li>列表（lists）</li>
<li>集合（sets）</li>
<li>有序集合（sorted sets/ zset）</li>
<li>位图（BitMaps） 实现过滤器</li>
<li>超小内存唯一值计数（HyperLogLog）</li>
<li>地理信息定位（GEO）</li>
</ul>
<h4 id="支持多种编辑语言"><a href="#支持多种编辑语言" class="headerlink" title="支持多种编辑语言"></a>支持多种编辑语言</h4><h4 id="功能丰富"><a href="#功能丰富" class="headerlink" title="功能丰富"></a>功能丰富</h4><ul>
<li>发布订阅</li>
<li>Lua脚本</li>
<li>事务</li>
<li>pipeline</li>
</ul>
<h4 id="简单"><a href="#简单" class="headerlink" title="简单"></a>简单</h4><ul>
<li>不依赖外部库</li>
<li>单线程模型</li>
</ul>
<h4 id="主从复制"><a href="#主从复制" class="headerlink" title="主从复制"></a>主从复制</h4><p>主服务器数据复制到从服务器上</p>
<h4 id="高可用，分布式"><a href="#高可用，分布式" class="headerlink" title="高可用，分布式"></a>高可用，分布式</h4><p>高可用（Redis-Sentinel(v2.8支持高可用)）<br>分布式（Redis-Cluster(v3.0支持分布式)）</p>
<h3 id="redis的使用场景"><a href="#redis的使用场景" class="headerlink" title="redis的使用场景"></a>redis的使用场景</h3><ul>
<li><p>高速缓存cache</p>
<ul>
<li>10万+的QPS（查询次数/秒），集群可达百万级以上</li>
<li>首页内容缓存优化（门户、新闻等）</li>
<li>秒杀业务、抢购业务、库存控制等</li>
</ul>
</li>
<li><p>计数器<br>实现评论计数、播放量计算等</p>
</li>
<li><p>消息队列系统</p>
</li>
<li><p>排行榜</p>
</li>
<li><p>社交网络<br>粉丝数量、关注数、共同关注、</p>
</li>
<li><p>实时系统</p>
</li>
</ul>
<h3 id="Redis可执行文件说明"><a href="#Redis可执行文件说明" class="headerlink" title="Redis可执行文件说明"></a>Redis可执行文件说明</h3><p>redis-server （redis服务器）<br>redis-cli （redis命令行客户端）<br>redis-benchmark （性能检测工具）<br>redis-check-aof （AOF文件修复工具）<br>redis-check-dump （RDB文件修复工具）<br>redis-sentinel （Sentinel服务器2.8以后）</p>
<h3 id="启动redis"><a href="#启动redis" class="headerlink" title="启动redis"></a>启动redis</h3><ul>
<li><p>最简启动</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>动态参数启动</p>
</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server --port 6379</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>配置文件启动（生产环境选择）<br>单机多实例使用端口区分，一台机器会有多个redis，配置文件用端口来区分</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-0-9-centos redis-6.0.12]<span class="comment"># cd src</span></span><br><span class="line">[root@VM-0-9-centos redis-6.0.12]<span class="comment"># ./src/redis-server redis.conf</span></span><br><span class="line"></span><br><span class="line">[root@VM-0-9-centos redis-6.0.12]<span class="comment"># mv /src/redis-server/redis.conf redis-6380.conf </span></span><br><span class="line">[root@VM-0-9-centos redis-6.0.12]<span class="comment"># redis-server redis-6380.conf </span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; redis-server redis.windows.conf</span><br></pre></td></tr></tbody></table></figure>


<p>可以做一个包含此命令的bat文件，每次双击启动</p>
<p>Redis 命令<br>Redis 命令用于在 redis 服务上执行操作。<br>要在 redis 服务上执行命令需要一个 redis 客户端。Redis 客户端在我们之前下载的的 redis 的安装包中。</p>
<p>Redis 客户端的基本语法为：</p>
<ul>
<li>启动 redis 服务器，连接本地的 redis 服务。连接到<strong>本地</strong>的 redis 服务并执行 PING 命令，<br>加上 –raw避免中文乱码了<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-0-9-centos ~]<span class="comment"># redis-cli --raw</span></span><br><span class="line">127.0.0.1:6379&gt; ping</span><br><span class="line">PONG</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">exit</span></span><br></pre></td></tr></tbody></table></figure>
<code>auth "password"</code>登录才有权限，不能漏掉双引号</li>
</ul>
<p>在远程 redis 服务上执行命令</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ redis-cli -h host -p port -a password</span><br><span class="line">$ redis-cli -h 127.0.0.1 -p 6379 -a <span class="string">"mypass"</span></span><br><span class="line">redis 127.0.0.1:6379&gt; PING</span><br><span class="line">PONG</span><br></pre></td></tr></tbody></table></figure>


<p>验证是否成功启动</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-0-9-centos ~]<span class="comment"># ps -ef | grep redis</span></span><br><span class="line">root      4092  3940  0 11:52 pts/5    00:00:00 grep --color=auto redis</span><br><span class="line">root     21009     1  0 Apr24 ?        00:26:12 ./src/redis-server 127.0.0.1:6379</span><br><span class="line">[root@VM-0-9-centos ~]<span class="comment"># ps -ef | grep redis | grep -v grep</span></span><br></pre></td></tr></tbody></table></figure>
<p>netstat antpl | grep redis 查看端口是否是listen<br>redis-cli ping<br>redis-cli -h ip -p port ping</p>
<h3 id="Redis常用配置"><a href="#Redis常用配置" class="headerlink" title="Redis常用配置"></a>Redis常用配置</h3><p>后台进程</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-0-9-centos redis-6.0.12]<span class="comment"># vim redis.conf</span></span><br></pre></td></tr></tbody></table></figure>
<p>yy复制一行，p粘贴，</p>
<figure class="highlight nginx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># daemonize no 默认</span></span><br><span class="line"><span class="attribute">daemonize</span> <span class="literal">yes</span>  <span class="comment"># 启动的日志</span></span><br></pre></td></tr></tbody></table></figure>
<p>Esc + :wq</p>
<p>port （对外端口号 默认为6379）<br>logfile （系统日志）工作表现、异常<br>dir （工作目录）</p>
<p>redis 没有表 缓存经常被读取的热数据的平台<br>redis里面取出来的数据都是bytes类型的，所以要用decode方法转成字符串</p>
<p>flushdb 清空逻辑表格<br>flushall  清空逻辑库数据</p>
<h4 id="字符串（String）相关操作"><a href="#字符串（String）相关操作" class="headerlink" title="字符串（String）相关操作"></a>字符串（String）相关操作</h4><ul>
<li><code>set</code> – 设置值</li>
<li><code>get</code> – 获取值</li>
<li><code>mset</code> – 设置多个键值对key-value</li>
<li><code>mget</code> – 获取多个键值对key-value</li>
<li><code>append</code> – 在字符串结尾添加字符串内容</li>
<li><code>del</code> – 删除</li>
<li><code>incr</code>/<code>decr</code> – 增加/减少 1<br>incr num 数字自增加1<br>incrby num 25 数字加上指定的整数值<br>incrbyfloat num 2.5 数字加上指定的整数值<br>decr num 数字自增减1<br>decrby num 25 数字减去指定的整数值</li>
</ul>
<pre class=" language-redis"><code class="language-redis">>set email scott@163.com
>get email

>mset a 10 b 20 c 30
>mget a b c email

mset username scott sex male 
mget username sex  

append username 123 在字符串结尾追加内容
</code></pre>
<pre class=" language-redis"><code class="language-redis">> incr count
(integer) 1
> incr count
(integer) 2
> incr count
(integer) 3
> get count
"3"
> incr count
(integer) 4
> incr count
(integer) 5
`


缓存
- 内容变化不频繁
 - 几个小时、几天才变化一次
- 重复性工作
 - 查询数据库
 - 生成响应数据
- 优化一下：不查数据库，缓存内容


getrange email 0 3 获得截取字符串内容
strlen emai 获得字符串长度

setex 设置带有过期时间（秒）的 key-value
setex city 5 Beijing


数据类型
String(字符串)：用来实现
简单的 KV 键值对存储，比如计数器

哈希表 存储彼此相关信息的键值对，用HSET key filed value 来去设置一组相关信息，例如设置用户ID和名字相关联 
HSET name { id: user_name}
hset 8000 ename Tom
hset  8000 job salesman
hmset 9000 ename Scott job salesman deptno 10

hget 8000 ename
hmget 8000 ename job deptno
HGETALL 8000  必须大写

hkeys 8000 获得所有哈希表字段名,key

hlen 8000 获得所有哈希表key数量
hexists 8000 job 判断哈希表是否存在某个key字段名

hvals 9000 获得哈希表素有字段值
hdel 9000 job deptno 删除哈希表的字段

hdel 9000 key1 key2 

HINCRBY 8000 deptno 10让哈希表某个字段加上指定的整数值
HINCRBYfloat 8000 sal 6.6

列表类型：向value 保存序列化的数据，可重复
List(链表)：实现双向链表，比如用户的关注，粉丝列表
rpush list 1 2 3 # 创建并且依次向右边添加
lrange list 0 -1


lpush list2 1 2 3 创建并且依次向右边添加
lrange list2 0 -1 


lpush dname 秘书处   # 在已存在的字段向左边

lset dname 2 销售部 # 第二个位置
lrange dname 0 -1 打印列表第一个元素到最后一个元素
秘书处
技术部
销售部
售后部

llen dname 获得列表长度
lindex 数字 获得列表某个元素
linsert dname before 秘书处 董事会 在某个位置插入元素之前
lpop dname 删除列表最左边的元素
rpop dname 删除列表最右边的元素

rpush employee Scott
rpush employee Jack
rpush employee Scott
lrem employee 1 Scott 删除列表第一个元素
lrem employee 2 Scott 删除列表2个元素

集合类型set 列表中的元素不可以重复 存储不重复元素，比如用户的关注者，没有顺序
SADD EMPNO 8000 
SADD EMPNO 8001 8002
SMEMBERS EMPNO  获得集合所有元素，按照哈希值排序

SCARD EMPNO 获得集合长度
sismember EMPNO 8000 判断是否含有某个元素
srem EMPNO 8001 删除元素，

spop empno 随机删除并返回集合的某个元素
srandmember empno 33 随机返回集合中的3个元素

有序集合Sorted Set 带排序功能的集合，按照元素分数值排序
zadd keyword 0 'JACK' 0 'Miko' 0 'Ashe' 定义有序集合 先写分数值
zincrby keyword 1 'JACK' 
zincrby keyword 5 'Ashe' 
zincrby keyword 3 'Miko' 
zincrby keyword 2 'Mikko'  mikko不存在则新建
zrange keyword 0 -1 获得有序集合的内容（升序）
zrevrange keyword 0 -1 获得有序集合的内容（降序）
zrevrange keyword 0 0 分数值最高的元素
zrangebyscore 获得分数值区间内容的集合内容（升序）
zrangebyscore keyword 0 2
zrangebyscore keyword 0 (2  不包括2
zrangebyscore keyword 2 +inf 正无穷
zrerangebyscore 获得分数值区间内容的集合内容（降序）
zrevrangebyscore keyword 3 0
zrevrangebyscore keyword (3 0   不包括3

zcard keyword 获得有序集合长度
zcount keyword 2 4 查询某个分数值区间的元素数量
zscore keyword 'Ashe' 返回元素的分数值

zrank keyword 'Ashe' 获得元素的升序排名（从0开始）
zrevrank keyword 'Ashe' 获得元素的降序排名（从0开始）
zrevrank keyword 'Ashe'

zrem keyword  'Miko'  'Ashe'  删除有序集合中的元素
zremrangebyrank keyword 0 2  删除排名区间内的元素
zremrangebyscore keyword -inf 2  删除排名区间内的元素

exists employee 判断是否存在某个key
expire employee 5设置过期时间
expireat employee 12设置记录的过期时间(UNIX时间戳)
move keyword 1 记录迁移到其他逻辑库,1号逻辑库
select 1 切换到1号逻辑库
rename employee emp
presistkeyword 移除过期时间 
type keyword 判断value数据类型

为什么要一如线程池
如果程序中经常需要用到线程，频繁的创建和销毁线程会浪费很多硬件资源，所以需要把线程和任务分离开。线程可以反复利用，省去了重复创建的麻烦。
</code></pre>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/replace/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/replace/" class="post-title-link" itemprop="url">replace</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:45" itemprop="dateModified" datetime="2021-04-02T12:24:45Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>主串.replace(‘旧子串’,’新子串’,匹配次数)<br>多种异常字段替换成一种字段</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 原数据</span></span><br><span class="line">data = [<span class="number">123</span>, <span class="number">234</span>, <span class="string">'零'</span>, <span class="string">'None'</span>, <span class="number">8975</span>]</span><br><span class="line"><span class="comment"># 需要替换字段</span></span><br><span class="line">replace = [<span class="string">'零'</span>, <span class="string">'None'</span>]</span><br><span class="line">result = [<span class="number">0</span> <span class="keyword">if</span> i <span class="keyword">in</span> replace <span class="keyword">else</span> i <span class="keyword">for</span> i <span class="keyword">in</span> data]</span><br><span class="line">print(result)</span><br><span class="line"><span class="comment"># [123, 234, 0, 0, 8975]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 多字段替换</span></span><br><span class="line"><span class="comment"># 原数据</span></span><br><span class="line">data = [<span class="number">123</span>, <span class="number">234</span>, <span class="string">'零'</span>, <span class="string">'None'</span>, <span class="number">8975</span>]</span><br><span class="line"><span class="comment"># 需要替换字段</span></span><br><span class="line">replace = {<span class="string">'零'</span>: <span class="number">0</span>, <span class="number">123</span>: <span class="string">'一二三'</span>}</span><br><span class="line">result = [replace[i] <span class="keyword">if</span> i <span class="keyword">in</span> replace <span class="keyword">else</span> i <span class="keyword">for</span> i <span class="keyword">in</span> data]</span><br><span class="line">print(result)</span><br><span class="line"><span class="comment"># ['一二三', 234, 0, 'None', 8975]</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'tea for too'</span>.replace(<span class="string">'too'</span>, <span class="string">'two'</span>))</span><br><span class="line"><span class="comment"># 'tea for two'</span></span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/request-mo-kuai/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/request-mo-kuai/" class="post-title-link" itemprop="url">request模块</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-21 15:08:19" itemprop="dateModified" datetime="2021-05-21T15:08:19Z">2021-05-21</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>urllib 是 Python 标准库中用于网络请求的库。该库有四个模块，分别是urllib.request，urllib.error，urllib.parse，urllib.robotparser。其中urllib.request，urllib.error两个库在爬虫程序中应用比较频繁。urllib一般要先构建get或者post请求，然后再发起请求。</p>
<p>requests模块 基于HTTP请求的模块第三方的Python库，<br>小规模，数据量小，速度不敏感、爬取网页<br>支持HTTP连接保持和连接池，支持使用cookie保持会话，<br>支持文件上传，支持自动确定响应内容的编码，<br>支持国际化的 URL 和 POST 数据自动编码。</p>
<p>requests可以直接构建常用的get和post请求并发起，<br>使用了urllib3，多次请求重复使用一个socket，<br>“connection”:”keep-alive”，说明多次请求使用一个连接，消耗更少的资源</p>
<p>作用：模拟浏览器发送HTTP请求。用于爬虫或接口的测试<br>如何使用：</p>
<ul>
<li><p>指定url</p>
</li>
<li><p>发起请求</p>
</li>
<li><p>获取响应数据</p>
</li>
<li><p>持久化存储</p>
</li>
<li><p><code>requests.request()</code>    构造一个请求，支撑以下各方法的基础方法</p>
</li>
<li><p><code>requests.head()</code>    获取HTML网页头信息的方法，对应于HTTP的HEAD</p>
</li>
<li><p><code>requests.put()</code>    向HTML网页提交PUT请求的方法，对应于HTTP的PUT</p>
</li>
<li><p><code>requests.patch()</code>    向HTML网页提交局部修改请求，对应于HTTP的PATCH</p>
</li>
<li><p><code>requests.delete()</code>    向HTML网页提交删除请求，对应于HTTP的DELETE</p>
</li>
<li><p><code>requests.post()</code>    向HTML网页提交POST请求的方法，对应于HTTP的POST</p>
</li>
<li><p><code>requests.get(url,params=None,**kwarge)</code> 构造一个向服务器请求资源的requests对象，返回一个包含服务器资源的requests对象，获取HTML网页的主要方法，对应于HTTP的GET<br>Requests方法的13个访问控制参数<br>参数名    说明<br><code>url</code>:获取页面的url链接<br><code>params</code>字典或字节序列，作为参数增加到url中<br><code>s</code>：12个控制访问的参数<br><code>data</code>    字典、字节序列或文件对象，作为Request的内容<br><code>json</code>    JSON格式的数据，作为Request的内容<br><code>headers</code>字典、HTTP定制头<br><code>cookies</code>字典或CookieJar，Request中的cookie<br><code>auth</code>    元组，支持HTTP认证功能<br><code>files</code>    字典类型，传输文件<br><code>timeout</code>    设定超时时间，秒为单位<br><code>proxies</code>    字典类型，设定访问代理服务器，可以增加登录认证<br><code>allow_redirects</code>    True/False,默认为True，重定向开关<br><code>stream</code>默认为True，获取内容立即下载开关<br><code>verify</code>默认为True，认证SSL证书开关<br><code>cert</code>    本地SSL证书路径</p>
</li>
</ul>
<p>Request:构造一个向服务器请求资源的Request对象<br>Response：返回一个包含服务器资源的Response对象</p>
<h3 id="Response对象的属性"><a href="#Response对象的属性" class="headerlink" title="Response对象的属性"></a>Response对象的属性</h3><p><code>r.status_code</code>    HTTP请求的返回状态码<br><code>r.text</code>    HTTP响应内容的字符串形式，即 url对应的页面内容<br><code>r.encoding</code>    从HTTP header中猜测的响应内容编码方式，如果header中不存在charset字段，则认为编码为 ISO-8859-1<br><code>r.apparent_encoding</code>    从内容中分析出的响应内容编码方式（备选编码方式）<br><code>r.content</code>    HTTP响应内容的二进制形式</p>
<h3 id="Requests库的异常"><a href="#Requests库的异常" class="headerlink" title="Requests库的异常"></a>Requests库的异常</h3><p><code>requests.ConnectionError</code>    网络连接异常，如DNS查询失败、拒绝连接等<br><code>requests.HTTPError</code>    HTTP错误异常<br><code>requests.URLRequired</code>    URL缺失异常<br><code>requests.TooManyRedirects</code>    超过最大重定向次数，产生重定向异常<br><code>requests.ConnectTimeout</code>    连接远程服务器超时异常<br><code>requests.Timeout</code>    请求URL超时，产生异常</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1 . 组装请求</span></span><br><span class="line">url1 = <span class="string">"http://api.tianapi.com/txapi/aqi/index?key=4dce7e012c6391364928602666813641&amp;area=上海"</span></span><br><span class="line">url2 = <span class="string">"http://api.tianapi.com/txapi/aqi/index"</span></span><br><span class="line">url3 = <span class="string">"http://api.tianapi.com/txapi/aqi/index"</span></span><br><span class="line">params = {<span class="string">"key"</span>: <span class="string">"4dce7e012c6391364928602666813641"</span>, <span class="string">"area"</span>: <span class="string">"上海"</span>}</span><br><span class="line">data = {<span class="string">"key"</span>: <span class="string">"4dce7e012c6391364928602666813641"</span>, <span class="string">"area"</span>: <span class="string">"上海"</span>}</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 发送请求，获取响应</span></span><br><span class="line">res1 = requests.get(url=url1)</span><br><span class="line">res2 = requests.get(url=url2, params=data)</span><br><span class="line">res3 = requests.post(url=url3, data=data)</span><br><span class="line"><span class="comment"># 3. 解析响应</span></span><br><span class="line">print(res1.text)</span><br><span class="line">print(res2.text)</span><br><span class="line">print(res3.text)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">{<span class="attr">"code"</span>:<span class="number">200</span>,<span class="attr">"msg"</span>:<span class="string">"success"</span>,<span class="attr">"newslist"</span>:[{<span class="attr">"area"</span>:<span class="string">"上海"</span>,<span class="attr">"area_code"</span>:<span class="string">"shanghai"</span>,<span class="attr">"so2"</span>:<span class="string">"5"</span>,<span class="attr">"o3"</span>:<span class="string">"36"</span>,<span class="attr">"pm2_5"</span>:<span class="string">"49"</span>,<span class="attr">"primary_pollutant"</span>:<span class="string">"颗粒物(PM2.5)"</span>,<span class="attr">"co"</span>:<span class="string">"0.7"</span>,<span class="attr">"num"</span>:<span class="string">"231"</span>,<span class="attr">"no2"</span>:<span class="string">"71"</span>,<span class="attr">"quality"</span>:<span class="string">"良好"</span>,<span class="attr">"aqi"</span>:<span class="string">"68"</span>,<span class="attr">"pm10"</span>:<span class="string">"57"</span>,<span class="attr">"o3_8h"</span>:<span class="string">"52"</span>,<span class="attr">"time"</span>:<span class="string">"2021-04-27 20:40:10.642"</span>}]}</span><br><span class="line">{<span class="attr">"code"</span>:<span class="number">200</span>,<span class="attr">"msg"</span>:<span class="string">"success"</span>,<span class="attr">"newslist"</span>:[{<span class="attr">"area"</span>:<span class="string">"上海"</span>,<span class="attr">"area_code"</span>:<span class="string">"shanghai"</span>,<span class="attr">"so2"</span>:<span class="string">"5"</span>,<span class="attr">"o3"</span>:<span class="string">"36"</span>,<span class="attr">"pm2_5"</span>:<span class="string">"49"</span>,<span class="attr">"primary_pollutant"</span>:<span class="string">"颗粒物(PM2.5)"</span>,<span class="attr">"co"</span>:<span class="string">"0.7"</span>,<span class="attr">"num"</span>:<span class="string">"231"</span>,<span class="attr">"no2"</span>:<span class="string">"71"</span>,<span class="attr">"quality"</span>:<span class="string">"良好"</span>,<span class="attr">"aqi"</span>:<span class="string">"68"</span>,<span class="attr">"pm10"</span>:<span class="string">"57"</span>,<span class="attr">"o3_8h"</span>:<span class="string">"52"</span>,<span class="attr">"time"</span>:<span class="string">"2021-04-27 20:40:10.642"</span>}]}</span><br><span class="line">{<span class="attr">"code"</span>:<span class="number">200</span>,<span class="attr">"msg"</span>:<span class="string">"success"</span>,<span class="attr">"newslist"</span>:[{<span class="attr">"area"</span>:<span class="string">"上海"</span>,<span class="attr">"area_code"</span>:<span class="string">"shanghai"</span>,<span class="attr">"so2"</span>:<span class="string">"5"</span>,<span class="attr">"o3"</span>:<span class="string">"36"</span>,<span class="attr">"pm2_5"</span>:<span class="string">"49"</span>,<span class="attr">"primary_pollutant"</span>:<span class="string">"颗粒物(PM2.5)"</span>,<span class="attr">"co"</span>:<span class="string">"0.7"</span>,<span class="attr">"num"</span>:<span class="string">"231"</span>,<span class="attr">"no2"</span>:<span class="string">"71"</span>,<span class="attr">"quality"</span>:<span class="string">"良好"</span>,<span class="attr">"aqi"</span>:<span class="string">"68"</span>,<span class="attr">"pm10"</span>:<span class="string">"57"</span>,<span class="attr">"o3_8h"</span>:<span class="string">"52"</span>,<span class="attr">"time"</span>:<span class="string">"2021-04-27 20:40:10.642"</span>}]}</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">r = requests.get(<span class="string">"http://www.baidu.com"</span>)</span><br><span class="line">print(r.status_code)  <span class="comment"># 检测请求网页的状态码</span></span><br><span class="line"><span class="comment"># 输出200</span></span><br><span class="line">r.encoding = <span class="string">'utf-8'</span></span><br><span class="line">print(r.text)</span><br><span class="line"><span class="comment"># 输出网页内容</span></span><br></pre></td></tr></tbody></table></figure>

<p>通用框架</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLText</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(url, timeout=<span class="number">30</span>)</span><br><span class="line">        r.raise_for_status()  <span class="comment"># 如果状态不是200，引发HTTPError异常</span></span><br><span class="line">        r.encoding = r.apparent_encoding  <span class="comment"># 使得返回内容的解码是正确的</span></span><br><span class="line">        <span class="keyword">return</span> r.text</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"产生异常"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    url = <span class="string">"http://www.baidu.com"</span></span><br><span class="line">    print(getHTMLText(url))</span><br></pre></td></tr></tbody></table></figure>

<p>request使用代理<br>很多网站如果发现同一个IP发出的大量请求，就会封禁这样的IP<br>爬虫为了避免被封IP，必须不断地更换IP地址发出请求，这个时候就需要使用代理</p>
<p>requests库有一个代理参数proxies可以指定通过代理服务器发起请求<br>proxies参数是一个字典，里面包含了http和https的代理URL</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># 不使用代理</span></span><br><span class="line">resp = requests.get(<span class="string">'http://httpbin.org/ip'</span>)</span><br><span class="line">print(resp.text)</span><br><span class="line"><span class="comment"># {"origin": "114.93.163.248"}</span></span><br><span class="line"></span><br><span class="line">proxies = {</span><br><span class="line">    <span class="string">'http'</span>: <span class="string">'http://139.227.252.141:8118'</span>,</span><br><span class="line">    <span class="string">'https'</span>: <span class="string">'https://139.227.252.141:8118'</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用代理</span></span><br><span class="line">resp = requests.get(<span class="string">'http://httpbin.org/ip'</span>, proxies=proxies)</span><br><span class="line">print(resp.text)</span><br><span class="line"><span class="comment"># {"origin": "139.227.252.141"}</span></span><br></pre></td></tr></tbody></table></figure>

<p>需求1：爬取搜狗首页的页面数据</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># 第一步：指定url</span></span><br><span class="line">    url = <span class="string">'https://www.sogou.com/'</span></span><br><span class="line">    <span class="comment"># 第二步：发起请求</span></span><br><span class="line">    response = requests.get(url)</span><br><span class="line">    <span class="comment"># 第三步：获取响应数据</span></span><br><span class="line">    page_text = response.text</span><br><span class="line">    <span class="comment"># print(page_text)</span></span><br><span class="line">    <span class="comment"># 第四步：持久化存储</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'./搜狗首页.html'</span>, <span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>)<span class="keyword">as</span> fp:</span><br><span class="line">        fp.write(page_text)</span><br><span class="line">    print(<span class="string">'爬取结束'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>需求2：实现一个简易的网页采集器（爬取搜狗指定词条对应的搜索结果页面）<br>UA伪装：门户网站的服务器会检测载体身份标识，如果检测到是爬虫发起就会拒绝访问，所以需要伪装成正常的浏览器访问身份。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    url = <span class="string">'https://www.sogou.com/web'</span></span><br><span class="line">    <span class="comment"># 处理url携带的参数：封装到字典中</span></span><br><span class="line">    keyWord = input(<span class="string">'请输入关键字：'</span>)</span><br><span class="line">    param = {</span><br><span class="line">        <span class="string">'query'</span>: keyWord</span><br><span class="line">    }</span><br><span class="line">    headers = {</span><br><span class="line">        <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.96 Safari/537.36 Edg/88.0.705.56'</span></span><br><span class="line">    }</span><br><span class="line">    response = requests.get(url=url, params=param, headers=headers)</span><br><span class="line">    page_text = response.text</span><br><span class="line">    filename = <span class="string">'./简易网页采集/'</span> + keyWord + <span class="string">'.html'</span></span><br><span class="line">    <span class="keyword">with</span> open(filename, <span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        fp.write(page_text)</span><br><span class="line">    print(keyWord + <span class="string">'  保存成功！'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>需求3：破解百度翻译<br>注意：响应数据为json类型；请求方式为POST</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    url = <span class="string">'https://fanyi.baidu.com/sug'</span></span><br><span class="line">    keyWord = input(<span class="string">'请输入关键字：'</span>)</span><br><span class="line">    data = {</span><br><span class="line">        <span class="string">'kw'</span>: keyWord</span><br><span class="line">    }</span><br><span class="line">    headers = {</span><br><span class="line">        <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.96 Safari/537.36 Edg/88.0.705.56'</span></span><br><span class="line">    }</span><br><span class="line">    response = requests.post(url=url, data=data, headers=headers)</span><br><span class="line">    page_json = response.json()</span><br><span class="line">    <span class="comment"># print(page_json)</span></span><br><span class="line">    fp = open(<span class="string">'./百度翻译/'</span> + keyWord + <span class="string">".json"</span>, <span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">    json.dump(page_json, fp=fp, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">    print(<span class="string">'翻译结束！已保存'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>需求4：爬取豆瓣电影分类排行榜</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    url = <span class="string">'https://movie.douban.com/j/chart/top_list'</span></span><br><span class="line">    num = input(<span class="string">'请输入前多少名数据:'</span>)</span><br><span class="line">    param = {</span><br><span class="line">        <span class="string">'type'</span>: <span class="string">'11'</span>,</span><br><span class="line">        <span class="string">'interval_id'</span>: <span class="string">'100:90'</span>,</span><br><span class="line">        <span class="string">'action'</span>: <span class="string">''</span>,</span><br><span class="line">        <span class="string">'start'</span>: <span class="string">'0'</span>,</span><br><span class="line">        <span class="string">'limit'</span>: num</span><br><span class="line">    }</span><br><span class="line">    headers = {</span><br><span class="line">        <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.96 Safari/537.36 Edg/88.0.705.56'</span></span><br><span class="line">    }</span><br><span class="line">    response = requests.get(url=url, params=param, headers=headers)</span><br><span class="line">    list_data = response.json()</span><br><span class="line">    fp = open(<span class="string">'./豆瓣排行/豆瓣排行.json'</span>, <span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">    json.dump(list_data, fp=fp, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">    print(<span class="string">'保存完成'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>需求5：肯德基餐厅查询（<a target="_blank" rel="noopener" href="http://www.kfc.com.cn/kfccda/storelist/index.aspx%EF%BC%89">http://www.kfc.com.cn/kfccda/storelist/index.aspx）</a></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    url = <span class="string">'http://www.kfc.com.cn/kfccda/ashx/GetStoreList.ashx'</span></span><br><span class="line">    cname = input(<span class="string">'请输入城市：'</span>)</span><br><span class="line">    keyword = input(<span class="string">'请输入关键字：'</span>)</span><br><span class="line">    op = <span class="string">'keyword'</span></span><br><span class="line">    param = {</span><br><span class="line">        <span class="string">'op'</span>: op</span><br><span class="line">    }</span><br><span class="line">    data = {</span><br><span class="line">        <span class="string">'cname'</span>: cname,</span><br><span class="line">        <span class="string">'pid'</span>: <span class="string">''</span>,</span><br><span class="line">        <span class="string">'keyword'</span>: keyword,</span><br><span class="line">        <span class="string">'pageIndex'</span>: <span class="string">'1'</span>,</span><br><span class="line">        <span class="string">'pageSize'</span>: <span class="string">'10'</span></span><br><span class="line">    }</span><br><span class="line">    headers = {</span><br><span class="line">        <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.96 Safari/537.36 Edg/88.0.705.56'</span></span><br><span class="line">    }</span><br><span class="line">    response = requests.post(url=url, data=data, headers=headers, params=param)</span><br><span class="line">    print(response.json())</span><br><span class="line">    table_data = response.json()</span><br><span class="line">    fp = open(<span class="string">'./肯德基餐厅/'</span>+cname+<span class="string">'_'</span>+keyword+<span class="string">'.json'</span>, <span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">    json.dump(table_data, fp=fp, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">    print(<span class="string">'保存完成'</span>)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">URL_GET = <span class="string">"https://api.douban.com/v2/event/list"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">use_params_requests</span>():</span></span><br><span class="line">    <span class="comment"># 构建请求参数</span></span><br><span class="line">    params = {<span class="string">'loc'</span>: <span class="string">'108288'</span>, <span class="string">'day_type'</span>: <span class="string">'weekend'</span>, <span class="string">'type'</span>: <span class="string">'exhibition'</span>}</span><br><span class="line">    <span class="comment"># 发送请求</span></span><br><span class="line">    response = requests.get(URL_GET, params=params)</span><br><span class="line">    <span class="comment"># 处理响应</span></span><br><span class="line">    print(<span class="string">'&gt;&gt;&gt;&gt;&gt;&gt;Response Headers:'</span>)</span><br><span class="line">    print(response.headers)</span><br><span class="line">    print(<span class="string">'&gt;&gt;&gt;&gt;&gt;&gt;Status Code:'</span>)</span><br><span class="line">    print(response.status_code)</span><br><span class="line">    print(<span class="string">'&gt;&gt;&gt;&gt;&gt;&gt;&gt;Response Body:'</span>)</span><br><span class="line">    print(response.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'Use params requests:'</span>)</span><br><span class="line">    use_params_requests()</span><br></pre></td></tr></tbody></table></figure>

<p>网络图片爬取及存储</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''r.content  #表示返回内容的二进制格式'''</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">new_folder = <span class="string">'./Picture/'</span>  <span class="comment"># 相对路径</span></span><br><span class="line">url = <span class="string">'http://img0.dili360.com/ga/M00/02/AB/wKgBzFQ26i2AWujSAA_-xvEYLbU441.jpg@!rw9'</span></span><br><span class="line">path = new_folder + url.split(<span class="string">'/'</span>)[<span class="number">-1</span>].split(<span class="string">'@'</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(new_folder):</span><br><span class="line">        os.mkdir(new_folder)  <span class="comment"># 创建新目录</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path):</span><br><span class="line"></span><br><span class="line">        r = requests.get(url)</span><br><span class="line">        <span class="comment"># 如何将二进制转化为图片保存</span></span><br><span class="line">        <span class="keyword">with</span> open(path, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="comment"># 新建wKgBzFQ26i2AWujSAA_-xvEYLbU441.jpg</span></span><br><span class="line">            f.write(r.content)</span><br><span class="line">            f.close()</span><br><span class="line">            print(<span class="string">'图片保存成功'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'文件已存在'</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">"爬取失败"</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>百度/360搜索关键字</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#实例3：爬取搜索页面</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    kw = {<span class="string">'wd'</span>: <span class="string">'python'</span>}</span><br><span class="line">    r = requests.get(<span class="string">'https://www.baidu.com/s'</span>, params=kw)</span><br><span class="line">    r.raise_for_status()</span><br><span class="line">    r.encoding = r.apparent_encoding</span><br><span class="line">    print(len(r.text))  <span class="comment"># 227</span></span><br><span class="line">    <span class="comment"># r.request.url  返回的是百度安全验证的链接？</span></span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">"爬取失败"</span>)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    kw = {<span class="string">'q'</span>: <span class="string">'python'</span>}  <span class="comment"># 360搜索的关键字的键为q</span></span><br><span class="line">    r = requests.get(<span class="string">'https://www.so.com/s'</span>, params=kw)</span><br><span class="line">    r.raise_for_status()</span><br><span class="line">    r.encoding = r.apparent_encoding</span><br><span class="line">    print(len(r.text))  <span class="comment">#257468</span></span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">"爬取失败"</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>添加headers和查询参数</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">kw = {<span class="string">'wd'</span>:<span class="string">'python'</span>}</span><br><span class="line">headers = {<span class="string">'User-Agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.101 Safari/537.36'</span>}</span><br><span class="line"></span><br><span class="line"><span class="comment"># params 接收一个字典或者字符串的查询参数，字典类型自动转换为url编码，不需要urlencode()</span></span><br><span class="line">response = requests.get(<span class="string">"http://www.baidu.com/s?"</span>, params = kw, headers = headers)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看响应内容，response.text 返回的是Unicode格式的数据</span></span><br><span class="line"><span class="keyword">print</span> response.text</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看响应内容，response.content返回的字节流数据</span></span><br><span class="line"><span class="keyword">print</span> response.content</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看完整url地址</span></span><br><span class="line"><span class="keyword">print</span> response.url</span><br><span class="line"></span><br><span class="line"><span class="comment"># # 查看响应头部字符编码</span></span><br><span class="line"><span class="keyword">print</span> response.encoding</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看响应码</span></span><br><span class="line"><span class="keyword">print</span> response.status_code</span><br></pre></td></tr></tbody></table></figure>

<p>使用代理</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">headers = {<span class="string">'User-Agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.101 Safari/537.36'</span>}</span><br><span class="line"><span class="comment"># 根据协议类型，选择不同的代理</span></span><br><span class="line">proxies = {</span><br><span class="line">  <span class="string">"http"</span>: <span class="string">"http://119.28.152.208:80"</span>,</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">response = requests.get(<span class="string">"http://www.baidu.com/"</span>, proxies = proxies,headers=headers)</span><br><span class="line"><span class="keyword">print</span> response.text</span><br></pre></td></tr></tbody></table></figure>

<p>私密代理验证</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">headers = {<span class="string">'User-Agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.101 Safari/537.36'</span>}</span><br><span class="line"></span><br><span class="line">proxy = { <span class="string">"http"</span>: <span class="string">"name:pwd@ip:port"</span> }</span><br><span class="line"></span><br><span class="line">response = requests.get(<span class="string">"http://www.baidu.com/"</span>, proxies = proxy,headers=headers)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> response.text</span><br></pre></td></tr></tbody></table></figure>

<p>web客户端验证</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">auth=(<span class="string">'test'</span>, <span class="string">'123456'</span>)</span><br><span class="line"></span><br><span class="line">response = requests.get(<span class="string">'http://192.168.xxx.xx'</span>, auth = auth)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> response.text</span><br></pre></td></tr></tbody></table></figure>

<p>session</p>
<p>在 requests 里，session对象是一个非常常用的对象，这个对象代表一次用户会话：从客户端浏览器连接服务器开始，到客户端浏览器与服务器断开。</p>
<p>会话能让我们在跨请求时候保持某些参数，比如在同一个 Session 实例发出的所有请求之间保持 cookie 。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _*_ coding:utf-8 _*_</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 创建session对象，可以保存Cookie值</span></span><br><span class="line">ssion = requests.session()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 处理 headers</span></span><br><span class="line">headers = {<span class="string">'User-Agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.101 Safari/537.36'</span>}</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 需要登录的用户名和密码</span></span><br><span class="line">data = {<span class="string">"email"</span>:<span class="string">"158xxxxxxxx"</span>, <span class="string">"password"</span>:<span class="string">"pythonxxxxxxx"</span>}</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 发送附带用户名和密码的请求，并获取登录后的Cookie值，保存在ssion里</span></span><br><span class="line">ssion.post(<span class="string">"http://www.renren.com/PLogin.do"</span>, data = data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. ssion包含用户登录后的Cookie值，可以直接访问那些登录后才可以访问的页面</span></span><br><span class="line">response = ssion.get(<span class="string">"http://zhibo.renren.com/news/108"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 打印响应内容</span></span><br><span class="line"><span class="keyword">print</span> response.text</span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/12/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><span class="space">&hellip;</span><a class="page-number" href="/page/25/">25</a><a class="extend next" rel="next" href="/page/14/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>
<script src="/js/comments.js"></script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">外心人D</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
