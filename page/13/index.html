<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<meta name="hexo-config" content="{&quot;hostname&quot;:&quot;bubbleboy11.github.io&quot;,&quot;root&quot;:&quot;/&quot;,&quot;images&quot;:&quot;/images&quot;,&quot;scheme&quot;:&quot;Muse&quot;,&quot;version&quot;:&quot;8.3.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:true,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:false,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;}}">
<meta name="description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:type" content="website">
<meta property="og:title" content="外心人D的博客">
<meta property="og:url" content="https://bubbleboy11.github.io/page/13/index.html">
<meta property="og:site_name" content="外心人D的博客">
<meta property="og:description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="外心人D">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://bubbleboy11.github.io/page/13/">



<meta name="hexo-config-page" content="{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:true,&quot;isPost&quot;:false,&quot;lang&quot;:&quot;zh-CN&quot;}">
<meta name="hexo-config-calendar" content="">
<script data-pjax src="/js/load-config.js"></script>
  <title>外心人D的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="外心人D的博客" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">外心人D的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">外心人D</p>
  <div class="site-description" itemprop="description">本博客大多内容为慕课和网上博客，并非原创</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">275</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">40</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/docker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/docker/" class="post-title-link" itemprop="url">docker</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-06-07 03:06:01" itemprop="dateModified" datetime="2021-06-07T03:06:01Z">2021-06-07</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Docker<br>Docker是一个容器化的平台，他将应用程序和所需要的依赖打包在一个容器里面，在其他的环境下 ，拿上镜像就可以运行，<br>学习docker就是，学习在docker中安装依赖和将项目部署到docker中。</p>
<p>Docker架构是什么<br>Docker deamon  ： docker的守护进程<br>Client  ：         docker的客户端<br>Images ：   docker的镜像<br>Container   ：  docker的容器<br>Registry：      docker的仓库</p>
<p>linux安装</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun</span><br></pre></td></tr></tbody></table></figure>


<p>设置开机启动docker</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> docker</span><br><span class="line">[root@VM-0-9-centos ~]<span class="comment"># systemctl start docker</span></span><br><span class="line">[root@VM-0-9-centos ~]<span class="comment"># ps -ef |grep docker</span></span><br><span class="line">root      3699     1  2 23:17 ?        00:00:00 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock</span><br><span class="line">root      3840  1544  0 23:17 pts/5    00:00:00 grep --color=auto docker</span><br><span class="line">[root@VM-0-9-centos ~]<span class="comment"># docker ps -a</span></span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br></pre></td></tr></tbody></table></figure>

<p>docker ps [options]  查看docker容器进程信息：</p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/document/product/1207/45596">使用腾讯云 Docker 镜像源加速镜像下载</a></p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -L https://get.daocloud.io/docker/compose/releases/download/1.29.2/docker-compose-`uname -s`-`uname -m` &gt; /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line">chmod +x /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line">[root@VM-0-9-centos ~]<span class="comment"># docker-compose -v</span></span><br><span class="line">docker-compose version 1.29.2, build 5becea4c</span><br></pre></td></tr></tbody></table></figure>

<p>如果本机linux的mysql启动会占用3306，先关掉，才能启动docker mysql</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-0-9-centos ~]<span class="comment"># netstat -tanlp</span></span><br><span class="line">    ESTABLISHED 1097/YDService      </span><br><span class="line">tcp6       0      0 :::33060                :::*                    LISTEN      25791/mysqld        </span><br><span class="line">tcp6       0      0 :::3306                 :::*                    LISTEN      25791/mysqld        </span><br><span class="line">[root@VM-0-9-centos ~]<span class="comment"># kill 25791</span></span><br><span class="line">[root@VM-0-9-centos ~]<span class="comment"># netstat -tanlp</span></span><br><span class="line">[root@VM-0-9-centos ~]<span class="comment"># docker run -p 3306:3306 --name mymysql -v $PWD/conf:/etc/mysql/conf.d -v $PWD/logs:/logs -v $PWD/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7</span></span><br><span class="line">a7df53a51485060228adcf9b7b307f1c63aa1f6de8266ee798b3b3a376af0fc6</span><br><span class="line">[root@VM-0-9-centos ~]<span class="comment"># docker ps -aCONTAINER ID   IMAGE       COMMAND                  CREATED          STATUS          PORTS                                                  NAMES</span></span><br><span class="line">a7df53a51485   mysql:5.7   <span class="string">"docker-entrypoint.s…"</span>   35 seconds ago   Up 35 seconds   0.0.0.0:3306-&gt;3306/tcp, :::3306-&gt;3306/tcp, 33060/tcp   mymysql</span><br></pre></td></tr></tbody></table></figure>

<p>-p 3306:3306：将容器的 3306 端口映射到主机的 3306 端口。</p>
<p>-v -v $PWD/conf:/etc/mysql/conf.d：将主机当前目录下的 conf/my.cnf 挂载到容器的 /etc/mysql/my.cnf。</p>
<p>-v $PWD/logs:/logs：将主机当前目录下的 logs 目录挂载到容器的 /logs。</p>
<p>-v $PWD/data:/var/lib/mysql ：将主机当前目录下的data目录挂载到容器的 /var/lib/mysql 。</p>
<p>-e MYSQL_ROOT_PASSWORD=123456：初始化 root 用户的密码。</p>
<h3 id="容器配置"><a href="#容器配置" class="headerlink" title="容器配置"></a>容器配置</h3><p>由于mysql的安全策略，现在还不能使用root/123456来访问数据库</p>
<ol>
<li>进入容器<br>通过<code>docker ps -a</code>来查看mysql的容器id，status 为 up</li>
</ol>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it a7df53a51485 /bin/bash</span><br></pre></td></tr></tbody></table></figure>
<p> 进入mysql</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p123456</span><br></pre></td></tr></tbody></table></figure>

<p>建立用户并授权</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GRANT ALL PRIVILEGES ON *.* TO <span class="string">'root'</span>@<span class="string">'%'</span> IDENTIFIED BY <span class="string">'root'</span> WITH GRANT OPTION;</span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO <span class="string">'root'</span>@<span class="string">'127.0.0.1'</span> IDENTIFIED BY <span class="string">'root'</span> WITH GRANT OPTION;</span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO <span class="string">'root'</span>@<span class="string">'localhost'</span> IDENTIFIED BY <span class="string">'root'</span> WITH GRANT OPTION;</span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></tbody></table></figure>

<p>密码为root</p>
<p>Docker镜像的常用的命令：<br>docker images：  列出已经下载的镜像<br>docker  search 镜像名字：tag     ：  搜索这个镜像<br>docker  pull  镜像名称:tag        拉取镜像<br>docker  rmi   镜像名称:tag         删除镜像<br>docker 容器常用的命令：<br>创建容器<br>docker create -p 3306:3306 –name suiyi -e MYSQL_ROOT_PASSWORD=smallming mysql:5.7<br>新建并且启动<br>docker run -p 3306:3306 –name mysql -e MYSQL_ROOT_PASSWORD=root -d mysql:5.7 </p>
<p>列出正在运行的容器： docker container ls</p>
<p>docker exec [options] 容器ID [command]<br>docker exec -it mysql /bin/bash<br>5    停止容器<br>docker stop 容器ID<br>docker stop mysql<br>6    启动容器<br>docker start 容器ID<br>docker start mysql<br>7    强制停止容器<br>不推荐使用，容易造成容器服务不正常关闭，影响后续使用。<br>docker kill 容器ID<br>docker kill mysql<br>8    删除容器<br>要删除的容器，必须是关闭状态的。<br>docker rm 容器ID<br>docker rm mysql<br>9    查看容器日志<br>docker logs -f -t –tail 行数 容器ID<br>docker logs -f -t –tail 5 mysql<br>10    查看容器中运行的进程<br>可以知道容器中到底运行的是哪个应用程序。<br>docker top 容器ID<br>docker top mysql<br>11    查看容器内部详情<br>docker inspect 容器ID<br>docker inspect mysql<br>12    复制容器数据到宿主机<br>docker cp 容器ID:容器内路径 宿主机路径<br>复制MySQL配置到宿主机：  docker cp mysql:/etc/mysql ~/tmp/conf    </p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/doctest-mo-kuai/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/doctest-mo-kuai/" class="post-title-link" itemprop="url">doctest模块</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-14 07:34:57" itemprop="dateModified" datetime="2021-04-14T07:34:57Z">2021-04-14</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>doctest模块<br>扫描模块并根据程序中内嵌的文档字符串执行测试。<br>测试构造如同简单的将它的输出结果剪切并粘贴到文档字符串中。</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```doctest.test_mod```函数从一个模块中读取所有文档字符串，找出所有看起来像是在交互式解释器中输入的例子的文本，之后检查例子是否符合实际要求。</span><br><span class="line">在python代码中寻找类似交互解释器里执行的命令，执行它们并且和这些命令的期望值进行比较。通过用户提供的例子，它强化了文档，允许 doctest 模块确认代码的结果是否与文档一致:</span><br><span class="line">用来验证docstring中的注释和代码实际的作用是一致的</span><br><span class="line">可以作为回归测试来验证代码能够正确执行</span><br><span class="line">可以用来编写模块的文档演示这些模块是如何处理输入得到输出的。</span><br><span class="line"></span><br><span class="line">一般写在函数的docstring里面，较为标准的文档字符串格式，</span><br><span class="line">用```&gt;&gt;&gt;```表示一个用例的开始，&gt;&gt;&gt;后有一个空格，直到遇到```空行```或者下一个```&gt;&gt;&gt;```</span><br><span class="line">```’’’```后的英文文档后有一个空行。</span><br><span class="line"></span><br><span class="line">使用```#doctest: +ELLIPSIS（中文含义省略）```来表示下面的省略号匹配任意内容</span><br><span class="line"></span><br><span class="line">```python sample.py```只打印出错的用例结果</span><br><span class="line">```python sample.py -v``` 将会打印所有测试用例的结果。</span><br><span class="line">pychamr右键 run doctest</span><br><span class="line"></span><br><span class="line">定义如下函数代码square，求一个数的平方，并且在它的文档字符串中添加两个例子，文件名为my_math.py</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line"># my_math.py</span><br><span class="line">import doctest</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def square(x):</span><br><span class="line">    '''</span><br><span class="line">    Squares a number and returns the result</span><br><span class="line">    </span><br><span class="line">    &gt;&gt;&gt; square(2)</span><br><span class="line">    4</span><br><span class="line">    &gt;&gt;&gt; square(3)</span><br><span class="line">    9</span><br><span class="line">    '''</span><br><span class="line">    return x * x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == '__main__':</span><br><span class="line">    import my_math</span><br><span class="line">    doctest.testmod(my_math)</span><br></pre></td></tr></tbody></table></figure>

<p>在 win或 Linux终端命令行中运行查看测试结果。</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@centos ~]# python my_math.py</span><br><span class="line"><span class="meta">#</span><span class="bash"> 没反应，因为符合预期结果，默认只打印出错的用例结果</span></span><br><span class="line">[root@centos ~]# python my_math.py -v</span><br><span class="line">Trying:</span><br><span class="line">    square(2)</span><br><span class="line">Expecting:</span><br><span class="line">    4</span><br><span class="line">ok</span><br><span class="line">Trying:</span><br><span class="line">    square(3)</span><br><span class="line">Expecting:</span><br><span class="line">    9</span><br><span class="line">ok</span><br><span class="line">1 items had no tests:</span><br><span class="line">    my_math</span><br><span class="line">1 items passed all tests:</span><br><span class="line">   2 tests in my_math.square</span><br><span class="line">2 tests in 2 items.</span><br><span class="line">2 passed and 0 failed.</span><br><span class="line">Test passed.</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@centos ~]<span class="comment"># python my_math.py</span></span><br><span class="line">**********************************************************************</span><br><span class="line">File <span class="string">"my_math.py"</span>, line 9, <span class="keyword">in</span> __main__.average</span><br><span class="line">Failed example:</span><br><span class="line">    <span class="built_in">print</span>(average([20, 30, 70]))</span><br><span class="line">Expected:</span><br><span class="line">    50.0</span><br><span class="line">Got:</span><br><span class="line">    40.0</span><br><span class="line">**********************************************************************</span><br><span class="line">1 items had failures:</span><br><span class="line">   1 of   2 <span class="keyword">in</span> __main__.average</span><br><span class="line">***Test Failed*** 1 failures.</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@centos ~]<span class="comment"># python my_math.py -v</span></span><br><span class="line">Trying:</span><br><span class="line">    <span class="built_in">print</span>(average([20, 30, 70]))</span><br><span class="line">Expecting:</span><br><span class="line">    40.0</span><br><span class="line">ok</span><br><span class="line">Trying:</span><br><span class="line">    <span class="built_in">print</span>(average([20, 30, 70]))</span><br><span class="line">Expecting:</span><br><span class="line">    50.0</span><br><span class="line">**********************************************************************</span><br><span class="line">File <span class="string">"my_math.py"</span>, line 9, <span class="keyword">in</span> __main__.average</span><br><span class="line">Failed example:</span><br><span class="line">    <span class="built_in">print</span>(average([20, 30, 70]))</span><br><span class="line">Expected:</span><br><span class="line">    50.0</span><br><span class="line">Got:</span><br><span class="line">    40.0</span><br><span class="line">1 items had no tests:</span><br><span class="line">    __main__</span><br><span class="line">**********************************************************************</span><br><span class="line">1 items had failures:</span><br><span class="line">   1 of   2 <span class="keyword">in</span> __main__.average</span><br><span class="line">2 tests <span class="keyword">in</span> 2 items.</span><br><span class="line">1 passed and 1 failed.</span><br><span class="line">***Test Failed*** 1 failures.</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    <span class="string">""" add two number or string</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; add(1, 2)</span></span><br><span class="line"><span class="string">    3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; add("hello", " world")</span></span><br><span class="line"><span class="string">    'hello world'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; add(1, 2.0)</span></span><br><span class="line"><span class="string">    3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; add("hello", " python")  # doctest: +ELLIPSIS</span></span><br><span class="line"><span class="string">    'hello ...'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">return</span> x+y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">import</span> doctest</span><br><span class="line">    doctest.testmod()</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight markdown"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[root@centos ~]# python my<span class="emphasis">_math.py -v</span></span><br><span class="line"><span class="emphasis">Trying:</span></span><br><span class="line"><span class="emphasis">    add(1, 2)</span></span><br><span class="line"><span class="emphasis">Expecting:</span></span><br><span class="line"><span class="emphasis">    3</span></span><br><span class="line"><span class="emphasis">ok</span></span><br><span class="line"><span class="emphasis">Trying:</span></span><br><span class="line"><span class="emphasis">    add("hello", " world")</span></span><br><span class="line"><span class="emphasis">Expecting:</span></span><br><span class="line"><span class="emphasis">    'hello world'</span></span><br><span class="line"><span class="emphasis">ok</span></span><br><span class="line"><span class="emphasis">Trying:</span></span><br><span class="line"><span class="emphasis">    add(1, 2.0)</span></span><br><span class="line"><span class="emphasis">Expecting:</span></span><br><span class="line"><span class="emphasis">    3</span></span><br><span class="line"><span class="emphasis"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">**</span></span></span><br><span class="line"><span class="emphasis"><span class="strong">File "my<span class="emphasis">_math.py", line 9, in <span class="strong">__main__</span>.add  </span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis">Failed example:</span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis">    add(1, 2.0)</span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis">Expected:</span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis">    3</span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis">Got:</span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis">    3.0</span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis">Trying:</span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis">    add("hello", " python")  # doctest: +ELLIPSIS</span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis">Expecting:</span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis">    'hello ...'</span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis">ok</span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis">1 items had no tests:</span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis">    <span class="strong">__main__</span></span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">**</span></span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis"><span class="strong">1 items had failures:</span></span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis"><span class="strong">   1 of   4 in _<span class="emphasis">_main<span class="strong">__.add</span></span></span></span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis"><span class="strong"><span class="emphasis"><span class="strong">4 tests in 2 items.</span></span></span></span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis"><span class="strong"><span class="emphasis"><span class="strong">3 passed and 1 failed.</span></span></span></span></span></span></span><br><span class="line"><span class="emphasis"><span class="strong"><span class="emphasis"><span class="strong"><span class="emphasis"><span class="strong">**<span class="emphasis">*Test Failed<span class="strong">**<span class="emphasis">* 1 failures.</span></span></span></span></span></span></span></span></span></span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/drf-ren-zheng-he-quan-xian/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/drf-ren-zheng-he-quan-xian/" class="post-title-link" itemprop="url">drf认证和权限</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-06-12 04:46:05" itemprop="dateModified" datetime="2021-06-12T04:46:05Z">2021-06-12</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/django/" itemprop="url" rel="index"><span itemprop="name">django</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="drf认证"><a href="#drf认证" class="headerlink" title="drf认证"></a>drf认证</h2><p>认证:<br>认证可以简单的理解为登录和访问需要登录的接口的认证。<br>只要认证通过了,那么在 request对象(是drf的 request对象)上便有两个属性,<br>一个是 <code>request.user</code>,一个是 <code>request,auth</code>,前者就<br>是 django中的User对象,后者根据不同的认证机制有不同的对象,</p>
<p>DRF的token登录原理<br>基于DRF的前后端分离登录与单独使用Django登录的原理不同，不再需要CSRF验证，<br>DRF提供了许多开箱即用的身份验证方案，并且还允许实现自定义方案。<br>身份验证始终在视图的最开始处，在进行权限和限制检查之前以及在允许任何其他代码进行之前运行。<br>身份验证方案始终定义为类列表，依赖的是<code>django.contrib</code>的<code>auth</code>，<br>对列表的多个内置认证类，drf会按照从上到下的顺序对对列表中的每个类进行身份认证验证，<br>并使用第一个成功通过的验证类的返回值来设置<code>request.user</code>和<code>request.auth</code></p>
<p><code>setting.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DRF 全局配置</span></span><br><span class="line">REST_FRAMEWORK = {</span><br><span class="line">    <span class="comment"># 配置默认认证类 authentication: 对用户登录的身份进行校验</span></span><br><span class="line">    <span class="string">"DEFAULT_AUTHENTICATION_CLASSES"</span>: [</span><br><span class="line">        <span class="comment"># 弹出输入用户名密码</span></span><br><span class="line">        <span class="string">"rest_framework.authentication.BasicAuthentication"</span>,</span><br><span class="line">        <span class="string">"rest_framework.authentication.SessionAuthentication"</span>  <span class="comment"># Session用于方便在DRF中调试使用</span></span><br><span class="line">        <span class="comment"># 'rest_framework.authentication.TokenAuthentication',  # TokenAuthentication，取消全局token，放在视图中进行</span></span><br><span class="line">        <span class="comment"># 'rest_framework_simplejwt.authentication.JWTAuthentication',  # djangorestframework_simplejwt 认证 用于前端登录认证</span></span><br><span class="line">    ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MIDDLEWARE = [</span><br><span class="line">    <span class="string">'django.contrib.sessions.middleware.SessionMiddleware'</span>,</span><br><span class="line">    <span class="string">'django.contrib.auth.middleware.AuthenticationMiddleware'</span>,</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

<p>每当一个request进来的时候，上面代码会将request里面的cookie里面的session id转换成request.user</p>
<p>DRF提供4种认证类，包括</p>
<ul>
<li><code>BasicAuthentication</code>是通过base64对用户名和密码加密成字符串，<br>使用HTTP基本身份验证，该身份针对用户的用户名和密码进行了签名，但是易破解<br>在实际开发中一般仅适用于测试环境而不是生成环境<br>认证成功会把<code>request.user</code>设置<code>User</code>类的实例，<code>request.auth</code>设置为<code>None</code>，失败会在header添加www-Authentication</li>
</ul>
<p>源码</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_authorization_header</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Return request's 'Authorization:' header, as a bytestring.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Hide some test client ickyness where the header can be unicode.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    auth = request.META.get(<span class="string">'HTTP_AUTHORIZATION'</span>, <span class="string">b''</span>)</span><br><span class="line">    <span class="keyword">if</span> isinstance(auth, str):</span><br><span class="line">        <span class="comment"># Work around django test client oddness</span></span><br><span class="line">        auth = auth.encode(HTTP_HEADER_ENCODING)</span><br><span class="line">    <span class="keyword">return</span> auth</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BasicAuthentication</span>(<span class="params">BaseAuthentication</span>):</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    HTTP Basic authentication against username/password.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    www_authenticate_realm = <span class="string">'api'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">authenticate</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Returns a `User` if a correct username and password have been supplied</span></span><br><span class="line"><span class="string">        using HTTP Basic authentication.  Otherwise returns `None`.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        auth = get_authorization_header(request).split()</span><br><span class="line">        <span class="comment"># ['Basic', 'YWRtaW46YWRtaW4xMjM0NTY=']类似这样的格式</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> auth <span class="keyword">or</span> auth[<span class="number">0</span>].lower() != <span class="string">b'basic'</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> len(auth) == <span class="number">1</span>:</span><br><span class="line">            msg = _(<span class="string">'Invalid basic header. No credentials provided.'</span>)</span><br><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(msg)</span><br><span class="line">        <span class="keyword">elif</span> len(auth) &gt; <span class="number">2</span>:</span><br><span class="line">            msg = _(<span class="string">'Invalid basic header. Credentials string should not contain spaces.'</span>)</span><br><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(msg)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                auth_decoded = base64.b64decode(auth[<span class="number">1</span>]).decode(<span class="string">'utf-8'</span>)</span><br><span class="line">            <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">                auth_decoded = base64.b64decode(auth[<span class="number">1</span>]).decode(<span class="string">'latin-1'</span>)</span><br><span class="line">            auth_parts = auth_decoded.partition(<span class="string">':'</span>)</span><br><span class="line">            <span class="comment"># ('admin', ':', 'admin123456')`</span></span><br><span class="line">        <span class="keyword">except</span> (TypeError, UnicodeDecodeError, binascii.Error):</span><br><span class="line">            msg = _(<span class="string">'Invalid basic header. Credentials not correctly base64 encoded.'</span>)</span><br><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(msg)</span><br><span class="line"></span><br><span class="line">        userid, password = auth_parts[<span class="number">0</span>], auth_parts[<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">return</span> self.authenticate_credentials(userid, password, request)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">authenticate_credentials</span>(<span class="params">self, userid, password, request=None</span>):</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Authenticate the userid and password against username and password</span></span><br><span class="line"><span class="string">        with optional request for context.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        credentials = {</span><br><span class="line">            get_user_model().USERNAME_FIELD: userid,</span><br><span class="line">            <span class="string">'password'</span>: password</span><br><span class="line">        }</span><br><span class="line">        <span class="comment"># 调用 django 的 authenticate</span></span><br><span class="line">        user = authenticate(request=request, **credentials)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> user <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(_(<span class="string">'Invalid username/password.'</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> user.is_active:</span><br><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(_(<span class="string">'User inactive or deleted.'</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (user, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">authenticate_header</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Basic realm="%s"'</span> % self.www_authenticate_realm</span><br></pre></td></tr></tbody></table></figure>

<p><code>request.META</code> 是一个 Python 字典， 包含了所有本次 HTTP 请求的 Header 信息， 比如用户认证、 IP 地址和用户 Agent（通常是浏览器的名称和版本号） 等。<br><code>HTTP_AUTHORIZATION</code> 用于获取 <code>HTTP authorization</code>。如果为空，将得到一个空的bytes对象。<br>当客户端传输的认证数据为:admin/admin123456,这里得到的数据是:<br><code>Basic YWRtaW46YWRtaW4xMjM0NTY=</code><br>通过 <code>split()</code>方法将通过空格其拆分成 <code>list</code>。 拆分后的数据是这样的： <code>['Basic', 'YWRtaW46YWRtaW4xMjM0NTY=']</code><br><code>auth_parts = base64.b64decode(auth[1]).decode('iso-8859-1').partition(':')</code><br>取出 list 中的加密串， 通过 base64 对加密串进行解码。 通过<code>decode()</code>方法以UTF-8编码对字符串进行解码。<code>partition()</code>方法以冒号<code>":"</code>为分隔符对字符串进行分割,得到的数据是： <code>('admin', ':', 'admin123456')</code><br>执行到这一行， 如果获取不到 Auth 信息， 将会抛 <code>(TypeError, UnicodeDecodeError, binascii.Error)</code> 异常， 通过 <code>try...except..</code>.进行异常捕捉， 如<br>果捕捉到异常将返回<code>AuthenticationFailed</code> 。<br><code>userid, password = auth_parts[0], auth_parts[2]</code><br>最后， 取出元组中对应的用户 id 和密码。 最终于数据： admin admin123456<br>再接来的处理过程我们就很熟悉了。 调用 Django 的认证模块， 对得到 Auth 信息进行认证。<br><code>return (user, None)</code>认证成功返回<code>user</code>，认证失败返回<code>None</code></p>
<p>自定义用户认证功能需要继承重写<code>authenticate</code>在视图接口中调用刚开发的用户认证功能。</p>
<ul>
<li><p><code>SessionAuthentication</code>依赖django的会话，通常在前端js里面使用http ajax请求的时候用，需要给后端提供CSRF令牌<br>认证成功会把<code>request.user</code>设置<code>User</code>类的实例，<code>request.auth</code>设置为<code>None</code>，失败会返回403 forbidden。常见于浏览器，因为浏览器可以自动设置cookie，并将session和cookie传到浏览器，在后端分离项目中较少见；</p>
</li>
<li><p><code>TokenAuthentication</code>身份验证方案使用基于令牌的简单HTTP身份验证方案，适用于客户端-服务器设置，例如本地台式机和移动客户端，适用于前后端分离项目，也是本项目中身份验证的重点；<br>缺点</p>
</li>
<li><p>请求服务器生成的token只存在于一台被请求的服务器中，如果是分布式系统，为了数据一致，则需要将该服务器的数据同步到其他服务器，增加了操作和维护难度；</p>
</li>
<li><p>token没有过期时间，一旦登求完成后，这个 token是水久有效的,这是不安全的<br>基于 token的认证机制。只要登完成后便会返回一个 token,以后请求一些需要登录的api,就通<br>过传递这个 token就可以了,并且这个 token是存储在服务器的数据库中的</p>
</li>
</ul>
<p>成功，<code>request.user</code> 是一个<code>User</code>类的实例，<code>request.auth</code> 是一个 <code>rest_framework.authtoken.models.Token</code> 实例。<br>未经身份验证的响应被拒绝将导致 HTTP 401 Unauthorized 的响应和相应的 WWW-Authenticate header。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TokenAuthentication</span>(<span class="params">BaseAuthentication</span>):</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Simple token based authentication.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Clients should authenticate by passing the token key in the "Authorization"</span></span><br><span class="line"><span class="string">    HTTP header, prepended with the string "Token ".  For example:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Authorization: Token 401f7ac837da42b97f613d789819ff93537bee6a</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    keyword = <span class="string">'Token'</span></span><br><span class="line">    model = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_model</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.model <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> self.model</span><br><span class="line">        <span class="keyword">from</span> rest_framework.authtoken.models <span class="keyword">import</span> Token</span><br><span class="line">        <span class="keyword">return</span> Token</span><br><span class="line"></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    A custom token model may be used, but must have the following properties.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    * key -- The string identifying the token</span></span><br><span class="line"><span class="string">    * user -- The user to which the token belongs</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">authenticate</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        auth = get_authorization_header(request).split()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> auth <span class="keyword">or</span> auth[<span class="number">0</span>].lower() != self.keyword.lower().encode():</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> len(auth) == <span class="number">1</span>:</span><br><span class="line">            msg = _(<span class="string">'Invalid token header. No credentials provided.'</span>)</span><br><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(msg)</span><br><span class="line">        <span class="keyword">elif</span> len(auth) &gt; <span class="number">2</span>:</span><br><span class="line">            msg = _(<span class="string">'Invalid token header. Token string should not contain spaces.'</span>)</span><br><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(msg)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            token = auth[<span class="number">1</span>].decode()</span><br><span class="line">        <span class="keyword">except</span> UnicodeError:</span><br><span class="line">            msg = _(<span class="string">'Invalid token header. Token string should not contain invalid characters.'</span>)</span><br><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(msg)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.authenticate_credentials(token)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">authenticate_credentials</span>(<span class="params">self, key</span>):</span></span><br><span class="line">        model = self.get_model()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            token = model.objects.select_related(<span class="string">'user'</span>).get(key=key)</span><br><span class="line">        <span class="keyword">except</span> model.DoesNotExist:</span><br><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(_(<span class="string">'Invalid token.'</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> token.user.is_active:</span><br><span class="line">            <span class="keyword">raise</span> exceptions.AuthenticationFailed(_(<span class="string">'User inactive or deleted.'</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (token.user, token)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">authenticate_header</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.keyword</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><code>RemoteUserAuthentication</code> 通过此身份验证方案，可以将身份验证委派给Web服务器，要求服务器设置REMOTE_USER环境变量。</li>
</ul>
<h3 id="drf生成Token"><a href="#drf生成Token" class="headerlink" title="drf生成Token"></a>drf生成Token</h3><p><code>setting.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">"rest_framework.authtoken"</span>,  <span class="comment"># DRF自带的token认证</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># DRF 全局配置</span></span><br><span class="line">REST_FRAMEWORK = {</span><br><span class="line">    <span class="comment"># 配置默认认证类 authentication: 对用户登录的身份进行校验</span></span><br><span class="line">    <span class="string">"DEFAULT_AUTHENTICATION_CLASSES"</span>: [</span><br><span class="line">        <span class="string">"rest_framework.authentication.TokenAuthentication"</span>,</span><br><span class="line">    ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 或者pycharm Tools - Run manage.py Task</span></span><br><span class="line">migrations</span><br><span class="line">migrate</span><br></pre></td></tr></tbody></table></figure>
<p>生成数据表<code>authtoken_token</code>，这个表和用户表是一一对应的。<br><code>user_id</code>是一个外键，指向<code>users_userprofile</code>表，<br>表中的<code>key</code>（即token）和user之间具有一对一的关系。</p>
<p>如果之前已经创建了用户，在这个token表是没有记录的。<br>创建用户表后需要手动创建token表。<br>当用户注册时，需要调用<code>token = Token.objects.create(user=...)</code>来生成token。</p>
<p>创建用户默认会生成一个对应的token值会保存到数据中，跟这个用户相关联。<br>其表结构如下：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+<span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line">| Field   | Type        | Null | Key | Default | Extra |</span><br><span class="line">+<span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line">| key     | varchar(40) | NO   | PRI | NULL    |       |</span><br><span class="line">| created | datetime(6) | NO   |     | NULL    |       |</span><br><span class="line">| user_id | int(11)     | NO   | UNI | NULL    |       |</span><br><span class="line">+<span class="comment">---------+-------------+------+-----+---------+-------+</span></span><br><span class="line">3 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></tbody></table></figure>

<h4 id="方式一-manage-py-生成Token"><a href="#方式一-manage-py-生成Token" class="headerlink" title="方式一 manage.py 生成Token"></a>方式一 <code>manage.py</code> 生成Token</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py drf_create_token admin  <span class="comment"># admin是用户名</span></span><br></pre></td></tr></tbody></table></figure>

<p>只能供管理员测试，每新增一个用户就要手动输入一条命令太麻烦</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+<span class="comment">------------------------------------------+----------------------------+---------+</span></span><br><span class="line">| key                                      | created                    | user_id |</span><br><span class="line">+<span class="comment">------------------------------------------+----------------------------+---------+</span></span><br><span class="line">| 236de0331b3e5a89665771f9aaff9be720cbba04 | 2021-05-27 08:29:47.306382 |       1 |</span><br><span class="line">+<span class="comment">------------------------------------------+----------------------------+---------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></tbody></table></figure>

<h4 id="方式二-Django信号机制自动生成Token"><a href="#方式二-Django信号机制自动生成Token" class="headerlink" title="方式二 Django信号机制自动生成Token"></a>方式二 Django信号机制自动生成Token</h4><p>在新建用户的时候触发一个信号，执行一个函数能生成Token<br>提供获取Token的API接口给每个用户</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.conf <span class="keyword">import</span> settings  <span class="comment"># 不要用相对导入的方式导入配置文件</span></span><br><span class="line"><span class="keyword">from</span> django.db.models.signals <span class="keyword">import</span> post_save</span><br><span class="line"><span class="keyword">from</span> django.dispatch <span class="keyword">import</span> receiver</span><br><span class="line"><span class="keyword">from</span> rest_framework.authtoken.models <span class="keyword">import</span> Token</span><br><span class="line"></span><br><span class="line"><span class="meta">@receiver(post_save, sender=settings.AUTH_USER_MODEL)  # Django的信号机制</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_token</span>(<span class="params">sender, instance=None, created=False, **kwargs</span>):</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    当User模型类创建用户实例并保存的时候，调用safe方法传递信号给receiver自动生成Token</span></span><br><span class="line"><span class="string">    :param sender:</span></span><br><span class="line"><span class="string">    :param instance:新建的用户实例</span></span><br><span class="line"><span class="string">    :param created:</span></span><br><span class="line"><span class="string">    :param kwargs:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">if</span> created:</span><br><span class="line">        Token.objects.create(user=instance)</span><br></pre></td></tr></tbody></table></figure>

<p><code>drf_tutorial\urls.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.authtoken <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    <span class="comment"># drf 自带的获取Token的接口，没有设置过期刷新之类的功能</span></span><br><span class="line">    path(<span class="string">"api-token-auth/"</span>, views.obtain_auth_token),</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

<p>可以使用HTTP请求模拟发送工具进行发送参数创建，通过携带数据访问<a target="_blank" rel="noopener" href="http://127.0.0.1:8000/api-token-auth/">http://127.0.0.1:8000/api-token-auth/</a>，<br>生成了当前用户的token并获取到，同时将生成的token和当前用户存入表authtoken_token中</p>
<p><img src="/2020/08/21/drf-ren-zheng-he-quan-xian/1.png" alt="description"></p>
<p>登录后台，新建用户，激活员工，数据表<code>authtoken_token</code>的key值会增加一个</p>
<p>获取token需要用户名密码认证<br>用POST方法在客户端身份验证 postman获取，选择no-auth<br>body</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="attr">"username"</span>: <span class="string">"user01"</span>,</span><br><span class="line">    <span class="attr">"password"</span>: <span class="string">"my123password"</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>body设为none ,Auth设为API Key</p>
<figure class="highlight apache"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Key</span>: Authorization</span><br><span class="line"><span class="attribute">Value</span>: <span class="number">69</span>d<span class="number">53</span>cdb<span class="number">0</span>b<span class="number">395</span>d<span class="number">638</span>b<span class="number">50</span>b<span class="number">51</span>d<span class="number">5</span>f<span class="number">3008</span>f<span class="number">66499</span>b<span class="number">4</span>b<span class="number">8</span></span><br></pre></td></tr></tbody></table></figure>

<p>对于客户端进行身份验证，在 Authorization HTTP header 中。<br>密钥关键字应以字符串文字 <code>Token</code> 为前缀，用空格分隔两个字符串。例如：<br><code>Authorization</code>: <code>Token 9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b</code></p>
<p>注意： 如果您想在 header 中使用不同的关键字（例如 Bearer），只需子类化 TokenAuthentication 并设置 keyword 类变量。</p>
<p>此时再使用获取到的Token请求商品数据如下：<br><img src="/2020/08/21/drf-ren-zheng-he-quan-xian/2.png" alt="description"></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self, request</span>):</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    :param request:</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    queryset = Course.objects.all()</span><br><span class="line">    s = CourseSerializer(instance=queryset,</span><br><span class="line">                         many=<span class="literal">True</span>)  <span class="comment"># 这里是instance = xx 查询集</span></span><br><span class="line">    print(type(request), type(request.data), type(s), type(s.data))</span><br><span class="line">    <span class="comment"># &lt;class 'rest_framework.request.Request'&gt; &lt;class 'dict'&gt; &lt;class 'rest_framework.serializers.ListSerializer'&gt; &lt;class 'rest_framework.utils.serializer_helpers.ReturnList'&gt;</span></span><br><span class="line">    print(self.request.user, self.request.auth)  <span class="comment"># admin None 默认模式</span></span><br><span class="line">    print(type(self.request.user), type(self.request.auth))</span><br><span class="line">    <span class="comment"># &lt;class 'django.contrib.auth.models.User'&gt; &lt;class 'NoneType'&gt; 默认模式</span></span><br><span class="line">    <span class="comment"># user01 69d53cdb0b395d638b50b51d5f3008f66499b4b8 token模式</span></span><br><span class="line">    <span class="comment"># &lt;class 'django.contrib.auth.models.User'&gt; &lt;class 'rest_framework.authtoken.models.Token'&gt;  token模式</span></span><br><span class="line">    <span class="keyword">return</span> Response(s.data, status=status.HTTP_200_OK)</span><br></pre></td></tr></tbody></table></figure>

<p>认证成功会把<code>request.user</code>设置<code>User</code>类的实例，<code>request.auth</code>设置为数据表<code>authtoken_token</code>的key值<code>69d53cdb0b395d638b50b51d5f3008f66499b4b8</code>，失败会在header添加www-Authentication</p>
<p>viewsets设置认证类<br>在使用token认证时，如果token不正确，则会抛出异常，<br>并且如果对于本来不需要认证即可访问的公开数据要是再需要正确的token才能访问的话，就会降低项目的友好性，<br>此时可以对token不采用全局设置，在需要配置认证的视图接口中进行<code>authentication_classes</code>认证判断</p>
<p>分接口配置认证。解决某些接口需要认证才可以访问，某些接口不需要认证就可以访问</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.authentication <span class="keyword">import</span> TokenAuthentication</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 没有登录打开对应url不会弹出帐密输入框了，因为自定义了认证类不再继承BasicAuthentication</span></span><br><span class="line">    authentication_classes = [TokenAuthentication]</span><br></pre></td></tr></tbody></table></figure>

<p>此时再请求<a target="_blank" rel="noopener" href="http://127.0.0.1:8000/mine/">http://127.0.0.1:8000/mine/</a>，request.user即为当前用户admin。</p>
<h2 id="drf权限"><a href="#drf权限" class="headerlink" title="drf权限"></a>drf权限</h2><p>仅进行身份验证或标识不足以获取信息或代码。为此，请求访问的实体必须具有<strong>授权</strong>。<strong>权限与身份验证和限制</strong>一起，确定是否应准予请求访问或拒绝访问。权限检查始终在视图的开始处运行，然后再允许执行其他任何代码，通常会使用<code>request.user</code>和<code>request.auth</code>属性中的身份验证信息来确定是否应允许传入请求。</p>
<p>权限用于授予或拒绝不同类别的用户对API不同部分的访问，最简单的许可方式是允许访问任何经过身份验证的用户，并拒绝访问任何未经身份验证的用户。</p>
<p>常见的权限<br><code>from rest_framework.permissions import IsAuthenticated</code> 只有登录才能进行操作，不登录不能进行任何操作 将拒绝任何未经身份验证的用户的权限，否则将允许权限。<br><code>from rest_framework.permissions import AllowAny</code><br><code>from rest_framework.permissions import IsAdminUser</code> 是不是管理员<code>request.user.is_staff</code>员工<br><code>from rest_framework.permissions import IsAuthenticatedOrReadOnly</code></p>
<p>常用的权限类设置权限策略<br>如何自定义对象级别权限<br>权限检测后的处理，认证URL设置，全局权限控制与ViewSet的权限。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DRF 全局配置</span></span><br><span class="line">REST_FRAMEWORK = {</span><br><span class="line">    <span class="comment"># 配置默认授权类 权限permisson: 对登录验证通过的用户能访问的api和对api能取得的对应级别数据</span></span><br><span class="line">    <span class="string">"DEFAULT_PERMISSION_CLASSES"</span>: [</span><br><span class="line">        <span class="comment"># "rest_framework.permissions.AllowAny",  # 默认，允许所有请求，不需要认证</span></span><br><span class="line">        <span class="string">"rest_framework.permissions.IsAuthenticated"</span></span><br><span class="line">    ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="DRF自定义BasePermission验证所有者"><a href="#DRF自定义BasePermission验证所有者" class="headerlink" title="DRF自定义BasePermission验证所有者"></a>DRF自定义BasePermission验证所有者</h3><p>DRF也提供了自定义权限功能，要实现自定义权限，覆盖<code>BasePermission</code>并实现以下方法之一或两者都实现：<br><code>.has_permission(self, request, view)</code><br><code>.has_object_permission(self, request, view, obj)</code></p>
<p>如果应该授予请求访问权，则方法应该返回True，否则返回False。</p>
<p>如果鉴权失败，自定义权限将引发一个PermissionDenied异常。要更改与异常关联的错误消息，直接在自定义权限上实现message属性。否则，将使用PermissionDenied中的default_detail属性。</p>
<h3 id="设置登录的用户能查看修改自己的信息、收藏等数据，不能修改别人的信息"><a href="#设置登录的用户能查看修改自己的信息、收藏等数据，不能修改别人的信息" class="headerlink" title="设置登录的用户能查看修改自己的信息、收藏等数据，不能修改别人的信息"></a>设置登录的用户能查看修改自己的信息、收藏等数据，不能修改别人的信息</h3><p><a target="_blank" rel="noopener" href="https://www.django-rest-framework.org/tutorial/4-authentication-and-permissions/#object-level-permissions">https://www.django-rest-framework.org/tutorial/4-authentication-and-permissions/#object-level-permissions</a></p>
<p><a target="_blank" rel="noopener" href="https://www.django-rest-framework.org/api-guide/permissions/#custom-permissions">https://www.django-rest-framework.org/api-guide/permissions/#custom-permissions</a></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SAFE_METHODS = (<span class="string">'GET'</span>, <span class="string">'HEAD'</span>, <span class="string">'OPTIONS'</span>)  <span class="comment"># 源码规定</span></span><br></pre></td></tr></tbody></table></figure>

<p>Really we’d like all code courses to be visible to anyone, but also make sure that only the user that created a code course is able to update or delete it.</p>
<p>To do that we’re going to need to create a custom permission.</p>
<p>In the course app, create a new file,</p>
<p>把官网的实例，直接复制过来就可以了，把<code>object.owner</code>其中的<code>owner</code>改为<code>user</code><br>同时需要自定义权限来判断要删除的收藏记录是否是当前的用户。</p>
<p><code>utils/permissions.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework <span class="keyword">import</span> permissions</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IsOwnerOrReadOnly</span>(<span class="params">permissions.BasePermission</span>):</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Custom permission to only allow owners of an object to edit it.</span></span><br><span class="line"><span class="string">    自定义所有者权限：只允许对象的所有者能够编辑</span></span><br><span class="line"><span class="string">    Object-level permission to only allow owners of an object to edit it.</span></span><br><span class="line"><span class="string">    Assumes the model instance has an `user` attribute.</span></span><br><span class="line"><span class="string">    对象级别的权限，仅允许对象的所有者对其进行编辑</span></span><br><span class="line"><span class="string">    模型实例有一个 user 属性，指向用户的外键。</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">has_object_permission</span>(<span class="params">self, request, view, obj</span>):</span></span><br><span class="line">        <span class="comment"># Read permissions are allowed to any request,所有的请求都有读权限，</span></span><br><span class="line">        <span class="comment"># so we'll always allow GET, HEAD or OPTIONS requests.，所以我们总是允许GET、HEAD或OPTIONS请求。</span></span><br><span class="line">        <span class="keyword">if</span> request.method <span class="keyword">in</span> permissions.SAFE_METHODS:</span><br><span class="line">            <span class="comment"># SAFE_METHODS = ("GET", "HEAD", "OPTIONS")</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Instance must have an attribute named `owner`.</span></span><br><span class="line">        <span class="comment"># 实例必须有一个名为user的属性。</span></span><br><span class="line">        <span class="comment"># 只有当对象的user和当前登录user一样，才返回True，对象的所有者才有权限</span></span><br><span class="line">        <span class="comment"># obj = queryset = Course.objects.all()</span></span><br><span class="line">        <span class="comment"># 这里要把owner改为我们数据库中的user</span></span><br><span class="line">        <span class="keyword">return</span> obj.user == request.user</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> utils.permissions <span class="keyword">import</span> IsOwnerOrReadOnly</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># IsAuthenticated：必须登录用户；IsOwnerOrReadOnly：必须是当前登录的用户</span></span><br><span class="line">    permission_classes = [IsAuthenticated, IsOwnerOrReadOnly]</span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/enumerate-mei-ju/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/enumerate-mei-ju/" class="post-title-link" itemprop="url">python enumerate枚举</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-06-08 10:55:41" itemprop="dateModified" datetime="2021-06-08T10:55:41Z">2021-06-08</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>将一个可遍历的数据对象(如列表、元组或字符串)组合为一个索引序列，<br>同时列出数据和数据下标</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">seasons = [<span class="string">'Spring'</span>, <span class="string">'Summer'</span>, <span class="string">'Fall'</span>, <span class="string">'Winter'</span>]</span><br><span class="line">print(enumerate(seasons))  <span class="comment"># &lt;enumerate object at 0x00000217ADAB6F40&gt;</span></span><br><span class="line">print(list(enumerate(seasons)))  <span class="comment"># 下标从 0 开始</span></span><br><span class="line"><span class="comment"># [(0, 'Spring'), (1, 'Summer'), (2, 'Fall'), (3, 'Winter')]</span></span><br><span class="line">print(list(enumerate(seasons, start=<span class="number">1</span>)))  <span class="comment"># 下标从 1 开始</span></span><br><span class="line"><span class="comment"># [(1, 'Spring'), (2, 'Summer'), (3, 'Fall'), (4, 'Winter')]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for 循环使用 enumerate的对象</span></span><br><span class="line"><span class="keyword">for</span> i, val <span class="keyword">in</span> enumerate(seasons):</span><br><span class="line">    print(i, seasons[i])</span><br><span class="line"><span class="comment"># 0 Spring</span></span><br><span class="line"><span class="comment"># 1 Summer</span></span><br><span class="line"><span class="comment"># 2 Fall</span></span><br><span class="line"><span class="comment"># 3 Winter</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for 循环使用 enumerate对象的列表</span></span><br><span class="line">print(<span class="string">'------'</span>)</span><br><span class="line"><span class="keyword">for</span> i, val <span class="keyword">in</span> list(enumerate(seasons)):</span><br><span class="line">    print(i, seasons[i])</span><br><span class="line"><span class="comment"># 0 Spring</span></span><br><span class="line"><span class="comment"># 1 Summer</span></span><br><span class="line"><span class="comment"># 2 Fall</span></span><br><span class="line"><span class="comment"># 3 Winter</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for 循环使用 enumerate对象的列表</span></span><br><span class="line">print(<span class="string">'------'</span>)</span><br><span class="line"><span class="keyword">for</span> i, val <span class="keyword">in</span> list(enumerate(seasons)):</span><br><span class="line">    print(i, seasons[i])</span><br><span class="line"><span class="comment"># 0 Spring</span></span><br><span class="line"><span class="comment"># 1 Summer</span></span><br><span class="line"><span class="comment"># 2 Fall</span></span><br><span class="line"><span class="comment"># 3 Winter</span></span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">print(<span class="string">'------'</span>)</span><br><span class="line"><span class="keyword">for</span> val <span class="keyword">in</span> seasons:  <span class="comment"># 普通的 for 循环，不使用 enumerate</span></span><br><span class="line">    print(i, seasons[i])</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"><span class="comment"># 0 Spring</span></span><br><span class="line"><span class="comment"># 1 Summer</span></span><br><span class="line"><span class="comment"># 2 Fall</span></span><br><span class="line"><span class="comment"># 3 Winter</span></span><br><span class="line"></span><br><span class="line">seasons = [<span class="string">'Spring'</span>, <span class="string">'Summer'</span>, <span class="string">'Fall'</span>, <span class="string">'Winter'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, val <span class="keyword">in</span> list(enumerate(seasons)):</span><br><span class="line">    print(val)</span><br><span class="line"><span class="comment"># Spring</span></span><br><span class="line"><span class="comment"># Summer</span></span><br><span class="line"><span class="comment"># Fall</span></span><br><span class="line"><span class="comment"># Winter</span></span><br></pre></td></tr></tbody></table></figure>

<p>上面的第5行并没有打印index，实际上有些情况下，我们并不会使用index这个变量。<br>但是这个时候index的变量不使用但是index这个名称却被占用了，所以这个时候我们就可以使用匿名变量。将上面的index改为下划线 <code>_</code>，表示这个地方的变量是一个匿名变量。这样既不用占用变量名又可以多一个占位符。<br>将上面的代码改成：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">seasons = [<span class="string">'Spring'</span>, <span class="string">'Summer'</span>, <span class="string">'Fall'</span>, <span class="string">'Winter'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _, val <span class="keyword">in</span> list(enumerate(seasons)):</span><br><span class="line">    print(val)</span><br><span class="line"><span class="comment"># Spring</span></span><br><span class="line"><span class="comment"># Summer</span></span><br><span class="line"><span class="comment"># Fall</span></span><br><span class="line"><span class="comment"># Winter</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_multiple_args</span>(<span class="params">*args</span>):</span></span><br><span class="line">    print(type(args), args)</span><br><span class="line">    <span class="keyword">for</span> k, val <span class="keyword">in</span> enumerate(args):</span><br><span class="line">        print(k, val)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">'======'</span>)</span><br><span class="line">print_multiple_args(<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>)  <span class="comment"># 法一</span></span><br><span class="line">print(<span class="string">'======'</span>)</span><br><span class="line">print_multiple_args(*[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>])  <span class="comment"># 法二 列表打包成关键字参数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 给定一个整数数组和一个目标值，找出数组中和为目标值的两个整数，并返回它们的数组下标</span></span><br><span class="line">nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">3</span>]</span><br><span class="line">target = <span class="number">8</span></span><br><span class="line">print(<span class="string">'-----'</span>)</span><br><span class="line"><span class="keyword">for</span> i, j <span class="keyword">in</span> enumerate(nums):</span><br><span class="line">    <span class="keyword">if</span> target - j <span class="keyword">in</span> nums[i + <span class="number">1</span>:]:</span><br><span class="line">        <span class="comment"># 字符串.index(子串,起始位置,结束位置)    返回开始的索引值，没找到则抛出异常。</span></span><br><span class="line">        print([i, nums[i + <span class="number">1</span>:].index(target - j) + i + <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">print(<span class="string">'******'</span>)</span><br><span class="line"><span class="comment"># .items 处理可遍历的字典，返回元组数组。</span></span><br><span class="line">dictionary = {<span class="string">'Name'</span>: <span class="string">'Runoob'</span>, <span class="string">'Age'</span>: <span class="number">7</span>}</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Value : %s"</span> % dictionary.items())</span><br><span class="line"><span class="comment"># Value : dict_items([('Name', 'Runoob'), ('Age', 7)])</span></span><br><span class="line">print(type(dictionary.items()), dictionary.items())</span><br><span class="line"><span class="comment"># &lt;class 'dict_items'&gt; dict_items([('Name', 'Runoob'), ('Age', 7)])</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_kwargs</span>(<span class="params">**kwargs</span>):</span></span><br><span class="line">    print(type(kwargs), kwargs)</span><br><span class="line">    <span class="keyword">for</span> key, val <span class="keyword">in</span> kwargs.items():</span><br><span class="line">        print(<span class="string">'{}：{}'</span>.format(key, val))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">'---------'</span>)</span><br><span class="line">print_kwargs(a=<span class="number">1</span>, b=<span class="number">2</span>)  <span class="comment"># 法一</span></span><br><span class="line"><span class="comment"># &lt;class 'dict'&gt; {'a': 1, 'b': 2}</span></span><br><span class="line"><span class="comment"># a：1</span></span><br><span class="line"><span class="comment"># b：2</span></span><br><span class="line">print(<span class="string">'---------'</span>)</span><br><span class="line">print_kwargs(**dict(a=<span class="number">1</span>, b=<span class="number">2</span>))  <span class="comment"># 法二 字典打包成关键字参数</span></span><br><span class="line"><span class="comment"># &lt;class 'dict'&gt; {'a': 1, 'b': 2}</span></span><br><span class="line"><span class="comment"># a：1</span></span><br><span class="line"><span class="comment"># b：2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_all</span>(<span class="params">a, *args, **kwargs</span>):</span></span><br><span class="line">    print(a)</span><br><span class="line">    <span class="keyword">if</span> args:</span><br><span class="line">        print(args)</span><br><span class="line">    <span class="keyword">if</span> kwargs:</span><br><span class="line">        print(kwargs)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">'--------'</span>)</span><br><span class="line">print_all(<span class="string">'hello'</span>, <span class="string">'world'</span>, name=<span class="string">'cyf'</span>)</span><br><span class="line"><span class="comment"># hello</span></span><br><span class="line"><span class="comment"># ('world',)</span></span><br><span class="line"><span class="comment"># {'name': 'cyf'}</span></span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/flask-restful-xiang-mu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/flask-restful-xiang-mu/" class="post-title-link" itemprop="url">flask restful项目</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-22 13:05:52" itemprop="dateModified" datetime="2021-04-22T13:05:52Z">2021-04-22</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>setting.通用的配置</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/ftp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/ftp/" class="post-title-link" itemprop="url">ftp</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-14 07:34:15" itemprop="dateModified" datetime="2021-04-14T07:34:15Z">2021-04-14</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" itemprop="url" rel="index"><span itemprop="name">计算机网络</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>FTP是应用层的一个文件传输协议。其主要作用是在服务器和客户端之间实现文件的传输和共享。FTP协议运行在TCP连接上,保证了文件传输的可靠性。<br>FTP支持两种方式的传输:</p>
<ul>
<li>文本方式</li>
<li>二进制方式</li>
</ul>
<p>FTP有两种传输模式:</p>
<ul>
<li>主动模式的核心是TFP客户端告诉服务端自己开发那个端口作为数据端口,然后让服务端来连接自己 </li>
<li>和被动模式 连接的核心是控制连接请求和数据连接请求都是由客户端发起。</li>
</ul>
<p>FTP局限性:当客户端用户数量不断增多,FTP服务器所要维持的会话总数,也会迅速增长。<br>会大大限制FTP服务器的性能。</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/hexo-chang-yong-ming-ling/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/hexo-chang-yong-ming-ling/" class="post-title-link" itemprop="url">hexo 常用命令</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 15:48:20" itemprop="dateModified" datetime="2021-04-02T15:48:20Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/hexo/" itemprop="url" rel="index"><span itemprop="name">hexo</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></tbody></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo s</span><br></pre></td></tr></tbody></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g</span><br></pre></td></tr></tbody></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo d</span><br></pre></td></tr></tbody></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
<h3 id="clean-to-remote-sites"><a href="#clean-to-remote-sites" class="headerlink" title="clean to remote sites"></a>clean to remote sites</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo clean</span><br></pre></td></tr></tbody></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/html/" class="post-title-link" itemprop="url">HTML</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-16 07:53:27" itemprop="dateModified" datetime="2021-05-16T07:53:27Z">2021-05-16</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>html在vscode没有高亮，右下角语言模式把<code>django html</code>切换成<code>html</code><br>live Server可以本地服务器的形式来运行html文件,或者项目,实现边改边在浏览器<br>看见效果。打开浏览器进行预览和调试页面。这个插件就可以实现静态、动态页面的实时预览，保存就能看见页面更新，不需要手动去刷新。</p>
<p>js中用<code>/**</code>表示方法的注释</p>
<h1 id="当前页面-当前文档所有内容"><a href="#当前页面-当前文档所有内容" class="headerlink" title="当前页面 * 当前文档所有内容"></a>当前页面 * 当前文档所有内容</h1><p>html的基本结构，</p>
文档标记，
头部标记，其中<title></title>属于
正文标记

<p>⽹⻚中常⽤的块元素有：div、dl、form、h1 – h6、hr、ol、p、pre、table、ul；<br>⽹⻚中常⽤的内联元素有：a、br、img、input、label、q、select、span、strong、textarea； </p>
⽤来定义表格的表头标签
是表格中单元格标签
是表格中定义⾏的标签
<hr>是水平线
<b>加粗
<ins>下划线
<i>斜体
<sub>下标
<p> 换段
<br> 换行
在html中，⽆论打多少个空格，在⻚⾯中都只显示⼀个，显然不能正确的表示空格。 

</p><p>什么是转义<br>◆把有特殊意义的字符显示出来<br>在浏览器显示页面时，浏览器会移除源代码中多余的空格和空行，所有连续的空格或空行都会被认为是一个空格。<br>&nbsp;  在⻚⾯表示空格符。<br>&amp;amp  &amp;<br>html标签中的&lt;&gt;—&amp;lt,&gt;<br>&amp;lt；在⻚⾯上表示的是左尖括号&lt;。<br>&amp;gt；在⻚⾯上表示<br>rowspan是跨⾏属性<br>colspan是跨列属性<br>cellspacing是单元格空隙<br>cellpadding是单元格内容与单元格边框空隙。 </p>
<p>行级元素和其他内元素都会在一条水平线上排列，都在同一行<br>行级元素 a标签 label img span <br><br>标签 <span> 通常作为文本的容器，它没有特定的含义和样式，只有与 CSS 同时使用才可以为指定文本设置样式属性<br>该标签是一个内联元素，他与块级元素相反，内联元素不会自动在前后自动放置换行符，因此内联元素会默认显示在同一行。</span></p>
<p>lt 是 less than 的缩写，表示（严格）小于；<br>gt 是 greater than 的缩写，表示（严格）大于；<br>le 是 less than or equal 的缩写，表示小于等于<br>ge 是 greater than or equal 的缩写，表示大于等于</p>
<p>h1~h6 标题<br>&lt;img src=“***”/&gt;   作用在浏览器显示图片<br>示例&lt;img src=”image/logo.jpg” width=”250” height=”250” alt=“**”/&gt;<br>常用属性src、alt、height、width</p>
<p>href用来设置链接指向的页面的URL，指定要链接内容的地址<br><a>.….</a> 使用超级链接与网络上的另一个文档相连<br><a href="page2.html">打开另一个页面</a><br>外网加上http://<br><a target="_blank" rel="noopener" href="http://www.imooc.com">慕课网</a></p>
<p>A标签的target属性<br>标签|格式<br>_blank 在新打开、未命名的窗口打开链接<br>_parent 在父窗口打开链接<br>_self 当前窗口打开<br>_top 在框架中打开，目标将会清除所有被包含的frame框架</p>
<p>target规定在何处打开链接文档。<br>用title属性规定关于元素的额外信息。这些信息通常会在鼠标移到元素上时显示一段工具提示文本（tooltip text）。title 属性常与form以及a元素一同使用，以提供关于输入格式和链接目标的信同时它也是abbr和acronym元素的必需属性。</p>
<p>锚点标签<a name="ziti">…</a><br>name规定锚的名称。<br>作用同一个文档中创建指向该锚（位置）的链接，保证页面能最后一段是完整的，不能是半页<br>示例<a href="#duanluo">段落标签</a></p>
<h1>目录</h1><h1>
</h1><h2><a href="#duanluo">段落标签</a></h2>
<h2><a href="page1.html#ziti">字体标签</a>有序列表<ol><li>….</li></ol><p></p>
<p>无序列表</p><ul><li>….</li></ul><br>作用此列项目使用粗体圆点（典型的小黑圆圈）进行标记<br>适用于规律性显示的页面效果，范围和大小可以根据需要和整体宽度来自适应<br>示例<ul><li>我的文件</li></ul><p></p>
<ul>
<li>我的文件</li>
<li>我的图片</li>
</ul>
列表项内部可以使用段落、换行符、图片、链接以及其他列表等

<form>标签定义表单，表单本身是不可见的，相当于一个容器
所有表单元素要放在标签中，<input>、下拉菜单和列表项目分组中每项内容标签<option>，文字域</option><textarea>、可创建单选或多选菜单</textarea><select>等标签，
form中没有标签。

常见的表单元素◆隐藏表单域◆单行文本框/多行文本框◆表单按钮◆选择(单选、多选、下拉选择)◆文件上传框
◆ action表单提交的URL地址◆ method表单请求的方式(GET/POST)◆ enctype-请求内容的形式application/x-www-form-urlencodedmultipart/form-data 上传文件，如word excelmethod=”post” enctype=”multipart/form-data”
</select><input>是表单输入标签,type属性的设置，text是文本域，submit是提交按钮<br>type属性是text的input标签代表文本框 可以接收用户输入<p></p>
<input type="" value="">
value 属性对于不同 input 类型，用法也不同：
定义按钮上的文本： "button"、"reset"、"submit"
 定义输入字段的初始（默认）值： "text"、"password"、"hidden"隐藏表单域
多选 "checkbox"、单选"radio"、"image" 类型,<select><option></option></select>下拉选择 - 定义与 input 元素相关的值，当提交表单时该值会发送到表单的 action URL。
<input type="file"> 文件上传
<input type="text" size="20"> 
type="text"是⽤来设置⽂本域的，size属性表示⽂本域的宽 度为多少个英⽂字符
 时间日期等（date、month、week、time、date、datetime、datetime-local）


<p><code>placeholder</code>文本框的输入提示</p>
<p>以规范实现选择“是”或“否”单选框效果<br>&lt;input type=’radio’name=’radio’ value=’s’/&gt;True<br>&lt;input type=’radio’name=’radio’ value=’f’/&gt;Flase</p>
<p>开始标签 <option> 与结束标签 </option> 之间的内容是浏览器显示在下拉列表中的内容，而 value 属性中的值是表单提交时被发送到服务器的值。</p>
<p>注意：如果没有规定 value 属性，选项的值将设置为 <option> 标签中的内容。</option></p>
<p>CSS Cascading Style Sheets 层叠样式列表<br>·结构与样式分离的方式，便于后期维护与改版<br>·可以用多套样式，使网页有任意样式切换的效果<br>·使页面载入得更快、降低服务器的成本</p>
<p>CSS规则是由选择器和声明组成。声明要由花括号包围起来；<br>属性和属性值之间用冒号分开；属性值如果有单位，那么数字和单位之间不能有空格；<br>每条声明的结尾用分号结束；</p>
<p>选择器 作用：用来选择（找到）需要添加样式的位置<br>常用选择器：（归）类选择器</p>
<p class="title">https://www.imooc.com/</p><p>
</p><p class="title">你学习的好帮手/</p><p>
标签选择器 
<p〉慕课网< p="">

</p〉慕课网<></p><p>CSS中文字字体的设意，<br>CSS中设置文字字体使用的属性是font-family<br>font-size用来设置字体的大小 npx<br>fong-weight是用来设置字体的粗细 normal、bold、100-900<br>font-style用来设置字体的样式 normal、italic、oblique规定斜体文本</p>
<p>使用内部样式表，完成背景设置<br>背景样式<br>属性|属性值|作用<br>1|background-color 颜色值 颜色作为背景颜色<br>2background-image 图片位置 图片作为背景图片<br>3|background-repeat repeat、repeat-x<br>|repeat-y、no-repeat 背景图片的重复方向<br>4background-attachment scroll、fixed 背景是否随滚动条滚<br>5|background-position 见详细表格 背景图像的起始位置<br>6background 背景样式的值是复合属性值组合<br>top left|如果您仅规定了一个关键词，那么第二个值将是”center”。<br>top center top right 默认值：0%0%。<br>center left center center center right bottom left bottom center bottom right<br>×%y%第一个值是水平位置，第二个值是垂直位置。<br>左上角是0%0%。右下角是100%100%。如果您仅规定了一个值，另一个值将是50%。<br>xpos ypos第一个值是水平位置，第二个值是垂直位置。<br>左上角是00。单位是像素（OpxOpx）或任何其他的CSS单位。<br>如果您仅规定了一个值，另一个值将是50%。<br>您可以混合使用%和position值。</p>
<p>外部样式表就是新建一个文档，里面全写css，<br>然后再通过link 插入到html代码中<br>作用：使网页的表示层与结构层彻底分离<br>示例：将背景设置，修改为外部样式表<br>&lt;linklrel=”stylesheet”|type=”text/css href=”index.css”&gt;<br>小贴士除了link进行外部样式表的链接，还是其他方法哦</p>
<p>文本样式</p>
<p>属性|属性值|作用<br>|1color表示颜色的内容设置文本颜色<br>2direction ltr、rtl文本的方向/书写方向<br>3|letter-spacing npx注：n可以是负数）字符间距<br>4line-height npx行高<br>5text-align |left、right、center、justify 文本对齐方式<br>6 text-decoration none、underline、overline文本的修饰：<br>line-through例如：下划线<br>7text-shadow h-shadow v-shadow blur color 文本设置阴影<br>8 text-transform pone、capitalize、uppercase、y字母/小<br>lowercase<br>9 text-indent npx、nem首行缩进</p>
<p>伪类：超级链接上设置的样式<br>1、伪类是用在超链接上的效果比较多，但超链接不是伪类。<br>2、伪类是选择器。伪类包含两种：状态伪类和结构性伪类<br>作用：设置超级链接的4种状态<br>属性           作用<br>1|a:link未访问的链接<br>2a:visited已访问的链接<br>3|a:hover鼠标移动到链接上（浮动、悬停）<br>4 a:active向被激活的元素添加样式<br>5|：focus选择拥有键盘输入焦点的元素<br>（结构性）伪类选择器（全部）<br>属性作用<br>|1|：first-child 选择元素的第一个子元素2|：last-child选择某个元素的最后一个子元素3|：nth-child（0选择某个元素的一个或多个特定的子元素4 nth-last-childo选择某个元素的一个或多全特定的子元素，从这个元素的最后一个子元素开始算<br>5|：first-of-type选择一个上级元素下的第一个同类子元素</p>
<p>伪元素选择器（部分）<br>属性作用<br>::selection选择指定元素中被用户选中的内容<br>::before可以在选定内容之前插入新内容<br>::after可以在选定内容之后插入新内容<br>:after 选择器向的元素之后插入内容。<br>::first-line选择指定选择器的首行<br>::first-letter选择文本的第一个字符</p>
<p>CSS其他选择器<br>选择器|作用<br>id，*选择指定元素中被用户选中的内容<br>逗号选择器 联合选择器<br>空格选择器 子孙（后代）选择器4</p>
<blockquote>
<p>选择器子选择器（不是子孙后代）<br>+选择器相邻兄弟选择器<br>[]属性选择器</p>
</blockquote>
<p>CSS选择器优先级<br>选择器<br>1|limportant<br>2行内样式<br>3|ID选择器<br>4类选择器<br>5|标签<br>6通配符<br>7浏览器默认属性</p>
<div> 和 </div>定义区块， 前后自动放置一个换行符。
图层，层叠样式表中的定位技术

<p>overflow属性设置<br>属性|作用<br>1|visible 默认值。内容不会被修剪，会呈现在元素框之外。<br>2hidden 超出的部分被隐藏，清除浮动 ，父元素和子元素高度发生联系<br>3|scroll 不论是否需要，都显示滚动条。<br>4 auto按需显示滚动条以便查看其余的内容。</p>
<p></p></form></h2></sub></i></ins></b><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/http-huan-cun/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/http-huan-cun/" class="post-title-link" itemprop="url">http缓存</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-27 01:30:19" itemprop="dateModified" datetime="2021-04-27T01:30:19Z">2021-04-27</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Markdown/" itemprop="url" rel="index"><span itemprop="name">Markdown</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/http/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/http/" class="post-title-link" itemprop="url">http</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-04 15:18:05" itemprop="dateModified" datetime="2021-05-04T15:18:05Z">2021-05-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BD%91%E7%BB%9C/" itemprop="url" rel="index"><span itemprop="name">网络</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>HTTP HyperText Transfer Protocol 超文本传输协议<br>HTTP是基于TCP/IP的关于数据如何在万维网（WWW:World Wide Web ）中如何通信的协议，<br>用来传递来传递数据（HTML 文件, 图片文件, 查询结果等）。<br>是用于从万维网服务器传输超文本到本地浏览器。<br>默认80端口<br>它可以使浏览器更加高效，使网络传输减少。<br>保证计算机正确快速地传输超文本文档，还确定传输文档中的哪一部分，<br>以及哪部分内容首先显示(如文本先于图形)等。<br>HTTP协议采用URL作为定位网络资源的标识<br>以明文的形式传输 效率更高，但是不安全</p>
<p>HTTP协议特点</p>
<ol>
<li>支持客户/服务器模式 基于“请求与响应”模式的的应用层协议</li>
</ol>
<ul>
<li>客户/服务器模式工作的方式是由客户端向服务器发出请求，服务器端响应请求，并进行相应服务</li>
</ul>
<ol start="2">
<li>简单快速</li>
</ol>
<ul>
<li>客户向服务器请求服务时，只需传送请求方法和路径</li>
<li>请求方法常用的有GET、HEAD、POST。每种方法规定了客户与服务器联系的类型不同。由于HTTP协议简单，使得HTTP服务器的程序规模小，因而通信速度很快</li>
</ul>
<ol start="3">
<li>灵活</li>
</ol>
<ul>
<li>HTTP允许传输任意类型的数据对象</li>
<li>正在传输的类型由Content-Type（Content-Type是HTTP包中用来表示内容类型的标识）加以标记。</li>
</ul>
<ol start="4">
<li>无连接</li>
</ol>
<ul>
<li>无连接的含义是限制每次连接只处理一个请求</li>
<li>服务器处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方式可以节省传输时间。不建立持久的连接</li>
</ul>
<ol start="5">
<li>无状态</li>
</ol>
<ul>
<li>HTTP协议是无状态协议</li>
<li>无状态是指协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，在服务器不需要先前信息时它的应答就较快<br>HTTP是无状态的，每次发送HTTP实际和之前的HTTP请求都没有什么关系，如何识别用户呢？</li>
</ul>
<p>-HTTPS:HTTP + SSL用安全套接字层传送的超文本传输协议，<br>传输之前采用证书密钥加密数据 ，之后解密获取内容<br>默认端口：443<br>-安全 效率较低，</p>
<p>Http与Https的区别：</p>
<ol>
<li>   HTTP 的URL 以http:// 开头，而HTTPS 的URL 以https:// 开头</li>
<li>   HTTP 是不安全的，而 HTTPS 是安全的</li>
<li>   HTTP 标准端口是80 ，而 HTTPS 的标准端口是443</li>
<li>   在OSI 网络模型中，HTTP工作于应用层，而HTTPS 的安全传输机制工作在传输层</li>
<li>   HTTP 无法加密，而HTTPS 对传输的数据进行加密</li>
<li>   HTTP无需证书，而HTTPS 需要CA机构wosign的颁发的SSL证书</li>
</ol>
<p>HTTP协议由哪些部分组成？可以使用抓包工具去查看和理解<br>请求是发送给接口的数据对象<br>一个HTTP请求由四部分组成：<br>1、状态行 HTTP请求方法或动作，如：GET或POST；正在请求的接口地址URL<br>3、请求头，包含一些客户端环境信息、身份验证信息、Cookies<br>HTTP Header 请求头信息</p>
<ul>
<li>Accept：指定客户端能够接收的内容类型</li>
<li>Accept-Charset：浏览器可以接受的字符编码集。</li>
<li>Authorization: HTTP 授权的授权证书</li>
<li>Content-type：请求的与实体对应的 MIME 信息，发送端实际发送的数据类型</li>
<li>Referer：先前网页的地址，当前请求网页紧随其后，即来路 防盗链</li>
<li>User-Agent:用户代理：知道当前请求对方资源的是什么浏览器，请求载体的身份标识</li>
<li>Connection：请求完毕后，是断开连接还是保持连接</li>
</ul>
<p>4、请求体，即请求正文，可包含提交的查询字符串信息、表单信息等。</p>
<p>一个HTTP响应一般由三个部分组成：</p>
<ol>
<li>一个数字和文字组成的状态码，用来显示请求成功还是失败；</li>
<li>响应头，包含许多有用的信息，</li>
</ol>
<ul>
<li>Server: 服务器类型</li>
<li>Date 日期时间</li>
<li>Content-Type: 服务器响应回客户端的数据类型</li>
<li>Content-Lenth: 服务器响应回客户端的数据长度</li>
<li>application/x-www-form-urlencoded: 请求默认方式，数据是简单、平面的key-value键值对</li>
<li>application/json: 数据是复杂的嵌套关系，有多层数据</li>
<li>multipart/form-data 既可发送文本数据，也支持二进制数据上载</li>
</ul>
<ol start="3">
<li>响应体，即响应正文。<br>​- 请求头之间：\r\n<br>​- 请求头与请求体：\r\n\r\n</li>
</ol>
<p>① 在命令行下查看HTTP协议，可以使用 curl 或 http 命令发起HTTP请求</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># curl www.baidu.com    # 使用curl发起HTTP请求</span></span><br></pre></td></tr></tbody></table></figure>
<p>② 使用http 命令需要首先安装httpie，然后在通过http命令发起HTTP请求</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># pip install httpie      # 安装httpie</span></span><br><span class="line">[root@localhost ~]<span class="comment"># http baidu.com          # 使用http发起HTTP请求</span></span><br></pre></td></tr></tbody></table></figure>
<p>查看HTTP协议详细输出过程， http -v 详细输出过程</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># http -v baidu.com</span></span><br><span class="line">GET / HTTP/1.1               <span class="comment"># 状态行包括请求方法、路径url、http协议及版本</span></span><br><span class="line">Accept: */*                  <span class="comment"># 3~7行是http的请求头</span></span><br><span class="line">Accept-Encoding: gzip, deflate    <span class="comment"># 接收的编码</span></span><br><span class="line">Connection: keep-alive            <span class="comment"># 连接，</span></span><br><span class="line">Host: baidu.com                   <span class="comment"># 域名</span></span><br><span class="line">User-Agent: HTTPie/1.0.2          <span class="comment"># 请求的代理</span></span><br><span class="line"><span class="comment"># 请求头和请求体空一行 </span></span><br><span class="line"><span class="comment"># 消息主体（不一定有），这里为空没有显示，一般是由GET请求的时候它就没有消息主体</span></span><br><span class="line">-------------------------------------------------------------------------------------</span><br><span class="line">HTTP/1.1 200 OK                  <span class="comment"># 响应行 下面是HTTP响应</span></span><br><span class="line">Accept-Ranges: bytes             <span class="comment"># 3~7行是http的响应头</span></span><br><span class="line">Cache-Control: max-age=86400</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Content-Length: 81</span><br><span class="line">Content-Type: text/html</span><br><span class="line">Date: Fri, 02 Aug 2019 10:07:15 GMT</span><br><span class="line">ETag: <span class="string">"51-47cf7e6ee8400"</span></span><br><span class="line">Expires: Sat, 03 Aug 2019 10:07:15 GMT</span><br><span class="line">Last-Modified: Tue, 12 Jan 2010 13:48:00 GMT</span><br><span class="line">Server: Apache</span><br><span class="line"><span class="comment"># 请求头和请求体空一行 </span></span><br><span class="line">&lt;html&gt;         <span class="comment"># 响应正文。返回的是一个HTML</span></span><br><span class="line">&lt;meta http-equiv=<span class="string">"refresh"</span> content=<span class="string">"0;url=http://www.baidu.com/"</span>&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>fiddler保存HTTP请求文本<br>打开测试页面→到Fiddler中选中该请求→Shift+Del清空其他请求→右键→Save→Selected Sessions→as Text…  </p>
<p>提交一些表单的时候HTTP请求里面就会包含消息主体。</p>
<p>发送一个POST请求，带上hello=World参数 ，也可以加在url</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># http -f POST baidu.com hello=World -v </span></span><br><span class="line">POST / HTTP/1.1                  <span class="comment"># 请求状态行</span></span><br><span class="line">Accept: */*                      <span class="comment"># 3~9是请求头</span></span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Length: 11</span><br><span class="line">Content-Type: application/x-www-form-urlencoded; charset=utf-8</span><br><span class="line">Host: baidu.com</span><br><span class="line">User-Agent: HTTPie/1.0.2</span><br><span class="line"><span class="comment"># 空一行  </span></span><br><span class="line">hello=World                    <span class="comment"># 报文消息主体，当然有时候可以为空</span></span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line">HTTP/1.1 200 OK           <span class="comment"># 响应状态行，包括HTTP版本、状态码200、OK表示成功</span></span><br><span class="line">Accept-Ranges: bytes      <span class="comment"># 14~23是响应头</span></span><br><span class="line">Cache-Control: max-age=86400</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Content-Length: 81</span><br><span class="line">Content-Type: text/html</span><br><span class="line">Date: Fri, 02 Aug 2019 10:13:42 GMT</span><br><span class="line">ETag: <span class="string">"51-47cf7e6ee8400"</span></span><br><span class="line">Expires: Sat, 03 Aug 2019 10:13:42 GMT</span><br><span class="line">Last-Modified: Tue, 12 Jan 2010 13:48:00 GMT</span><br><span class="line">Server: Apache</span><br><span class="line"> </span><br><span class="line">&lt;html&gt;         <span class="comment"># 响应正文。返回的是一个HTML</span></span><br><span class="line">&lt;meta http-equiv=<span class="string">"refresh"</span> content=<span class="string">"0;url=http://www.baidu.com/"</span>&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>HTTP persistent connection， HTTP1.1实现长连接<br>短连接：建立连接…数据传输…关闭连接(连接的建立和关闭开销大)</p>
<p>长连接：Connection：Keep-alive。保持 TCP 连接不断开<br>如何区分不同的 HTTP 请求呢？Content-Length | Transfer-Encoding:chunked。</p>
<p>Content-Length首部告诉浏览器报文中实体主体的大小<br>第一种情况 就是客户端告诉服务端发送的 HTTP 请求多长(Content-Length)，接收这么多字节之后就认为你这次HTTP请求就结束了。(静态发送)<br>非KeepAlive模式时，每个请求/应答客户和服务器都要新建一个连接，完成 之后立即断开连接（HTTP协议为无连接的协议）；无连接的含义是限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方式可以节省传输时间。</p>
<p>第二种情况 请求是动态发送的不知道有多长，HTTP提供了一种分段发送方式(| Transfer-Encoding:chunked),每次发送一个chunk size和chunk body告诉每一次发送多长和发送的内容是什么，直到chunksize为0的时候，服务端就认为结束了。(动态发送)</p>
<p>当使用Keep-Alive模式（又称持久连接、连接重用）时，Keep-Alive功能使客户端到服 务器端的连接持续有效，当出现对服务器的后继请求时，Keep-Alive功能避免了建立或者重新建立连接。通用消息头，允许消息发送者暗示连接的状态，还可以用来设置超时时长和最大请求数。</p>
<p>cookie 和 session 区别<br>需要在服务端给用户生成一个标识，然后每次让客户端带过去给后端，识别用户会话。用户会话就是用户识别的一种方式。</p>
<p>Session“会话控制” 一般是服务器生成之后给客户端 （通过 url参数或cookie）<br>对象存储特定用户会话所需的属性及配置信息。<br>这样，当用户在应用程序的Web页之间跳转时，存储在Session对象中的变量将不会丢失，<br>而是在整个用户会话中一直存在下去。<br>当用户请求来自应用程序的 Web页时，如果该用户还没有会话，<br>则Web服务器将自动创建一个 Session对象。<br>当会话过期或被放弃后，服务器将终止该会话。<br>Session没有大小限制<br>session数据sessionid 识别用户 放在服务器<br>Session 存储安全性较高的数据。</p>
<p>Cookie 是实现 session 的一种机制，通过 HTTP cookie 字段实现<br>类型为“小型文本文件”，<br>是某些网站为了辨别用户身份，进行Session跟踪而储存在用户浏览器终端上的数据（通常经过加密），由用户客户端计算机暂时或永久保存的信息<br>用来存储用户信息的，每次请求会被携带上发送给对方的 浏览器<br>-要获取登录后才能访问的页面<br>-对方的服务器会通过cookie来判断是我们是一个爬虫<br>Cookie不能存储对象<br>Cookie可能会被浏览器禁用。怎么办<br>客户端禁用cookie采用url重写的方式 ，<br>也就是上面说的将sessionid写在url上，<br>用户登陆之后，需要将用户的信息存到Cookie中，<br>但因为Cookie中只能存储字符串，所以想到了先把用户实体序列化成Json串，存储在Cookie中，用到的时候再拿出来反序列化。<br>在客户端的Cookie 中存储session id，以此来标记服务器的哪个session 文件是当前用户的。（session 文件：session 存储介质视服务器而定）<br>Cookie 减轻服务器存储压力，一般存储安全性要求不高的数据。<br>单个cookie保存的数据不能超过4K，很多浏览器都限制一个站点最多保存20个cookie。<br>前言<br>HTTP是一种无状态的协议，为了分辨链接是谁发起的，就需要我们自己去解决这个问题。不然有些情况下即使是同一个网站我们每打开一个页面也都要登录一下。而Session和Cookie就是为解决这个问题而提出来的两个机制。</p>
<p>应用场景<br>日常登录一个网站，今天输入用户名密码登录了，第二天再打开很多情况下就直接打开了。这个时候用到的一个机制就是cookie。</p>
<p>session的一个场景是购物车，添加了商品之后客户端处可以知道添加了哪些商品，而服务器端如何判别呢，所以也需要存储一些信息，这里就用到了session。</p>
<p>Cookie<br>通俗讲，Cookie是访问某些网站以后在本地存储的一些网站相关的信息，下次再访问的时候减少一些步骤。另外一个更准确的说法是：Cookies是服务器在本地机器上存储的小段文本并随每一个请求发送至同一个服务器，是一种在客户端保持状态的方案。</p>
<p>Cookie的主要内容包括：名字，值，过期时间，路径和域。使用Fiddler抓包就可以看见，比方说我们打开百度的某个网站可以看到Headers包括Cookie，如下：</p>
<p>BIDUPSID: 9D2194F1CB8D1E56272947F6B0E5D47E<br>PSTM: 1472480791<br>BAIDUID: 3C64D3C3F1753134D13C33AFD2B38367:FG<br>ispeed_lsm: 2<br>MCITY: -131:<br>pgv_pvi: 3797581824<br>pgv_si: s9468756992<br>BDUSS: JhNXVoQmhPYTVENEdIUnQ5S05xcHZMMVY5QzFRNVh5SzZoV0xMVDR6RzV-bEJZSVFBQUFBJCQAAAAAAAAAAAEAAACteXsbYnRfY2hpbGQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALlxKVi5cSlYZj<br>BD_HOME: 1<br>H_PS_PSSID: 1423_21080_17001_21454_21408_21530_21377_21525_21193_21340<br>BD_UPN: 123253<br>sug: 3<br>sugstore: 0<br>ORIGIN: 0<br>bdime: 0<br>可以看见是key, value的形式，也就是我们说的对应着的名字，值。过期时间是可以设置的，如果不设置，则浏览器关掉就消失了，是存储在内存当中的，否则就是按照我们设置的时间来存储在硬盘上的，当过期后自动清除，比方说我们开机关机关闭再打开浏览器后他都会还存在，前者称之为Session cookie 又叫 transient cookie，后者称之为Persistent cookie 又叫 permenent cookie。路径和域就是对应的域名，a网站的cookie自然不能给b用。</p>
<p>Session<br>Session是存在服务器的一种用来存放用户数据的类HashTable结构。</p>
<p>　　(什么是hashTable,另一篇文章:–<a target="_blank" rel="noopener" href="https://www.cnblogs.com/goddog1024/p/11174417.html">https://www.cnblogs.com/goddog1024/p/11174417.html</a></p>
<p>当浏览器 第一次发送请求时，服务器自动生成了一个HashTable和一个Session ID用来唯一标识这个HashTable，并将其通过响应发送到浏览器。当浏览器第二次发送请求，会将前一次服务器响应中的Session ID放在请求中一并发送到服务器上，服务器从请求中提取出Session ID，并和保存的所有Session ID进行对比，找到这个用户对应的HashTable。</p>
<p>摘自<a target="_blank" rel="noopener" href="http://caibaojian.com/477.html">http://caibaojian.com/477.html</a></p>
<p>一般这个值会有一个时间限制，超时后毁掉这个值，默认是20分钟。</p>
<p>Session的实现方式和Cookie有一定关系。试想一下，建立一个连接就生成一个session id，那么打开几个页面就好几个了，这显然不是我们想要的，那么该怎么区分呢？这里就用到了Cookie，我们可以把session id存在Cookie中，然后每次访问的时候将Session id带过去就可以识别了，是不是很方便~</p>
<p>区别<br>通过上面的简单叙述，很容易看出来最明显的不同是一个在客户端一个在服务端。因为Cookie存在客户端所以用户可以看见，所以也可以编辑伪造，不是十分安全。</p>
<p>Session过多的时候会消耗服务器资源，所以大型网站会有专门的Session服务器，而Cookie存在客户端所以没什么问题。</p>
<p>域的支持范围不一样，比方说a.com的Cookie在a.com下都能用，而<a target="_blank" rel="noopener" href="http://www.a.com的session在api.a.com下都不能用,解决这个问题的办法是jsonp或者跨域资源共享./">www.a.com的Session在api.a.com下都不能用，解决这个问题的办法是JSONP或者跨域资源共享。</a></p>
<h3 id="浏览器的请求"><a href="#浏览器的请求" class="headerlink" title="浏览器的请求"></a>浏览器的请求</h3><ul>
<li><p>url</p>
</li>
<li><p>在chrome中点击检童，点到network,</p>
</li>
<li><p>url =谓求的协议+网站的域名+资源的路径+参数</p>
</li>
<li><p>浏览器谓求url地址</p>
</li>
<li><p>当前url对应的晌应+js+css+图片—&gt;elements中的内容</p>
</li>
<li><p>爬虫谓求url地址</p>
</li>
<li><p>当前url对应的晌应</p>
</li>
<li><p>elements的内容和爬虫获取到的url地址的晌应不同，爬虫中需要以当 前url地址对应的响应为准提取数据</p>
</li>
<li><p>当前url地址对应的晌应在哪里</p>
</li>
<li><p>从network中找到当前的url地址，点击response</p>
</li>
<li><p>在页面上右键显示网页源码</p>
</li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/12/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><span class="space">&hellip;</span><a class="page-number" href="/page/28/">28</a><a class="extend next" rel="next" href="/page/14/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>
<script src="/js/comments.js"></script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">外心人D</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
