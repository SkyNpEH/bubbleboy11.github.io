<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"bubbleboy11.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.6.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:type" content="website">
<meta property="og:title" content="外心人D的博客">
<meta property="og:url" content="https://bubbleboy11.github.io/page/21/index.html">
<meta property="og:site_name" content="外心人D的博客">
<meta property="og:description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="外心人D">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://bubbleboy11.github.io/page/21/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/21/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>外心人D的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="外心人D的博客" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">外心人D的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">外心人D</p>
  <div class="site-description" itemprop="description">本博客大多内容为慕课和网上博客，并非原创</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">341</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">40</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



          </div>
        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/mysql-suo-yin/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/mysql-suo-yin/" class="post-title-link" itemprop="url">mysql索引</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-16 14:43:35" itemprop="dateModified" datetime="2021-05-16T14:43:35Z">2021-05-16</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h1><p>数据表中一列或多列的值进行排序的数据结构，可快速访问数据库表中的特定信息。</p>
<p>为什么加了索引就查询快了<br>没有加索引就是全表查询，加了索引，索引底层是保存在数据结构中，有二叉树，红黑树，hash表，B-Tree.<br>我们现在的数据库里使用的索引底层的数据结构是B-tree<br>比如我们想要将一个表里面的某一个字段作为索引，如果底层是二叉搜索树，那么字段是键，数据地址是值，以键值对的形式保存在二叉搜索树里面，以后拿键里面的值搜索的时候，直接从二叉搜索树里面找，找到以后就有地址了，拿地址从表里面找，那么就可以找到了。<br>二叉搜索树的右边是比左边大，所以很快的。</p>
<p>但是如果二叉树是极端的，不是平衡二叉树，是在一段排列的，所以即使是从索引里面获取，性能还是比较的低。</p>
<p>红黑树的话，有自旋，所以不会出现极端，但是数据多的话，红黑树的高度是比较的高，不是我们想要的。我们希望高度是固定的，但是我们要放的数据可以全部的放进去。</p>
<p>哈希表的话，在查找范围的时候是不可以执行的，所以还是不选择</p>
<p>B+Tree是比较的好的，存储的数据比较多，高度是可以限定的，可以查找范围。</p>
<h4 id="索引对性能的影响"><a href="#索引对性能的影响" class="headerlink" title="索引对性能的影响"></a>索引对性能的影响</h4><ul>
<li>大大减少服务器需要扫描的数据量，</li>
<li>帮助服务器避免排序和临时表</li>
<li>将随机I/O变顺序I/O</li>
<li>提高查询检索数据的速度，</li>
</ul>
<h4 id="不良影响，索引不是越多越好的理由"><a href="#不良影响，索引不是越多越好的理由" class="headerlink" title="不良影响，索引不是越多越好的理由"></a>不良影响，索引不是越多越好的理由</h4><ul>
<li>降低写的速度、写入的代价过高</li>
<li>占用磁盘</li>
</ul>
<p>索引的使用场景<br>对于非常小的表，大部分情况下全表扫描效率更高<br>中到大型表，索引非常有效<br>特大型的表，建立和使用索引的代价将随之增长，可以使用分区技术来解决</p>
<p>Mysql的索引 每一个表里面都有一个聚簇索引，<br>如果表里面有主键的话，根据主键生成索引，<br>如果你没有设置主键，那么会根据unique的字段生成索引，或者都没有的话，那么就会根据行id生成索引</p>
<p>索引的类型都是实现在存储引擎层的<br>普通索引:最基本的索引，没有任何约束限制（CREATE INDEX）<br>唯一索引:（CREATE UNIQUE INDEX）与普通索引类似，但是不同的是唯一索引有唯一性约束，要求索引列的值必须唯一、所有的类的值是唯一的,这一点和主键索引一样.但是他允许有空值,</p>
<p>多列索引，使用多个列去创建索引，多列索引反应在B+Tree里面其实就是相当于B+Tree的key是由多个列的值组成的。<br>主键索引（PRIMARY KEY），一个表只能有一个，特殊的唯一索引，不允许有空值，(在B+TREE中的InnoDB引擎中,主键索引起到了至关重要的地位)<br>外键索引：只有InnoDB类型的表才可以使用外键索引，保证数据的一致性、完整性、和实现级联操作（基本不用）。<br>全文索引（FULLTEXT INDEX）：MySQL自带的全文索引只能用于MyISAM，并且只能对英文进行全文检索 （基本不用），InnoDB 不支持</p>
<p>唯一索引与主键索引的区别<br>一个表只能有一个主键索引，可以有多个唯一索引<br>主键索引一定是唯一索引，唯一索引不是主键索引<br>主键可以与外键构成参照完整性约束，防止数据不一致</p>
<p>联合索引 组合索引也叫复合索引：将多个列组合在一起创建索引，可以覆盖多个列。<br>*遵循“最左前缀”原则，把最常用作为检索或排序的列放在最左，依次递减，组合索引相当于建立了col1,col1col2,col1col2col3三个索引，而col2或者col3是不能使用索引的。<br>同时作用于abc的组合，效果：缩短查询范围 where时的条件要按照建立索引的时候字段的排序方式</p>
<figure class="highlight apache"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">KEY</span>(a, b, c)</span><br><span class="line"><span class="attribute">WHERE</span> a = <span class="number">1</span> AND b = <span class="number">2</span> AND c = <span class="number">3</span></span><br><span class="line"><span class="attribute">WHERE</span> a = <span class="number">1</span> AND b = <span class="number">2</span></span><br><span class="line"><span class="attribute">WHERE</span> a = <span class="number">1</span></span><br><span class="line"><span class="comment">#以上SQL语句可以用到索引</span></span><br><span class="line"><span class="attribute">WHERE</span> b = <span class="number">2</span> AND c = <span class="number">3</span></span><br><span class="line"><span class="attribute">WHERE</span> a = <span class="number">1</span> AND c = <span class="number">3</span></span><br><span class="line"><span class="comment">#以上SQL语句用不到索引，不能跳过前面的，没有连续</span></span><br></pre></td></tr></tbody></table></figure>

<p>MySQL索引的创建原则</p>
<ol>
<li>最适合索引的列是出现在经常被用作检索条件的字段上面，在 WHERE或ON子句中的列，<br>连接子句中的列、经常用作表连接的字段<br>经常出现在 order by， group by 之后的字段<br>而不是出现在 SELECT关键字后的列，</li>
<li>索引列的数据量很大，而且经常被查询的数据表，数据区分度越高</li>
<li>对字符串进行索引，应该制定一个前缀长度，可以节省大量的索引空间</li>
<li>根据情况创建复合索引，复合索引可以提高查询效率</li>
<li>避免创建过多索引，索引会额外占用磁盘空间，降低写操作效率</li>
<li>主键尽可能选择较短的数据类型，可以有效减少索引的磁盘占用，提高查询效率</li>
</ol>
<p>NOT NULL 非空字段<br>注意事项</p>
<ol>
<li>column is null 列值为空可以使用索引，Mysql 很难对空值作查询优化。反应在B+树结构里面就是空值无法去作比较这个时候索引就利用不上了。（很多互联网公司的建表规范要求索引字段有默认值）</li>
<li>区分度高，离散度大，作为索引的字段值尽量不要有大量相同的值。反应在B+树里面就是当很多字段是一样的时候说明B+树里面很多key是相同的，所以需要大量的去比较这样效率就比较低。（一般不推荐枚举值就几个字段去建索引）</li>
<li>索引的长度不要太长(比较好费时间)，作为索引的时候在B+树里面作为一个key来存在的，主键索引一般使用自增的int值，因为int值很容易去比较，如果是字符串的时候去比较不同树之间结点key的时候，就需要做一个很长的比较。如果在字符串类型上面去做索引的话就一定要指定长度不能太长否则比较的时候就会耗费时间。<br>索引什么时候失效？<br>经常在编写代码时候出现慢查询问题，这说明很多时候索引没有使用对。<br>记忆口诀：模糊匹配、类型隐转、最左匹配，这三种情况可能导致索引会失效。</li>
</ol>
<p>以%开头的LIKE语句，模糊搜索。索引没有办法去利用，因为B+树的key没有办法再去直接比较，可以使用全文索引<br>出现隐式类型转换，需要注意参数类型跟SQL查询时候类型是不是一样的，因为两个类型不同没法比较（在 Python 这种动态语言查询中需要注意）<br>没有满足最左前缀原则（想想为什么是最左匹配？最左前缀原则，如果是多列索引的时候需要满足最左前缀才能利用上索引。</p>
<p>对于InnoDB引擎它的辅助索引，它的叶结点存储的是主键的值。然后再通过主键找到对应的数据。其实这是两个过程，这就是为什么在InnoDB引擎里面使用辅助索引要比直接使用主键索引慢一些的原因。<br>辅助索引先找到主键以后再根据主键找到数据</p>
<p>例如：多列索引有三个值a, b, c三个字段，如(a, b, c)。有两个key值(1, 2, 3) 和 (1, 2, 4)作比较，先比较第一个都是1相等，再比交第二个都是2相等，最后比较第三个3小于4 ，这时候就知道二叉树往哪个方向。假如不满足最左匹配就没有办法直接比较，如 (a,b,c), (a,b), (a)，这三种情况下都是可以使用索引的，但是(b,c)就不可以，因为连第一个比较的基准都没有，根本没有办法再往后比较了）<br>三种情况总结成一句话，当Mysql B+树的key没有办法去比较的时候，索引就会失效。</p>
<ol start="4">
<li><p>如果 MySQL估计使用索引比全表扫描更慢，会放弃使用索引<br>例如：表中只有100条数据左右。对于SQL语句WHERE id &gt; 1 AND id &lt; 100，MySQL会优先考虑全表扫描。</p>
</li>
<li><p>如果or前的条件中的列有索引，后面的没有，索引都不会被用到</p>
</li>
<li><p>列类型是字符串，查询时一定要给值加引号，否则索引失效<br>例如：列name varchar(16)，存储了字符串”100”<br>WHERE name = 100;<br>以上SQL语句能搜到，但无法用到索引。</p>
</li>
</ol>
<h3 id="创建索引的语法："><a href="#创建索引的语法：" class="headerlink" title="创建索引的语法："></a>创建索引的语法：</h3><p>首先创建一个表：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名(</span><br><span class="line">    ….</span><br><span class="line">    <span class="keyword">index</span> [索引名] (字段名)</span><br><span class="line">    ….</span><br><span class="line">);</span><br></pre></td></tr></tbody></table></figure>

<p>索引名一般是：表名_字段名<br>创建单个索引的语法：<br>法一：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> 索引名 <span class="keyword">on</span> 表名 (字段);</span><br></pre></td></tr></tbody></table></figure>
<p>法二：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">add</span> <span class="keyword">index</span> [索引名] (字段);</span><br></pre></td></tr></tbody></table></figure>

<p>给id创建索引：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> table_id <span class="keyword">on</span> <span class="keyword">table</span>(<span class="keyword">id</span>);</span><br></pre></td></tr></tbody></table></figure>

<p>创建联合索引的语法：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> 索引名 <span class="keyword">on</span> 表名（字段名<span class="number">1</span>，字段名<span class="number">2</span>）</span><br></pre></td></tr></tbody></table></figure>

<p>其中index还可以替换成unique，primary key，分别代表唯一索引和主键索引</p>
<p>show index from  表名;</p>
<p>删除索引：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">index</span> 索引名 <span class="keyword">on</span> 表名;</span><br></pre></td></tr></tbody></table></figure>


<blockquote>
<p>聚集还是非聚集指的是B+Tree 叶结点存的是指针还是数据记录</p>
</blockquote>
<p>MyISAM索引和数据分离，使用的是非聚集索引<br>在叶结点里面存储的是指向数据的指针，如叶结点5中存储的0x6A，指针指向的数据的表文件也就是数据文件，</p>
<p>为什么需要索引？是如何工作的<br>索引类似于书籍的目录，要想找到一本数的某个特定主题，<br>需要先查找书的目录，定位对应的页码可以找到内容<br>索引结构、存储引擎使用类似的方式进行数据查询，<br>先去索引文件当中找到对应的值，<br>然后根据匹配的索引找到对应的数据行</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> myisam_table (</span><br><span class="line">    <span class="string">`id`</span> <span class="built_in">INTEGER</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">     title <span class="built_in">VARCHAR</span>(<span class="number">80</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span> = MYISAM;   </span><br></pre></td></tr></tbody></table></figure>

<p>InnoDB引擎 数据文件就是索引文件，数据和索引存储在同一个文件<code>innodb_table.idb</code>的b+tree上面，Innodb中的主键索引就是聚集索引<br>存储方式</p>
<ul>
<li>共享表空间：一个表中数据和索引可以横跨多个文件，数据存储的大小限制不再是文件大小的限制，而是空间本身大小的限制，linux操作系统本身对文件大小起到了一定的限制作用。如果索引越多跟的当数据变化时要更新的索引文件也越多</li>
<li>单独表空间：每个表中数据以单独的文件进行存放，单表数据的限制成为操作系统中文件系统对文件大小的限制<br>为什么需要索引？是如何工作的<br>索引类似于逛超市，要想找到一本数的某个特定商品，<br>需要先查找大的区域，比如蔬菜区，水果区，相当于寻找索引，一个区域一个区域的检索<br>索引结构、存储引擎使用类似的方式进行数据查询，</li>
</ul>
<p>叶结点即存储 主键 同时也存储 数据表里面的内容，如叶结点15, 存储主键34和数据Bob。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> innodb_table (</span><br><span class="line">    <span class="string">`id`</span> <span class="built_in">INTEGER</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    <span class="string">`url_md5`</span> <span class="built_in">char</span>(<span class="number">32</span>),</span><br><span class="line">    <span class="keyword">KEY</span> <span class="string">`idx_url`</span> (<span class="string">`url_md5`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span> = <span class="keyword">InnoDB</span>;</span><br></pre></td></tr></tbody></table></figure>

<p>Innodb和myisam的区别<br>InnoDB支持事务，MyISAM不支持</p>
<ul>
<li>InnoDB支持外键，而MyISAM不支持</li>
<li>InnoDB是聚集索引，数据文件是和索引绑在一起的，必须要有主键，通过主键索引效率很高。<br>而MyISAM是非聚集索引，数据文件是分离的，索引保存的是数据文件的指针。主键索引和辅助索引是独立的。<br>InnoDB不保存表的具体行数，而MyISAM用一个变量保存了整个表的行数<br>InnoDB不支持全文索引，而MyISAM支持全文索引，查询效率上MyISAM要高；5.7 已经支持</li>
</ul>
<p>以下语句是否会应用索引？</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">users</span> </span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">YEAR</span>(adddate) &lt; <span class="number">2007</span>;</span><br></pre></td></tr></tbody></table></figure>
<p>不会，因为只要列涉及到运算，MySQL就不会使用索引。</p>
<h3 id="以下三条sql-如何建索引，只建一条怎么建？"><a href="#以下三条sql-如何建索引，只建一条怎么建？" class="headerlink" title="以下三条sql 如何建索引，只建一条怎么建？"></a>以下三条sql 如何建索引，只建一条怎么建？</h3><figure class="highlight routeros"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">WHERE <span class="attribute">a</span>=1 <span class="keyword">AND</span> <span class="attribute">b</span>=1</span><br><span class="line">WHERE <span class="attribute">b</span>=1</span><br><span class="line">WHERE <span class="attribute">b</span>=1 </span><br><span class="line">ORDER BY time DESC</span><br></pre></td></tr></tbody></table></figure>
<p>以顺序b,a,time建立联合索引，</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> table1_b_a_time <span class="keyword">ON</span> index_test01(b,a,<span class="built_in">time</span>)。</span><br></pre></td></tr></tbody></table></figure>

<p>mysql优化器会自动调整where条件中字段的前后顺序，对于上面的第一条sql，如果建立索引为idx_b_a(b,a)也是可以用到索引的，<br>不过建议where后的字段顺序和联合索引保持一致，养成好习惯。</p>
<p>考察的是组合索引和索引排序，至少得建两个吧，idx_a_b(a,b)和idx_b_time(b,time)<br>已知存在下例索引  KEY <code>companyIsdelete</code> (<code>companyId</code>,<code>isDelete</code>)<br>我交换顺序后的解析计划如下，还是用到了该索引 </p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from DB_Message9 where isDelete=1 and companyId=1234\G</span><br><span class="line">*************************** 1.row***************************           </span><br><span class="line">id: 1  </span><br><span class="line">select_type: SIMPLE        </span><br><span class="line">table: DB_Message9         </span><br><span class="line">type: ref</span><br><span class="line">possible_keys: companyIsdelete,companyAnswerUp,customertype,sender,sender2,noAssign          </span><br><span class="line">key: companyIsdelete      </span><br><span class="line">key_len: 6          </span><br><span class="line">ref: const,const         </span><br><span class="line">rows: 1        </span><br><span class="line">Extra: NULL1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>

<p>这三条查询中,b字段的查询频率最高,所以b字段要加入到索引中,多列索引中,索引的列顺序很重</p>
<p>问题19：有A(id,sex,par,c1,c2),B(id,age,c1,c2)两张表，其中A.id与B.id关联，现在要求写出一条SQL语句，将B中age&gt;50的记录的c1,c2更新到A表中同一记录中的c1,c2字段中<br>考点分析<br>这道题主要考察的是MySQL的关联UPDATE语句<br>延伸考点：</p>
<p>MySQL的关联查询语句<br>MySQL的关联UPDATE语句<br>针对刚才这道题，答案可以是如下两种形式的写法：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> A,B <span class="keyword">SET</span> A.c1 = B.c1, A.c2 = B.c2 <span class="keyword">WHERE</span> A.id = B.id</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> A <span class="keyword">INNER</span> <span class="keyword">JOIN</span> B <span class="keyword">ON</span> A.id=B.id <span class="keyword">SET</span> A.c1 = B.c1,A.c2=B.c2</span><br></pre></td></tr></tbody></table></figure>
<p>再加上B中age&gt;50的条件：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> A,B <span class="keyword">set</span> A.c1 = B.c1, A.c2 = B.c2 <span class="keyword">WHERE</span> A.id = B.id <span class="keyword">and</span> B.age &gt; <span class="number">50</span>;</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> A <span class="keyword">INNER</span> <span class="keyword">JOIN</span> B <span class="keyword">ON</span> A.id = B.id <span class="keyword">set</span> A.c1 = B.c1,A.c2 = B.c2 <span class="keyword">WHERE</span> B.age &gt; <span class="number">50</span></span><br></pre></td></tr></tbody></table></figure>

<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/pymysql-mysqlclient/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/pymysql-mysqlclient/" class="post-title-link" itemprop="url">pymysql mysqlclient</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-24 13:48:59" itemprop="dateModified" datetime="2021-05-24T13:48:59Z">2021-05-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>单独使用django的model,批量导入数据<br>这是因为 Django 在连接 MySQL 数据库时默认使用的是 MySQLdb 驱动， 然而我们没有安装该驱动， 因为它并不支持 Python3， 我们现在安装的是 PyMySQL 驱动， 如何让当前的 Django 通过 PyMySQL 来<br>连接 MySQL 数据库呢？ 方法很简单。在…/guest/<strong>init</strong>.py 目录下添加：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line">pymysql.install_as_MySQLdb()</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> MySQLdb  <span class="comment"># pip install mysqlclient</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 新建数据库链接</span></span><br><span class="line">db = MySQLdb.connect(</span><br><span class="line">    host=<span class="string">'127.0.0.1'</span>,</span><br><span class="line">    user=<span class="string">'root'</span>,</span><br><span class="line">    passwd=<span class="string">''</span>,</span><br><span class="line">    db=<span class="string">'fish_shop'</span></span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> MySQLdb</span><br><span class="line"><span class="keyword">import</span> bs4</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">conn = MySQLdb.connect(host=<span class="string">'1.2.3.4'</span>, port=<span class="number">3306</span>,</span><br><span class="line">                       user=<span class="string">'hellokitty'</span>, password=<span class="string">'Hellokitty.618'</span>,</span><br><span class="line">                       database=<span class="string">'zhihu'</span>, charset=<span class="string">'utf8'</span>,</span><br><span class="line">                       autocommit=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_to_db</span>(<span class="params">url, page, digest</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> conn.cursor() <span class="keyword">as</span> cursor:</span><br><span class="line">            cursor.execute(</span><br><span class="line">                <span class="string">'insert into tb_explore (url, page, digest) values (%s, %s, %s) '</span>,</span><br><span class="line">                (url, page, digest)</span><br><span class="line">            )</span><br><span class="line">    <span class="keyword">except</span> MySQLdb.MySQLError <span class="keyword">as</span> err:</span><br><span class="line">        print(err)</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> MySQLdb</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MysqlAPI</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, db_ip, db_name, db_password, table_name, db_charset</span>):</span></span><br><span class="line">        self.db_ip = db_ip</span><br><span class="line">        self.db_name = db_name</span><br><span class="line">        self.db_password = db_password</span><br><span class="line">        self.table_name = table_name</span><br><span class="line">        self.db_charset = db_charset</span><br><span class="line">        self.conn = MySQLdb.connect(host=self.db_ip,</span><br><span class="line">                                    user=self.db_name,</span><br><span class="line">                                    password=self.db_password,</span><br><span class="line">                                    db=self.table_name,</span><br><span class="line">                                    charset=self.db_charset)</span><br><span class="line">        self.cur = self.conn.cursor()</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line"><span class="comment">#连接mysql</span></span><br><span class="line">con = pymysql.connect(<span class="string">'localhost'</span>,<span class="string">'root'</span>,<span class="string">'123456'</span>,<span class="string">'db2'</span>,charset=<span class="string">'utf8'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建操作mysql的游标</span></span><br><span class="line">cur = con.cursor()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># 将所有需要事物的sql语句放在一个try里</span></span><br><span class="line">    sql1 = <span class="string">'insert into bank values("lili",500)'</span></span><br><span class="line">    sql2 = <span class="string">'insert into bank values("bob",1000)'</span>    </span><br><span class="line">  </span><br><span class="line">    <span class="comment">#执行  </span></span><br><span class="line">    cur.execute(sql1)</span><br><span class="line">    cur.execute(sql2)</span><br><span class="line">    <span class="comment">#提交</span></span><br><span class="line">    con.commit()</span><br><span class="line"><span class="comment">#异常    </span></span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">'-----rollback------'</span>)    </span><br><span class="line">    <span class="comment">#回滚</span></span><br><span class="line">    con.rollback()</span><br><span class="line"></span><br><span class="line"><span class="comment">#关闭游标</span></span><br><span class="line">cur.close()</span><br><span class="line"><span class="comment">#关闭连接mysql</span></span><br><span class="line">con.close()</span><br></pre></td></tr></tbody></table></figure>

<p>使用pymysql向数据表中添加数据，并记录时间戳</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment">#建立连接</span></span><br><span class="line">con = pymysql.connect(<span class="string">'mysql服务端ip'</span>,<span class="string">'用户'</span>,<span class="string">'该用户mysql密码'</span>,<span class="string">'库名'</span>,charset=<span class="string">'utf8'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#游标</span></span><br><span class="line">cur = con.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment">#准备200万条数据</span></span><br><span class="line">data_list = []</span><br><span class="line">t1 = time.time()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2000000</span>):</span><br><span class="line">    name = <span class="string">'Tom_%s'</span>(i)</span><br><span class="line">    data_list.append(name)</span><br><span class="line">t2 = time.time()</span><br><span class="line">print(<span class="string">'name is ready ! cost %s seconds'</span>%(t2 - t1))</span><br><span class="line"></span><br><span class="line">sql = <span class="string">'insert into students(name) value(%s)'</span></span><br><span class="line">cur.executemany(sql,data_list)</span><br><span class="line">con.commit()</span><br><span class="line"></span><br><span class="line">t3  =time.time()</span><br><span class="line">print(<span class="string">'insert is over !! cost %s seconds'</span>%(t3 - t2))</span><br><span class="line"></span><br><span class="line">cur.close()</span><br><span class="line">con.close()</span><br></pre></td></tr></tbody></table></figure>

<p>mysql中测试有索引查询和无索引查询的时间差异</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#开启运行时间检测</span></span><br><span class="line">show variables like <span class="string">'%pro%'</span>;</span><br><span class="line"><span class="comment">#若其中profiling显示off，执行下面命令开启一下</span></span><br><span class="line">set profiling=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#执行查询语句，查最后一个(无索引)</span></span><br><span class="line">select name <span class="keyword">from</span> students where name=<span class="string">'Tom_99999'</span>;</span><br><span class="line"><span class="comment">#查看执行时间</span></span><br><span class="line">show profiles;</span><br><span class="line"></span><br><span class="line"><span class="comment">#在name字段创建索引</span></span><br><span class="line"><span class="comment">#语法：create index 索引名(一般与字段名一样) on 表名(要加索引的字段)</span></span><br><span class="line">create index name on students(name);</span><br><span class="line"><span class="comment">#执行查询语句(有索引),可能Mysql开了查询缓存，你查另外一个值</span></span><br><span class="line">select name <span class="keyword">from</span> students where name=<span class="string">'Tom_88888'</span>;</span><br><span class="line"><span class="comment">#查看执行时间</span></span><br><span class="line">show profiles;</span><br><span class="line"></span><br><span class="line"><span class="comment">#关闭运行时间检测</span></span><br><span class="line">set profiling=<span class="number">0</span>;</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight scheme"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>```</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/pytest/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/pytest/" class="post-title-link" itemprop="url">pytest</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-24 05:24:50" itemprop="dateModified" datetime="2021-05-24T05:24:50Z">2021-05-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>官方文档 给出了 pytest 寻找 测试项 的 具体规则</p>
<ul>
<li>如果未指定命令行参数，则从 testpath（如果已配置）或当前目录开始收集。</li>
</ul>
<p>如果命令行参数， 指定了 目录、文件名 或 node id 的任何组合，则按参数来找</p>
<ul>
<li><p>寻找过程会递归到目录中，除非它们匹配上 norecursedirs。</p>
</li>
<li><p>在这些目录中，搜索由其测试包名称导入的 test_*.py 或 *_test.py 文件。</p>
</li>
<li><p>从这些文件中，收集如下测试项：</p>
</li>
</ul>
<ul>
<li>test为前缀 的 函数</li>
<li>Test为前缀的 类 里面的 test为前缀的方法</li>
</ul>
<p>我们编写的测试用例代码文件， 必须以 test_ 开头，或者以 _test 结尾<br>比如，我们创建一个 文件名为 test_错误登录.py ，<br>放在目录 autotest\cases\登录 下面。<br>其中 autotest 是 我们创建的 自动化项目根目录</p>
<p>如果我们把测试用例存放在类中， 类名必须以 Test 为前缀的 类 ，<br>用例对应的方法必须以 test 为前缀的方法。</p>
<p>pytest 中用例的检查点 直接用 Python 的 assert 断言。</p>
<p>assert 后面的表达式结果 为 True ，就是 检查点 通过，<br>结果为False ，就是检查点 不通过。</p>
<p>我们这里先快速给大家介绍 pytest 的基本用法， 就先用简单的 表达式演示一下，<br>后面的教程会有实际的测试代码 和 检查点。</p>
<p>#运行测试<br>执行测试非常简单，打开命令行窗口，<br>进入自动化项目根目录（我们这里就是 autotest），执行命令程序 pytest 即可<br>显示找到3个测试项，2个执行通过，1个不通过。</p>
<p>通过的用例 是用一个绿色小点表示， 不通过的用例用一个红色的F表示</p>
<p>并且会在后面显示具体不通过的用例 和不通过的检查点 代码细节。</p>
<ul>
<li><p>希望 显示测试代码中print的内容，因为这些打印语句在调试代码时很有用，可以加上命令行参数 -s</p>
</li>
<li><p>希望得到更详细的执行信息，包括每个测试类、测试函数的名字，可以加上参数 -v，这个参数可以和 -s 合并为 -sv</p>
</li>
</ul>
<p>指定一个模块执行</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pytest 路径\模块名.py -sv</span><br></pre></td></tr></tbody></table></figure>

<p>指定一个目录执行</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pytest 目录名<span class="number">1</span> 目录名<span class="number">2</span> -sv</span><br></pre></td></tr></tbody></table></figure>

<p>指定一个类执行</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pytest 路径\模块名.py::类名<span class="number">1</span> -sv</span><br></pre></td></tr></tbody></table></figure>

<p>指定一个类里面的方法执行</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pytest 路径\模块名.py::类名<span class="number">1</span>::方法名 -sv</span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python-datetime-mo-kuai/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python-datetime-mo-kuai/" class="post-title-link" itemprop="url">python datetime模块</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-23 09:01:35" itemprop="dateModified" datetime="2021-05-23T09:01:35Z">2021-05-23</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>DateTime模块<br>函数/变量  描述<br>timedelta对日期/时间进行加减操作时使用<br>date() 表示一个日期<br>datetime.strftime 将datetime对象格式化成字符串<br>datetime.strptime 将字符串按照一定的格式转换成datetime对象<br>time() 表示一个时间的类<br>datetime.now 系统的当前时间 当前记录的生成时间<br>datetime.now() 编译的时间<br>day datetime对象的属性，类似的还有minute，hour等<br>days Timedelta的属性，类似的还有minutes, hour等</p>
<p>datetime.today()得到当前日期时间，<br>datetime.now().day 当前月的第几天<br>datetime.today().time 当前时间</p>
<p>DateTime模块转换参数表参数含义<br>%A星期的名称，如Monday<br>%B月份名，如anuary<br>%m用数字表示的月份（01<del>12）<br>%d用数字表示月份中的一天（01～31）<br>%Y四位的年份，如2015<br>%y两位的年份，如15<br>%H 24小时制的小时数（00</del>23）%l12小时制的小时数（01<del>12）<br>%p am或pm<br>%M分钟数（00</del>59<br>%S秒数（00~61）</p>
<p>支持日期和时间算法的同时，实现的重点放在更有效的处理和格式化输出。</p>
<p>该模块还支持时区处理:</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, date</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># dates are easily constructed and formatted</span></span><br><span class="line">now_time = datetime.now()</span><br><span class="line"></span><br><span class="line">print(<span class="string">"now: {0}"</span>.format(now_time))</span><br><span class="line"><span class="comment"># now: 2021-02-15 17:11:14.226178</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当前的日期</span></span><br><span class="line">print(<span class="string">'now day: {0}'</span>.format(now_time.date()))</span><br><span class="line"><span class="comment"># now day: 2021-02-15</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当前的时间</span></span><br><span class="line">print(<span class="string">'now time: {0}'</span>.format(now_time.time()))</span><br><span class="line"><span class="comment"># now time: 17:11:14.226178</span></span><br><span class="line">print(<span class="string">'now day2: {0}'</span>.format(datetime.today()))</span><br><span class="line"><span class="comment"># now day2: 2021-02-15 17:11:14.226178</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'year: {0}'</span>.format(now_time.year))</span><br><span class="line"><span class="comment"># year: 2021</span></span><br><span class="line">print(<span class="string">'month: {0}'</span>.format(now_time.month))</span><br><span class="line"><span class="comment"># month: 2</span></span><br><span class="line">print(<span class="string">'day: {0}'</span>.format(now_time.day))</span><br><span class="line"><span class="comment"># day: 15</span></span><br><span class="line">print(<span class="string">'microsecond: {0}'</span>.format(now_time.microsecond))</span><br><span class="line"><span class="comment"># microsecond: 226178</span></span><br><span class="line">print(dir(now_time))</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">['__add__', '__class__', '__delattr__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__ne__', '__new__', '__radd__', '__reduce__', '__reduce_ex__', </span></span><br><span class="line"><span class="string">'__repr__', '__rsub__', '__setattr__', '__sizeof__', '__str__', '__sub__', '__subclasshook__', 'astimezone', 'combine', 'ctime', 'date', 'day', 'dst', 'fold', 'fromisocalendar', 'fromisoformat', 'fromordinal', 'fromtimestamp', 'hour', 'isocalendar', 'isoformat', 'isoweekday', 'max', 'microsecond', 'min', 'minute', 'month', 'now', 'replace', 'resolution', 'second', 'strftime', 'strptime', 'time', 'timestamp', 'timetuple','timetz', 'today', 'toordinal', 'tzinfo', 'tzname', 'utcfromtimestamp', 'utcnow', 'utcoffset', 'utctimetuple', 'weekday', 'year']</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># date</span></span><br><span class="line">now = date.today()</span><br><span class="line">print(now)</span><br><span class="line"><span class="comment"># 2021-02-15</span></span><br><span class="line">print(now.strftime(<span class="string">"%m-%d-%y. %d %b %Y is a %A on the %d day of %B."</span>))</span><br><span class="line"><span class="comment"># 02-15-21. 15 Feb 2021 is a Monday on the 15 day of February.</span></span><br><span class="line"><span class="comment"># dates support calendar arithmetic</span></span><br><span class="line">birthday = date(<span class="number">1997</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">age = now - birthday</span><br><span class="line">print(age.days)</span><br><span class="line"><span class="comment"># 8811</span></span><br><span class="line"></span><br><span class="line">d1 = datetime(<span class="number">2020</span>, <span class="number">6</span>, <span class="number">20</span>)  <span class="comment"># 第一个日期</span></span><br><span class="line">d2 = datetime(<span class="number">2020</span>, <span class="number">6</span>, <span class="number">21</span>)  <span class="comment"># 第二个日期</span></span><br><span class="line">interval = d2 - d1  <span class="comment"># 1 两日期差距</span></span><br><span class="line">print(interval.days)  <span class="comment"># 0 具体的天数</span></span><br><span class="line">print(interval.seconds)  <span class="comment"># 0 具体的秒数</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'------------------'</span>)</span><br><span class="line"><span class="comment"># 获取到毫秒数</span></span><br><span class="line">print(time.time())  <span class="comment"># 1613380274.227134</span></span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, date, time, timedelta</span><br><span class="line"></span><br><span class="line">str_ = <span class="string">'2019-9-10 8:10:56'</span></span><br><span class="line">str_date = datetime.strptime(str_, <span class="string">'%Y-%m-%d %H:%M:%S'</span>)</span><br><span class="line">print(str_date)</span><br><span class="line"><span class="comment"># 2019-09-10 08:10:56</span></span><br><span class="line"></span><br><span class="line">now = datetime.now()</span><br><span class="line">date_str = now.strftime(<span class="string">'%Y/%m/%d %H:%M:%S'</span>)</span><br><span class="line">print(date_str)</span><br><span class="line"><span class="comment"># 2021/02/15 17:28:16</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">'{:%Y-%m-%d %H:%M:%S}'</span>.format(datetime(<span class="number">2010</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">58</span>)))</span><br><span class="line"><span class="comment"># '2010-07-04 12:15:58'</span></span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python-logging/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python-logging/" class="post-title-link" itemprop="url">python logging</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-06-26 12:29:42" itemprop="dateModified" datetime="2021-06-26T12:29:42Z">2021-06-26</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Loggers<br>Logger 即记录器，是日志系统的入口。它有三个重要的工作：</p>
<p>向应用程序（也就是你的项目）公开几种方法，以便运行时记录消息<br>根据传递给 Logger 的消息的严重性，确定消息是否需要处理<br>将需要处理的消息传递给所有感兴趣的处理器 Handler<br>每一条写入 Logger 的消息都是一条日志记录，每一条日志记录都包含级别，代表对应消息的严重程度。常用的级别如下：</p>
<p>DEBUG：排查故障时使用的低级别系统信息，通常开发时使用<br>INFO：一般的系统信息，并不算问题<br>WARNING：描述系统发生小问题的信息，但通常不影响功能<br>ERROR：描述系统发生大问题的信息，可能会导致功能不正常<br>CRITICAL：描述系统发生严重问题的信息，应用程序有崩溃的风险<br>当 Logger 处理一条消息时，会将自己的日志级别和这条消息配置的级别做对比。如果消息的级别匹配或者高于 Logger 的日志级别，它就会被进一步处理，否则这条消息就会被忽略掉。</p>
<p>当 Logger 确定了一条消息需要处理之后，会把它传给 Handler。</p>
<p>Handlers<br>Handler 即处理器，它的主要功能是决定如何处理 Logger 中的每一条消息，比如把消息输出到屏幕、文件或者 Email 中。</p>
<p>和 Logger 一样，Handler 也有级别的概念。如果一条日志记录的级别不匹配或者低于 Handler 的日志级别，则会被 Handler 忽略。</p>
<p>一个 Logger 可以有多个 Handler，每一个 Handler 可以有不同的日志级别。这样就可以根据消息的重要性不同，来提供不同类型的输出。例如，你可以添加一个 Handler 把 ERROR 和 CRITICAL 消息发到你的 Email，再添加另一个 Handler 把所有的消息（包括 ERROR 和 CRITICAL 消息）保存到文件里。</p>
<p>Filters<br>Filter 即过滤器。在日志记录从 Logger 传到 Handler 的过程中，使用 Filter 来做额外的控制。例如，只允许某个特定来源的 ERROR 消息输出。</p>
<p>Filter 还被用来在日志输出之前对日志记录做修改。例如，当满足一定条件时，把日志级别从 ERROR 降到 WARNING 。</p>
<p>Filter 在 Logger 和 Handler 中都可以添加，多个 Filter 可以链接起来使用，来做多重过滤操作。</p>
<p>Formaters<br>Formatter 即格式化器，主要功能是确定最终输出的形式和内容。</p>
<p>日志记录配置<br>logging是一个python标准库<br>logging的四个部分（配置logging中很重要）：<br>    • logger——日志记录入口<br>logger的级别：<br>        ○ DEBUG：用于调试目的的底层系统信息<br>        ○ INFO: 普通的系统信息<br>        ○ WARNING： 警告，较小的问题，不影响执行顺序<br>        ○ ERROR: 错误，较大的问题<br>        ○ CRITICAL: 严重，致命的问题<br>logger记录内容：<br>        ○ django 记录所有内容<br>        ○ django.request 记录？（官方文档说是记录请求，但是使用后发现没有写入任何内容。。。<br>        ○ django.server 记录请求<br>        ○ django.template 记录与渲染模板相关的内容<br>        ○ django.db.backends 记录数据库操作<br>        ○ django.security.* 记录与安全相关的内容<br>    • Handler——决定处理logger中消息的方式<br>比如写入文件‘log_file’，控制台输出’console‘，发送邮件’mail_admins’等等<br>    • Filters——对日志进行条件控制<br>    • Formatters——日志记录的文本顺序（格式）<br>在view视图中写入logging的方法<br>确保切换到了debug模式，否则本地运行无法读取静态文件，服务器端运行则需要部署nginx。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import the logging library</span></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="comment"># Get an instance of a logger</span></span><br><span class="line"><span class="comment"># __name__对应django的记录模式，比如'django'等，也可以自定义，但是需要到设置中配置handler</span></span><br><span class="line">logger = logging.getLogger(__name__)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_view</span>(<span class="params">request, arg1, arg</span>):</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">if</span> bad_mojo:</span><br><span class="line">    <span class="comment"># Log an error message</span></span><br><span class="line">   logger.error(<span class="string">'Something went wrong!'</span>)</span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python-mongodb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python-mongodb/" class="post-title-link" itemprop="url">python mongodb</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-04 15:36:13" itemprop="dateModified" datetime="2021-05-04T15:36:13Z">2021-05-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p> pip3 install mongoengine</p>
<p>连接MongoDB</p>
<p> 方法一:简写</p>
<p> connect(‘students)</p>
<p> 方法二:指定端口和地址</p>
<p> connect(‘students’,host=’192.168.1.35’,port=27017)</p>
<p> 方法三:使用URI</p>
<p> connect(‘students’,host=’mongodb://localhost/students’)
 </p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python-random/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python-random/" class="post-title-link" itemprop="url">python random</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-09 09:32:48" itemprop="dateModified" datetime="2021-04-09T09:32:48Z">2021-04-09</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="random提供了生成随机数的工具"><a href="#random提供了生成随机数的工具" class="headerlink" title="random提供了生成随机数的工具"></a>random提供了生成随机数的工具</h2><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">print(random.choice([<span class="string">'apple'</span>, <span class="string">'pear'</span>, <span class="string">'banana'</span>]))</span><br><span class="line"><span class="comment"># 'apple'</span></span><br><span class="line">print(random.sample(range(<span class="number">100</span>), <span class="number">10</span>))  <span class="comment"># sampling without replacement</span></span><br><span class="line"><span class="comment"># [30, 83, 16, 4, 8, 81, 41, 50, 18, 33]</span></span><br><span class="line">print(random.random())  <span class="comment"># random float 0~1</span></span><br><span class="line"><span class="comment"># 0.17970987693706186</span></span><br><span class="line">print(random.randrange(<span class="number">6</span>))  <span class="comment"># random integer chosen from range(6)</span></span><br><span class="line"><span class="comment"># 4</span></span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python3-xin-zeng-de-yu-fa-he-nei-zhi-ku/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python3-xin-zeng-de-yu-fa-he-nei-zhi-ku/" class="post-title-link" itemprop="url">python3新增的语法和内置库</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-11 04:22:16" itemprop="dateModified" datetime="2021-04-11T04:22:16Z">2021-04-11</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>① <code>yield from</code> 链接子生成器<br>② <code>asyncio</code>内置库， async/await原生协程支持异步编程<br>③ 新的内置库<code>enum</code>枚举库, mock库做单测试mock掉一些网络接口,  <code>ipaddress</code>处理IP地址库, <code>concurrent.futures</code>并发相关库等<br>④ python3把生成的pyc文件统一放到<code>__pycache__</code>文件夹下面。<br>⑤ 一些内置库的修改。urllib, selector等<br>⑥ 性能优化等</p>
<h3 id="兼容2-3的工具"><a href="#兼容2-3的工具" class="headerlink" title="兼容2/3的工具"></a>兼容2/3的工具</h3><pre><code>six模块
2to3等工具转换代码
__future__
</code></pre>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python-man/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python-man/" class="post-title-link" itemprop="url">python慢</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-01 03:02:29" itemprop="dateModified" datetime="2021-05-01T03:02:29Z">2021-05-01</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>py代码主要是干什么事情。通常的处理如果是干一些文件操作，网络操作，和c++差距人都感知不出来。性能敏感的代码可以用c++做成库去调用。其实很多Python的库核心都是c语言c加加写的，然后Python去调用它。Python qt库也是这样。</p>
<p>处理邮件，自动收发，回复邮件；包括操纵文档、PPT，python表示分分钟整理完成。</p>
<p>金融行业的可以用来量化投资，数据清洗</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python-mo-kuai/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python-mo-kuai/" class="post-title-link" itemprop="url">python模块</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-18 02:12:05" itemprop="dateModified" datetime="2021-05-18T02:12:05Z">2021-05-18</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li>模块是对内部逻辑的<strong>封装</strong>，只对外提供<strong>接口</strong></li>
<li>一个py文件就是一个模块，模块的名称就是不含.py后缀的文件名<br><code>import</code>关键字导入一个模块</li>
</ul>
<p>◆可维护性更强◆方便代码重用<br>python中模块是包含变量、函数、……代码块的文件；<br>包是存放多个文件/模块的文件夹，可以统一组织和管理多个python模块；<br>标准的包结构中包含一个特殊的文件[_init_py]。<br>两者的区别：包是一个文件夹，可以包含多个文件/模块，模块是一个文件</p>
<p>什么叫反射？<br>给定一个对象，返回该对象的所有属性和函数列表，<br>或给定对象和该对象的函数或者属性的名字，返回对象的函数或者属性实例。<br>dir函数就是反射的实现，<br>dir()函数:如果要获得一个对象的所有属性和方法，<br>dir() 函数一个排好序的字符串列表，内容是一个模块里定义过的名字。<br>返回的列表容纳了在一个模块里定义的所有模块，变量和函数</p>
<p>help——查看类，方法的帮助信息<br>__name__—当前模块的名称<br>__file__——文件全路径</p>
<p>当你导入一个模块，Python 解析器对模块位置的搜索顺序是：<br>1、当前目录（包）<br>2、如果不在当前目录，Python 则搜索在 shell 变量 PYTHONPATH 下的每个目录。（内置函数）<br>3、如果都找不到，Python会察看默认路径。<br>模块搜索路径存储在 system 模块的 sys.path 变量中。变量里包含当前目录，PYTHONPATH和由安装过程决定的默认目录。（环境变量）<br>PYTHONPATH 变量作为环境变量，PYTHONPATH 由装在一个列表里的许多目录组成。PYTHONPATH 的语法和 shell 变量 PATH 的一样。</p>
<p>导入模块时，只需要写模块名<br>只导入模块名时，引用模块中的函数时，格式是模块名.函数名</p>
<p>包python package<br>◆可以用来组织模块（可以包含其它模块的模块），包是一个分层次的文件目录结构，它定义了一个由模块及子包，和子包下的子包等组成的 Python 的应用环境。<br>◆目录（文件夹）必须包含文件_init.py，, 该文件的内容可以为空。<strong>init</strong>.py 用于标识当前文件夹是一个包。<br>◆模块重名问题解决</p>
<p>包Package的引用<br>·引入整个包：import module,还要确保该模块所在包中的_init__.py模块，写入具体要引入的模块名。<br>·只是引入所需要的属性和方法：from module.xx.xx import xx<br>在<em>init</em>.py为空的前提下，包的引入有三种，分别是<br>from 包名 import 模块名、<br>from 包名.模块名 import 函数名、<br>import 包名.模块名，利用as可以给模块或包指定别名</p>
<p>◆指定别名，导入不同包同名模块：from module.xx.xx import xx as renename<br>·引入所有：from module.xx.xx import * 不推荐，需要什么导入什么<br>导入包的本质就是执行该包下的<strong>init</strong>.py文件</p>
<p>在引入目录Directory中内容时，只可以引入该目录的子目录中的内容，也可以手动为Directory添加<em>init</em>.py使之可以像包一样引用</p>
<p>函数/变量描述<br>argv命令行参数，包括脚本名<br>getcwd返回当前所在的目录<br>modules一个字典，将模块名映射到加载的模块<br>path一个列表，包含要在其中查找模块的目录的名称<br>platform一个平台标识符，如sunos5或win32</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/20/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><span class="page-number current">21</span><a class="page-number" href="/page/22/">22</a><span class="space">&hellip;</span><a class="page-number" href="/page/35/">35</a><a class="extend next" rel="next" href="/page/22/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">外心人D</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
