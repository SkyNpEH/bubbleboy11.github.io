<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"bubbleboy11.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.6.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:type" content="website">
<meta property="og:title" content="外心人D的博客">
<meta property="og:url" content="https://bubbleboy11.github.io/page/30/index.html">
<meta property="og:site_name" content="外心人D的博客">
<meta property="og:description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="外心人D">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://bubbleboy11.github.io/page/30/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/30/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>外心人D的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="外心人D的博客" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">外心人D的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">外心人D</p>
  <div class="site-description" itemprop="description">本博客大多内容为慕课和网上博客，并非原创</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">341</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



          </div>
        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/tan-xin/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/tan-xin/" class="post-title-link" itemprop="url">贪心</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-08-04 00:46:06" itemprop="dateModified" datetime="2021-08-04T00:46:06Z">2021-08-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>找零问题：假设商店老板需要找零n元钱，钱币的面额有：100元、50元、20元、5元、1元，如何找零使得所需钱币的数量最少？</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># greedy algorithm</span></span><br><span class="line"></span><br><span class="line">money = [<span class="number">100</span>,<span class="number">50</span>,<span class="number">20</span>,<span class="number">5</span>,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_money</span>(<span class="params">x</span>):</span></span><br><span class="line">    change = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i,m <span class="keyword">in</span> enumerate(money):</span><br><span class="line">        change[i] = x // money[i]</span><br><span class="line">        x = x % money[i]</span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        print(<span class="string">"还剩%s"</span> % x)</span><br><span class="line">    <span class="keyword">return</span> change</span><br><span class="line"></span><br><span class="line">print(change_money(<span class="number">356.2</span>))</span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/shen-fen-yun-suan-fu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/shen-fen-yun-suan-fu/" class="post-title-link" itemprop="url">身份运算符</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-09 02:05:27" itemprop="dateModified" datetime="2021-05-09T02:05:27Z">2021-05-09</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>身份运算符，比较两个变量的身份是否相等，内存地址<br>is x is y, 比较内存地址和值是否相等 是判断两个标识符是不是引用自一个对象<br>类似 id(x) == id(y) , 如果引用的是同一个对象则返回 True，否则返回 False<br>is not 判断两个标识符是不是引用自不同对象<br>x is not y ，类似 id(a) != id(b)。<br>如果引用的不是同一个对象则返回结果 True，否则返回 False。</p>
<p>is 与 == 区别：<br>is 用于判断两个变量引用对象是否为同一个，<br>== 用于判断引用变量的值是否相等。<br>===内容和格式相同<br>id()  返回唯一标识一个对象对象的内存地址</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">20</span></span><br><span class="line">b = <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (a <span class="keyword">is</span> b):</span><br><span class="line">    print(<span class="string">"1.a 和 b 有相同的标识"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"1.a 和 b 没有相同的标识"</span>)</span><br><span class="line"><span class="comment"># 1.a 和 b 有相同的标识</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (id(a) == id(b)):</span><br><span class="line">    print(<span class="string">"2.a 和 b 有相同的标识"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"2.a 和 b 没有相同的标识"</span>)</span><br><span class="line"><span class="comment"># 1.a 和 b 有相同的标识</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改变量 b 的值</span></span><br><span class="line">b = <span class="number">30</span></span><br><span class="line"><span class="keyword">if</span> (a <span class="keyword">is</span> b):</span><br><span class="line">    print(<span class="string">"3.a 和 b 有相同的标识"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"3.a 和 b 没有相同的标识"</span>)</span><br><span class="line"><span class="comment"># 3.a 和 b 没有相同的标识</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (a <span class="keyword">is</span> <span class="keyword">not</span> b):</span><br><span class="line">    print(<span class="string">"4.a 和 b 没有相同的标识"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"4.a 和 b 有相同的标识"</span>)</span><br><span class="line"><span class="comment"># 4.a 和 b 没有相同的标识</span></span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]  <span class="comment"># 创建了一个指引指向列表[1, 2, 3]，但是a不是列表</span></span><br><span class="line">b = a  <span class="comment"># 并没有复制a所指引的列表。我们只是创建了一个新的标签b，然后将其指向a所指向的列表。</span></span><br><span class="line">print(b <span class="keyword">is</span> a)  <span class="comment"># True</span></span><br><span class="line">print(b == a)  <span class="comment"># True</span></span><br><span class="line">b = a[:]</span><br><span class="line">print(a)  <span class="comment"># [1, 2, 3]</span></span><br><span class="line">print(b)  <span class="comment"># [1, 2, 3]</span></span><br><span class="line">print(b <span class="keyword">is</span> a)  <span class="comment"># False</span></span><br><span class="line">print(b == a)  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'------'</span>)</span><br><span class="line">list1 = [<span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="string">"python"</span>]</span><br><span class="line">list1ID = id(list1)</span><br><span class="line">list2 = list1</span><br><span class="line"><span class="comment"># 将list2也指向list1的内存地址，把list1所指的对象绑定到名字list2上，</span></span><br><span class="line"><span class="comment"># 两个名字指向同一个对象内存地址，那么修改list2也就修改了L；</span></span><br><span class="line">list2ID = id(list2)</span><br><span class="line">list3 = list1[:]</span><br><span class="line"><span class="comment"># 切片运算符[:]返回一个从列表首端开始到末端的切片，</span></span><br><span class="line"><span class="comment"># 切片过程是切下列表的一部分，创建新的列表(不同对象)，将切下的部分复制到新列表。</span></span><br><span class="line"><span class="comment"># 新列表对象绑定到list3指向新的内存地址</span></span><br><span class="line"><span class="comment"># 也就是list（指引的列表）的完整复制，但这不是复制列表的唯一方式</span></span><br><span class="line"><span class="comment"># list3则是不同的东西，修改list3不会改变list1</span></span><br><span class="line"><span class="comment"># 百分之九十的切片标记法都可以被list()代替。</span></span><br><span class="line"><span class="comment"># 下次你看见[:]的时候试试使用list()替代，这样可以让你的代码更加可读。</span></span><br><span class="line">list3ID = id(list3)</span><br><span class="line">print(list1ID)  <span class="comment"># 1245319965376</span></span><br><span class="line">print(list2ID)  <span class="comment"># 1245319965376</span></span><br><span class="line">print(list3ID)  <span class="comment"># 1245319800512</span></span><br><span class="line">list1[<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">print(list1)  <span class="comment"># [0, 1, 4, 5, 'python']</span></span><br><span class="line">print(list2)  <span class="comment"># [0, 1, 4, 5, 'python']</span></span><br><span class="line">print(list3)  <span class="comment"># [2, 1, 4, 5, 'python']</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意这个引用的概念对于所有的东西都成立，例如容器内部存储的都是引用</span></span><br><span class="line"><span class="comment"># 引用贯穿整个Python。如果你的list里套了个list，那么即使外层进行了copy，</span></span><br><span class="line"><span class="comment"># 也只是copy了一个引用集。</span></span><br><span class="line">inner = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">outer = [inner]</span><br><span class="line"><span class="comment"># 你复制了个outer，里面也不过是一个指向inner的引用。</span></span><br><span class="line">L = outer[:]  <span class="comment"># 只是复制了一个outer。</span></span><br><span class="line">L.append(<span class="number">1</span>)  <span class="comment"># 不会使得outer变为[[1,2,3],1]，</span></span><br><span class="line">L[<span class="number">0</span>].append(<span class="number">1</span>)  <span class="comment"># 却会直接修改L[0]指向的inner，</span></span><br><span class="line"><span class="comment"># 这样看起来似乎outer也改变了。</span></span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/yun-wei/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/yun-wei/" class="post-title-link" itemprop="url">运维</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-04 01:51:39" itemprop="dateModified" datetime="2021-05-04T01:51:39Z">2021-05-04</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>互联网运维职责</p>
<ul>
<li>资源管理：采购、规划、调度</li>
<li>变更部署：部署、变更、发布、回退</li>
<li>监控告警</li>
<li>故障响应</li>
</ul>
<p>“六大”运维发布策略</p>
<ul>
<li>重建部署<br>版本A下线后版本B上线  <ul>
<li>优点：<ul>
<li>便于设置</li>
<li>应用状态完整更新  </li>
</ul>
</li>
<li>缺点：<br>对用户影响很大，预期的宕机时间取决于下线时间和应用启动耗时</li>
</ul>
</li>
</ul>
<ul>
<li>滚动部署（增量发布）<br>版本B缓慢更新并替代版本A<ul>
<li>优点：<ul>
<li>便于设置</li>
<li>版本在实例间缓慢发布</li>
</ul>
</li>
<li>缺点：<ul>
<li>发布/回滚耗时</li>
<li>无法控制流量</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>蓝绿部署<br>版本B并行与版本A发布，然后流量切换到版本B</p>
<ul>
<li>优点：<ul>
<li>实时发布、回滚</li>
<li>避免版本冲突问题，整个应用状态统一一次切换</li>
</ul>
</li>
<li>缺点：<ul>
<li>比较昂贵因为需要双倍的资源</li>
<li>在释放版本到生产环境之前，整个平台的主流程测试必须执行</li>
</ul>
</li>
</ul>
</li>
<li><p>金丝雀部署<br>版本B向一部分用户发布，然后完全放开</p>
<ul>
<li>优点：<ul>
<li>版本面向一部分用户发布</li>
<li>方便错误评估和性能监控</li>
<li>快速回滚</li>
</ul>
</li>
<li>缺点：<ul>
<li>发布缓慢</li>
</ul>
</li>
</ul>
</li>
<li><p>A/B部署(灰度)<br>版本B只向特定条件的用户发布</p>
<ul>
<li>优点：<ul>
<li>多个版本并行运行</li>
<li>完全控制流量分布</li>
</ul>
</li>
<li>缺点：<ul>
<li>需要智能负载均衡，配置算法复杂</li>
<li>资源占用</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>影子部署<br>版本B接受真实的流量请求，但是不产生响应<ul>
<li>优点：<ul>
<li>可以使用生产环境流量进行性能评估</li>
<li>对用户无影响</li>
<li>直到应用的稳定性和性能满足要求后才发布</li>
</ul>
</li>
<li>缺点：<ul>
<li>双倍资源，成本昂贵</li>
<li>不是真实用户测试，可能出现误导</li>
<li>配置复杂</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="发布策略的选择"><a href="#发布策略的选择" class="headerlink" title="发布策略的选择"></a>发布策略的选择</h3><ul>
<li> 实际采用哪种方式取决于需求和预算</li>
<li> 蓝绿、金丝雀、AB和影子部署对预算有更高的要求，因为需要双倍资源</li>
<li> 缺乏测试或者对软件的功能和稳定性影响缺乏信心，那么可以使用金丝雀部署或者AB部署或者影子部署</li>
</ul>
<p>阿里发布方式</p>
<ul>
<li> 在结合不同应用情况选择不同发布策略的基础之上，增加了“分批发布”及“智能化无人值守发布”</li>
<li> 分批发布简单来说就是按照一定的批次，每次只对服务的一部分实例进行升级，是升级版的滚动部署</li>
<li> 无人值守发布则是在发布过程中，减少人力成本同时自动检测发布风险，拦截异常发布的方式</li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/jin-zhi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/jin-zhi/" class="post-title-link" itemprop="url">进制</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-06-29 01:43:12" itemprop="dateModified" datetime="2021-06-29T01:43:12Z">2021-06-29</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">操作系统</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="学习二进制、八进制和十六进制的意义"><a href="#学习二进制、八进制和十六进制的意义" class="headerlink" title="学习二进制、八进制和十六进制的意义"></a>学习二进制、八进制和十六进制的意义</h3><p>二进制是硬件底层实现的基础。<br>编译的程序也是以二进制存储的。<br>其实为什么是八进制和十六进制而不是十进制很容易理解： 计算机的世界是和2相关，人类的世界是和10相关</p>
<p>总结：十进制主要运用于日常生活当中，而二进制、八进制、十六进制主要运用于电子技术行业，二进制是数字电路、处理器等最直接的语言，八进制、十六进制由于有着方便转化记录的意义而使用，如今更多的是十六进制进行存储记忆，八进制较少使用，比如处理器里的寄存器、存储器的地址、数据都是使用十六进行进行表示。</p>
<p>十六进制是方便查看的，本质上还是将二进制的数据以十六进制显示出来。为什么不使用二进制来显示，因为二进制显示出来很不方便查看。</p>
<p>电路中只能进行二进制逻辑运算，所以二进制是基础中的基础。之所以使用16进制，我认为是因为现在的通常情况下每8bit为一个字节，而16进制里一位数正好能表示一个字节，虽说本质上还是二进制代码，但16进制表示的话也更便于查看和修改。</p>
<p>就拿最简单的RGB颜色来说，调成黑色或者白色的话16进制直接用#000或者#FFF就能表示，改用二进制还得打24个0或者24个1，看上去就复杂不少还容易出错</p>
<p>二进制实际上在计算机中是通过补码表示的，我们看到的各种二进制实际上都是给我们能看懂的，对于计算机来说补码更加实用。</p>
<p>在计算机的世界里，只有0和1，也就是二进制。计算机底层运算的时候操作的是二进制，</p>
<p>那如何把一个十进制的数转成二进制或者其他进制，请下图：</p>
<p>八进制： 3个二进制位最多能表示0-7共8个数字，基数为8，加法运算时逢八进一，减法运算时借一当八。例如，数字 0、1、5、7、14、733、67001、25430 都是有效的八进制。</p>
<p>二进制是机器能够识别的最直接语言，但是二进制位数太多，不方便记录，所以一般把二进制转化为八进制或十六进制。为什么不直接把二进制转化为十进制呢？因为二进制转化为十进制较麻烦，不够直观，而二进制转化为八进制或十六进制十分方便，3位二进制可转化为1位八进制，4位二进制可转化为1位十六进制，比如二进制111转化为八进制7，二进制1111转化为十六进制F。只有3位或4位二进制转化为十进制还是比较容易，但是如果多位二进制呢？就很麻烦了，比如二进制1111111111111111转化为十进制，很难秒算出来，需要借助计算器，但是转化为十六进制就不一样了，四位四位二进制合并为一位十六进制就可以了，即二进制（1111111111111111）=十六进制（FFFF），一目了然很方便，只要记住下图16个二进制转化为十六进制的数字即可。</p>
<p>十六进制表示：包括0-9的数字，及字母a-f，A-F，a 或者 A 表示10，B表示11，C表示12，D表示13，E表示14，F表示15，因此有  0~F 共16个数字，基数为16，加法运算时逢16进1，减法运算时借1当16。例如，数字  0、1、6、9、A、D、F、419、EA32、80A3、BC00 都是有效的十六进制。<br>4个二进制位能表示0-15共16个数，<br>就是为了简洁。例如一个16位的二进制数1010010111001011，无论写起来还是读起来，很费事儿，还容易出错，写成十六进制数A5CD，就方便多了，也不容易出错。</p>
<p>Python 中浮点数的运算存在误差</p>
<p>当带小数点的十进制转换成二进制的时候可能存在小数部分乘不尽的情况</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">1.2</span> - <span class="number">1.0</span>)  <span class="comment"># 0.19999999999999996</span></span><br><span class="line">print(<span class="number">0.1</span> + <span class="number">0.2</span>)  <span class="comment"># 0.30000000000000004</span></span><br><span class="line">print(<span class="number">0.1</span> + <span class="number">2</span>)  <span class="comment"># 2.1</span></span><br><span class="line">print(<span class="number">0.1</span> * <span class="number">2</span>)  <span class="comment"># 0.2</span></span><br><span class="line"></span><br><span class="line">print(<span class="number">1.2</span> - <span class="number">1.0</span> == <span class="number">0.2</span>)  <span class="comment"># False</span></span><br><span class="line">print(type(<span class="number">2</span> / <span class="number">2</span>))  <span class="comment"># &lt;class 'float'&gt;</span></span><br><span class="line"></span><br><span class="line">print(float(<span class="number">1</span>))   <span class="comment"># 1.0</span></span><br></pre></td></tr></tbody></table></figure>

<p>python中<code>0b</code>(数字0和小写字母B前缀)代表二进制数字</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">0b101</span>)  <span class="comment"># 5</span></span><br><span class="line">print(<span class="number">0b11</span>)  <span class="comment"># 3</span></span><br></pre></td></tr></tbody></table></figure>

<p>java中以<code>0</code>开头代表八进制数字，如：037，056<br>python中<code>0o</code>(数字0和小写字母O前缀)代表八进制数字，</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">0o11</span>)  <span class="comment"># 9</span></span><br><span class="line">print(<span class="number">0o110</span>)  <span class="comment"># 72</span></span><br></pre></td></tr></tbody></table></figure>

<p>java中以<code>0x</code>或<code>0X</code>开头代表十六进制数字，如：0x12，0xabcf，0XABCF<br>python中<code>0x</code>(数字0和小写字母X前缀)代表十六进制数字</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">0x101</span>)  <span class="comment"># 257</span></span><br><span class="line">print(<span class="number">0x1F</span>)  <span class="comment"># 31</span></span><br><span class="line">print(<span class="number">0x1f</span>)  <span class="comment"># 31</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>int()</code> 代表不同类型数据转换为10进制数字</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 字符串转int</span></span><br><span class="line"></span><br><span class="line">data = <span class="string">"11"</span></span><br><span class="line">int_data = int(data)  <span class="comment"># 默认10进制</span></span><br><span class="line">print(type(int_data), int_data)  <span class="comment"># &lt;class 'int'&gt; 11</span></span><br><span class="line">int_data = int(data, <span class="number">16</span>)  <span class="comment"># 16进制</span></span><br><span class="line">print(type(int_data), int_data)  <span class="comment"># &lt;class 'int'&gt; 17</span></span><br><span class="line"></span><br><span class="line">data = <span class="string">"21"</span></span><br><span class="line">int_data = int(data)  <span class="comment"># 默认10进制</span></span><br><span class="line">print(type(int_data), int_data)  <span class="comment"># &lt;class 'int'&gt; 21</span></span><br><span class="line">int_data = int(data, <span class="number">16</span>)  <span class="comment"># 16进制</span></span><br><span class="line">print(type(int_data), int_data)  <span class="comment"># &lt;class 'int'&gt; 33</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. int转字符串</span></span><br><span class="line">data_str = str(int_data)</span><br><span class="line">print(type(data_str), data_str)  <span class="comment"># &lt;class 'str'&gt; 33</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. float类型转换</span></span><br><span class="line">data_float = float(<span class="string">"3.1415"</span>)</span><br><span class="line">print(type(data_float), data_float)  <span class="comment"># &lt;class 'float'&gt; 3.1415</span></span><br><span class="line"></span><br><span class="line">float_str = str(data_float)</span><br><span class="line">print(type(float_str), float_str)  <span class="comment"># &lt;class 'str'&gt; 3.1415</span></span><br></pre></td></tr></tbody></table></figure>


<p><code>oct()</code>  代表不同类型数据转换为8进制数字</p>
<p><code>hex(x)</code>，将不同类型进制整数转换为以“0x”为前缀的小写十六进制数的字符串。如果 x 不是 Python int 对象，则必须定义返回整数的 <code>__index__()</code> 方法。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">print(hex(<span class="number">1</span>))  <span class="comment"># 0x1 补码</span></span><br><span class="line">print(hex(<span class="number">-1</span>))  <span class="comment"># -0x1 负号 + 原码 （Python 特色，Java 会直接输出补码）</span></span><br><span class="line"></span><br><span class="line">print(hex(<span class="number">3</span>), type(hex(<span class="number">3</span>)))  <span class="comment"># 0x3 &lt;class 'str'&gt;</span></span><br><span class="line">print(int(<span class="string">'3'</span>, <span class="number">16</span>), type(int(<span class="string">'3'</span>, <span class="number">16</span>)))  <span class="comment"># 3 &lt;class 'int'&gt;</span></span><br><span class="line">print(hex(<span class="number">0b11</span>))  <span class="comment"># 0x3  将2进制数字转换为2=16进制</span></span><br></pre></td></tr></tbody></table></figure>

<p>如果要将整数转换为大写或小写的十六进制字符串，并可选择有无“0x”前缀，则可以使用如下方法：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'%#x'</span> % <span class="number">3</span>, <span class="string">'%x'</span> % <span class="number">3</span>, <span class="string">'%X'</span> % <span class="number">3</span>, )</span><br><span class="line"><span class="comment"># 0x3 3 3</span></span><br><span class="line"></span><br><span class="line">print(format(<span class="number">3</span>, <span class="string">'#x'</span>), format(<span class="number">3</span>, <span class="string">'x'</span>), format(<span class="number">3</span>, <span class="string">'X'</span>))</span><br><span class="line"><span class="comment"># 0x3 3 3</span></span><br><span class="line">print(f'{3:#x}', f'{3:x}', f'{3:X}')</span><br><span class="line"><span class="comment"># 0x3 3 3</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'%#x'</span> % <span class="number">-3</span>, <span class="string">'%x'</span> % <span class="number">-3</span>, <span class="string">'%X'</span> % <span class="number">-3</span>, )</span><br><span class="line"><span class="comment"># -0x3 -3 -3</span></span><br><span class="line"></span><br><span class="line">print(format(<span class="number">-3</span>, <span class="string">'#x'</span>), format(<span class="number">-3</span>, <span class="string">'x'</span>), format(<span class="number">-3</span>, <span class="string">'X'</span>))</span><br><span class="line"><span class="comment"># -0x3 -3 -3</span></span><br><span class="line">print(f'{-3:#x}', f'{-3:x}', f'{-3:X}')</span><br><span class="line"><span class="comment"># -0x3 -3 -3</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>bin(x)</code> 将一个不同类型进制整数转变为一个前缀为“0b”的二进制数的字符串。结果是一个合法的 Python 表达式。<br>如果 x 不是 Python 的 <code>int</code> 对象，那它需要定义 <code>__index__()</code> 方法返回一个整数。<br>bin一个正数（十进制表示），输出的是它的原码的二进制表示<br>bin一个负数（十进制表示），输出的是它的原码的二进制表示加上个负号，而不是补码的形式。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(bin(<span class="number">3</span>), type(bin(<span class="number">3</span>)))  <span class="comment"># 0b11 &lt;class 'str'&gt;</span></span><br><span class="line">print(bin(<span class="number">-3</span>))  <span class="comment"># -0b11</span></span><br></pre></td></tr></tbody></table></figure>

<p>对数值进行与操作就获得补码形式的二进制表示</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">print(bin(<span class="number">5</span>))</span><br><span class="line"><span class="comment"># 0b101</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">-5</span>))</span><br><span class="line"><span class="comment"># -0b101</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">-5</span> &amp; <span class="number">0b1111</span>))  </span><br><span class="line"><span class="comment"># 0b1011</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">-5</span> &amp; <span class="number">0b11111</span>))  </span><br><span class="line"><span class="comment"># 0b11011</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">-5</span> &amp; <span class="number">0b1111111111111111</span>))</span><br><span class="line"><span class="comment"># 0b1111111111111011</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># bin一个负数（十六进制表示），输出的是对应的二进制表示。</span></span><br><span class="line">print(bin(<span class="number">-3</span> &amp; <span class="number">0xffffffff</span>))</span><br><span class="line"><span class="comment"># 0b11111111111111111111111111111101</span></span><br><span class="line">print(bin(<span class="number">0xfffffffd</span>))</span><br><span class="line"><span class="comment"># 0b11111111111111111111111111111101</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">-3</span> &amp; <span class="number">0b111</span>))</span><br><span class="line"><span class="comment"># 0b101</span></span><br><span class="line">print(bin(<span class="number">-3</span> &amp; <span class="number">0b1111111111111111</span>))</span><br><span class="line"><span class="comment"># 0b1111111111111101</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">0o7</span>))  <span class="comment"># 0b111 将8进制数字转换为2进制</span></span><br><span class="line">print(bin(<span class="number">0xE</span>))  <span class="comment"># 0b1110 将16进制数字转换为2进制</span></span><br></pre></td></tr></tbody></table></figure>

<p>If prefix “0b” is desired or not, you can use either of the following ways.<br>如果不一定需要前缀“0b”，还可以使用如下的方法。<br>用format字符串获取一个int的binary表示：<br><code>f"{a:b}"</code>：将a转换成binary的str。<br><code>f"{a:030b}"</code>：将a转换成binary的str，并在前面补0使其总位数是30。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">format(<span class="number">14</span>, <span class="string">'#b'</span>), format(<span class="number">14</span>, <span class="string">'b'</span>)</span><br><span class="line"><span class="comment"># ('0b1110', '1110')</span></span><br><span class="line">f'{14:#b}', f'{14:b}'</span><br><span class="line"><span class="comment"># ('0b1110', '1110')</span></span><br></pre></td></tr></tbody></table></figure>

<p>4bit有符号整型， 其数值范围为[-8， 7]<br>-2 + 3 可以通过补码计算 1110 + 0011 =(1) 0001</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span></span><br><span class="line">+   <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">-----------</span><br><span class="line">(<span class="number">1</span>) <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> # 注意溢出</span><br></pre></td></tr></tbody></table></figure>

<p>python 由于不知道符号位具体是第几位，因此需要进行的操作是</p>
<ol>
<li>将输入数字转化成无符号整数</li>
<li>计算无符号整数相加并的到结果</li>
<li>讲结果根据范围判定，映射为有符号整型</li>
</ol>
<p>转化为4bit无符号整数</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a &amp;= <span class="number">0xF</span> <span class="comment"># a = a &amp; 0b1111 = 1110 = 14</span></span><br><span class="line">b &amp;= <span class="number">0xF</span> <span class="comment"># b = 0011 = 3</span></span><br></pre></td></tr></tbody></table></figure>

<p>原码：直接将一个数值转化为二进制，其首位代表符号，<code>0</code> 为正， <code>1</code> 为负<br>正数：原码 = 反码 = 补码<br>负数反码：原码最高位符号位不变，其余为取反<br>负数补码：负数反码+1，即 符号位不变，各位取反再加 1</p>
<h4 id="补码特性"><a href="#补码特性" class="headerlink" title="补码特性"></a>补码特性</h4><p>1、一个负整数（或原码）与其补数（或补码）相加，和为模。<br>2、对一个整数的补码再求补码，等于该整数自身。<br>3、补码的正零与负零表示方法相同</p>
<ul>
<li>Python 负数的存储：<ul>
<li>获取负数的补码：<br>将整数与 0xffffffff 相与，<br>可理解为该数从 32 位开始到最高位全部置零，最高位为0为正数<br>从无限长度变为一个 32 位内二进制可以表示的正整数<br>一直循环左移并不会存在溢出的现象，模拟其他语言的32位溢出机制。<br>一个负整数（或原码）与其补数（或补码）相加，和为模。2 的32 次方 是模。<br>那么就是 2 的32 次方 然后 + n  这是在取一个负数的补码<br>就相当于  n &amp; 0xffffffff<br>高位第一位的数字取决于此数字是正数还是负数，是正数则为 0 ，是负数则为 1</li>
</ul>
</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(hex(<span class="number">1</span> &amp; <span class="number">0xffffffff</span>))  <span class="comment"># 0x1 正数补码</span></span><br><span class="line">print(hex(<span class="number">-1</span> &amp; <span class="number">0xffffffff</span>))  <span class="comment"># 0xffffffff 负数补码</span></span><br><span class="line">print(<span class="number">-1</span> &amp; <span class="number">0xffffffff</span>)  <span class="comment"># 4294967295（Python 将其认为正数）</span></span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>返回前数字还原 补码转原码：<br>若补码 a 为负数（第 32位是 1），<br>a ^ 0xffffffff 运算将 1 至 32 位按位取反；<br>~ 运算是将所有位的数字会取反；<br>因此， ~(a ^ 0xffffffff) 是将低的 1 至 32 位不变。<br>32 位以上的位取反，即 32位以上所有位全部置 1了，<br>对于32位的数字来说最高位是1则说明此数为负数<br>把这个负数补码恢复到 超过32位的 python 存储负数的形式，</li>
</ul>
<p>如果不对负数特殊处理，那么负数的前32位里的最高位还可能存在 0，最后输出的是大于32位的正数</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/di-gui/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/di-gui/" class="post-title-link" itemprop="url">递归</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-08-04 00:45:40" itemprop="dateModified" datetime="2021-08-04T00:45:40Z">2021-08-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>“””<br>在递归过程中，，函数可能会有多个位置将自身作为子例程调用<br>每当递归函数调用自身时，它都会将给定的问题拆解为子问题。<br>递归调用继续进行，直到到子问题无需进一步递归就可以解决的地步。</p>
<p>为了确保递归函数不会导致无限循环，它应具有以下属性：</p>
<ul>
<li>一个简单的基本案例（basic case）（一般情况），<br>能够不使用递归来产生答案的终止方案，必须要有终止条件，</li>
<li>一组规则，也称作递推关系（recurrence relation），可将所有其他情况拆分到基本案例。<br>不断调用自身，直到遇到终止条件后进行回溯，最终返回答案。</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span>(<span class="params">x</span>):</span></span><br><span class="line">    print(x)</span><br><span class="line">    func1(x - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        print(x)</span><br><span class="line">        func2(x + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func3</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        print(x)</span><br><span class="line">        func3(x - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func4</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        func4(x - <span class="number">1</span>)</span><br><span class="line">        print(x)</span><br></pre></td></tr></tbody></table></figure>
<p>func3和func4是递归，x为正整数，func3会连续输出x到1，func4会输出1 到x</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printReverse</span>(<span class="params">str</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> str:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    printReverse(str+<span class="number">1</span>)</span><br><span class="line">    print()</span><br></pre></td></tr></tbody></table></figure>

<p>python 自带求和<code>sum()</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(sum(range(<span class="number">1</span>, <span class="number">11</span>)))  <span class="comment"># 55</span></span><br></pre></td></tr></tbody></table></figure>

<p>高斯求和</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 循环</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum_number</span>(<span class="params">n</span>):</span></span><br><span class="line">    total = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">        total += i</span><br><span class="line">    <span class="keyword">return</span> total</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(sum_number(<span class="number">10</span>))  <span class="comment"># 5</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 递归</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum_number</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> n + sum_number(n - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(sum_number(<span class="number">10</span>))  <span class="comment"># 55</span></span><br></pre></td></tr></tbody></table></figure>

<p>基本情况：sum_number(0) = 0<br>其它情形: sum_number(n) = n + sum_number</p>
<p>sum_number(n-1)又是一次sum_number函数的调用，<br>不过参数的值变成了n-1，<br>要得sum_number(n)到的值就必须等待sum_number(n-1)的值被计算出来，<br>同样要得到sum_number(n-1)的值必须等待sum_number(n-2)的值，<br>如此一路推算下去，直到sum_number(0)，<br>因为if语句的存在，它不需要等待sum_number(-1)的计算了，而是直接给出结果0。<br>参数值由 10 9 8 7 6 5 4 3 2 1 0<br>sun_number(1)=1+sun_number(0)=1<br>sun_number(2)=2+sun_number(1)=2+1+sun_number(0)=2+1+0=3<br>sun_number(3)=3+sun_number(2)=3+3=6<br>….<br>然后程序一路返回，直到回到最初的sum_number(n)，并给出最终结果。<br>“””</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 求阶乘</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">F</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">or</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="comment"># 对应基本情形</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> F(n - <span class="number">1</span>) * n  <span class="comment"># 对应递归情形</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(F(<span class="number">4</span>))  <span class="comment"># 24</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string"> F(0) = 1, F(1) = 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">其它情形: F(n) = F(n-1) * n</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算s=a+aa+aaa+aaaa+aa...a，其中 a是一个数字。</span></span><br><span class="line"><span class="comment"># 例如2+22+222+2222+22222(此时共有5个数相加)，几个数相加由键盘控制。</span></span><br><span class="line"><span class="comment"># 其中，a 以及 n 由用户输入，但是我们在这里就直接给定了。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sss</span>(<span class="params">a, n</span>):</span></span><br><span class="line">    <span class="comment"># 这里我说明一下，直接用input函数得到的就是字符串，除非你已经做了转换</span></span><br><span class="line">    <span class="comment"># 所以,我们设定a、n都是字符串</span></span><br><span class="line">    n = int(n)  <span class="comment"># 转换</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> int(a)</span><br><span class="line">    <span class="keyword">return</span> sss(a, n - <span class="number">1</span>) + int(a * n)  <span class="comment"># 请思考这里a*n</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">"""基本情形：sss(a, 1) = a</span></span><br><span class="line"><span class="string">sss(a, 2) = a+aa=sss(a, 1)+aa</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">其它情形:</span></span><br><span class="line"><span class="string">sss(a, n) = sss(a, n-1) + a...a(共n项)""</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">print(sss(<span class="string">'2'</span>, <span class="string">'1'</span>))  <span class="comment"># 2</span></span><br><span class="line">print(sss(<span class="string">'2'</span>, <span class="string">'2'</span>))  <span class="comment"># 24</span></span><br><span class="line">print(<span class="string">'-----'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line">n = int(input(<span class="string">"请输入层数n："</span>))  <span class="comment"># &lt;class 'int'&gt;</span></span><br><span class="line">a = int(input(<span class="string">"请输入数字a："</span>))  <span class="comment"># &lt;class 'int'&gt;</span></span><br><span class="line"></span><br><span class="line">Tn = <span class="number">0</span>  <span class="comment"># 初始化数字叠加后的值</span></span><br><span class="line">Sn = []  <span class="comment"># 创建一个空列表，以便接收叠加后的数值</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(n):  <span class="comment"># 此处的循环表示，n为几，i就循环几次，</span></span><br><span class="line">    <span class="comment"># 也就是，层数为几，下面的循环体就执行几次</span></span><br><span class="line">    Tn = Tn + a  <span class="comment"># 将循环的值赋值给Tn</span></span><br><span class="line">    <span class="comment"># print("数字叠加后值为：", Tn)  # 打印出数字叠加后的值</span></span><br><span class="line">    Sn.append(Tn)  <span class="comment"># 将数字叠加后的值依次添加到Sn这个空的列表中</span></span><br><span class="line">    <span class="comment"># print("创建的数列为：", Sn)  # 打印出列表Sn中的所有值</span></span><br><span class="line">    a = a * <span class="number">10</span>  <span class="comment"># 为下一个数做循环准备</span></span><br><span class="line">print(<span class="string">"创建的数列为："</span>, Sn)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 法一</span></span><br><span class="line"><span class="comment"># sum_ = reduce(lambda x, y: x + y, Sn)  # 计算Sn的值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 法二</span></span><br><span class="line">sum_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Sn:</span><br><span class="line">    sum_ += i</span><br><span class="line">print(<span class="string">"计算的和为："</span>, sum_)  <span class="comment"># 打印出Sn的值</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = input(<span class="string">"a:"</span>)  <span class="comment"># &lt;class 'str'&gt;</span></span><br><span class="line">n = int(input(<span class="string">"n:"</span>))  <span class="comment"># &lt;class 'int'&gt;</span></span><br><span class="line">ls = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">    ls.append(i * a)  <span class="comment"># 字符串乘一个数</span></span><br><span class="line">sum = <span class="number">0</span></span><br><span class="line">print(ls)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ls:</span><br><span class="line">    sum += eval(i)  <span class="comment"># 字符串表达式</span></span><br><span class="line">print(sum)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getNum</span>(<span class="params">a, count</span>):</span></span><br><span class="line">    list1 = []</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    a = str(a)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, count + <span class="number">1</span>):</span><br><span class="line">        list1.append(int(a * i))</span><br><span class="line">        print(list1[i - <span class="number">1</span>], end=<span class="string">" "</span>)</span><br><span class="line">        <span class="keyword">if</span> i &lt; count:</span><br><span class="line">            print(<span class="string">"+"</span>, end=<span class="string">" "</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> list1:</span><br><span class="line">        res += j</span><br><span class="line">    print(<span class="string">"="</span>, res)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">getNum(<span class="number">2</span>, <span class="number">2</span>)  <span class="comment"># 2 + 22 = 24</span></span><br></pre></td></tr></tbody></table></figure>

<p>判断用户输入的数组的逆序数。<br>定义：OP(seq, n)为序列seq中前n项的逆序数</p>
<p>基本情形:<br>OP(seq[1…n], 1) = 0，对于只有一个元素的集合，逆序数必然只有0<br>其它情形:<br>OP(seq[1…n], n) = OP(seq[1…n, n-1] + F(n)，其中，F(n)是n关于seq[1…n-1]的逆序数.</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">OP</span>(<span class="params">seq, n</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="comment"># 不为0</span></span><br><span class="line">    Fn = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> seq[n - <span class="number">1</span>] &lt; seq[i]:</span><br><span class="line">            Fn += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> OP(seq, n - <span class="number">1</span>) + Fn</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = [<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">print(OP(s, len(s)))  <span class="comment"># 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># n=5 n-1-1=3</span></span><br><span class="line"><span class="comment"># 当i=0,seq[4]=1&lt;seq[0]=5</span></span><br><span class="line"><span class="comment"># 当i=1,seq[4]=1&lt;seq[1]=4</span></span><br><span class="line"><span class="comment"># 当i=2,seq[4]=1&lt;seq[2]=3</span></span><br><span class="line"><span class="comment"># 当i=3,seq[4]=1&lt;seq[3]=2</span></span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/bi-bao/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/bi-bao/" class="post-title-link" itemprop="url">闭包</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-16 05:54:59" itemprop="dateModified" datetime="2021-05-16T05:54:59Z">2021-05-16</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="闭包-Closure-‘kləʊʒə"><a href="#闭包-Closure-‘kləʊʒə" class="headerlink" title="闭包 Closure /‘kləʊʒə/"></a>闭包 Closure /‘kləʊʒə/</h2><ul>
<li><p>绑定了外部作用域的变量的函数</p>
</li>
<li><p>即使程序离开外部作用域，如果闭包仍然可见，绑定变量不会销毁<br>即使外部函数结束了，但只要内部函数还在引用外部函数的变量，外部变量它就依然存在。</p>
</li>
<li><p>每次运行外部函数都会重新创建闭包</p>
</li>
<li><p>自由变量：不在当前函数定义的变量。</p>
</li>
<li><p>外函数outer中定义了嵌套内函数inner，</p>
</li>
</ul>
<ul>
<li>内部函数inner引用外部函数outer的自由变量，</li>
<li>当外部函数outer返回内部函数名inner时，即外函数的返回值是内函数的引用，<br>相关参数和变量都保存在返回的函数中</li>
</ul>
<h3 id="外函数返回了内函数的引用："><a href="#外函数返回了内函数的引用：" class="headerlink" title="外函数返回了内函数的引用："></a>外函数返回了内函数的引用：</h3><p>当进行a=1的时候，实际上在内存当中有一个地方存了值1，<br>然后用a这个变量名存了1所在内存位置的引用。<br>引用就好像c语言里的指针，可以把引用理解成地址。<br>a只不过是一个变量名字，a里面存的是1这个数值所在的地址，就是a里面存了数值1的引用。</p>
<p>相同的道理，在python中定义一个函数def demo():的时候，<br>内存当中会开辟一些空间，存下这个函数的代码、内部的局部变量等等。<br>这个demo只不过是一个变量名字，它里面存了这个函数所在位置的引用而已。<br>我们还可以进行x = demo， y = demo， 这样的操作就相当于，<br>把demo里存的东西赋值给x和y，这样x 和y 都指向了demo函数所在的引用，<br>在这之后我们可以用x() 或者 y() 来调用我们自己创建的demo() ，<br>调用的实际上根本就是一个函数，x、y和demo三个变量名存了同一个函数的引用。</p>
<p>对于闭包，在外函数outer中 最后return inner，<br>我们在调用外函数 demo = outer() 的时候，<br>outer返回了inner，inner是一个函数的引用，这个引用被存入了demo中。<br>所以接下来我们再进行demo() 的时候，相当于运行了inner函数。<br>一个函数，如果函数名后紧跟一对括号，相当于现在我就要调用这个函数，<br>如果不跟括号，相当于只是一个函数的名字，里面存了函数所在位置的引用，那它可以被到处传递，并且可以赋值给别的变量而不去执行它。</p>
<p>2 外函数把临时变量绑定给内函数：<br>一般情况下，如果一个函数结束，函数的内部所有东西都会释放掉，<br>还给内存，临时局部变量都会消失。<br>如果没有在函数中引用全局变量，或者仅引用局部变量，<br>在内函数给局部变量赋值python认为是一个局部变量，不能引用外部函数的环境变量，<br>都不会形成闭包</p>
<p>但是闭包是一种特殊情况，发现有自己的临时变量将来会在内部函数中用到，<br>自己在结束的时候，返回内函数的同时，会把外函数的临时变量绑定给了内部函数，<br>所以外函数已经结束了，调用内函数的时候仍然能够使用外函数的临时变量。</p>
<p>python中一切都是对象，虽然函数我们只定义了一次，<br>但是外函数在运行的时候，<br>实际上是按照里面代码执行的，<br>外函数里创建了一个函数，每次调用外函数，<br>它都创建一个代码、功能一样的内函数，<br>但是却创建了不同的对象，并且把每次传入的临时变量数值绑定给内函数，再把内函数引用返回。</p>
<p>特性：自由变量会和闭包函数同时存在，即闭包函数和外部变量会同时存在。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">curve_pre</span>():</span></span><br><span class="line">    a = <span class="number">25</span></span><br><span class="line">    b = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">curve</span>():</span></span><br><span class="line">        <span class="keyword">return</span> b * a</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> curve  <span class="comment"># 实质是返回了函数及现场环境变量</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = <span class="number">10</span>  <span class="comment"># a并没有在调用curve函数中起到作用</span></span><br><span class="line">r = curve_pre()</span><br><span class="line"></span><br><span class="line">print(r())  <span class="comment"># 50</span></span><br><span class="line">print(r.__closure__)</span><br><span class="line"><span class="comment"># (&lt;cell at 0x000001580A52B3A0: int object at 0x00007FFB6FC599A0&gt;, &lt;cell at 0x000001580A52B400: int object at 0x00007FFB6FC596C0&gt;)</span></span><br><span class="line">print(r.__closure__[<span class="number">0</span>].cell_contents)  <span class="comment"># 25</span></span><br><span class="line">print(r.__closure__[<span class="number">1</span>].cell_contents)  <span class="comment"># 2</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f1</span>():</span></span><br><span class="line">    a = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f2</span>():</span></span><br><span class="line">        <span class="comment"># a = 20  # a被python认为式一个局部变量，不是闭包</span></span><br><span class="line">        c = <span class="number">20</span> * a</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> f2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = f1()</span><br><span class="line">print(f)</span><br><span class="line"><span class="comment"># &lt;function f1.&lt;locals&gt;.f2 at 0x00000205E28F1670&gt;</span></span><br><span class="line"></span><br><span class="line">print(f.__closure__)  <span class="comment"># 判断是一个闭包</span></span><br><span class="line"><span class="comment"># (&lt;cell at 0x00000205E289B3A0: int object at 0x00007FFB6FC597C0&gt;,)</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">origin = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factory</span>(<span class="params">pos</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">go</span>(<span class="params">step</span>):</span></span><br><span class="line">        <span class="keyword">nonlocal</span> pos</span><br><span class="line">        new_pos = pos + step</span><br><span class="line">        pos = new_pos  <span class="comment"># origin被赋值，python认为式一个局部变量,</span></span><br><span class="line">        <span class="comment"># 不能引用外部函数的环境变量，不是闭包</span></span><br><span class="line">        <span class="keyword">return</span> new_pos</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> go</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tourist = factory(origin)</span><br><span class="line">print(tourist(<span class="number">2</span>))  <span class="comment"># 2</span></span><br><span class="line">print(tourist.__closure__[<span class="number">0</span>].cell_contents)  <span class="comment"># 2 查看内函数环境变量</span></span><br><span class="line">print(tourist(<span class="number">3</span>))  <span class="comment"># 5</span></span><br><span class="line">print(tourist.__closure__[<span class="number">0</span>].cell_contents)  <span class="comment"># 5 查看内函数环境变量</span></span><br><span class="line">print(tourist(<span class="number">6</span>))  <span class="comment"># 5 实质是返回了函数及现场环境变量</span></span><br><span class="line">print(tourist.__closure__[<span class="number">0</span>].cell_contents)  <span class="comment"># 11查看内函数环境变量</span></span><br><span class="line">print(origin)  <span class="comment"># 11 外部环境变量没改变</span></span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>(<span class="params">y</span>):</span></span><br><span class="line">        <span class="keyword">return</span> x + y  <span class="comment"># inner函数引用了外部函数outer的变量x</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(outer(<span class="number">6</span>)(<span class="number">5</span>))  <span class="comment"># 11</span></span><br></pre></td></tr></tbody></table></figure>
<p>第一个括号传进去的值返回inner函数，其实就是返回6 + y，所以再传第二个参数进去，就可以得到返回值，6 + 5。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="comment"># a和b都是外函数的临时变量</span></span><br><span class="line">    b = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>():</span></span><br><span class="line">        print(a + b)  <span class="comment"># 在内函数中 用到了外函数的临时变量</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> inner  <span class="comment"># 外函数的返回值是内函数的引用和环境变量</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">        调用外函数传入参数5</span></span><br><span class="line"><span class="string">        此时外函数两个临时变量 a是5 b是10 ，</span></span><br><span class="line"><span class="string">        并创建了内函数，然后把内函数的引用返回存给了demo</span></span><br><span class="line"><span class="string">        外函数结束的时候发现内部函数将会用到自己的临时变量，</span></span><br><span class="line"><span class="string">        这两个临时变量就不会释放，会绑定给这个内部函数</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    demo = outer(<span class="number">5</span>)</span><br><span class="line">    <span class="comment"># demo存了外函数的返回值，也就是inner函数的引用，这里相当于执行inner函数</span></span><br><span class="line">    demo()  <span class="comment"># 15</span></span><br><span class="line"></span><br><span class="line">    demo2 = outer(<span class="number">7</span>)</span><br><span class="line">    demo2()  <span class="comment"># 17</span></span><br></pre></td></tr></tbody></table></figure>
<p>两次调用外部函数outer，分别传入的值是5和7。<br>内部函数只定义了一次，我们发现调用的时候，内部函数是能识别外函数的临时变量是不一样的。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>(<span class="params">y</span>):</span></span><br><span class="line">        <span class="keyword">nonlocal</span> x</span><br><span class="line">        x += y</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = outer(<span class="number">10</span>)</span><br><span class="line">print(a(<span class="number">1</span>))  <span class="comment"># 11</span></span><br><span class="line">print(a(<span class="number">3</span>))  <span class="comment"># 14，不是13</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span>():</span></span><br><span class="line">    fs = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">f</span>():</span></span><br><span class="line">            <span class="keyword">return</span> i * i</span><br><span class="line"></span><br><span class="line">        fs.append(f)</span><br><span class="line">    <span class="keyword">return</span> fs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f1, f2, f3 = count()</span><br><span class="line">print(f1())  <span class="comment"># 9</span></span><br><span class="line">print(f2())  <span class="comment"># 9</span></span><br><span class="line">print(f3())  <span class="comment"># 9</span></span><br><span class="line">print(f1.__closure__)  <span class="comment"># 判断是否为闭包</span></span><br><span class="line"><span class="comment"># (&lt;cell at 0x00000254B86EB910: int object at 0x00007FFE087E96E0&gt;,)</span></span><br><span class="line">print(f1.__closure__[<span class="number">0</span>].cell_contents)  <span class="comment"># 环境变量 3</span></span><br></pre></td></tr></tbody></table></figure>

<p>是开启一个函数执行过后消亡，但是闭包变量实际上只有一份，每次开启内函数都在使用同一份闭包变量x<br>why f1(), f2(), f3() returns 9, 9, 9 rather than 1, 4, 9?<br>原因就在于返回的函数引用了变量i，但它并非立刻执行。<br>等到3个函数都返回时，它们所引用的变量i已经变成了3，因此最终结果为9</p>
<p>修改闭包变量<br>要修改全局数据的时候有两种方法:<br>1 global 声明全局变量，声明变量n非内部函数的局部变量，否则内部函数只能引用，<br>       一旦修改会视其为局部变量，报错“局部变量在赋值之前被引用”。<br>         外函数的环境变量没被改变<br>2 全局变量是可变类型数据的时候可以修改 闭包更好<br>在闭包内函数中想修改闭包变量（外函数绑定给内函数的局部变量）的时候：<br>嵌套函数修改上层变量同样需要的关键字nonlocal 关键字声明<br>表示这个变量不是局部变量空间的变量，需要向上一层变量空间找这个变量。<br>闭包的环境变量可以记忆上次调用的状态，外函数的环境变量没被改变<br>使用闭包的过程中，一旦外函数被调用一次返回了内函数的引用，<br>虽然每次调用内函数，<br>是开启一个函数执行过后消亡，但是闭包变量实际上只有一份，<br>每次开启内函数都在使用同一份闭包变量</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">a</span>):</span>  <span class="comment"># outer是外部函数 a和b都是外函数的临时变量</span></span><br><span class="line">    b = <span class="number">10</span>  <span class="comment"># a和b都是闭包变量</span></span><br><span class="line">    c = [a]  <span class="comment"># 这里对应修改闭包变量的方法2</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>():</span>  <span class="comment"># inner是内函数</span></span><br><span class="line">        <span class="comment"># 内函数中想修改闭包变量</span></span><br><span class="line">        <span class="comment"># 方法1 nonlocal关键字声明不是局部变量</span></span><br><span class="line">        <span class="keyword">nonlocal</span> b</span><br><span class="line">        b += <span class="number">1</span></span><br><span class="line">        print(b)</span><br><span class="line">        <span class="comment"># 方法二，把闭包变量修改成可变数据类型 比如列表</span></span><br><span class="line">        c[<span class="number">0</span>] += <span class="number">1</span></span><br><span class="line">        print(c[<span class="number">0</span>])</span><br><span class="line">        print(b)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 外函数的返回值是内函数的引用</span></span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    demo = outer(<span class="number">5</span>)</span><br><span class="line">    demo()</span><br><span class="line">    <span class="comment"># 11</span></span><br><span class="line">    <span class="comment"># 6</span></span><br><span class="line">    <span class="comment"># 11</span></span><br><span class="line">print(<span class="string">'----------'</span>)</span><br><span class="line"></span><br><span class="line">利用闭包返回一个计数器函数，每次调用它返回递增整数：</span><br><span class="line">在内函数中，分别对闭包变量进行了修改，</span><br><span class="line">打印出来的结果也确实是修改之后的结果。</span><br><span class="line">以上两种方法就是内函数修改闭包变量的方法。</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_counter</span>():</span>  <span class="comment"># 是外部函数</span></span><br><span class="line">    i = <span class="number">0</span>  <span class="comment"># i都是闭包变量</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">counter</span>():</span>  <span class="comment"># 内函数</span></span><br><span class="line">        <span class="keyword">nonlocal</span> i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> counter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试:</span></span><br><span class="line">counterA = create_counter()</span><br><span class="line">print(counterA(), counterA(), counterA(), counterA(), counterA())  <span class="comment"># 1 2 3 4 5</span></span><br><span class="line">counterB = create_counter()</span><br><span class="line"><span class="keyword">if</span> [counterB(), counterB(), counterB(), counterB()] == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]:</span><br><span class="line">    print(<span class="string">'测试通过!'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'测试失败!'</span>)</span><br><span class="line"><span class="comment"># 测试通过!</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createCounter</span>():</span></span><br><span class="line">    i = [<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">counter</span>():</span></span><br><span class="line">        i[<span class="number">0</span>] = i[<span class="number">0</span>] + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> i[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> counter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试:</span></span><br><span class="line">counterA = createCounter()</span><br><span class="line">print(counterA(), counterA(), counterA(), counterA(), counterA())  <span class="comment"># 1 2 3 4 5</span></span><br><span class="line">counterB = createCounter()</span><br><span class="line"><span class="keyword">if</span> [counterB(), counterB(), counterB(), counterB()] == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]:</span><br><span class="line">    print(<span class="string">'测试通过!'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'测试失败!'</span>)</span><br><span class="line"><span class="comment"># 测试通过!</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cache</span>(<span class="params">func</span>):</span>  <span class="comment"># 定义装饰器，cache是外层函数</span></span><br><span class="line">    store = {} <span class="comment"># 外部变量</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">    @wraps(func)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_</span>(<span class="params">n</span>):</span>     <span class="comment"># 闭包函数</span></span><br><span class="line">        <span class="keyword">if</span> n <span class="keyword">in</span> store:</span><br><span class="line">            <span class="keyword">return</span> store[n]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res = func(n)</span><br><span class="line">            store[n] = res</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">return</span> _</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 用装饰器的方式记录前面的结果    </span></span><br><span class="line"><span class="meta">@cache </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span>(<span class="params">n</span>):</span>       <span class="comment"># 斐波那契数列</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> fib(n - <span class="number">1</span>) + fib(n - <span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/dui-lie-he-zhan/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/dui-lie-he-zhan/" class="post-title-link" itemprop="url">队列和栈</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-24 16:38:13" itemprop="dateModified" datetime="2021-04-24T16:38:13Z">2021-04-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h4 id="队列-是有序数据集合"><a href="#队列-是有序数据集合" class="headerlink" title="队列 是有序数据集合"></a>队列 是有序数据集合</h4><p>**队列和栈一样，队列是一种操作受限制的线性表。<br>进行删除操作的端称为队头，称为前端(front)，<br>进行插入操作的端称为队尾，称为后端(rear)。</p>
<p>数据项总是开始排在队伍的后端，慢慢向前走，直到排到最前面，轮到它的时候离开队列。<br>刚进来的数据排在后端，待在队伍里时间最长的在前端，<br>这种排列规则叫做FIFO(first-in first-out)，“先进先出”</p>
<p>在实际编码中不会自己来实现一个队列，<br>而是使用标准库中的queue，通过<code>from queue import Queue</code>来导入<code>Queue</code>类。线程<code>Queue</code>，</p>
<p>**</p>
<p>对列的添加       insert              append </p>
<p>队列的取值      列表[-1]            列表[0]</p>
<p>队列的删除       pop()                    pop(0)</p>
<p>push(1);push(2);pop(3);push(4); # 尾部插入<br>1234<br>pop(1),pop(2), 头部删除<br>34</p>
<p>一个Node对象如下示意图：<br>![]C:\python代码\牛客网剑指offer66题思路分析\图解说明\node对象.jpg</p>
<figure class="highlight plain"><figcaption><span>创建一个空队列，无参数，返回值是空队列</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">如果是一个空的队列，那head和tail都指向None。</span><br><span class="line">![](C:\python代码\牛客网剑指offer66题思路分析\图解说明\空队列.jpg)</span><br><span class="line"></span><br><span class="line">当队列里有一个元素时，head和tail两个指针都指向这个元素，next指向None</span><br><span class="line">示意图是这样的：</span><br><span class="line">![](C:\python代码\牛客网剑指offer66题思路分析\图解说明\队列.jpg)</span><br><span class="line"></span><br><span class="line">enqueue(item) 在队列尾部加入一个数据项，参数是数据项，无返回值</span><br><span class="line">当队列再增加一个元素时，而head指针不会发生改变，</span><br><span class="line">tail指针会移动到新增加的这个元素，</span><br><span class="line">前一个元素的next指针也会指向新元素，</span><br><span class="line">如下图：</span><br><span class="line">![](C:\python代码\牛客网剑指offer66题思路分析\图解说明\对列增加元素.jpg)</span><br><span class="line">___</span><br><span class="line"></span><br><span class="line">```isEmpty()``` 检测队列是否为空。无参数，返回布尔值。</span><br><span class="line">```size()``` 返回队列数据项的数量。无参数，返回一个整数。</span><br><span class="line"></span><br><span class="line">同栈一样，队列也可以用顺序表或者链表实现。</span><br><span class="line">我们假设队列里的元素有一个指针，最先加进元素的指针指向它下一个元素，依次类推，</span><br><span class="line">最后一个元素的指针是指向None。</span><br><span class="line">所以队列里的元素可以抽象出一个Queue类，会创建两个指针，</span><br><span class="line">一个head，指向队头的元素，</span><br><span class="line">一个tail，指向队尾的元素。</span><br><span class="line">同样像链表时的Node类一样有自己的数据和一个指向None的指针。</span><br><span class="line">```python</span><br><span class="line">class Node:</span><br><span class="line">    def __init__(self, value):</span><br><span class="line">        self.value = value</span><br><span class="line">        self.next = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Queue:</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.head = None</span><br><span class="line">        self.tail = None</span><br><span class="line"></span><br><span class="line">    def enqueue(self, value):</span><br><span class="line">        node = Node(value)  # 实列化节点</span><br><span class="line">        if self.head is None:</span><br><span class="line">            self.head = node</span><br><span class="line">            self.tail = node</span><br><span class="line">        else:</span><br><span class="line">            self.tail.next = node</span><br><span class="line">            self.tail = node</span><br><span class="line"></span><br><span class="line">    def dequeue(self):</span><br><span class="line">        if self.head is None:</span><br><span class="line">            raise Exception('This is a empty queue')</span><br><span class="line">        cur = self.head</span><br><span class="line">        self.head = cur.next</span><br><span class="line">        return cur.value</span><br><span class="line"></span><br><span class="line">    def is_empty(self):</span><br><span class="line">        return self.head is None</span><br><span class="line"></span><br><span class="line">    def size(self):</span><br><span class="line">        cur = self.head</span><br><span class="line">        count = 0</span><br><span class="line">        if cur is None:</span><br><span class="line">            return count</span><br><span class="line">        while cur.next is not None:</span><br><span class="line">            count += 1</span><br><span class="line">            cur = cur.next</span><br><span class="line">        return count + 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == '__main__':</span><br><span class="line">    q = Queue()  # 实列化队列</span><br><span class="line">    for i in range(5):</span><br><span class="line">        q.enqueue(i)</span><br><span class="line">    for _ in range(5):</span><br><span class="line">        print(q.dequeue())</span><br><span class="line">    print(q.is_empty())</span><br><span class="line">    print(q.dequeue())</span><br><span class="line">        # 0</span><br><span class="line">        # 1</span><br><span class="line">        # 2</span><br><span class="line">        # 3</span><br><span class="line">        # 4</span><br><span class="line">    print(q.is_empty())  # True</span><br><span class="line">    print(q.size())  # 0</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Queue</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="string">""" 使用列表[]实现队列 """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.items = []  <span class="comment"># 初始化一个[]对象</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_empty</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.items == []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">enqueue</span>(<span class="params">self, item</span>):</span></span><br><span class="line">        <span class="string">"""队列一端添加元素"""</span></span><br><span class="line">        self.items.insert(<span class="number">0</span>, item)</span><br><span class="line">        <span class="comment"># self.items.append(item)</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dequeue</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""队列另一端删除一个元素"""</span></span><br><span class="line">        <span class="keyword">return</span> self.items.pop()</span><br><span class="line">        <span class="comment"># return self.items.pop(0)</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">size</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""返回队列大小"""</span></span><br><span class="line">        <span class="keyword">return</span> len(self.items)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    q = Queue()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        q.enqueue(i)</span><br><span class="line">    print(q.size())  <span class="comment"># 5</span></span><br><span class="line">    print(q.is_empty())  <span class="comment"># False</span></span><br><span class="line">    print(q.dequeue())  <span class="comment"># 0</span></span><br><span class="line">    print(q.dequeue())  <span class="comment"># 1</span></span><br><span class="line">    print(q.dequeue())  <span class="comment"># 2</span></span><br></pre></td></tr></tbody></table></figure>

<hr>
<h1 id="优先级队列"><a href="#优先级队列" class="headerlink" title="优先级队列"></a>优先级队列</h1><p>是因为虽然名字有队列，但其实是使用堆来实现的。</p>
<h1 id="实现优先级队列"><a href="#实现优先级队列" class="headerlink" title="实现优先级队列"></a>实现优先级队列</h1><p>优先级队列(Priority Queue) 顾名思义，就是入队的时候可以给一个优先级，通常是个数字或者时间戳等，<br>当出队的时候我们希望按照给定的优先级出队，我们按照 TDD(测试驱动开发) 的方式先来写测试代码：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_priority_queue</span>():</span></span><br><span class="line">    size = <span class="number">5</span></span><br><span class="line">    pq = PriorityQueue(size)</span><br><span class="line">    pq.push(<span class="number">5</span>, <span class="string">'purple'</span>)    <span class="comment"># priority, value</span></span><br><span class="line">    pq.push(<span class="number">0</span>, <span class="string">'white'</span>)</span><br><span class="line">    pq.push(<span class="number">3</span>, <span class="string">'orange'</span>)</span><br><span class="line">    pq.push(<span class="number">1</span>, <span class="string">'black'</span>)</span><br><span class="line"></span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> pq.is_empty():</span><br><span class="line">        res.append(pq.pop())</span><br><span class="line">    <span class="keyword">assert</span> res == [<span class="string">'purple'</span>, <span class="string">'orange'</span>, <span class="string">'black'</span>, <span class="string">'white'</span>]</span><br></pre></td></tr></tbody></table></figure>

<p>上边就是期望的行为，写完测试代码后我们来编写优先级队列的代码，按照出队的时候最大优先级先出的顺序：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PriorityQueue</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, maxsize</span>):</span></span><br><span class="line">        self.maxsize = maxsize</span><br><span class="line">        self._maxheap = MaxHeap(maxsize)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span>(<span class="params">self, priority, value</span>):</span></span><br><span class="line">        <span class="comment"># 注意这里把这个 tuple push 进去，python 比较 tuple 从第一个开始比较</span></span><br><span class="line">        <span class="comment"># 这样就很巧妙地实现了按照优先级排序</span></span><br><span class="line">        entry = (priority, value)    <span class="comment"># 入队的时候会根据 priority 维持堆的特性</span></span><br><span class="line">        self._maxheap.add(entry)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span>(<span class="params">self, with_priority=False</span>):</span></span><br><span class="line">        entry = self._maxheap.extract()</span><br><span class="line">        <span class="keyword">if</span> with_priority:</span><br><span class="line">            <span class="keyword">return</span> entry</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> entry[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_empty</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> len(self._maxheap) == <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>



<p>Python 中使用 collections 中的函数 deque() double-ended queue<br>底层是链表，因此头部和尾部是等价的，其插入和删除操作在表的两端进行，都是 O(1) 时间复杂度；<br>删除队列头部的数据项，不需要参数，返回值是被删除的数据，<br>队列本身有变化，直接把head指针移动到下一个元素，再把值弹出即可。<br>是一种具有队列和栈的性质的数据结构。<br>但是对于列表可以很方便向后面去追加元素，但如果想在第一个位置插入元素就需要移动后面所有的元素，因此在这里效率不如 collections.deque() 。<br>deque对于list的性能优势，<br>主要是在两端反复添加大量元素时差异才会比较明显，<br>而对于构建一个全新的集合，list反而比deque还要快一些。</p>
<p>用python的list数据类型能比较容易的实现队列数据模型，<br>列表是 java c++ 中的数组，数组移除头部元素的方式 是把后面的元素全部往前移动一位，所以复杂度是 O(N) ；</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Deque</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="string">"""双端队列"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.items = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_empty</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""判断队列是否为空"""</span></span><br><span class="line">        <span class="keyword">return</span> self.items == []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_front</span>(<span class="params">self, item</span>):</span></span><br><span class="line">        <span class="string">"""在队列头部添加元素"""</span></span><br><span class="line">        self.items.insert(<span class="number">0</span>, item)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_rear</span>(<span class="params">self, item</span>):</span></span><br><span class="line">        <span class="string">"""在队列尾部添加元素"""</span></span><br><span class="line">        self.items.append(item)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop_front</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""队列头部删除一个元素"""</span></span><br><span class="line">        <span class="keyword">return</span> self.items.pop(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop_rear</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""队列尾部删除一个元素"""</span></span><br><span class="line">        <span class="keyword">return</span> self.items.pop()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">size</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""返回队列大小"""</span></span><br><span class="line">        <span class="keyword">return</span> len(self.items)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tarvel</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> self.items:</span><br><span class="line">            print(i, end=<span class="string">" "</span>)</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    deque = Deque()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        deque.add_front(i)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>, <span class="number">5</span>):</span><br><span class="line">        deque.add_rear(i)</span><br><span class="line">    deque.tarvel()</span><br><span class="line">    print(<span class="string">'---'</span>)</span><br><span class="line">    print(deque.size())</span><br><span class="line">    print(<span class="string">'---'</span>)</span><br><span class="line">    print(deque.pop_front())</span><br><span class="line">    print(deque.pop_front())</span><br><span class="line">    print(deque.pop_rear())</span><br><span class="line">    print(deque.pop_rear())</span><br><span class="line">    deque.tarvel()</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> <span class="number">1</span> <span class="number">0</span> <span class="number">3</span> <span class="number">4</span> <span class="string">---</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用collections模块deque()函数实现队列。</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Queue</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.items = deque()  <span class="comment"># 初始化一个deque对象</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">append</span>(<span class="params">self, val</span>):</span> </span><br><span class="line">        <span class="keyword">return</span> self.items.append(val)  <span class="comment"># 向队列右边添加元素</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span>(<span class="params">self</span>):</span>  </span><br><span class="line">        <span class="keyword">return</span> self.items.popleft()    <span class="comment"># 从队列左边取元素</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">empty</span>(<span class="params">self</span>):</span>        </span><br><span class="line">        <span class="keyword">return</span> len(self.items) == <span class="number">0</span>    <span class="comment"># 判断是不是空队列</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_queue</span>():</span></span><br><span class="line">    q = Queue()</span><br><span class="line">    q.append(<span class="number">0</span>)</span><br><span class="line">    q.append(<span class="number">1</span>)</span><br><span class="line">    q.append(<span class="number">2</span>)</span><br><span class="line">    print(q.pop())</span><br><span class="line">    print(q.pop())</span><br><span class="line">    print(q.pop())</span><br><span class="line"> </span><br><span class="line">test_queue()</span><br><span class="line"><span class="comment"># 输出结果：</span></span><br><span class="line"><span class="comment">#     0</span></span><br><span class="line"><span class="comment">#     1</span></span><br><span class="line"><span class="comment">#     2</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="栈（stack）又名堆栈，它是一种运算受限的线性表。"><a href="#栈（stack）又名堆栈，它是一种运算受限的线性表。" class="headerlink" title="栈（stack）又名堆栈，它是一种运算受限的线性表。"></a>栈（stack）又名堆栈，它是一种运算受限的线性表。</h4><p>其限制是仅允许在栈的栈顶进行插入和删除运算。<br>这一端被称为栈顶，相对地，把另一端称为栈底。<br>用 append() 方法把新元素放到栈顶元素的上面，使之成为新的栈顶元素，称作是进栈，入栈或者压栈  </p>
<p>从一个栈删除元素又称作出栈或退栈，用不指定索引的 pop() 方法可以把一个元素从堆栈顶释放删除，使其相邻的元素成为新的栈顶元素。</p>
<p>栈可以用顺序表实现，也可以用链表实现。<br>列表方法使得列表可以很方便的作为一个堆栈来使用</p>
<p>最先进入的元素最后一个被释放<br>先进后出 后进先出</p>
<p>栈的本质是递归。所以可以借助栈理解递归；<br>栈顶是递归终止条件，栈的每一层是递归的方法体</p>
<p>取值列表[-1]，因为它只能从栈顶来取值，相当于取列表的最后一个值，所以用索引-1.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">stack1 = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">stack1.append(<span class="number">6</span>)</span><br><span class="line">stack1.append(<span class="number">7</span>)</span><br><span class="line">print(stack1)  <span class="comment"># [3, 4, 5, 6, 7]</span></span><br><span class="line">print(stack1.pop())  <span class="comment"># 7</span></span><br><span class="line">print(stack1)  <span class="comment"># [3, 4, 5, 6]</span></span><br><span class="line">print(stack1.pop())  <span class="comment"># 6</span></span><br><span class="line">print(stack1.pop())  <span class="comment"># 5</span></span><br><span class="line">print(stack1)  <span class="comment"># [3, 4]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用列表[]实现栈</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.stack = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_empty</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""判断是否为空"""</span></span><br><span class="line">        <span class="keyword">return</span> self.stack == []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span>(<span class="params">self, element</span>):</span></span><br><span class="line">        <span class="string">"""添加一个新的元素item到栈顶"""</span></span><br><span class="line">        self.stack.append(element)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""弹出栈顶元素"""</span></span><br><span class="line">        <span class="keyword">return</span> self.stack.pop()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">peek</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.stack[<span class="number">-1</span>] <span class="keyword">if</span> self.stack <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">size</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""返回栈的元素个数"""</span></span><br><span class="line">        <span class="keyword">return</span> len(self.stack)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">stack = Stack()</span><br><span class="line">stack.push(<span class="number">1</span>)</span><br><span class="line">stack.push(<span class="number">2</span>)</span><br><span class="line">stack.push(<span class="number">3</span>)</span><br><span class="line">print(stack.pop())  <span class="comment"># 3</span></span><br><span class="line">print(stack)  <span class="comment"># &lt;__main__.Stack object at 0x0000024BAF626D60&gt;</span></span><br><span class="line">print(stack.peek())  <span class="comment"># 2</span></span><br><span class="line">print(stack.size())  <span class="comment"># 2</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用collections模块deque()函数实现栈</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.deque = deque()</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        self.deque.append(value) </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.deque.pop()  <span class="comment"># 默认从右边取</span></span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_stack</span>():</span></span><br><span class="line">    s = Stack()</span><br><span class="line">    s.push(<span class="number">0</span>)</span><br><span class="line">    s.push(<span class="number">1</span>)</span><br><span class="line">    s.push(<span class="number">2</span>)</span><br><span class="line">    print(s.pop())</span><br><span class="line">    print(s.pop())</span><br><span class="line">    print(s.pop())</span><br><span class="line"> </span><br><span class="line">test_stack()</span><br><span class="line"><span class="comment">#       2</span></span><br><span class="line"><span class="comment">#       1</span></span><br><span class="line"><span class="comment">#       0</span></span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/mian-xiang-dui-xiang-san-da-te-dian/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/mian-xiang-dui-xiang-san-da-te-dian/" class="post-title-link" itemprop="url">面向对象三大特点</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-07-19 01:42:11" itemprop="dateModified" datetime="2021-07-19T01:42:11Z">2021-07-19</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>面向对象设计思想<br>一、同一个模块内的各个元素之间要高度紧密<br>二、不同模块之间的相互依存度不必这么紧密</p>
<p>面向对象的三个基本特征： 1. 封装 2. 继承 3. 多态 4. 方法重载 5. 抽象基类</p>
<h2 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h2><p>对外部隐藏有关对象工作原理的细节、隐私数据，<br>封装就是隐藏对象的属性和实现细节，<br>仅对暴露外公开接口，控制对数据的读写操作，也就是将数据也就是对象属性与操作数据的方法进行有机的结合，形成“类”，封装的目的是为了增强安全性和简化编程，使用者不必了解具体的实现细节，而只是要通过外部接口，以特定的访问权限来使用类的成员</p>
<p>封装，就是把客观事物封装成抽象的类，并且类可以把自己的数据和方法只让可信的类或者对象操作，对不可信的进行信息隐藏。一个类就是一个封装了数据以及操作这些数据的代码的逻辑实体。在一个对象内部，某些代码或某些数据可以是私有的，不能被外界访问。通过这种方式，对象对内部数据提供了不同级别的保护，以防止程序中无关的部分意外的改变或错误的使用了对象的私有部分。</p>
<p>既然有了列表为什么我们还要基于list去实现一个栈呢</p>
<ul>
<li>随机获取数据 l[0] - 很有可能误操作 都达不到我们想要的栈的效果</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span>:</span></span><br><span class="line">    <span class="string">"""栈"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.items = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isEmpty</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.items == []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span>(<span class="params">self, item</span>):</span></span><br><span class="line">        self.items.append(item)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.items.pop()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">size</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> len(self.items)</span><br></pre></td></tr></tbody></table></figure>

<p>另外一个场景 我们现在有一组课程的信息需要保存 一门课程有： 课程名、课程的url、课程的价格<br>下边的类封装了 变量 - list 以及基于这些变量的方法</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Course</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, price, url</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.price = price</span><br><span class="line">        self._url = url  <span class="comment">#大家都认可的一种编码规范，这种权限级别的控制 java是可以做到</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_price</span>(<span class="params">self, price</span>):</span></span><br><span class="line">        self.price = price</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">courses = []</span><br><span class="line">course1 = Course(<span class="string">"django"</span>, <span class="number">100</span>, <span class="string">"https://imooc.com"</span>)</span><br><span class="line">print(course1._url)</span><br><span class="line">courses.append(course1)</span><br><span class="line"></span><br><span class="line">course2 = Course(<span class="string">"scrapy"</span>, <span class="number">100</span>, <span class="string">"https://imooc.com"</span>)</span><br><span class="line">courses.append(course2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#方法和函数 差异并不大</span></span><br><span class="line">c = Course(<span class="string">"django"</span>, <span class="number">100</span>, <span class="string">"https://www.imooc.com"</span>)</span><br><span class="line">c.set_price(<span class="number">200</span>)</span><br><span class="line">print(c.price)  <span class="comment"># 200</span></span><br></pre></td></tr></tbody></table></figure>

<p>如果我们仅仅只关心数据的话 还有另一种数据结构更合适，tuple更省内存 性能更高</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">courses2 = []</span><br><span class="line">new_course1 = (<span class="string">"django"</span>, <span class="number">100</span>, <span class="string">"https://imooc.com"</span>)</span><br><span class="line">courses2.append(new_course1)</span><br></pre></td></tr></tbody></table></figure>

<p>namedtuple很像是一个只能封装数据、不能封装方法的类 但是namedtuple的性能比class高， 内存会比class小很多</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line">NewCourse = namedtuple(<span class="string">'Course'</span>, <span class="string">'name price url'</span>)</span><br><span class="line">a = NewCourse(name=<span class="string">"django"</span>, price=<span class="number">100</span>, url=<span class="string">"https://imooc.com"</span>)</span><br><span class="line">print(a.price)  <span class="comment"># 100</span></span><br><span class="line">courses2.append(a)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><p>子类继承父类，使得子类对象（实例）自动拥有父类的所有的属性（特征）和方法（行为），不能选择性继承</p>
<p>详细的分析了在多个继承关系当中，如果有相同的数据字段，他们的访问顺序</p>
<p>当多个子类拥有父类相同的方法与属性时，就可以抽取共有特征和方法形成一个父级类，形成了父子类之间关系。<br>继承机制可以很好的提高了代码复用率、扩展性与维护性，<br>比如在Java中的Object类，就是所有类的超类。</p>
<p>它支持按级分类的概念。它可以使用现有类的所有功能，并在无需重新编写原来的类的情况下对这些功能进行扩展。 通过继承创建的新类称为“子类”或“派生类”（Subclass、derived class），被继承的类称为“基类”、“父类”或“超类”（Base class、Super class）。<br>继承的过程，就是从一般到特殊的过程。</p>
<p>要实现继承，可以通过 “继承”（Inheritance）和“组合”（Composition）来实现。继承概念的实现方式有二类：实现继承与接口继承。<br>实现继承是指直接使用 基类的属性和方法而无需额外编码的能力；<br>接口继承是指仅使用属性和方法的名称、但是子类必须提供实现的能力。</p>
<p>方法的继承与重载<br>方法重写、覆盖（override）：如果从父类继承的方法不能满足子类的需求，可以在子类重写你父类的方法 并在无需重新编写原来的类的情况下对这些功能进行扩展</p>
<p>子类的定义</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> 子类(<span class="params">父类</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></tbody></table></figure>

<p>建议：一个文件夹只写一个类，那么只需在子类文件上写<code>from 文件 import 父类</code><br>多继承：一个子类继承多个父类，<br>class 子类(父类1，父类2):<br>注意圆括号中父类的顺序，若是父类中有相同的方法名，而在子类使用时未指定，<br>python从左至右搜索，默认调用的是在括号中排前的父类的方法。即方法在子类中未找到时，从左到右查找父类中是否包含方法，</p>
<p>如果在子类中需要父类的构造方法就需要显式地调用父类的构造方法，或者不重写父类的构造方法。<br>子类不重写 <strong>init__，实例化子类时，会自动调用父类定义的 __init__。<br>如果重写了__init</strong> ，实例化子类，默认不会调用父类已经定义的 <strong>init__，<br>class 子类(父类1，父类2):<br>    def __init</strong>(self,子类形参，父类形参):<br>     父类名1.方法名(self,父类形参1)<br>     父类名2.方法名(self,父类形参2)</p>
<p>② 父子方法同名问题<br>如果重写了<strong>init</strong> 时，若想要继承父类的构造方法，<br>若父类和子类具有同名的实例方法，<br>如果想调用父类同名实例方法，<br>需要在定义子类方法时，<br>Python 3 加上super().方法名(不写self,只写父类形参)代替super(子类名,self).方法名(父类形参)<br>def <strong>init</strong>(self,name,color):<br>    super().<strong>init</strong>(不写self,只写父类形参) 或者父类名称.<strong>init</strong>(self,参数1，参数2，…)<br>super() 函数是用于调用父类(超类)的一个方法。<br>super 是用来解决多重继承问题的，直接用类名调用父类方法在使用单继承的时候没问题，<br>但是如果使用多继承，会涉及到查找顺序（MRO）、重复调用（钻石继承）等种种问题。<br>MRO 就是类的方法解析顺序表, 其实也就是继承父类方法时的顺序表</p>
<h3 id="优化的-super-方便直接调用父类函数"><a href="#优化的-super-方便直接调用父类函数" class="headerlink" title="优化的 super() 方便直接调用父类函数"></a>优化的 super() 方便直接调用父类函数</h3><p><code>super().eat()</code> 直接就可以调用父类，像什么 self 都不必传递</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">'hello'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>(<span class="params">Base</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># py2，显示调用父类方法</span></span><br><span class="line">        <span class="keyword">return</span> super(C, self).hello()</span><br><span class="line"></span><br><span class="line">c = C()</span><br><span class="line">c.hello()   <span class="comment"># hello</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C2</span>(<span class="params">Base</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># py3，显示调用父类方法</span></span><br><span class="line">        <span class="keyword">return</span> super().hello()</span><br><span class="line"></span><br><span class="line">c2 = C2()</span><br><span class="line">c2.hello()  <span class="comment"># hello</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">speak</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">"姓名:{}, 年龄:{}"</span>.format(self.name, self.age))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params">Person</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age, school</span>):</span></span><br><span class="line">        super().__init__(name, age)</span><br><span class="line">        self.school = school</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">detail</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">"姓名:{}, 年龄:{}， 学校:{}"</span>.format(self.name, self.age, self.school))</span><br><span class="line"></span><br><span class="line">s = Student(<span class="string">"bobby"</span>, <span class="number">18</span>, <span class="string">"慕课网"</span>)</span><br><span class="line">s.speak()</span><br><span class="line">s.detail()</span><br></pre></td></tr></tbody></table></figure>

<h2 id="多态：多种形态"><a href="#多态：多种形态" class="headerlink" title="多态：多种形态"></a>多态：多种形态</h2><p>同一种类型在不同场景下表现为不同的行为，我们举了生活中的饮用水，在不同的温度下水的三种形态，分别为冰，水，蒸汽</p>
<p>对不同类型的对象执行相同的操作，得到不同的结果，<br>每当无需知道对象是什么样的就能对其执行操作时<br>指父类定义的方法可以调用子类实现的方法，不同的子类有不同的实现，从而给父类的方法带来了多样的不同行为。<br>声明类型的时候你申明的类型是一种兼容类型， 但是实际赋值的时候是另一种类型。</p>
<p>同一个行为具有多个不同表现形式。<br>一个类实例（对象）的相同方法在不同场景下有不同表现形式。<br>多态机制使内部结构不同的对象可以共享相同的外部接口。<br>这意味着，虽然针对不同对象的具体操作不同，但通过一个公共的类，它们（那些操作）可以通过相同的方式予以调用。</p>
<p>多态的作用（为什么要多态）<br>张三的儿子娶媳妇，通知李五去他家喝喜酒（这里就是一个方法），但是李五有事不能来，李五就让他的三个儿子其中一个代表他老爹李五去喝喜酒（这里就是一个方法），使用的是他们老爹的喝喜酒方法,就像他老爹本人一样。</p>
<p>不必编写每一子类的功能调用，可以直接把不同子类当父类看，屏蔽子类间的差异，提高代码的通用率/复用率，降低类型之间的耦合度</p>
<p>父类引用可以调用不同子类的功能，提高了代码的扩充性和可维护性</p>
<p>必要条件：</p>
<ul>
<li>满足继承关系</li>
<li>子类重写父类方法</li>
</ul>
<p>在继承关系中，如果一个实例的数据类型是某个子类，<br>那它的数据类型也可以被看做是父类。但是，反过来就不行</p>
<p>调用方只管调用，不管细节，而当我们新增一种Animal的子类时，<br>只要确保run()方法编写正确，不用管原来的代码是如何调用的。<br>“开闭”原则：<br>对扩展开放：允许新增Animal子类；<br>对修改封闭：不需要修改依赖Animal类型的run_twice()等函数。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Human</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__age = age</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">do_homework</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">"这是一个父类方法"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>(<span class="params">Human</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age, school</span>):</span></span><br><span class="line">        <span class="comment"># 不建议这样用</span></span><br><span class="line">        <span class="comment"># Human.__init__(self,name,age)</span></span><br><span class="line">        <span class="comment"># 正确用户</span></span><br><span class="line">        super(Student, self).__init__(name, age)</span><br><span class="line">        self.school = school</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">do_homework</span>(<span class="params">self</span>):</span></span><br><span class="line">        super(Student, self).do_homework()</span><br><span class="line">        <span class="comment"># 不可以这样访问父类变量</span></span><br><span class="line">        <span class="comment"># print(self.__name)</span></span><br><span class="line">        <span class="comment"># print(super(Student,self).__name)</span></span><br><span class="line">        print(super(Student, self).get_name() + <span class="string">"正在做作业"</span>)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> abc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>(<span class="params">metaclass=abc.ABCMeta</span>):</span>  <span class="comment"># 抽象类：里面的方法必须是抽象方法</span></span><br><span class="line"><span class="meta">    @abc.abstractmethod     # 抽象方法</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">speak</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>(<span class="params">Animal</span>):</span>      <span class="comment"># 继承</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">speak</span>(<span class="params">self</span>):</span>     <span class="comment"># 多态：狗狗说话汪</span></span><br><span class="line">        print(<span class="string">'汪~汪~汪~'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span>(<span class="params">Animal</span>):</span>  <span class="comment"># 继承</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">speak</span>(<span class="params">self</span>):</span>    <span class="comment"># 多态：猫猫说话喵</span></span><br><span class="line">        print(<span class="string">'喵~喵~喵~'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span>(<span class="params">obj</span>):</span>   <span class="comment"># 多态性：一种调用方式，不同 obj 产生不同的执行效果</span></span><br><span class="line">    obj.speak() <span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="comment"># 多态</span></span><br><span class="line">    dog = Dog()</span><br><span class="line">    dog.speak()</span><br><span class="line">    cat = Cat()</span><br><span class="line">    cat.speak()</span><br><span class="line">    <span class="comment"># 多态性</span></span><br><span class="line">    fun(dog)</span><br><span class="line">    fun(cat)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight txt"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">汪~汪~汪~</span><br><span class="line">喵~喵~喵~</span><br><span class="line">汪~汪~汪~</span><br><span class="line">喵~喵~喵~</span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/os-mo-kuai/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/os-mo-kuai/" class="post-title-link" itemprop="url">OS模块</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-24 16:53:37" itemprop="dateModified" datetime="2021-05-24T16:53:37Z">2021-05-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>OS模块 operating system 提供了不少与操作系统相关联的函数<br>sys: 通常用于命令行参数</p>
<p>要使用这个模块，你必须先导入它，然后才可以调用相关的各种功能。<br>模块导入：<code>import os</code></p>
<p>函数/变量描述<br>environ包含环境变量的映射<br><code>system(command)</code>在子shell中执行操作系统命令<br><code>sep</code>路径中使用的分隔符<br><code>pathsep</code>分隔不同路径的分隔符<br><code>linesep</code>行分隔符(\n’、\r’或\r\n’)<br><code>urandom(n)</code>返回n个`的强加密随机数据</p>
<p><code>pathlib</code> 目的是提供一个简单的类层次结构来处理文件系统的路径，同时提供用户对其进行的常见操作。<br>那为什么不使用 <code>os</code> 模块或者 <code>os.path</code> 来实现呢？</p>
<p>许多人更喜欢使用 <code>datetime</code> 模块提供的高级对象来处理日期和时间，而不是使用数字时间戳和 <code>time</code> 模块 API，</p>
<p>同样的原因，假如使用专用类表示文件系统路径，如果要处理文件系统相关的路径，选 pathlib 就对了。<br>pathlib 并不是基于 str 的实现，而是基于 object 面向对象设计的，这样就严格地区分了 Path 对象和字符串对象，<br>同时也用到了一点 os 的功能，比如 os.name，os.getcwd 等，这一点大家可以看 pathlib 的源码了解更多。</p>
<p>换句话说，os.path 是面向过程风格的，<br>Python 也在一直在慢慢地从严格复制 C 语言的 API 转变为围绕各种常见功能提供更好，更有用的抽象。</p>
<p>其他方面，使用专用的类允许默认情况下启用所需的行为也是很有必要的，例如 Windows 路径不区分大小写。<br>pathlib 的优势在于考虑了 Windows 路径的特殊性，同时提供了带 I/O 操作的和不带 I/O 操作的类，使用场景更加明确。</p>
<p>图中的箭头表示继承自，<br>比如 <code>Path</code> 继承自 <code>PurePath</code>，<br><code>PurePath</code> 表示纯路径类，只提供路径常见的操作，但不包括实际的 I/O 操作，相对安全；<br><code>Path </code>包含 <code>PurePath</code> 的全部功能，包括 I/O 操作。</p>
<p>要说劣势，如果有的话，那就是在选择类时会比较困惑，到底用哪一个呢？<br>其实如果你不太确定的话，用 Path 就可以了，这也是为什么它的名称最短的原因。</p>
<p>PurePath 有两个子类，一个是 <code>PureWindowsPath</code>，表示 Windows 下的路径，不区分大小写，<br>另一个是 <code>PurePosixPath</code>，表示其他系统的路径。</p>
<p>PurePath 可以在任何操作系统上实例化，也就是说与平台无关，<br>你可以在 unix 系统上使用 PureWindowsPath，<br>也可以在 Windows 系统上使用 PurePosixPath，<br>他们还可以相互比较，同一个类可以相互比较，不同的类比较的结果是 False。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> pathlib <span class="keyword">import</span> PurePosixPath, PureWindowsPath, PosixPath</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PurePosixPath(<span class="string">'a'</span>) == PurePosixPath(<span class="string">'b'</span>)</span><br><span class="line"><span class="literal">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PurePosixPath(<span class="string">'a'</span>) &lt; PurePosixPath(<span class="string">'b'</span>)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PurePosixPath(<span class="string">'a'</span>) == PosixPath(<span class="string">'a'</span>)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PurePosixPath(<span class="string">'a'</span>) == PureWindowsPath(<span class="string">'a'</span>)</span><br><span class="line"><span class="literal">False</span></span><br></pre></td></tr></tbody></table></figure>

<p>包含 I/O 操作的类 <code>PosixPath</code> 及 <code>WindowsPath</code> 只能在对应的平台实例化</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># idle win</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> pathlib <span class="keyword">import</span> PosixPath</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>WindowsPath(<span class="string">'a'</span>)</span><br><span class="line">WindowsPath(<span class="string">'a'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PosixPath(<span class="string">'a'</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">"C:\Users\rose\AppData\Local\Programs\Python\Python38\lib\pathlib.py"</span>, line <span class="number">1020</span>, <span class="keyword">in</span> __new__</span><br><span class="line">    <span class="keyword">raise</span> NotImplementedError(<span class="string">"cannot instantiate %r on your system"</span></span><br><span class="line">NotImplementedError: cannot instantiate <span class="string">'PosixPath'</span> on your system</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># idle linux</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> pathlib <span class="keyword">import</span> PosixPath, WindowsPath</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PosixPath(<span class="string">'a'</span>)</span><br><span class="line">PosixPath(<span class="string">'a'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>WindowsPath(<span class="string">'a'</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">"/usr/local/lib/python3.8/pathlib.py"</span>, line <span class="number">1043</span>, <span class="keyword">in</span> __new__</span><br><span class="line">    <span class="keyword">raise</span> NotImplementedError(<span class="string">"cannot instantiate %r on your system"</span></span><br><span class="line">NotImplementedError: cannot instantiate <span class="string">'WindowsPath'</span> on your system</span><br></pre></td></tr></tbody></table></figure>

<p>django的setting.py</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">verifyConst</span>(<span class="params">varname, var</span>):</span></span><br><span class="line">    varname += <span class="string">' : '</span></span><br><span class="line">    print(varname + str(var))</span><br><span class="line"></span><br><span class="line">verifyConst(<span class="string">'__file__'</span>, __file__)</span><br><span class="line">verifyConst(<span class="string">'Path(__file__)'</span>, Path(__file__))</span><br><span class="line">verifyConst(<span class="string">'Path(__file__).resolve()'</span>, Path(__file__).resolve())</span><br><span class="line">verifyConst(<span class="string">'Path(__file__).resolve().parent'</span>, Path(__file__).resolve().parent)</span><br><span class="line">verifyConst(<span class="string">'BASE_DIR'</span>, BASE_DIR)</span><br><span class="line">print()</span><br></pre></td></tr></tbody></table></figure>

<p>python中的<code>os.system(cmd)</code> 可以执行系统命令，调用其它程序</p>
<h3 id="Linux下面"><a href="#Linux下面" class="headerlink" title="Linux下面"></a>Linux下面</h3><p>python程序使用 <code>os.system</code>来调用其它程序时，返回值是一个16位的数字，<br> 低位字节 表示结束进程的信号数值，如果低8位字节值为0， 高8位字节表示退出码</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">print(os.system(<span class="string">'ifconfig'</span>))</span><br></pre></td></tr></tbody></table></figure>
<p>在Linux平台上 只需要在命令末尾加上shell后台运算符<code>&amp;</code>即可：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.system(<span class="string">'ping www.baidu.com &amp;'</span>)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="windows-下面，python程序使用-os-system来调用其它程序时，返回值就是被调用程序的退出码"><a href="#windows-下面，python程序使用-os-system来调用其它程序时，返回值就是被调用程序的退出码" class="headerlink" title="windows 下面，python程序使用 os.system来调用其它程序时，返回值就是被调用程序的退出码"></a>windows 下面，python程序使用 <code>os.system</code>来调用其它程序时，返回值就是被调用程序的退出码</h3><p>加不加<code>print()</code>都一样会在终端输出</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.system(<span class="string">'ipconfig'</span>)</span><br><span class="line">print(os.system(<span class="string">'ipconfig'</span>))</span><br><span class="line">print(os.system(<span class="string">'dir'</span>))  <span class="comment"># 显示当前文件夹下的全部目录和文件夹</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>os.system('del e:\\test\\test.txt')</code>  删除指定文件夹下的文件<br><code>os.system('rd e:\\test')</code>  删除一个空文件夹<br><code>os.system('taskkill  /F /IM chrome.exe')</code> 关闭进程</p>
<p>在python 中执行 <code>os.system(“ping www.baidu.com”) </code>等命令的时候会阻塞，<br>它会等待 <code>os.system</code> 里的命令执行完才会返回。<br>有的时候我们需要并行运行：</p>
<p>用DOS的<code>start</code>命令通常也能使命令并行启动：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">os.system(<span class="string">'start ping www.baidu.com'</span>)  <span class="comment"># 在终端显示结果</span></span><br><span class="line">os.system(<span class="string">'start ping www.baidu.com'</span>)  <span class="comment"># 弹出cmd程序运行 </span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="调用其它程序，并且判断其返回码"><a href="#调用其它程序，并且判断其返回码" class="headerlink" title="调用其它程序，并且判断其返回码"></a>调用其它程序，并且判断其返回码</h2><p>程序执行结束退出，会有一个退出码。通常表示程序是否正确执行退出，<br>如果执行成功，那么会返回<code>0</code>，表示命令执行成功<br> 不管是windows，Linux， Python使用 os.system 调用 其它程序，该程序的退出码如果是0，os.system 调用 返回码肯定也是0。判断调用这个程序是否成功。 那么只需要根据调用的返回值是否为零即可判断。</p>
<h3 id="win"><a href="#win" class="headerlink" title="win"></a>win</h3><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">ret = os.system(<span class="string">'dir C:\\abc'</span>)</span><br><span class="line"><span class="keyword">if</span> ret==<span class="number">0</span>:</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">'被调用程序正常退出'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">'被调用程序异常退出'</span>)</span><br><span class="line"><span class="comment">#  驱动器 C 中的卷是 OS</span></span><br><span class="line"><span class="comment">#  卷的序列号是 127E-A945</span></span><br><span class="line"><span class="comment">#  C:\abc 的目录</span></span><br><span class="line"><span class="comment"># 2020/04/19  09:47    &lt;DIR&gt;          第2章 面试流程介绍</span></span><br><span class="line"><span class="comment"># 2020/03/01  22:17    &lt;DIR&gt;          网络工程师</span></span><br><span class="line"><span class="comment">#               14 个文件    337,432,340 字节</span></span><br><span class="line"><span class="comment">#               32 个目录 26,577,518,592 可用字节</span></span><br><span class="line"><span class="comment"># 被调用程序正常退出</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># path = 'C:/abc'  # win不支持</span></span><br><span class="line">path = <span class="string">'C:\\abc'</span>  </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> os.system(<span class="string">"dir {}"</span>.format(path)) == <span class="number">0</span>:</span><br><span class="line">    print(<span class="string">"return 0 represent success!"</span>)</span><br><span class="line"><span class="comment"># 2021/04/03  23:30    &lt;DIR&gt;          .</span></span><br><span class="line"><span class="comment"># 2021/04/03  23:30    &lt;DIR&gt;          ..</span></span><br><span class="line"><span class="comment"># 2020/03/31  18:34       187,965,472 AtomSetup-x64.exe</span></span><br><span class="line"><span class="comment"># 2021/02/24  13:00           330,823 Carefree_1.9.dsf</span></span><br><span class="line"><span class="comment">#               14 个文件    337,432,340 字节</span></span><br><span class="line"><span class="comment">#               32 个目录 26,576,957,440 可用字节</span></span><br><span class="line"><span class="comment"># return 0 represent success!</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h3><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding = utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">path = <span class="string">'/root/Downloads/dir/'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> os.system(<span class="string">"ls {}"</span>.format(path)) == <span class="number">0</span>:</span><br><span class="line">    print(<span class="string">"return 0 represent success!"</span>)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="调用其它程序，并且获取输出结果"><a href="#调用其它程序，并且获取输出结果" class="headerlink" title="调用其它程序，并且获取输出结果"></a>调用其它程序，并且获取输出结果</h2><p>如果想获取被调用的程序输出到终端的信息 并进行处理，可以使用 <code>subprocess</code>库里面的<code>check_output</code> 函数，参数<code>encoding</code>应该设置为该程序输出信息文本的编码方式。 很多程序通常会根据当前终端使用的字符编码格式来决定 输出文本的编码方式。<br>比如 通常在中文windows的cmd终端上，字符编码方式为 <code>gbk</code>，<br>正确指定了字符编码方式， <code>check_output</code> 函数 才能正确将 终端上输出的 文本字节串，解码为python里面的unicode字符串对象</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line">info = subprocess.check_output(<span class="string">'dir'</span>, shell=<span class="literal">True</span>, encoding=<span class="string">'gbk'</span>)</span><br><span class="line">print(info)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> 驱动器 C 中的卷是 OS</span><br><span class="line"> 卷的序列号是 <span class="number">127</span>E-A945</span><br><span class="line"></span><br><span class="line"> C:\python代码\牛客网剑指offer66题思路分析 的目录</span><br><span class="line"></span><br><span class="line"><span class="number">2021</span>/<span class="number">03</span>/<span class="number">08</span>  <span class="number">22</span>:<span class="number">18</span>    &lt;DIR&gt;          .</span><br><span class="line"><span class="number">2021</span>/<span class="number">03</span>/<span class="number">08</span>  <span class="number">22</span>:<span class="number">18</span>    &lt;DIR&gt;          ..</span><br><span class="line"><span class="number">2021</span>/<span class="number">02</span>/<span class="number">24</span>  <span class="number">11</span>:<span class="number">36</span>    &lt;DIR&gt;          .idea</span><br><span class="line"><span class="number">2020</span>/<span class="number">12</span>/<span class="number">26</span>  <span class="number">16</span>:<span class="number">18</span>    &lt;DIR&gt;          .pytest_cache</span><br><span class="line"><span class="number">2021</span>/<span class="number">01</span>/<span class="number">24</span>  <span class="number">10</span>:<span class="number">29</span>    &lt;DIR&gt;          .vscode</span><br><span class="line"><span class="number">2021</span>/<span class="number">03</span>/<span class="number">27</span>  <span class="number">20</span>:<span class="number">07</span>    &lt;DIR&gt;          <span class="number">6</span>大排序</span><br><span class="line"><span class="number">2021</span>/<span class="number">02</span>/<span class="number">25</span>  <span class="number">12</span>:<span class="number">52</span>    &lt;DIR&gt;          Python<span class="number">-100</span>-Days-master2021/<span class="number">01</span>/<span class="number">24</span>  <span class="number">21</span>:<span class="number">08</span>    &lt;DIR&gt;          python_data_structures_and_algorithms-master</span><br><span class="line"><span class="number">2021</span>/<span class="number">02</span>/<span class="number">18</span>  <span class="number">20</span>:<span class="number">36</span>    &lt;DIR&gt;          __pycache__</span><br><span class="line"><span class="number">2021</span>/<span class="number">04</span>/<span class="number">04</span>  <span class="number">16</span>:<span class="number">04</span>    &lt;DIR&gt;          代码</span><br><span class="line"><span class="number">2021</span>/<span class="number">03</span>/<span class="number">08</span>  <span class="number">20</span>:<span class="number">34</span>    &lt;DIR&gt;          图解说明</span><br><span class="line"><span class="number">2021</span>/<span class="number">02</span>/<span class="number">24</span>  <span class="number">11</span>:<span class="number">34</span>    &lt;DIR&gt;          爬虫</span><br><span class="line">               <span class="number">0</span> 个文件              <span class="number">0</span> 字节</span><br><span class="line">              <span class="number">12</span> 个目录 <span class="number">26</span>,<span class="number">584</span>,<span class="number">457</span>,<span class="number">216</span> 可用字节</span><br></pre></td></tr></tbody></table></figure>

<p>实时 获取 cmd输出并打印</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line">cmd = <span class="string">'ping www.baidu.com'</span></span><br><span class="line">screenData = subprocess.Popen(cmd, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, shell=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    line = screenData.stdout.readline()</span><br><span class="line">    print(line.decode(<span class="string">'gbk'</span>).strip(<span class="string">"b'"</span>))</span><br><span class="line">    <span class="keyword">if</span> line == <span class="string">b''</span> <span class="keyword">or</span> subprocess.Popen.poll(screenData) == <span class="number">0</span>:</span><br><span class="line">        screenData.stdout.close()</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="非阻塞式调用其它程序"><a href="#非阻塞式调用其它程序" class="headerlink" title="非阻塞式调用其它程序"></a>非阻塞式调用其它程序</h2><p>调用 os.system 和 subprocess.check_output 时，都会等待该程序退出后，才会继续执行后续的代码。</p>
<p>如果我们的Python程序本身并不需要等待外部程序结束。 比如，我们启动 <code>wget</code> 下载命令， 下载1个文件。让它下载就可以了， 然后我们的程序还要继续去做其他的任务。 这时候， 我们就不能用<code>os.system</code>， 因为它会等待 外部程序结束。 我们可以用<code>subprocess</code>里面的<code>Popen</code>，</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(dir(os))</span><br><span class="line"><span class="comment"># &lt;returns a list of all module functions&gt;</span></span><br><span class="line"></span><br><span class="line">print(help(os))</span><br><span class="line"><span class="comment"># &lt;returns an extensive manual page created from the module's docstrings&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>os.path</code></p>
<h3 id="文件目录相关操作"><a href="#文件目录相关操作" class="headerlink" title="文件目录相关操作"></a>文件目录相关操作</h3><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">print(os.path)</span><br><span class="line"><span class="comment"># &lt;module 'ntpath' from 'C:\\Users\\rose\\AppData\\Local\\Programs\\Python\\Python38\\lib\\ntpath.py'&gt;</span></span><br><span class="line">print(sys.path)  <span class="comment"># 模块的路径集</span></span><br><span class="line">[<span class="string">'c:\\python代码\\牛客网剑指offer66题思路分析\\代码'</span>, <span class="string">'C:\\Users\\rose\\AppData\\Local\\Programs\\Python\\Python38\\python38.zip'</span>, <span class="string">'C:\\Users\\rose\\AppData\\Local\\Programs\\Python\\Python38\\DLLs'</span>, <span class="string">'C:\\Users\\rose\\AppData\\Local\\Programs\\Python\\Python38\\lib'</span>, <span class="string">'C:\\Users\\rose\\AppData\\Local\\Programs\\Python\\Python38'</span>, <span class="string">'C:\\Users\\rose\\AppData\\Roaming\\Python\\Python38\\site-packages'</span>, <span class="string">'C:\\Users\\rose\\AppData\\Local\\Programs\\Python\\Python38\\lib\\site-packages'</span>]</span><br><span class="line"></span><br><span class="line">print(<span class="string">'当前 Python 解释器路径：'</span>)</span><br><span class="line">print(sys.executable)</span><br><span class="line"><span class="string">r"""</span></span><br><span class="line"><span class="string">当前 Python 解释器路径：</span></span><br><span class="line"><span class="string">C:\Users\rose\AppData\Local\Programs\Python\Python38\python.exe</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'当前 Python 解释器目录：'</span>)</span><br><span class="line">print(os.path.dirname(sys.executable))</span><br><span class="line"><span class="string">r"""</span></span><br><span class="line"><span class="string">当前 Python 解释器目录：</span></span><br><span class="line"><span class="string">C:\Users\rose\AppData\Local\Programs\Python\Python38</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>os.path.basename(path)</code> 返回文件名</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">print(os.path.basename(<span class="string">'/root/runoob.txt'</span>))  <span class="comment"># runoob.txt</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>os.path.dirname(path)</code> 返回文件目录路径</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(os.path.dirname(<span class="string">'/root/test/runoob.txt'</span>))  <span class="comment"># /root/test</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>os.path.split(path)</code> 用元祖返回目录路径和文件名，且两者用”,”分割</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">print(os.path.split(<span class="string">'/root/test/runoob.txt'</span>))  <span class="comment"># ('/root/test', 'runoob.txt')</span></span><br></pre></td></tr></tbody></table></figure>

<p>路径的拼接。<br><code>os.path.join(path1[, path2[, ...]])</code> 当前所处的文件夹上一级文件夹的绝对路径，把目录和文件名拼接合成一个路径</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">print(os.path.join(<span class="string">'root'</span>, <span class="string">'test'</span>, <span class="string">'runoob.txt'</span>))  <span class="comment"># root\test\runoob.txt</span></span><br><span class="line"></span><br><span class="line">STATICFILES_DIRS = [</span><br><span class="line">    os.path.join(BASE_DIR, <span class="string">"static"</span>),</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

<p><code>pathlib</code>用<code>/</code>连接符拼接系统路径。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line"><span class="comment"># Build paths inside the project like this: BASE_DIR / 'subdir'.</span></span><br><span class="line">STATICFILES_DIRS = [</span><br><span class="line">    BASE_DIR / <span class="string">"static"</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ide run</span></span><br><span class="line">p = Path(<span class="string">'foo'</span>)</span><br><span class="line">print(p / <span class="string">'bar'</span>)</span><br><span class="line"><span class="comment"># foo\bar</span></span><br><span class="line">print(<span class="string">'bar'</span> / p)</span><br><span class="line"><span class="comment"># bar\foo</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># idle win</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = Path(<span class="string">'foo'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p / <span class="string">'bar'</span></span><br><span class="line">WindowsPath(<span class="string">'foo/bar'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p / Path(<span class="string">'bar'</span>)</span><br><span class="line">WindowsPath(<span class="string">'foo/bar'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'bar'</span> / p</span><br><span class="line">WindowsPath(<span class="string">'bar/foo'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># idle linux</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = Path(<span class="string">'foo'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p / <span class="string">'bar'</span></span><br><span class="line">PosixPath(<span class="string">'foo/bar'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p / Path(<span class="string">'bar'</span>)</span><br><span class="line">PosixPath(<span class="string">'foo/bar'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'bar'</span> / p</span><br><span class="line">PosixPath(<span class="string">'bar/foo'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p><code>PurePosixPath</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> PurePosixPath</span><br><span class="line"></span><br><span class="line"><span class="comment"># ide run</span></span><br><span class="line">p = PurePosixPath(<span class="string">'foo'</span>)</span><br><span class="line">print(p / <span class="string">'bar'</span>)</span><br><span class="line"><span class="comment"># foo/bar</span></span><br><span class="line">print(p / PurePosixPath(<span class="string">'bar'</span>))</span><br><span class="line"><span class="comment"># foo/bar</span></span><br><span class="line">print(<span class="string">'bar'</span> / p)</span><br><span class="line"><span class="comment"># bar/foo</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># idle  linux和win一样</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = PurePosixPath(<span class="string">'foo'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p / <span class="string">'bar'</span></span><br><span class="line">PurePosixPath(<span class="string">'foo/bar'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p / PurePosixPath(<span class="string">'bar'</span>)</span><br><span class="line">PurePosixPath(<span class="string">'foo/bar'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'bar'</span> / p</span><br><span class="line">PurePosixPath(<span class="string">'bar/foo'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PurePosixPath(<span class="string">'/etc'</span>).joinpath(<span class="string">'passwd'</span>)</span><br><span class="line">PurePosixPath(<span class="string">'/etc/passwd'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PurePosixPath(<span class="string">'/etc'</span>).joinpath(PurePosixPath(<span class="string">'passwd'</span>))</span><br><span class="line">PurePosixPath(<span class="string">'/etc/passwd'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PurePosixPath(<span class="string">'/etc'</span>).joinpath(<span class="string">'init.d'</span>, <span class="string">'apache2'</span>)</span><br><span class="line">PurePosixPath(<span class="string">'/etc/init.d/apache2'</span>)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> PureWindowsPath</span><br><span class="line"></span><br><span class="line"><span class="comment"># ide run</span></span><br><span class="line">print(PureWindowsPath(<span class="string">'c:'</span>).joinpath(<span class="string">'/Program Files'</span>))</span><br><span class="line"><span class="comment"># c:\Program Files</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># idle linux和win一样</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PureWindowsPath(<span class="string">'c:'</span>).joinpath(<span class="string">'/Program Files'</span>)</span><br><span class="line">PureWindowsPath(<span class="string">'c:/Program Files'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对路径进行比较</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PureWindowsPath(<span class="string">'a'</span>) == PureWindowsPath(<span class="string">'A'</span>)</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>os.path.splitext(path)</code><br>Split the pathname path into a pair (root, ext) such that root + ext == path, and ext is empty or begins with a period and contains at most one period. Leading periods on the basename are ignored; splitext(‘.cshrc’) returns (‘.cshrc’, ‘’).</p>
<p>获取给定路径文件名及文件扩展名<br>获取文件名(name)，文件名主体部分(stem)和文件后缀(suffix)</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">filename = os.path.basename(<span class="string">'/home/www/index.html'</span>)</span><br><span class="line">print(filename)  <span class="comment"># index.html</span></span><br><span class="line">stem, suffix = os.path.splitext(filename)</span><br><span class="line">print(stem)  <span class="comment"># index</span></span><br><span class="line">print(suffix)  <span class="comment"># .html</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">fp = Path(<span class="string">'/home/www/index.html'</span>)</span><br><span class="line">print(fp.name)  <span class="comment"># index.html</span></span><br><span class="line">print(fp.stem)  <span class="comment"># index</span></span><br><span class="line">print(fp.suffix)  <span class="comment"># .html</span></span><br></pre></td></tr></tbody></table></figure>


<p><code>os.path.exists("path")</code>如果路径存在，返回True；如果路径不存在，返回False</p>
<p>在aa文件夹下创建了bb,cc两个文件夹，并且用ls展示出来</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># path = r'/root/Download/dir/'</span></span><br><span class="line">path = <span class="string">r'C:\abc'</span></span><br><span class="line">pathb = <span class="string">'{}{}'</span>.format(path, <span class="string">'\Potplayer'</span>)</span><br><span class="line">pathc = <span class="string">'{}{}'</span>.format(path, <span class="string">'\cc'</span>)</span><br><span class="line"></span><br><span class="line">print(os.path.exists(pathb))  <span class="comment"># True</span></span><br><span class="line">print(os.path.exists(pathc))  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line">print(Path(path).exists())  <span class="comment"># True</span></span><br><span class="line">print(Path(pathc).exists())  <span class="comment"># False</span></span><br></pre></td></tr></tbody></table></figure>


<p><code>os.path.isdir("dir1")</code>判断是否是文件夹，<br><code>os.path.isfile("file")</code>判断是否是文件</p>
<p><code>os.path.abspath('.')</code>表示当前所处的文件夹的绝对路径 <code>Path('.').resolve</code><br><code>os.path.abspath('..')</code>表示当前所处的文件夹上一级文件夹的绝对路径 <code>Path('..').resolve</code></p>
<p><code>os.listdir(path)</code>返回指定的文件夹所包含的文件或文件夹名字的列表。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">path = <span class="string">r'C:\abc'</span></span><br><span class="line">pathb = <span class="string">'{}{}'</span>.format(path, <span class="string">'\Potplayer'</span>)</span><br><span class="line">print(os.listdir(pathb))</span><br><span class="line"><span class="comment"># ['!)卸载清除.bat', '!)选项配置.reg', 'ATextOut64.dll', 'AviSynth', 'Capture', 'CaptureUWP64.dll', 'CmdLine64.txt', 'd3dcompiler_47.dll', 'd3dx9_43.dll', 'DaumCrashHandler64.dll', 'DesktopHook.dll', 'DesktopHook.exe', 'DTDrop64.exe', 'Extension', 'ffcodec64.dll', 'GameCaptureHook.dll', 'GameCaptureHook64.dll', 'History', 'IconPack', 'Language', 'Logos', 'MediaDB64.dll', 'MediaInfo.sdb', 'Menus', 'Module', 'Playlist', 'PotIcons64.dll', 'PotPlayer64.dll', 'PotPlayerMini64.exe', 'PotPlayerTools.exe', 'PxShader', 'Skins', 'UrlList', 'VapourSynth']</span></span><br><span class="line"></span><br><span class="line">b = Path(<span class="string">"pathb"</span>)</span><br><span class="line"></span><br><span class="line">print(b.iterdir())</span><br><span class="line"><span class="comment"># &lt;generator object Path.iterdir at 0x7fa3f20d95f0&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(list(b.iterdir()))</span></span><br></pre></td></tr></tbody></table></figure>


<h3 id="执行文件处理操作的方法"><a href="#执行文件处理操作的方法" class="headerlink" title="执行文件处理操作的方法"></a>执行文件处理操作的方法</h3><p><code>os.rename(current_file_name, new_file_name)</code>重命名文件<br>两个参数，当前的文件名和新文件名。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重命名一个已经存在的文件test1.txt到test2.txt。</span></span><br><span class="line">os.rename( <span class="string">"test1.txt"</span>, <span class="string">"test2.txt"</span> )</span><br></pre></td></tr></tbody></table></figure>

<p><code>os.unlink(file_name)</code>删除文件<br>unlink的功能和remove一样是删除一个文件，但是删除一个删除一个正在使用的文件会报错。</p>
<p><code>os.remove(file_name)</code>删除文件，path是文件的路径，<br>如果这个路径是一个文件夹，则会抛出OSError的错误，这时需用用<code>rmdir()</code>来删除</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除一个已经存在的文件test2.txt</span></span><br><span class="line">os.remove(<span class="string">"test2.txt"</span>)</span><br></pre></td></tr></tbody></table></figure>

<p><code>os.rmdir('dirname')</code>删除空文件夹目录，path是文件夹路径，目录名称以参数传递。 等同于<code>Path.rmdir()</code><br>在删除这个目录之前，它的所有内容应该先被清除</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除”/tmp/test”目录</span></span><br><span class="line">os.rmdir( <span class="string">"/tmp/test"</span>  )</span><br></pre></td></tr></tbody></table></figure>

<p><code>os.removedirs(path)</code> 递归地删除目录。如果子目录成功被删除，则将会成功删除父目录，子目录没成功删除，将抛异常。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(top, topdown=<span class="literal">False</span>):</span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> files:</span><br><span class="line">        os.remove(os.path.join(root, name))</span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> dirs:</span><br><span class="line">        os.rmdir(os.path.join(root, name))</span><br></pre></td></tr></tbody></table></figure>

<p><code>shutil.rmtree()</code></p>
<p>创建文件目录<br><code>os.mkdir("newdir")</code>在当前目录下创建新的一级目录们。你需要提供一个包含了要创建的目录名称的参数。<br><code>os.mkdirs("newdir")</code>在当前目录下逐级创建新的目录们。你需要提供一个包含了要创建的目录名称的参数。</p>
<p><code>Path('test').mkdir()</code><br><code>Path('/base/child').mkdir(parents=True, exist_ok=True)</code>，如果希望逐级创建目录，需指定 <code>parents=True</code> 。如果希望指定在目标目录不存在时才创建文件夹，需设置 <code>exist_ok=True</code> 。以下两者等同。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在当前目录下创建一个目录test</span></span><br><span class="line">os.mkdir(<span class="string">"test"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(pathb):</span><br><span class="line">    os.system(<span class="string">"mkdir {}"</span>.format(pathb))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(pathc):</span><br><span class="line">    os.system(<span class="string">"mkdir {}"</span>.format(pathc))</span><br><span class="line"></span><br><span class="line">os.system(path)</span><br><span class="line"><span class="comment"># bb cc</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(os.path.join(<span class="string">"base"</span>, <span class="string">"child"</span>)):</span><br><span class="line">    os.makedirs(<span class="string">'/base/child'</span>)</span><br><span class="line"></span><br><span class="line">Path(<span class="string">'/base/child'</span>).mkdir(parents=<span class="literal">True</span>, exist_ok=<span class="literal">True</span>)</span><br></pre></td></tr></tbody></table></figure>


<p><code>os.chdir("newdir")</code>切换修改当前的工作目录<br>参数是你想设成当前目录的目录名称</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将当前目录改为"/home/newdir"</span></span><br><span class="line">os.chdir(<span class="string">"/home/newdir"</span>)</span><br></pre></td></tr></tbody></table></figure>

<p><code>os.getcwd()</code>当前的工作目录路径 等同于<code>Path.cwd()</code><br>参数是你想设成当前目录的目录名称</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">print(os.getcwd())  <span class="comment"># C:\abc</span></span><br><span class="line">print(type(os.getcwd()))  <span class="comment"># &lt;class 'str'&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># win</span></span><br><span class="line">print(Path.cwd())  <span class="comment"># C:\abc</span></span><br><span class="line">print(type(Path.cwd()))  <span class="comment"># &lt;class 'pathlib.WindowsPath'&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># linux</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Path.cwd()</span><br><span class="line">PosixPath(<span class="string">'/root'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(Path.cwd())</span><br><span class="line">/root</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(type(Path.cwd()))</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">pathlib</span>.<span class="title">PosixPath</span>'&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>Python 3.4版本及以后的标准库添加了新的模块<code>pathlib</code>，它使用面向对象的编程方式来表示和处理文件系统路径。<br>Django 3.1版本以后也将首选使用<code>pathlib</code>来拼接文件路径，来替代传统的<code>os.path</code>模块。</p>
<p>Django 3.0及以前版本默认配置文件 <code>settings.py</code> 中项目根目录 <code>BASE_DIR</code> 是使用<code>os.path</code>生成的，<br>意思是项目根目录为<code>settings.py</code>所在文件夹的上级文件夹。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))</span><br></pre></td></tr></tbody></table></figure>

<p>Django 3.1及以后使用pathlib的代码更简洁，且使用了链式查找，<br>是项目根目录为文件所在路径的父级目录的父级目录。<br>如果目录层级非常多（比如大于4层），使用<code>os.path</code>查找根目录的代码将非常的长，<br>而使用<code>pathlib</code>只需要在路径后面多加几个<code>.parent</code>就好了。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">BASE_DIR = Path(__file__).resolve(strict=<span class="literal">True</span>).parent.parent</span><br></pre></td></tr></tbody></table></figure>



<p>查找指定文件夹文件，pathlib支持通配符<code>*</code>，os 不支持含有通配符<code>*</code>的路径<br>指定目录所有的python文件名</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p = Path(<span class="string">r'C:\django'</span>)</span><br><span class="line">print([x <span class="keyword">for</span> x <span class="keyword">in</span> p.glob(<span class="string">'*.py'</span>)])</span><br><span class="line"></span><br><span class="line">path = <span class="string">r'C:\abc'</span></span><br><span class="line">pathb = <span class="string">'{}{}'</span>.format(path, <span class="string">'\Potplayer'</span>)</span><br><span class="line">print(list(Path(pathb).glob(<span class="string">"*.txt"</span>)))</span><br><span class="line"><span class="comment"># [WindowsPath('C:/abc/Potplayer/CmdLine64.txt')]</span></span><br></pre></td></tr></tbody></table></figure>

<p>路径匹配</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>PurePath(<span class="string">'a/b.py'</span>).match(<span class="string">'*.py'</span>)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PurePath(<span class="string">'/a/b/c.py'</span>).match(<span class="string">'b/*.py'</span>)</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PurePath(<span class="string">'/a/b/c.py'</span>).match(<span class="string">'a/*.py'</span>)</span><br><span class="line"><span class="literal">False</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="读写文件"><a href="#读写文件" class="headerlink" title="读写文件"></a>读写文件</h4><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">f = Path(<span class="string">'test_dir/test.txt'</span>))</span><br><span class="line">f.write_text(<span class="string">'This is a sentence.'</span>)</span><br><span class="line">f.read_text()</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = Path(<span class="string">'setup.py'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> p.open() <span class="keyword">as</span> f: f.readline()</span><br><span class="line">...</span><br><span class="line"><span class="string">'#!/usr/bin/env python3\n'</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="获取文件的元数据"><a href="#获取文件的元数据" class="headerlink" title="获取文件的元数据"></a>获取文件的元数据</h4><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">p=Path(<span class="string">r"C:\python代码\牛客网剑指offer66题思路分析\代码/1.py"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ide run</span></span><br><span class="line">print(p)</span><br><span class="line"></span><br><span class="line">print(p.stat())</span><br><span class="line"><span class="comment"># os.stat_result(st_mode=33206, st_ino=52072870691751990, st_dev=310290757, st_nlink=1, st_uid=0, st_gid=0, st_size=974, st_atime=1621246364, st_mtime=1621246360, st_ctime=1617523441)</span></span><br><span class="line"></span><br><span class="line">print(p.parts)  <span class="comment"># ('C:\\', 'python代码', '牛客网剑指offer66题思路分析', '代码', '1.py')</span></span><br><span class="line"></span><br><span class="line">print(p.parent)  <span class="comment"># C:\python代码\牛客网剑指offer66题思路分析\代码</span></span><br><span class="line"></span><br><span class="line">print(p.resolve())</span><br><span class="line"><span class="comment"># C:\python代码\牛客网剑指offer66题思路分析\代码\1.py</span></span><br><span class="line"></span><br><span class="line">print(p.exists())  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line">print(p.is_dir())  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line">print(p.is_file())  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(p.owner())  # NotImplementedError: Path.owner() is unsupported on this system</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(p.group())  # NotImplementedError: Path.owner() is unsupported on this system</span></span><br><span class="line"></span><br><span class="line">print(p.name)  <span class="comment"># '1.py'</span></span><br><span class="line"></span><br><span class="line">print(p.suffix)  <span class="comment"># '.py'</span></span><br><span class="line"></span><br><span class="line">print(p.suffixes)  <span class="comment"># ['.py']</span></span><br><span class="line"></span><br><span class="line">print(p.stem)  <span class="comment"># '1'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># idle win</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p</span><br><span class="line"><span class="comment"># WindowsPath('C:/python代码/牛客网剑指offer66题思路分析/代码/1.py')</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.parent</span><br><span class="line">WindowsPath(<span class="string">'C:/python代码/牛客网剑指offer66题思路分析/代码'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(p.parent)</span><br><span class="line">C:\python代码\牛客网剑指offer66题思路分析\代码</span><br><span class="line"></span><br><span class="line"><span class="comment"># idle linux</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p=Path(<span class="string">r"C:\python代码\牛客网剑指offer66题思路分析\代码/1.py"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p</span><br><span class="line">PosixPath(<span class="string">'C:\\python代码\\牛客网剑指offer66题思路分析\\代码/1.py'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.parent</span><br><span class="line">PosixPath(<span class="string">'C:\\python代码\\牛客网剑指offer66题思路分析\\代码'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(p.parent)</span><br><span class="line">C:\python代码\牛客网剑指offer66题思路分析\代码</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">p=Path(<span class="string">r"/Users/aaron/tmp/c.py"</span>)</span><br><span class="line"></span><br><span class="line">print(p)</span><br><span class="line"></span><br><span class="line">print(p.stat())</span><br><span class="line"><span class="comment"># os.stat_result(st_mode=33188, st_ino=35768389, st_dev=16777221, st_nlink=1, st_uid=501, st_gid=20, st_size=20, st_atime=1620633580, st_mtime=1620633578, st_ctime=1620633578)</span></span><br><span class="line"></span><br><span class="line">print(p.parts)  <span class="comment"># ('/', 'Users', 'aaron', 'tmp', 'c.py')</span></span><br><span class="line"></span><br><span class="line">print(p.parent)  <span class="comment"># PosixPath('/Users/aaron/tmp')</span></span><br><span class="line"></span><br><span class="line">print(p.resolve())</span><br><span class="line"><span class="comment"># PosixPath('/Users/aaron/tmp/c.py')</span></span><br><span class="line"></span><br><span class="line">print(p.exists())  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line">print(p.is_dir())  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line">print(p.is_file())  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line">print(p.owner())  <span class="comment"># 'aaron'</span></span><br><span class="line"></span><br><span class="line">print(p.group())  <span class="comment"># 'staff'</span></span><br><span class="line"></span><br><span class="line">print(p.name)  <span class="comment"># 'c.py'</span></span><br><span class="line"></span><br><span class="line">print(p.suffix)  <span class="comment"># '.py'</span></span><br><span class="line"></span><br><span class="line">print(p.suffixes)  <span class="comment"># ['.py']</span></span><br><span class="line"></span><br><span class="line">print(p.stem)  <span class="comment"># 'c'</span></span><br></pre></td></tr></tbody></table></figure>


<p>获得当前工作目录并判断是否为目录</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">os.path.isdir(os.getcwd())</span><br><span class="line"></span><br><span class="line">Path.cwd().is_dir()  <span class="comment"># 支持链式查询</span></span><br></pre></td></tr></tbody></table></figure>

<p>获取家目录</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Path.home()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Path.home()</span><br><span class="line">WindowsPath(<span class="string">'C:/Users/rose'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Path.home()</span><br><span class="line">PosixPath(<span class="string">'/root'</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Path.home()</span><br><span class="line">PosixPath(<span class="string">'/Users/ashe'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>父目录的层级获取</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = PureWindowsPath(<span class="string">'c:/foo/bar/setup.py'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.parents[<span class="number">0</span>]</span><br><span class="line">PureWindowsPath(<span class="string">'c:/foo/bar'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.parents[<span class="number">1</span>]</span><br><span class="line">PureWindowsPath(<span class="string">'c:/foo'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.parents[<span class="number">2</span>]</span><br><span class="line">PureWindowsPath(<span class="string">'c:/'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>获取多个文件后辍：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>PurePosixPath(<span class="string">'my/library.tar.gar'</span>).suffixes</span><br><span class="line">[<span class="string">'.tar'</span>, <span class="string">'.gar'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PurePosixPath(<span class="string">'my/library.tar.gz'</span>).suffixes</span><br><span class="line">[<span class="string">'.tar'</span>, <span class="string">'.gz'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PurePosixPath(<span class="string">'my/library'</span>).suffixes</span><br></pre></td></tr></tbody></table></figure>

<p>Windows 风格转 Posix:</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = PureWindowsPath(<span class="string">'c:\\windows'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str(p)</span><br><span class="line"><span class="string">'c:\\windows'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.as_posix()</span><br><span class="line"><span class="string">'c:/windows'</span></span><br></pre></td></tr></tbody></table></figure>

<p>获取文件的 uri：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = PurePosixPath(<span class="string">'/etc/passwd'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.as_uri()</span><br><span class="line"><span class="string">'file:///etc/passwd'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = PureWindowsPath(<span class="string">'c:/Windows'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.as_uri()</span><br><span class="line"><span class="string">'file:///c:/Windows'</span></span><br></pre></td></tr></tbody></table></figure>

<p>判断是否绝对路径：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>PurePosixPath(<span class="string">'/a/b'</span>).is_absolute()</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PurePosixPath(<span class="string">'a/b'</span>).is_absolute()</span><br><span class="line"><span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PureWindowsPath(<span class="string">'c:/a/b'</span>).is_absolute()</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PureWindowsPath(<span class="string">'/a/b'</span>).is_absolute()</span><br><span class="line"><span class="literal">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PureWindowsPath(<span class="string">'c:'</span>).is_absolute()</span><br><span class="line"><span class="literal">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>PureWindowsPath(<span class="string">'//some/share'</span>).is_absolute()</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></tbody></table></figure>

<p>文件名若有变化：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>p = PureWindowsPath(<span class="string">'c:/Downloads/pathlib.tar.gz'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.with_name(<span class="string">'setup.py'</span>)</span><br><span class="line">PureWindowsPath(<span class="string">'c:/Downloads/setup.py'</span>)</span><br></pre></td></tr></tbody></table></figure>


<p>```</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/vue-shi-zhan-xiang-mu-da-jian/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/vue-shi-zhan-xiang-mu-da-jian/" class="post-title-link" itemprop="url">Vue实战项目搭建</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-06-09 15:52:03" itemprop="dateModified" datetime="2021-06-09T15:52:03Z">2021-06-09</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%85%E6%B8%B8%E7%BD%91%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">旅游网项目</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="项目的搭建"><a href="#项目的搭建" class="headerlink" title="项目的搭建"></a>项目的搭建</h3><ul>
<li>项目公共的配置（ajax配置、项目结构、目录等）</li>
<li>前后端通信方式（接口规范、错误码等）</li>
</ul>
<h3 id="开发的流程"><a href="#开发的流程" class="headerlink" title="开发的流程"></a>开发的流程</h3><ul>
<li>【前端】实现页面（组件）</li>
<li>【前端】使用假数据，或者是mock数据</li>
<li>【后端】模型分析，建模</li>
<li>【后端】实现接口</li>
<li>【前/后端】接口文档编写</li>
<li>【前/后端】接口联调(对接)</li>
</ul>
<h3 id="实战项目搭建"><a href="#实战项目搭建" class="headerlink" title="实战项目搭建"></a>实战项目搭建</h3><p>操作步骤</p>
<ul>
<li>第一步，使用Vue CLI 搭建项目</li>
<li>第二步，准备好静态资源（图片资源）</li>
<li>第三步，调整生产项目结构</li>
</ul>
<p>项目结构</p>
<ul>
<li>公共的样式<br><code>src/assets/common.less</code></li>
<li>公共js（工具函数、接口地址、配置文件），方便管理api请求的各种逻辑</li>
</ul>
<figure class="highlight less"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 接口地址配置 对后端进行请求</span></span><br><span class="line"><span class="selector-tag">src</span>/<span class="selector-tag">utils</span>/<span class="selector-tag">apis</span><span class="selector-class">.js</span></span><br><span class="line"><span class="comment">// 常量配置</span></span><br><span class="line"><span class="selector-tag">src</span>/<span class="selector-tag">utils</span>/<span class="selector-tag">constants</span><span class="selector-class">.js</span></span><br><span class="line"><span class="comment">// 工具函数</span></span><br><span class="line"><span class="selector-tag">src</span>/<span class="selector-tag">utils</span>/<span class="selector-tag">filters</span><span class="selector-class">.js</span></span><br></pre></td></tr></tbody></table></figure>

<p>首页拆解<br>操作步骤</p>
<ul>
<li>第一步，分析首页的结构</li>
<li>第二步，新建页面</li>
<li>第三步，新建对应组件</li>
</ul>
<p>首页组件拆分</p>
<ul>
<li>标题</li>
<li>轮播图（Banner图）</li>
<li>本周推荐</li>
<li>精选景点</li>
<li>底部导航<br>如果组件很多地方都用到过，应该放在<code>/src/component/common</code><br>如果只有某一个页面用到，应该放在<code>/src/component/home</code></li>
</ul>
<h3 id="为何不能在Vue-js中使用AJAX"><a href="#为何不能在Vue-js中使用AJAX" class="headerlink" title="为何不能在Vue.js中使用AJAX"></a>为何不能在Vue.js中使用AJAX</h3><ul>
<li>Ajax是通过浏览器后台与服务器通信的技术</li>
<li>jQuery 中的AJAX只是基于jQuery的实现</li>
<li>在Vue.js中使用jQuery不能充分利用Vue.js的特性</li>
</ul>
<h3 id="axios异步请求库"><a href="#axios异步请求库" class="headerlink" title="axios异步请求库"></a>axios异步请求库</h3><ul>
<li>基于Promise的HTTP库</li>
<li>支持Node.js和浏览器</li>
<li>浏览器：XMLHttpRequest</li>
<li>Node.js：http</li>
</ul>
<p>对axios进行全局配置可提升代码的可维护性</p>
<h3 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h3><ul>
<li>一种异步编程解决方案</li>
<li>Promise其实一直都在，只是在ES6时，才被并入标准库</li>
</ul>
<h3 id="处理回调"><a href="#处理回调" class="headerlink" title="处理回调"></a>处理回调</h3><ul>
<li><code>then</code>函数的使用<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> {</span><br><span class="line"><span class="comment">// 业务逻辑</span></span><br><span class="line">resolve(<span class="number">1</span>);</span><br><span class="line">}).then(<span class="function"><span class="params">res</span> =&gt;</span> {</span><br><span class="line"><span class="comment">// 你的代码1</span></span><br><span class="line">}) .then(<span class="function"><span class="params">res</span> =&gt;</span> {</span><br><span class="line"><span class="comment">// 你的代码2</span></span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h3 id="处理异常"><a href="#处理异常" class="headerlink" title="处理异常"></a>处理异常</h3><p><code>catch</code>函数的使用</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> {</span><br><span class="line">    <span class="comment">// 业务逻辑</span></span><br><span class="line">    reject(<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'It is my fault'</span>))</span><br><span class="line">    }) .then(<span class="function"><span class="params">res</span> =&gt;</span> {</span><br><span class="line">        <span class="comment">// 正常的逻辑代码</span></span><br><span class="line">    }).catch(<span class="function"><span class="params">err</span> =&gt;</span> {</span><br><span class="line">        <span class="comment">// 产生异常后执行的代码</span></span><br><span class="line">    })</span><br></pre></td></tr></tbody></table></figure>

<p>如何安装</p>
<ul>
<li>方式一：引用JS<br><code>&lt;script src="./axios.min.js"&gt;&lt;/script&gt;</code></li>
<li>方式二：使用npm/cnpm/yarn安装<br><code>npm install axios -S</code></li>
</ul>
<h3 id="使用npm-cnpm安装"><a href="#使用npm-cnpm安装" class="headerlink" title="使用npm/cnpm安装"></a>使用npm/cnpm安装</h3><ul>
<li><p>安装到dependencies（生产环境依赖）<br><code>npm install axios --save</code><br>或者<code>npm install axios -S</code></p>
</li>
<li><p>安装到devDependencies（开发环境依赖）<br><code>npm install axios --save-dev</code><br>或者<code>npm install axios -D</code></p>
</li>
</ul>
<h3 id="如何使用axios向后端接口发送请求"><a href="#如何使用axios向后端接口发送请求" class="headerlink" title="如何使用axios向后端接口发送请求"></a>如何使用axios向后端接口发送请求</h3><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">axios.get(url[, config])</span><br><span class="line">axios.delete(url[, config])</span><br><span class="line">axios.head(url[, config])</span><br><span class="line">axios.options(url[, config])</span><br><span class="line">axios.post(url[, data[, config]])</span><br><span class="line">axios.put(url[, data[, config]])</span><br><span class="line">axios.patch(url[, data[, config]])</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>GET请求</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">axios.get(<span class="string">'/user'</span>, {</span><br><span class="line">    params: {</span><br><span class="line">        ID: <span class="number">12345</span></span><br><span class="line">    }</span><br><span class="line">})</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">})</span><br><span class="line">.catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>POST请求</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">axios.post(<span class="string">'/user'</span>, {</span><br><span class="line">    firstName: <span class="string">'Fred'</span>,</span><br><span class="line">    lastName: <span class="string">'Flintstone'</span></span><br><span class="line">})</span><br><span class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">})</span><br><span class="line">.catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h3 id="请求响应拦截"><a href="#请求响应拦截" class="headerlink" title="请求响应拦截"></a>请求响应拦截</h3><h4 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h4><ul>
<li>设置自定义请求头</li>
<li>默认携带上次的cookie</li>
<li>添加loading动画（请求发起前显示、完成后隐藏）</li>
<li>统一的错误处理</li>
</ul>
<h4 id="实现方法"><a href="#实现方法" class="headerlink" title="实现方法"></a>实现方法</h4><ul>
<li>创建axios的实例<br><code>const ajax = axios.create(options)</code></li>
<li>常用参数<ul>
<li><code>headers</code>: 设置请求头</li>
<li><code>timeout</code>: 超时的毫秒数</li>
<li><code>data</code>: POST/PUT/PATCH请求的数据</li>
<li><code>params</code>: URL中的参数</li>
<li><code>responseType</code>: 默认为json</li>
</ul>
</li>
</ul>
<h4 id="设置自定义请求头"><a href="#设置自定义请求头" class="headerlink" title="设置自定义请求头"></a>设置自定义请求头</h4><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ajax = axios.create({</span><br><span class="line">headers: {</span><br><span class="line">source: <span class="string">'h5'</span>,</span><br><span class="line"><span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span></span><br><span class="line">}</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<h4 id="默认携带上次的cookie"><a href="#默认携带上次的cookie" class="headerlink" title="默认携带上次的cookie"></a>默认携带上次的cookie</h4><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ajax = axios.create({</span><br><span class="line">    withCredentials: <span class="literal">true</span></span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<h4 id="添加loading动画"><a href="#添加loading动画" class="headerlink" title="添加loading动画"></a>添加loading动画</h4><ul>
<li><p> 请求拦截</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">axios.interceptors.request.use(<span class="function"><span class="keyword">function</span> (<span class="params">config</span>) </span>{</span><br><span class="line"><span class="comment">// 在发送请求之前做些什么</span></span><br><span class="line"><span class="keyword">return</span> config</span><br><span class="line">}, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>{</span><br><span class="line"><span class="comment">// 对请求错误做些什么</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p> 响应拦截</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">axios.interceptors.response.use(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>{</span><br><span class="line"><span class="comment">// 对响应数据做点什么</span></span><br><span class="line"><span class="keyword">return</span> response</span><br><span class="line">}, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>{</span><br><span class="line"><span class="comment">// 对响应错误做点什么</span></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h4 id="统一的错误处理"><a href="#统一的错误处理" class="headerlink" title="统一的错误处理"></a>统一的错误处理</h4><ul>
<li>400<br>参数错误提示</li>
<li>401<br>未登录，跳转到登录页面</li>
<li>500/504<br>服务器正忙，网络异常/请求超时</li>
</ul>
<h3 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h3><p>前后端联调，涉及最多的就是跨域的问题，<br>出于安全考虑，浏览器要求你的网站不能执行/访问其它网站的资源</p>
<ul>
<li>如何认定为“其它的网站”：<br>通常需要遵循同源策略，即“协议、域名/主机/IP、端口”三者都相同</li>
</ul>
<ul>
<li><p>跨域的影响</p>
<ul>
<li>浏览器本地存储无法使用<br>（Cookie、LocalStorage 和 IndexDB）</li>
<li>DOM对象 、JS 对象无法获取</li>
<li>AJAX无法使用</li>
</ul>
</li>
<li><p>跨域问题解决</p>
<ul>
<li>利用HTML标签的特性<br>script、a、iframe、img、link等</li>
<li>在前端使用代理解决</li>
<li>在服务器端解决<br>CORS(Cross-Origin Resource Sharing)——跨域资源共享，通过添加响应头信息来解决</li>
</ul>
</li>
</ul>
<h4 id="在Vue-js中解决跨域问题"><a href="#在Vue-js中解决跨域问题" class="headerlink" title="在Vue.js中解决跨域问题"></a>在Vue.js中解决跨域问题</h4><ul>
<li>添加配置文件<code>vue.config.js</code><br>添加配置项<br>参数解释</li>
<li> <code>target</code>目标地址</li>
<li> <code>changeOrigin</code>变更请求头中设置的host</li>
<li> <code>pathRewrite</code>URL重写规则<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue.config.js</span></span><br><span class="line"><span class="comment">// Node.js里面的模块</span></span><br><span class="line"><span class="built_in">module</span>.exports = {</span><br><span class="line">  <span class="comment">// http://localhost:8080/api/test</span></span><br><span class="line">  <span class="comment">// =&gt;</span></span><br><span class="line">  <span class="comment">// http://localhost:8000/test</span></span><br><span class="line">  <span class="comment">// 在Vue.js中解决跨域问题</span></span><br><span class="line">  devServer: {</span><br><span class="line">    proxy: {</span><br><span class="line">      <span class="string">'/api'</span>: {</span><br><span class="line">        target: <span class="string">'http://django.t.mukewang.com'</span>,    <span class="comment">// 这个地址的服务器要启动才能访问 </span></span><br><span class="line">        changeOrigin: <span class="literal">true</span>,</span><br><span class="line">        pathRewrite: {</span><br><span class="line">          <span class="string">'^/api'</span>: <span class="string">''</span>   <span class="comment">// 重写的URL，空字符表示把/api字符串去掉</span></span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p>使用axios获取数据</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Home.vue</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> {</span><br><span class="line">  name: <span class="string">'Home'</span>,</span><br><span class="line">  components: {</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    <span class="comment">// ajax.get('http://django.t.mukewang.com/api/system/slider/list/?types=11').then(resp =&gt; {</span></span><br><span class="line">    <span class="comment">// 未登录访问用户信息</span></span><br><span class="line">    <span class="comment">// ajax.get('http://django.t.mukewang.com/api/accounts/user/detail/').then(resp =&gt; {</span></span><br><span class="line">    <span class="comment">// ajax.get('http://localhost:8080/api/system/slider/list/?types=11').then(resp =&gt; {</span></span><br><span class="line">    <span class="comment">// ajax.get('http://localhost:9527/hello/world/').then(resp =&gt; {</span></span><br><span class="line">    ajax.get(<span class="string">'http://localhost:8080/test/hello/world/'</span>).then(<span class="function"><span class="params">resp</span> =&gt;</span> {</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'返回的结果：'</span>, resp)</span><br><span class="line">    }).catch(<span class="function"><span class="params">err</span> =&gt;</span> {</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'请求出错：'</span>, err)</span><br><span class="line">    })</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="在Django中解决跨域问题"><a href="#在Django中解决跨域问题" class="headerlink" title="在Django中解决跨域问题"></a>在Django中解决跨域问题</h4><ul>
<li> 第一步：安装第三方模块 <code>django-cors-headers</code>来解决<br>`bash<blockquote>
<blockquote>
<p>pip install django-cors-headers<br>`</p>
</blockquote>
</blockquote>
</li>
<li> 第二步：配置django的<code>setting.py</code><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [<span class="string">'corsheaders'</span>,]</span><br><span class="line"></span><br><span class="line">MIDDLEWARE_CLASSES = [</span><br><span class="line"><span class="string">'django.middleware.security.SecurityMiddleware'</span>,</span><br><span class="line"><span class="string">'django.contrib.sessions.middleware.SessionMiddleware'</span>,</span><br><span class="line"><span class="string">'corsheaders.middleware.CorsMiddleware'</span>,  <span class="comment"># 中间件CorsMiddleware必须放在django-common中间件的前一个</span></span><br><span class="line"><span class="string">'django.middleware.common.CommonMiddleware'</span>,</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>
CorsMiddleware should be placed as high as possible, especially before any middleware that can generate responses such as Django’s CommonMiddleware or Whitenoise’s WhiteNoiseMiddleware. If it is not before, it will not be able to add the CORS headers to these responses.</li>
</ul>
<p>Also if you are using CORS_REPLACE_HTTPS_REFERER it should be placed before Django’s CsrfViewMiddleware (see more below).</p>
<p>意思就是 要放的尽可能靠前，必须在CsrfViewMiddleware之前。我们直接放在第一个位置就好了</p>
<ul>
<li>第三步：可选配置<br><code>setting.py</code><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加白名单 特定白名单的完整域名</span></span><br><span class="line">CORS_ORIGIN_WHITELIST = (</span><br><span class="line"><span class="string">'http://127.0.0.1:8080'</span>,</span><br><span class="line"><span class="string">'http://localhost:8080'</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">CORS_ORIGIN_REGEX_WHITELIST = [  <span class="comment"># 白名单的正则字符串，当有多个域名时，非常有用</span></span><br><span class="line">    <span class="string">r"^http://\w+\.starmeow\.cn"</span>,</span><br><span class="line">    <span class="string">r"^https://\w+\.starmeow\.cn"</span>,</span><br><span class="line">    <span class="string">r'^(https?://)?（\w+\.)?jim\.com $'</span>,)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 所有主机地址支持跨域配置</span></span><br><span class="line">CORS_ORIGIN_ALLOW_ALL = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 允许携带cookie</span></span><br><span class="line">CORS_ALLOW_CREDENTIALS = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 允许哪些请求头</span></span><br><span class="line">CORS_ALLOW_HEADERS = (</span><br><span class="line">    <span class="string">'source'</span>,</span><br><span class="line">    <span class="string">'icode'</span>,</span><br><span class="line">    <span class="string">'X_FILENAME'</span>,</span><br><span class="line">    <span class="string">'accept-encoding'</span>,</span><br><span class="line">    <span class="string">'authorization'</span>,</span><br><span class="line">    <span class="string">'content-type'</span>,</span><br><span class="line">    <span class="string">'dnt'</span>,</span><br><span class="line">    <span class="string">'origin'</span>,</span><br><span class="line">    <span class="string">'user-agent'</span>,</span><br><span class="line">    <span class="string">'x-csrftoken'</span>,</span><br><span class="line">    <span class="string">'x-requested-with'</span>,</span><br><span class="line">    <span class="string">'XMLHttpRequest'</span>,</span><br><span class="line">    <span class="string">'Pragma'</span>,</span><br><span class="line">    <span class="string">'token'</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CORS_ALLOW_METHODS = (</span><br><span class="line">    <span class="string">'DELETE'</span>,</span><br><span class="line">    <span class="string">'GET'</span>,</span><br><span class="line">    <span class="string">'OPTIONS'</span>,</span><br><span class="line">    <span class="string">'PATCH'</span>,</span><br><span class="line">    <span class="string">'POST'</span>,</span><br><span class="line">    <span class="string">'PUT'</span>,</span><br><span class="line">    <span class="string">'VIEW'</span>,</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h3 id="VantUI"><a href="#VantUI" class="headerlink" title="VantUI"></a>VantUI</h3><ul>
<li>开源免费</li>
<li>轻量、可靠的移动端 Vue 组件库</li>
</ul>
<h4 id="Vant组件库"><a href="#Vant组件库" class="headerlink" title="Vant组件库"></a>Vant组件库</h4><ul>
<li>基础组件<br>按钮、图标、布局、提示信息等</li>
<li>表单组件<br>日历、复选框、时间选择、输入框、评分等</li>
<li>反馈组件<br>弹出框、加载、下拉菜单、消息提示、下拉刷新、滚动加载等</li>
<li>展示组件<br>进度条、倒计时、分割线、懒加载、列表等</li>
<li>导航组件<br>宫格、索引、导航栏、分页、多标签页等</li>
<li>业务组件<br>地址编辑、联系人、优惠券、提交订单、SKU选择框等</li>
</ul>
<h3 id="开始使用"><a href="#开始使用" class="headerlink" title="开始使用"></a>开始使用</h3><ul>
<li><p>第一步：安装<br><code>&gt;&gt; cnpm install vant -S</code></p>
</li>
<li><p>第二步：手动按需导入组件</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Button <span class="keyword">from</span> <span class="string">'vant/lib/button'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'vant/lib/button/style'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> {</span><br><span class="line">  name: <span class="string">'Home'</span>,</span><br><span class="line">  components: {</span><br><span class="line">    <span class="string">'v-button'</span>: Button</span><br><span class="line">    <span class="comment">// Button: Button</span></span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>第二步：导入全部组件，全局引用<br><code>main.js</code></p>
</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span>;</span><br><span class="line"><span class="keyword">import</span> Vant <span class="keyword">from</span> <span class="string">'vant'</span>;  <span class="comment">// VantUI组件库</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'vant/lib/index.css'</span>;</span><br><span class="line"></span><br><span class="line">Vue.use(Vant);  <span class="comment">// 把VantUI当做一个插件，在Vue中使用</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="轮播图组件开发"><a href="#轮播图组件开发" class="headerlink" title="轮播图组件开发"></a>轮播图组件开发</h3><h4 id="开发步骤"><a href="#开发步骤" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li>第一步，查找Vant中可以使用的组件</li>
<li>第二步，实现组件模板部分<br><code>\src\components\common\Banner.vue</code></li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 首页的轮播图 --&gt;</span><br><span class="line">  &lt;div class="home-banner-box"&gt;</span><br><span class="line">    &lt;van-swipe class="my-swipe" :autoplay="3000" indicator-color="white"&gt;</span><br><span class="line">      &lt;van-swipe-item v-for="item in bannerList"</span><br><span class="line">        :key="item.id"&gt;</span><br><span class="line">        &lt;img :src="item.img_url" alt=""&gt;</span><br><span class="line">      &lt;/van-swipe-item&gt;</span><br><span class="line">    &lt;/van-swipe&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>
<p><code>Home.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class="page-home"&gt;</span><br><span class="line">    &lt;!-- banner图 --&gt;</span><br><span class="line">    &lt;Banner/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 引入组件</span><br><span class="line">import Banner from '@/components/home/Banner'</span><br><span class="line"></span><br><span class="line">export default {</span><br><span class="line">  name: 'Home',</span><br><span class="line">  components: {</span><br><span class="line">    // banner图</span><br><span class="line">    Banner,</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>第三步，模型层准备数据，通过接口的方式从django服务器获取<br><code>\src\components\common\Banner.vue</code><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import { ajax } from '@/utils/ajax'</span><br><span class="line">import { SystemApis } from '@/utils/apis'</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      bannerList: []</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    /**</span><br><span class="line">     * 获取轮播图的数据</span><br><span class="line">     */</span><br><span class="line">    getDataList () {</span><br><span class="line">      ajax.get(SystemApis.sliderListUrl).then(res =&gt; {</span><br><span class="line">        console.log('res:', res)</span><br><span class="line">        this.bannerList = res.data.objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    // 从接口获取数据</span><br><span class="line">    this.getDataList()</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure></li>
<li>第四步，模拟数据，实现轮播效果</li>
</ul>
<h3 id="热门推荐组件开发"><a href="#热门推荐组件开发" class="headerlink" title="热门推荐组件开发"></a>热门推荐组件开发</h3><h4 id="开发步骤-1"><a href="#开发步骤-1" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li><p>第一步，查找Vant中可以使用的组件</p>
</li>
<li><p>第二步，完成布局，实现组件模板部分<br><code>\src\components\common\Hot.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 热门景点 --&gt;</span><br><span class="line">  &lt;div class="home-hot-box"&gt;</span><br><span class="line">    &lt;!-- 顶上导航 --&gt;</span><br><span class="line">    &lt;van-cell</span><br><span class="line">      title="热门推荐"</span><br><span class="line">      icon="/static/home/hot/fire.png"</span><br><span class="line">      is-link</span><br><span class="line">      title-style="text-align:left"</span><br><span class="line">      value="全部榜单" /&gt;</span><br><span class="line">    &lt;!-- // 顶上导航 --&gt;</span><br><span class="line">    &lt;!-- 景点列表 --&gt;</span><br><span class="line">    &lt;div class="box-main"&gt;</span><br><span class="line">      &lt;a href="#" class="hot-item"</span><br><span class="line">        v-for="item in dataList"</span><br><span class="line">        :key="item.id"&gt;</span><br><span class="line">        &lt;div class="img"&gt;</span><br><span class="line">          &lt;span&gt;&lt;/span&gt;</span><br><span class="line">          &lt;img :src="item.main_img" alt=""&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;!-- ellipsis 省略号 意思是超过一定长度变成省略号 --&gt;</span><br><span class="line">        &lt;h5 class="van-ellipsis"&gt;{{ item.name }}&lt;/h5&gt;</span><br><span class="line">        &lt;div class="line-price"&gt;</span><br><span class="line">          &lt;span class="price"&gt;￥{{ item.min_price }}&lt;/span&gt;起</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //景点列表 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>
<p><code>Home.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class="page-home"&gt;</span><br><span class="line">    &lt;!-- 热门推荐景点 --&gt;</span><br><span class="line">    &lt;Hot/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 引入组件</span><br><span class="line">import Hot from '@/components/home/Hot'</span><br><span class="line"></span><br><span class="line">export default {</span><br><span class="line">  name: 'Home',</span><br><span class="line">  components: {</span><br><span class="line">    // 热门推荐景点</span><br><span class="line">    Hot,</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>第三步，模型层准备数据<br><code>\src\components\common\Hot.vue</code></p>
</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import { ajax } from '@/utils/ajax'</span><br><span class="line">import { SightApis } from '@/utils/apis'</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      dataList: []</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    /**</span><br><span class="line">     * 查热门景点</span><br><span class="line">     */</span><br><span class="line">    getDataList () {</span><br><span class="line">      ajax.get(SightApis.sightListUrl, {</span><br><span class="line">        params: {</span><br><span class="line">          is_hot: 1</span><br><span class="line">        }</span><br><span class="line">      }).then(({ data }) =&gt; {</span><br><span class="line">        this.dataList = data.objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    // 查询获取接口数据</span><br><span class="line">    this.getDataList()</span><br><span class="line">    // this.dataList = [</span><br><span class="line">    //   {id: 1, img: '/static/home/hot/h1.jpg', name: '景点名称', price: 65},</span><br><span class="line">    //   {id: 2, img: '/static/home/hot/h2.jpg', name: '景点名称景点名称', price: 65},</span><br><span class="line">    //   {id: 3, img: '/static/home/hot/h3.jpg', name: '景点名称', price: 65},</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>第四步，添加假数据，实现效果</li>
</ul>
<h3 id="景点列表组件开发"><a href="#景点列表组件开发" class="headerlink" title="景点列表组件开发"></a>景点列表组件开发</h3><h4 id="开发步骤-2"><a href="#开发步骤-2" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li>第一步，分析组件的复用情况</li>
<li>第二步，新建组件文件，实现组件内容<br><code>\src\components\common\ListSight.vue</code><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 精选景点 --&gt;</span><br><span class="line">  &lt;div class="home-fine-box"&gt;</span><br><span class="line">    &lt;!-- 顶上导航 --&gt;</span><br><span class="line">    &lt;van-cell</span><br><span class="line">      title="精选景点"</span><br><span class="line">      icon="location-o"</span><br><span class="line">      is-link</span><br><span class="line">      title-style="text-align:left"</span><br><span class="line">      value="更多" /&gt;</span><br><span class="line">    &lt;!-- // 顶上导航 --&gt;</span><br><span class="line">    &lt;!-- 景点的列表 --&gt;</span><br><span class="line">    &lt;div class="box-main"&gt;</span><br><span class="line">      &lt;!-- `src\components\common\ListSight.vue`子组件的 --&gt;</span><br><span class="line">      &lt;sight-item v-for="item in dataList"</span><br><span class="line">        :key="item.id"</span><br><span class="line">        :item="item"/&gt;&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //景点的列表 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure></li>
<li>第三步，设置props,从父组件传递数据<br><code>\src\components\common\ListSight.vue</code><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">export default {</span><br><span class="line">  props: ['item']</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h3 id="精选景点组件开发"><a href="#精选景点组件开发" class="headerlink" title="精选景点组件开发"></a>精选景点组件开发</h3><h4 id="开发步骤-3"><a href="#开发步骤-3" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li>第一步，查找Vant中可以使用的组件</li>
<li>第二步，完成布局，实现组件模板部分</li>
</ul>
<p><code>\src\components\common\Fine.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 精选景点 --&gt;</span><br><span class="line">  &lt;div class="home-fine-box"&gt;</span><br><span class="line">    &lt;!-- 顶上导航 --&gt;</span><br><span class="line">    &lt;van-cell</span><br><span class="line">      title="精选景点"</span><br><span class="line">      icon="location-o"</span><br><span class="line">      is-link</span><br><span class="line">      title-style="text-align:left"</span><br><span class="line">      value="更多" /&gt;</span><br><span class="line">    &lt;!-- // 顶上导航 --&gt;</span><br><span class="line">    &lt;!-- 景点的列表 --&gt;</span><br><span class="line">    &lt;div class="box-main"&gt;</span><br><span class="line">      &lt;!-- `src\components\common\ListSight.vue`子组件的 --&gt;</span><br><span class="line">      &lt;sight-item v-for="item in dataList"</span><br><span class="line">        :key="item.id"</span><br><span class="line">        :item="item"/&gt;&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //景点的列表 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">`</span><br><span class="line">`Home.vue`</span><br><span class="line">`vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class="page-home"&gt;</span><br><span class="line">    &lt;!-- 精选景点 --&gt;</span><br><span class="line">    &lt;Fine/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 引入组件</span><br><span class="line">import Fine from '@/components/home/Fine'</span><br><span class="line"></span><br><span class="line">export default {</span><br><span class="line">  name: 'Home',</span><br><span class="line">  components: {</span><br><span class="line">    // 精选景点</span><br><span class="line">    Fine,</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>第三步，模型层准备数据,从父组件传递数据<br><code>\src\components\common\Fine.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import { ajax } from '@/utils/ajax'</span><br><span class="line">import { SightApis } from '@/utils/apis'</span><br><span class="line">import SightItem from '@/components/common/ListSight'</span><br><span class="line">export default {</span><br><span class="line">  components: {</span><br><span class="line">    SightItem</span><br><span class="line">  },</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      dataList: []</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    /**</span><br><span class="line">     * 查精选景点</span><br><span class="line">     */</span><br><span class="line">    getDataList () {</span><br><span class="line">      ajax.get(SightApis.sightListUrl, {</span><br><span class="line">        params: {</span><br><span class="line">          is_top: 1</span><br><span class="line">        }</span><br><span class="line">      }).then(({ data }) =&gt; {</span><br><span class="line">        this.dataList = data.objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    this.getDataList()</span><br><span class="line">    // this.dataList = [</span><br><span class="line">    //   {id: 1, name: '景点名称', score: 5, price: 98},</span><br><span class="line">    //   {id: 2, name: '景点名称', score: 4.5, price: 98},</span><br><span class="line">    //   {id: 3, name: '景点名称', score: 4, price: 98},</span><br><span class="line">    // ]</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>第四步，添加假数据，实现效果</p>
</li>
</ul>
<h3 id="页面底部组件开发"><a href="#页面底部组件开发" class="headerlink" title="页面底部组件开发"></a>页面底部组件开发</h3><h4 id="开发步骤-4"><a href="#开发步骤-4" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li>第一步，查找Vant中可以使用的组件</li>
<li>第二步，完成布局，实现组件模板部分<br><code>\src\components\common\Footer.vue</code></li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 底部导航（公共组件） --&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;van-tabbar v-model="active"&gt;</span><br><span class="line">      &lt;van-tabbar-item name="home" icon="wap-home-o"&gt;首页&lt;/van-tabbar-item&gt;</span><br><span class="line">      &lt;van-tabbar-item name="search" icon="search"&gt;搜索&lt;/van-tabbar-item&gt;</span><br><span class="line">      &lt;van-tabbar-item name="mine" icon="user-o"&gt;我的&lt;/van-tabbar-item&gt;</span><br><span class="line">    &lt;/van-tabbar&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>

<p><code>Home.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class="page-home"&gt;</span><br><span class="line">    &lt;!-- 热门推荐景点 --&gt;</span><br><span class="line">    &lt;Hot/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 引入组件</span><br><span class="line">import TripFooter from '@/components/common/Footer'</span><br><span class="line"></span><br><span class="line">export default {</span><br><span class="line">  name: 'Home',</span><br><span class="line">  components: {</span><br><span class="line">    // 底部导航</span><br><span class="line">    TripFooter</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>第三步，模型层准备数据<br><code>\src\components\common\Footer.vue</code><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      active: 'home'</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure></li>
<li>第四步，模拟从不同的菜单进入效果</li>
</ul>
<h3 id="模型设计"><a href="#模型设计" class="headerlink" title="模型设计"></a>模型设计</h3><ul>
<li>系统模块（公共的、可服用）：轮播图、用户反馈</li>
<li>景点模块：景点、景点详情、景点评论</li>
<li>用户模块：用户、用户详细信息、登录历史</li>
<li>订单模块：订单、订单明细、支付相关</li>
</ul>
<h3 id="设计轮播图ORM模型"><a href="#设计轮播图ORM模型" class="headerlink" title="设计轮播图ORM模型"></a>设计轮播图ORM模型</h3><h4 id="开发步骤-5"><a href="#开发步骤-5" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li><p>第一步，分析并设计数据库模型<br>创建app<br><code>py python manage.py startapp system </code></p>
</li>
<li><p>第二步，完成ORM模型编码<br><code>system/model.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Slider</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    name = models.CharField(<span class="string">'名称'</span>, max_length=<span class="number">32</span>)</span><br><span class="line">    desc = models.CharField(<span class="string">'描述'</span>, max_length=<span class="number">32</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    types = models.SmallIntegerField(<span class="string">'展现的位置'</span>, default=<span class="number">10</span>)</span><br><span class="line">    img = models.ImageField(<span class="string">'图片地址'</span>, max_length=<span class="number">255</span>, upload_to=<span class="string">'%Y%m/slider'</span>)</span><br><span class="line">    reorder = models.SmallIntegerField(<span class="string">'排序字段'</span>, default=<span class="number">0</span>, help_text=<span class="string">'数字越大越靠前'</span>)</span><br><span class="line">    start_time = models.DateTimeField(<span class="string">'生效开始时间'</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    end_time = models.CharField(<span class="string">'生效结束时间'</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    target_url = models.CharField(<span class="string">'跳转的地址'</span>, max_length=<span class="number">255</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    is_valid = models.BooleanField(<span class="string">'是否有效'</span>, default=<span class="literal">True</span>)</span><br><span class="line">    created_at = models.DateTimeField(<span class="string">'创建时间'</span>, auto_now_add=<span class="literal">True</span>)</span><br><span class="line">    updated_at = models.DateTimeField(<span class="string">'修改时间'</span>, auto_now=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">'system_slider'</span></span><br><span class="line">        ordering = [<span class="string">'-reorder'</span>]</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p><code>system/setting.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [<span class="string">'system.apps.SystemConfig'</span>,]</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>第三步，检测ORM模型<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py check</span><br></pre></td></tr></tbody></table></figure></li>
<li>第四步，模型同步<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h3 id="设计轮播图查询接口"><a href="#设计轮播图查询接口" class="headerlink" title="设计轮播图查询接口"></a>设计轮播图查询接口</h3><h4 id="开发步骤-6"><a href="#开发步骤-6" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li>第一步，设计接口返回标准<ul>
<li>定义接口的返回结构</li>
<li>接口的错误信息约定</li>
</ul>
</li>
<li>第二步，编写接口代码<br><code>system/views.py</code><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> http</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> system.models <span class="keyword">import</span> Slider</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">slider_list</span>(<span class="params">request</span>):</span></span><br><span class="line">    <span class="string">""" 轮播图接口</span></span><br><span class="line"><span class="string">    {</span></span><br><span class="line"><span class="string">        "meta": {},</span></span><br><span class="line"><span class="string">        "objects": []</span></span><br><span class="line"><span class="string">    }</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    data = {</span><br><span class="line">        <span class="string">'meta'</span>: {</span><br><span class="line"></span><br><span class="line">        },</span><br><span class="line">        <span class="string">'objects'</span>: []</span><br><span class="line">    }</span><br><span class="line">    queryset = Slider.objects.filter(is_valid=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> queryset:</span><br><span class="line">        data[<span class="string">'objects'</span>].append({</span><br><span class="line">            <span class="string">'id'</span>: item.id,</span><br><span class="line">            <span class="string">'img_url'</span>: item.img.url,</span><br><span class="line">            <span class="string">'target_url'</span>: item.target_url,</span><br><span class="line">            <span class="string">'name'</span>: item.name</span><br><span class="line">        })</span><br><span class="line">    <span class="comment"># return HttpResponse(data)</span></span><br><span class="line">    <span class="keyword">return</span> http.JsonResponse(data)</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p><code>system/url.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> system <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'slider/list/'</span>, views.slider_list, name=<span class="string">"slider_list"</span>),</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

<p><code>trip/url.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path, include</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),</span><br><span class="line">    <span class="comment"># 系统模块</span></span><br><span class="line">    path(<span class="string">'system/'</span>, include(<span class="string">'system.urls'</span>)),</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>第三步，模拟HTTP请求，测试验证接口</li>
</ul>
<h3 id="设计景点ORM模型"><a href="#设计景点ORM模型" class="headerlink" title="设计景点ORM模型"></a>设计景点ORM模型</h3><h4 id="开发步骤-7"><a href="#开发步骤-7" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li>第一步，分析并设计模型<br>景点简单信息、景点详细信息</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp sight</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>第二步，完成ORM模型编码<br><code>sight/model.py</code></li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sight</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    <span class="string">""" 景点基础信息 """</span></span><br><span class="line"></span><br><span class="line">    name = models.CharField(<span class="string">'名称'</span>, max_length=<span class="number">64</span>)</span><br><span class="line">    desc = models.CharField(<span class="string">'描述'</span>, max_length=<span class="number">256</span>)</span><br><span class="line">    main_img = models.ImageField(<span class="string">'主图'</span>, upload_to=<span class="string">'%Y%m/sight/'</span>, max_length=<span class="number">256</span>)</span><br><span class="line">    banner_img = models.ImageField(<span class="string">'详情主图'</span>, upload_to=<span class="string">'%Y%m/sight/'</span>, max_length=<span class="number">256</span>)</span><br><span class="line">    content = models.TextField(<span class="string">'详细'</span>)</span><br><span class="line">    score = models.FloatField(<span class="string">'评分'</span>, default=<span class="number">5</span>)</span><br><span class="line">    min_price = models.FloatField(<span class="string">'最低价格'</span>, default=<span class="number">0</span>)</span><br><span class="line">    province = models.CharField(<span class="string">'省份'</span>, max_length=<span class="number">32</span>)</span><br><span class="line">    city = models.CharField(<span class="string">'市区'</span>, max_length=<span class="number">32</span>)</span><br><span class="line">    area = models.CharField(<span class="string">'区/县'</span>, max_length=<span class="number">32</span>, null=<span class="literal">True</span>)</span><br><span class="line">    town = models.CharField(<span class="string">'乡镇'</span>, max_length=<span class="number">32</span>, null=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    is_top = models.BooleanField(<span class="string">'是否为精选景点'</span>, default=<span class="literal">False</span>)</span><br><span class="line">    is_hot = models.BooleanField(<span class="string">'是否为热门景点'</span>, default=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    is_valid = models.BooleanField(<span class="string">'是否有效'</span>, default=<span class="literal">True</span>)</span><br><span class="line">    created_at = models.DateTimeField(<span class="string">'创建时间'</span>, auto_now_add=<span class="literal">True</span>)</span><br><span class="line">    updated_at = models.DateTimeField(<span class="string">'修改时间'</span>, auto_now=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">'sight'</span></span><br><span class="line">        ordering = [<span class="string">'-updated_at'</span>]</span><br></pre></td></tr></tbody></table></figure>

<p><code>sight/setting.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [<span class="string">'sight.apps.SightConfig'</span>,]</span><br><span class="line">````</span><br><span class="line"></span><br><span class="line">- 第三步，检测ORM模型</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">python manage.py check</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>第四步，模型同步</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></tbody></table></figure>

<h3 id="设计景点列表API接口"><a href="#设计景点列表API接口" class="headerlink" title="设计景点列表API接口"></a>设计景点列表API接口</h3><h4 id="开发步骤-8"><a href="#开发步骤-8" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li>第一步，设计接口返回内容及字段</li>
<li>第二步，编写接口代码（查数据、分页）<br><code>sight/views.py</code></li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> http</span><br><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Q</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"><span class="keyword">from</span> django.views.generic <span class="keyword">import</span> ListView</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sight.models <span class="keyword">import</span> Sight</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SightListView</span>(<span class="params">ListView</span>):</span></span><br><span class="line">    <span class="string">""" 景点列表 """</span></span><br><span class="line">    <span class="comment"># 每页放5条数据</span></span><br><span class="line">    paginate_by = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">""" 重写查询方法 """</span></span><br><span class="line">        query = Q(is_valid=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># 1. 热门景点</span></span><br><span class="line">        is_hot = self.request.GET.get(<span class="string">'is_hot'</span>, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> is_hot:</span><br><span class="line">            query = query &amp; Q(is_hot=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># 2. 精选景点</span></span><br><span class="line">        is_top = self.request.GET.get(<span class="string">'is_top'</span>, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> is_top:</span><br><span class="line">            query = query &amp; Q(is_top=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># TODO 3. 景点名称搜索</span></span><br><span class="line">        queryset = Sight.objects.filter(query)</span><br><span class="line">        <span class="keyword">return</span> queryset</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">render_to_response</span>(<span class="params">self, context, **response_kwargs</span>):</span></span><br><span class="line">        page_obj = context[<span class="string">'page_obj'</span>]</span><br><span class="line">        data = {</span><br><span class="line">            <span class="string">'meta'</span>: {</span><br><span class="line">                <span class="string">'total_count'</span>: page_obj.paginator.count,</span><br><span class="line">                <span class="string">'page_count'</span>: page_obj.paginator.num_pages,</span><br><span class="line">                <span class="string">'current_page'</span>: page_obj.number,</span><br><span class="line">            },</span><br><span class="line">            <span class="string">'objects'</span>: []</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> page_obj.object_list:</span><br><span class="line">            data[<span class="string">'objects'</span>].append({</span><br><span class="line">                <span class="string">'id'</span>: item.id,</span><br><span class="line">                <span class="string">'name'</span>: item.name,</span><br><span class="line">                <span class="string">'main_img'</span>: item.main_img.url,</span><br><span class="line">                <span class="string">'score'</span>: item.score,</span><br><span class="line">                <span class="string">'province'</span>: item.province,</span><br><span class="line">                <span class="string">'min_price'</span>: item.min_price,</span><br><span class="line">                <span class="string">'city'</span>: item.city,</span><br><span class="line">                <span class="comment"># TODO 评论数量暂时无法获取</span></span><br><span class="line">                <span class="string">'comment_count'</span>: <span class="number">0</span></span><br><span class="line">            })</span><br><span class="line">        <span class="keyword">return</span> http.JsonResponse(data)</span><br></pre></td></tr></tbody></table></figure>

<p><code>sight/url.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> system <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    <span class="comment"># 景点列表接口</span></span><br><span class="line">    path(<span class="string">'sight/list/'</span>, views.SightListView.as_view(), name=<span class="string">"sight_list"</span>),</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

<p><code>trip/url.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path, include</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),</span><br><span class="line">    <span class="comment"># 景点相关的URL</span></span><br><span class="line">    path(<span class="string">'sight/'</span>, include(<span class="string">'sight.urls'</span>))</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>第三步，模拟HTTP请求，测试验证接口</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver</span><br></pre></td></tr></tbody></table></figure>

<h3 id="接口文档编写"><a href="#接口文档编写" class="headerlink" title="接口文档编写"></a>接口文档编写</h3><ul>
<li>第一步，学习Markdown语法，可以生成html结构的文档</li>
<li>第二步，编写文档公共部分</li>
<li>第三步，编写接口文档</li>
</ul>
<h3 id="轮播图接口数据获取-接口联调"><a href="#轮播图接口数据获取-接口联调" class="headerlink" title="轮播图接口数据获取(接口联调)"></a>轮播图接口数据获取(接口联调)</h3><h4 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li>第一步，阅读接口文档</li>
<li>第二步，配置接口地址<br><code>src\utils\apis.js</code><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 存放项目中所有的接口地址，当是`/api`开头，nginx把它转发给wsgi对应的内容进行处理，就会处理django的内容</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> apiHost = <span class="string">'http://localhost:8080/api'</span> <span class="comment">// 本地调试的localhost</span></span><br><span class="line"><span class="comment">// const apiHost = '/api' // linux服务器上用</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用户账户相关的接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> AccountsApis = {</span><br><span class="line">  loginUrl: <span class="string">'/'</span>,</span><br><span class="line">  logoutUrl: <span class="string">''</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 系统模块的接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> SystemApis = {</span><br><span class="line">  <span class="comment">// 轮播图列表</span></span><br><span class="line">  sliderListUrl: apiHost + <span class="string">'/system/slider/list/'</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> {</span><br><span class="line">  AccountsApis,</span><br><span class="line">  SystemApis</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p><code>vue.config.js</code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Node.js里面的模块</span></span><br><span class="line"><span class="built_in">module</span>.exports = {</span><br><span class="line">  <span class="comment">// http://localhost:8080/api/system/slider/list/</span></span><br><span class="line">  <span class="comment">// =&gt;</span></span><br><span class="line">  <span class="comment">// http://127.0.0.1:8080/system/slider/list/</span></span><br><span class="line">  <span class="comment">// 在Vue.js中解决跨域问题</span></span><br><span class="line">  devServer: {</span><br><span class="line">    proxy: {</span><br><span class="line">      <span class="string">'/api'</span>: {  <span class="comment">// 从/api开头 代理到目标地址</span></span><br><span class="line">        target: <span class="string">'http://127.0.0.1:8000/'</span>,  <span class="comment">// 这个地址的服务器要启动才能访问 </span></span><br><span class="line">        changeOrigin: <span class="literal">true</span>,</span><br><span class="line">        pathRewrite: {</span><br><span class="line">          <span class="string">'^/api'</span>: <span class="string">''</span>   <span class="comment">//  重写URL，空字符表示把/api字符串去掉</span></span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>第三步，在组件中使用axios获取数据<br><code>src/components/home/Bannaer</code></li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { ajax } <span class="keyword">from</span> <span class="string">'@/utils/ajax'</span></span><br><span class="line"><span class="keyword">import</span> { SystemApis } <span class="keyword">from</span> <span class="string">'@/utils/apis'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> {</span><br><span class="line">  data () {</span><br><span class="line">    <span class="keyword">return</span> {</span><br><span class="line">      bannerList: []</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取轮播图的数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    getDataList () {</span><br><span class="line">      ajax.get(SystemApis.sliderListUrl).then(<span class="function"><span class="params">res</span> =&gt;</span> {</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'res:'</span>, res)</span><br><span class="line">        <span class="built_in">this</span>.bannerList = res.data.objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    <span class="comment">// 从接口获取数据</span></span><br><span class="line">    <span class="built_in">this</span>.getDataList()</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>


<p>django项目的<code>trip/setting.py</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">STATIC_URL = <span class="string">'/static/'</span>  <span class="comment"># 静态文件的搜索地址</span></span><br><span class="line">MEDIA_URL = <span class="string">'http://localhost:8080/'</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>第四步，将数据设置到模型层<br>Vue组件<code>Banner.vue</code>的模板里的数据<code>img_id</code>和<code>img_url</code>是调用django的视图<code>system/view.py</code>里面的</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 首页的轮播图 --&gt;</span><br><span class="line">  &lt;div class="home-banner-box"&gt;</span><br><span class="line">    &lt;van-swipe class="my-swipe" :autoplay="3000" indicator-color="white"&gt;</span><br><span class="line">      &lt;van-swipe-item v-for="item in bannerList"</span><br><span class="line">        :key="item.id"&gt;</span><br><span class="line">        &lt;img :src="item.img_url" alt=""&gt;</span><br><span class="line">      &lt;/van-swipe-item&gt;</span><br><span class="line">    &lt;/van-swipe&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>

<h3 id="景点列表接口数据获取"><a href="#景点列表接口数据获取" class="headerlink" title="景点列表接口数据获取"></a>景点列表接口数据获取</h3><h4 id="实现步骤-1"><a href="#实现步骤-1" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li>第一步，阅读接口文档</li>
<li>第二步，配置接口地址<br><code>src\utils\apis.js</code></li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 景点模块</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> SightApis = {</span><br><span class="line">  <span class="comment">// 景点列表</span></span><br><span class="line">  sightListUrl: apiHost + <span class="string">'/sight/sight/list/'</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> {</span><br><span class="line">  SightApis</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>第三步，使用axios获取数据</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">methods: {</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查热门景点</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    getDataList () {</span><br><span class="line">      ajax.get(SightApis.sightListUrl, {</span><br><span class="line">        params: {</span><br><span class="line">          is_hot: <span class="number">1</span></span><br><span class="line">        }</span><br><span class="line">      }).then(<span class="function">(<span class="params">{ data }</span>) =&gt;</span> {</span><br><span class="line">        <span class="built_in">this</span>.dataList = data.objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  }</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>第四步，将数据设置到模型层，<br>Vue组件<code>Hot.vue</code>的模板里的数据<code>main_img</code>和<code>name</code>和<code>min_price</code>是调用django的视图<code>sight/view.py</code>里面的</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 热门景点 --&gt;</span><br><span class="line">  &lt;div class="home-hot-box"&gt;</span><br><span class="line">    &lt;!-- 顶上导航 --&gt;</span><br><span class="line">    &lt;van-cell</span><br><span class="line">      title="热门推荐"</span><br><span class="line">      icon="/static/home/hot/fire.png"</span><br><span class="line">      is-link</span><br><span class="line">      title-style="text-align:left"</span><br><span class="line">      value="全部榜单" /&gt;</span><br><span class="line">    &lt;!-- // 顶上导航 --&gt;</span><br><span class="line">    &lt;!-- 景点列表 --&gt;</span><br><span class="line">    &lt;div class="box-main"&gt;</span><br><span class="line">      &lt;a href="#" class="hot-item"</span><br><span class="line">        v-for="item in dataList"</span><br><span class="line">        :key="item.id"&gt;</span><br><span class="line">        &lt;div class="img"&gt;</span><br><span class="line">          &lt;span&gt;&lt;/span&gt;</span><br><span class="line">          &lt;img :src="item.main_img" alt=""&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;!-- ellipsis 省略号 意思是超过一定长度变成省略号 --&gt;</span><br><span class="line">        &lt;h5 class="van-ellipsis"&gt;{{ item.name }}&lt;/h5&gt;</span><br><span class="line">        &lt;div class="line-price"&gt;</span><br><span class="line">          &lt;span class="price"&gt;￥{{ item.min_price }}&lt;/span&gt;起</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //景点列表 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>Vue组件<code>Fine.vue</code>的模板里的数据<code>is_top</code>和<code>name</code>和<code>min_price</code>是调用django的视图<code>sight/view.py</code>里面的</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import SightItem from '@/components/common/ListSight'</span><br><span class="line">export default {</span><br><span class="line">  components: {</span><br><span class="line">    SightItem</span><br><span class="line">  },</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      dataList: []</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    /**</span><br><span class="line">     * 查精选景点</span><br><span class="line">     */</span><br><span class="line">    getDataList () {</span><br><span class="line">      ajax.get(SightApis.sightListUrl, {</span><br><span class="line">        params: {</span><br><span class="line">          is_top: 1</span><br><span class="line">        }</span><br><span class="line">      }).then(({ data }) =&gt; {</span><br><span class="line">        this.dataList = data.objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    this.getDataList()</span><br><span class="line">    // this.dataList = [</span><br><span class="line">    //   {id: 1, name: '景点名称', score: 5, price: 98},</span><br><span class="line">    //   {id: 2, name: '景点名称', score: 4.5, price: 98},</span><br><span class="line">    //   {id: 3, name: '景点名称', score: 4, price: 98},</span><br><span class="line">    // ]</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<p><code>src\components\common\ListSight.vue</code>的<code>name</code>和<code>score</code>是调用<code>sight/view.py</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;a href="#" class="sight-item"&gt;</span><br><span class="line">    &lt;img :src="item.main_img" :alt="item.name"&gt;</span><br><span class="line">    &lt;div class="right"&gt;</span><br><span class="line">      &lt;h5&gt;{{ item.name }}&lt;/h5&gt;</span><br><span class="line">      &lt;van-rate v-model="item.score" readonly/&gt;</span><br><span class="line">      &lt;div class="tips"&gt;{{ item.comment_count }}人点评 | 100%满意&lt;/div&gt;</span><br><span class="line">      &lt;div class="tips light"&gt;{{ item.province }} - {{ item.city }}&lt;/div&gt;</span><br><span class="line">      &lt;div class="line-price"&gt;￥ {{ item.min_price }} 起&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/a&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/29/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/29/">29</a><span class="page-number current">30</span><a class="page-number" href="/page/31/">31</a><span class="space">&hellip;</span><a class="page-number" href="/page/35/">35</a><a class="extend next" rel="next" href="/page/31/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">外心人D</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
