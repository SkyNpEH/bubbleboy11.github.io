<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"bubbleboy11.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.6.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:type" content="website">
<meta property="og:title" content="外心人D的博客">
<meta property="og:url" content="https://bubbleboy11.github.io/page/30/index.html">
<meta property="og:site_name" content="外心人D的博客">
<meta property="og:description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="外心人D">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://bubbleboy11.github.io/page/30/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/30/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>外心人D的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="外心人D的博客" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">外心人D的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">外心人D</p>
  <div class="site-description" itemprop="description">本博客大多内容为慕课和网上博客，并非原创</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">344</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



          </div>
        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/xing-wei-xing-mo-shi-zhi-guan-cha-zhe-mo-shi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/xing-wei-xing-mo-shi-zhi-guan-cha-zhe-mo-shi/" class="post-title-link" itemprop="url">行为型模式之观察者模式</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:46" itemprop="dateModified" datetime="2021-04-02T12:24:46Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Markdown/" itemprop="url" rel="index"><span itemprop="name">Markdown</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="观察者模式"><a href="#观察者模式" class="headerlink" title="观察者模式"></a>观察者模式</h3><ul>
<li>发布订阅是一种最常见的实现方式</li>
<li>发布订阅用于解耦逻辑</li>
<li>可以通过回调等方式实现，当发生事件时，调用相应的回调函数<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 发布订阅模式，通过在发布者里面加入订阅者，并通过订阅者的回调实现</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Publisher</span>:</span>  <span class="comment"># 发布者</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.observers = []  <span class="comment"># 初始化观察者为空列表</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">self, observer</span>):</span>  <span class="comment"># 加入观察者到观察者列表</span></span><br><span class="line">        <span class="keyword">if</span> observer <span class="keyword">not</span> <span class="keyword">in</span> self.observers:</span><br><span class="line">            self.observers.append(observer)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'Failed to add : {}'</span>.format(observer))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">remove</span>(<span class="params">self, observer</span>):</span>  <span class="comment"># 从观察者列表移除观察者</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.observers.remove(observer)</span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">            print(<span class="string">'Failed to remove : {}'</span>.format(observer))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">notify</span>(<span class="params">self</span>):</span>  <span class="comment"># 调用观察者的回调</span></span><br><span class="line">        [o.notify_by(self) <span class="keyword">for</span> o <span class="keyword">in</span> self.observers]</span><br><span class="line">        <span class="comment"># 当发生相应事件时候，通知所有观察者去调用回调函数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Formatter</span>(<span class="params">Publisher</span>):</span>  <span class="comment"># 继承自发布者</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        super().__init__()</span><br><span class="line">        self.name = name</span><br><span class="line">        self._data = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">data</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._data</span><br><span class="line"></span><br><span class="line"><span class="meta">    @data.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">data</span>(<span class="params">self, new_value</span>):</span></span><br><span class="line">        self._data = int(new_value)</span><br><span class="line">        self.notify()  <span class="comment"># data 在被合法赋值以后会执行notify</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BinaryFormatter</span>:</span></span><br><span class="line">    <span class="string">''' 订阅者 '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">notify_by</span>(<span class="params">self, publisher</span>):</span>  <span class="comment"># 接收一个Publisher类的实例作为参数</span></span><br><span class="line">        print(<span class="string">"{}: '{}' has now bin data = {}"</span>.format(</span><br><span class="line">            type(self).__name__, </span><br><span class="line">            publisher.name, </span><br><span class="line">            bin(publisher.data))</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df = Formatter(<span class="string">'formatter'</span>)  <span class="comment"># 发布者</span></span><br><span class="line">bf = BinaryFormatter()  <span class="comment"># 订阅者</span></span><br><span class="line">df.add(bf)  <span class="comment"># 添加订阅者</span></span><br><span class="line">df.data = <span class="number">3</span>  <span class="comment"># 设置的时候调用订阅者的notify_by函数</span></span><br><span class="line"><span class="comment"># 输出结果：</span></span><br><span class="line"><span class="comment"># BinaryFormatter: 'formatter' has now bin data = 0b11</span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/xing-wei-xing-mo-shi-zhi-die-dai-qi-mo-shi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/xing-wei-xing-mo-shi-zhi-die-dai-qi-mo-shi/" class="post-title-link" itemprop="url">行为型模式之策略模式</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-08-07 11:28:51" itemprop="dateModified" datetime="2021-08-07T11:28:51Z">2021-08-07</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="迭代器-Iterator-模式"><a href="#迭代器-Iterator-模式" class="headerlink" title="迭代器(Iterator)模式"></a>迭代器(Iterator)模式</h3><ul>
<li>Python内置对迭代器模式支持</li>
<li>可作用于for循环的，具备了__iter__或iter()方法的对象，就是可迭代对象 Iterable</li>
<li>调用对象名.<strong>next</strong>()时（或next(对象名)）和 <strong>iter</strong> 对象称为迭代器Iterator<br>每次调用next(g)，就计算出g的下一个元素的值，<br>返回它所记录位置的下一个位置的数据。<br>直到没有数据时抛出StopIteration错误，表示无法继续返回下一个值了。<br>直到计算到最后一个元素，没有可供返回的值</li>
</ul>
<p>Iterator对象表示的是一个数据流、一个有序序列，<br>但我们却不能提前知道序列的长度，<br>只能不断通过next()函数实现按需计算下一个数据，<br>所以Iterator的计算是惰性的，<br>只有在需要返回下一个数据时它才会计算。</p>
<p>Python的for循环本质上就是通过不断调用next()函数实现的</p>
<p>Iterator甚至可以表示一个无限大的数据流，例如全体自然数。<br>而使用list是永远不可能存储全体自然数的。</p>
<p>给定一个list或tuple或字符串，通过for循环来遍历这个list或tuple，称为迭代（Iteration）。<br>dict迭代的是key。<br>如果要迭代value，可以用for value in d.values()，<br>如果要同时迭代key和value，可以用for k, v in d.items()。</p>
<p>可以使用isinstance()判断一个对象是否是Iterable对象<br>可以使用isinstance()判断一个对象是否是Iterator对象：</p>
<p>迭代Iteration 是访问集合元素的一种方式。<br>迭代器是一个可以记住遍历的位置的对象，记录每次迭代访问到的位置，<br>迭代器对象从集合的第一个元素开始访问，<br>直到所有的元素被访问完结束。<br>迭代器只能往前不会后退。</p>
<p>重复多次，像循环那样，针对对象</p>
<p>数据类型有以下几种：<br>一类是集合数据类型，<br>int整型不是iterable，即int整型不是可以迭代的<br>如list、tuple、dict、set、str等是Iterable但不是Iterator，<br>把list、dict、str等Iterable变成Iterator可以使用iter()函数</p>
<p>法二：<br>    定义一个以 yield 关键字标识返回值的函数；<br>    调用刚刚创建的函数，即可创建一个生成器（generator）。<br>生成器函数就是一个迭代器，返回迭代器Iterator的函数，<br>创建了一个generator后，基本上永远不会调用next()，太麻烦<br>而是通过for循环来迭代它，并且不需要关心StopIteration的错误。</p>
<p>#普通函数是顺序执行，遇到return语句或者最后一行函数语句就返回。<br>#在调用生成器运行的过程中，遇到yield时函数会返回一个generator对象<br>#并保存当前所有的运行信息，函数冻结<br>#在下一次执行next()方法时从上次返回的yield语句处继续执行。<br>比如<code>[i for i in range(10) if i % 2 == 0]</code><br>生成器的创建方式也比迭代器简单很多<br>只要把一个列表生成式的方括号[]改成圆括号()就会返回生成器，只保存算法不保存数据，使用生成器推导大大节省内存<br>一边循环一边计算的机制 只能用于迭代操作</p>
<p><code>(i for i in range(10) if i % 2 == 0)</code> 返回生成器<br>一类是generator，包括生成器和带yield的generator function。</p>
<p>为啥会用到生成器？&nbsp; &nbsp;&nbsp;<br>&nbsp;简单举个例子：<br>&nbsp; &nbsp; 列表所有数据都在内存中，如果有海量数据的话将会非常耗内存。<br>如果仅仅需要访问前面几个元素，<br>那后面绝大多数元素占用的空间都白白浪费了。<br>&nbsp;&nbsp; &nbsp;如果列表元素能按照某种算法推算出来，<br>那我们就可以在循环的过程中不断推算出后续的元素，<br>这样就不必创建完整的list，从而节省大量的空间。</p>
<p>实现了延迟求值和惰性求值，也是后面协程实现的基础</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hello</span><br><span class="line">hello.test() <span class="comment"># test是hello模块的一个函数</span></span><br><span class="line">变量和函数并没有本质区别，函数名就是变量</span><br><span class="line"><span class="keyword">import</span> hello</span><br><span class="line">hello.new_var <span class="comment"># new_var是hello模块的一个变量</span></span><br></pre></td></tr></tbody></table></figure>

<p>_是一个合法的标识符，也可以作为一个有效的变量使用，除非明确的知道这个数据需要使用<br>但是定义成下划线就是希望不要被使用<br>无需关注其实际含义的变量可以用_代替，起到的是循环此数的作用,也可以用i，j 等其他字母代替，</p>
<p>如何让一个对象可迭代</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span>(<span class="params">object</span>):</span>  <span class="comment"># 使用组合的例子</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self._deque = deque()  <span class="comment"># has a deque()</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._deque.append(value)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._deque.pop()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">empty</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> len(self._deque) == <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span>(<span class="params">self</span>):</span>  <span class="comment"># 定义__iter__方法让它支持迭代</span></span><br><span class="line">        <span class="comment"># 因为栈是后进先出希望让它从上往下去迭代</span></span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> self._deque:  <span class="comment"># deque从左往右去遍历的</span></span><br><span class="line">            res.append(i)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> reversed(res):  <span class="comment"># 需要让res反转，才能实现从上往下迭代</span></span><br><span class="line">            <span class="keyword">yield</span> i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = Stack()</span><br><span class="line">s.push(<span class="number">1</span>)</span><br><span class="line">s.push(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:  <span class="comment"># 让自定义Stack实现迭代，通过添加__iter__方法实现迭代</span></span><br><span class="line">    print(i)</span><br><span class="line"><span class="comment"># 输出结果：</span></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line"><span class="comment"># 1</span></span><br></pre></td></tr></tbody></table></figure>
<p>注意：Stack并不是一个迭代器，它是个可迭代对象Iterable。要区分迭代器(Iterator)。</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/she-ji-mo-shi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/she-ji-mo-shi/" class="post-title-link" itemprop="url">HTML</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:45" itemprop="dateModified" datetime="2021-04-02T12:24:45Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Markdown/" itemprop="url" rel="index"><span itemprop="name">Markdown</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="常见创建型设计模式（重点单例模式和工厂模式）"><a href="#常见创建型设计模式（重点单例模式和工厂模式）" class="headerlink" title="常见创建型设计模式（重点单例模式和工厂模式）"></a>常见创建型设计模式（重点单例模式和工厂模式）</h3><ul>
<li>工厂模式(Factory)：解决对象创建问题</li>
<li>构建者模式(Builder)：控制复杂对象的创建</li>
<li>原型模式(Prototype)：通过原型的克隆创建新的实例</li>
<li>单例模式(Borg / Singleton)：一个类只能创建同一个对象</li>
<li>对象池模式(Pool)：预先分配同一类型的一组实例</li>
<li>惰性计算模式(Lazy Evalution)：延迟计算(python 的property)，当访问这些属性的时候才做一些相应的计算操作</li>
</ul>
<h3 id="常见结构型设计模式（重点适配器模式和代理模式和MVC）"><a href="#常见结构型设计模式（重点适配器模式和代理模式和MVC）" class="headerlink" title="常见结构型设计模式（重点适配器模式和代理模式和MVC）"></a>常见结构型设计模式（重点适配器模式和代理模式和MVC）</h3><ul>
<li>装饰器模式(Decorator)：无需子类化扩展对象功能</li>
<li>代理模式(Proxy)：把一个对象的操作代理到另一个对象</li>
<li>适配器模式(Adapter)：通过一个间接层适配同一接口</li>
<li>外观模式(Facade)：简化复杂对象的访问问题</li>
<li>享元模式(Flyweight)：通过对象复用(池)改善资源利用，比如连接池</li>
<li>Model-View_Controller(MVC)：解耦展示逻辑和业务逻辑，如Django 是MTV模式，T 为 template和MVC非常类似。</li>
</ul>
<h3 id="常见学习行为型设计模式"><a href="#常见学习行为型设计模式" class="headerlink" title="常见学习行为型设计模式"></a>常见学习行为型设计模式</h3><ul>
<li>迭代器模式(Iterator)：通过统一的接口迭代对象</li>
<li>观察者模式(Observer)：对象发生改变的时候，观察者执行相应动作</li>
<li>策略模式(Strategy)：针对不同规模输入使用不同的策略</li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/tan-xin/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/tan-xin/" class="post-title-link" itemprop="url">贪心</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-08-04 00:46:06" itemprop="dateModified" datetime="2021-08-04T00:46:06Z">2021-08-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>找零问题：假设商店老板需要找零n元钱，钱币的面额有：100元、50元、20元、5元、1元，如何找零使得所需钱币的数量最少？</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># greedy algorithm</span></span><br><span class="line"></span><br><span class="line">money = [<span class="number">100</span>,<span class="number">50</span>,<span class="number">20</span>,<span class="number">5</span>,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_money</span>(<span class="params">x</span>):</span></span><br><span class="line">    change = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i,m <span class="keyword">in</span> enumerate(money):</span><br><span class="line">        change[i] = x // money[i]</span><br><span class="line">        x = x % money[i]</span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        print(<span class="string">"还剩%s"</span> % x)</span><br><span class="line">    <span class="keyword">return</span> change</span><br><span class="line"></span><br><span class="line">print(change_money(<span class="number">356.2</span>))</span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/shen-fen-yun-suan-fu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/shen-fen-yun-suan-fu/" class="post-title-link" itemprop="url">身份运算符</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-09 02:05:27" itemprop="dateModified" datetime="2021-05-09T02:05:27Z">2021-05-09</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>身份运算符，比较两个变量的身份是否相等，内存地址<br>is x is y, 比较内存地址和值是否相等 是判断两个标识符是不是引用自一个对象<br>类似 id(x) == id(y) , 如果引用的是同一个对象则返回 True，否则返回 False<br>is not 判断两个标识符是不是引用自不同对象<br>x is not y ，类似 id(a) != id(b)。<br>如果引用的不是同一个对象则返回结果 True，否则返回 False。</p>
<p>is 与 == 区别：<br>is 用于判断两个变量引用对象是否为同一个，<br>== 用于判断引用变量的值是否相等。<br>===内容和格式相同<br>id()  返回唯一标识一个对象对象的内存地址</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">20</span></span><br><span class="line">b = <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (a <span class="keyword">is</span> b):</span><br><span class="line">    print(<span class="string">"1.a 和 b 有相同的标识"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"1.a 和 b 没有相同的标识"</span>)</span><br><span class="line"><span class="comment"># 1.a 和 b 有相同的标识</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (id(a) == id(b)):</span><br><span class="line">    print(<span class="string">"2.a 和 b 有相同的标识"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"2.a 和 b 没有相同的标识"</span>)</span><br><span class="line"><span class="comment"># 1.a 和 b 有相同的标识</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改变量 b 的值</span></span><br><span class="line">b = <span class="number">30</span></span><br><span class="line"><span class="keyword">if</span> (a <span class="keyword">is</span> b):</span><br><span class="line">    print(<span class="string">"3.a 和 b 有相同的标识"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"3.a 和 b 没有相同的标识"</span>)</span><br><span class="line"><span class="comment"># 3.a 和 b 没有相同的标识</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (a <span class="keyword">is</span> <span class="keyword">not</span> b):</span><br><span class="line">    print(<span class="string">"4.a 和 b 没有相同的标识"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"4.a 和 b 有相同的标识"</span>)</span><br><span class="line"><span class="comment"># 4.a 和 b 没有相同的标识</span></span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]  <span class="comment"># 创建了一个指引指向列表[1, 2, 3]，但是a不是列表</span></span><br><span class="line">b = a  <span class="comment"># 并没有复制a所指引的列表。我们只是创建了一个新的标签b，然后将其指向a所指向的列表。</span></span><br><span class="line">print(b <span class="keyword">is</span> a)  <span class="comment"># True</span></span><br><span class="line">print(b == a)  <span class="comment"># True</span></span><br><span class="line">b = a[:]</span><br><span class="line">print(a)  <span class="comment"># [1, 2, 3]</span></span><br><span class="line">print(b)  <span class="comment"># [1, 2, 3]</span></span><br><span class="line">print(b <span class="keyword">is</span> a)  <span class="comment"># False</span></span><br><span class="line">print(b == a)  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'------'</span>)</span><br><span class="line">list1 = [<span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="string">"python"</span>]</span><br><span class="line">list1ID = id(list1)</span><br><span class="line">list2 = list1</span><br><span class="line"><span class="comment"># 将list2也指向list1的内存地址，把list1所指的对象绑定到名字list2上，</span></span><br><span class="line"><span class="comment"># 两个名字指向同一个对象内存地址，那么修改list2也就修改了L；</span></span><br><span class="line">list2ID = id(list2)</span><br><span class="line">list3 = list1[:]</span><br><span class="line"><span class="comment"># 切片运算符[:]返回一个从列表首端开始到末端的切片，</span></span><br><span class="line"><span class="comment"># 切片过程是切下列表的一部分，创建新的列表(不同对象)，将切下的部分复制到新列表。</span></span><br><span class="line"><span class="comment"># 新列表对象绑定到list3指向新的内存地址</span></span><br><span class="line"><span class="comment"># 也就是list（指引的列表）的完整复制，但这不是复制列表的唯一方式</span></span><br><span class="line"><span class="comment"># list3则是不同的东西，修改list3不会改变list1</span></span><br><span class="line"><span class="comment"># 百分之九十的切片标记法都可以被list()代替。</span></span><br><span class="line"><span class="comment"># 下次你看见[:]的时候试试使用list()替代，这样可以让你的代码更加可读。</span></span><br><span class="line">list3ID = id(list3)</span><br><span class="line">print(list1ID)  <span class="comment"># 1245319965376</span></span><br><span class="line">print(list2ID)  <span class="comment"># 1245319965376</span></span><br><span class="line">print(list3ID)  <span class="comment"># 1245319800512</span></span><br><span class="line">list1[<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">print(list1)  <span class="comment"># [0, 1, 4, 5, 'python']</span></span><br><span class="line">print(list2)  <span class="comment"># [0, 1, 4, 5, 'python']</span></span><br><span class="line">print(list3)  <span class="comment"># [2, 1, 4, 5, 'python']</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意这个引用的概念对于所有的东西都成立，例如容器内部存储的都是引用</span></span><br><span class="line"><span class="comment"># 引用贯穿整个Python。如果你的list里套了个list，那么即使外层进行了copy，</span></span><br><span class="line"><span class="comment"># 也只是copy了一个引用集。</span></span><br><span class="line">inner = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">outer = [inner]</span><br><span class="line"><span class="comment"># 你复制了个outer，里面也不过是一个指向inner的引用。</span></span><br><span class="line">L = outer[:]  <span class="comment"># 只是复制了一个outer。</span></span><br><span class="line">L.append(<span class="number">1</span>)  <span class="comment"># 不会使得outer变为[[1,2,3],1]，</span></span><br><span class="line">L[<span class="number">0</span>].append(<span class="number">1</span>)  <span class="comment"># 却会直接修改L[0]指向的inner，</span></span><br><span class="line"><span class="comment"># 这样看起来似乎outer也改变了。</span></span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/yun-wei/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/yun-wei/" class="post-title-link" itemprop="url">运维</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-04 01:51:39" itemprop="dateModified" datetime="2021-05-04T01:51:39Z">2021-05-04</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>互联网运维职责</p>
<ul>
<li>资源管理：采购、规划、调度</li>
<li>变更部署：部署、变更、发布、回退</li>
<li>监控告警</li>
<li>故障响应</li>
</ul>
<p>“六大”运维发布策略</p>
<ul>
<li>重建部署<br>版本A下线后版本B上线  <ul>
<li>优点：<ul>
<li>便于设置</li>
<li>应用状态完整更新  </li>
</ul>
</li>
<li>缺点：<br>对用户影响很大，预期的宕机时间取决于下线时间和应用启动耗时</li>
</ul>
</li>
</ul>
<ul>
<li>滚动部署（增量发布）<br>版本B缓慢更新并替代版本A<ul>
<li>优点：<ul>
<li>便于设置</li>
<li>版本在实例间缓慢发布</li>
</ul>
</li>
<li>缺点：<ul>
<li>发布/回滚耗时</li>
<li>无法控制流量</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>蓝绿部署<br>版本B并行与版本A发布，然后流量切换到版本B</p>
<ul>
<li>优点：<ul>
<li>实时发布、回滚</li>
<li>避免版本冲突问题，整个应用状态统一一次切换</li>
</ul>
</li>
<li>缺点：<ul>
<li>比较昂贵因为需要双倍的资源</li>
<li>在释放版本到生产环境之前，整个平台的主流程测试必须执行</li>
</ul>
</li>
</ul>
</li>
<li><p>金丝雀部署<br>版本B向一部分用户发布，然后完全放开</p>
<ul>
<li>优点：<ul>
<li>版本面向一部分用户发布</li>
<li>方便错误评估和性能监控</li>
<li>快速回滚</li>
</ul>
</li>
<li>缺点：<ul>
<li>发布缓慢</li>
</ul>
</li>
</ul>
</li>
<li><p>A/B部署(灰度)<br>版本B只向特定条件的用户发布</p>
<ul>
<li>优点：<ul>
<li>多个版本并行运行</li>
<li>完全控制流量分布</li>
</ul>
</li>
<li>缺点：<ul>
<li>需要智能负载均衡，配置算法复杂</li>
<li>资源占用</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>影子部署<br>版本B接受真实的流量请求，但是不产生响应<ul>
<li>优点：<ul>
<li>可以使用生产环境流量进行性能评估</li>
<li>对用户无影响</li>
<li>直到应用的稳定性和性能满足要求后才发布</li>
</ul>
</li>
<li>缺点：<ul>
<li>双倍资源，成本昂贵</li>
<li>不是真实用户测试，可能出现误导</li>
<li>配置复杂</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="发布策略的选择"><a href="#发布策略的选择" class="headerlink" title="发布策略的选择"></a>发布策略的选择</h3><ul>
<li> 实际采用哪种方式取决于需求和预算</li>
<li> 蓝绿、金丝雀、AB和影子部署对预算有更高的要求，因为需要双倍资源</li>
<li> 缺乏测试或者对软件的功能和稳定性影响缺乏信心，那么可以使用金丝雀部署或者AB部署或者影子部署</li>
</ul>
<p>阿里发布方式</p>
<ul>
<li> 在结合不同应用情况选择不同发布策略的基础之上，增加了“分批发布”及“智能化无人值守发布”</li>
<li> 分批发布简单来说就是按照一定的批次，每次只对服务的一部分实例进行升级，是升级版的滚动部署</li>
<li> 无人值守发布则是在发布过程中，减少人力成本同时自动检测发布风险，拦截异常发布的方式</li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/jin-zhi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/jin-zhi/" class="post-title-link" itemprop="url">进制</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-06-29 01:43:12" itemprop="dateModified" datetime="2021-06-29T01:43:12Z">2021-06-29</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">操作系统</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="学习二进制、八进制和十六进制的意义"><a href="#学习二进制、八进制和十六进制的意义" class="headerlink" title="学习二进制、八进制和十六进制的意义"></a>学习二进制、八进制和十六进制的意义</h3><p>二进制是硬件底层实现的基础。<br>编译的程序也是以二进制存储的。<br>其实为什么是八进制和十六进制而不是十进制很容易理解： 计算机的世界是和2相关，人类的世界是和10相关</p>
<p>总结：十进制主要运用于日常生活当中，而二进制、八进制、十六进制主要运用于电子技术行业，二进制是数字电路、处理器等最直接的语言，八进制、十六进制由于有着方便转化记录的意义而使用，如今更多的是十六进制进行存储记忆，八进制较少使用，比如处理器里的寄存器、存储器的地址、数据都是使用十六进行进行表示。</p>
<p>十六进制是方便查看的，本质上还是将二进制的数据以十六进制显示出来。为什么不使用二进制来显示，因为二进制显示出来很不方便查看。</p>
<p>电路中只能进行二进制逻辑运算，所以二进制是基础中的基础。之所以使用16进制，我认为是因为现在的通常情况下每8bit为一个字节，而16进制里一位数正好能表示一个字节，虽说本质上还是二进制代码，但16进制表示的话也更便于查看和修改。</p>
<p>就拿最简单的RGB颜色来说，调成黑色或者白色的话16进制直接用#000或者#FFF就能表示，改用二进制还得打24个0或者24个1，看上去就复杂不少还容易出错</p>
<p>二进制实际上在计算机中是通过补码表示的，我们看到的各种二进制实际上都是给我们能看懂的，对于计算机来说补码更加实用。</p>
<p>在计算机的世界里，只有0和1，也就是二进制。计算机底层运算的时候操作的是二进制，</p>
<p>那如何把一个十进制的数转成二进制或者其他进制，请下图：</p>
<p>八进制： 3个二进制位最多能表示0-7共8个数字，基数为8，加法运算时逢八进一，减法运算时借一当八。例如，数字 0、1、5、7、14、733、67001、25430 都是有效的八进制。</p>
<p>二进制是机器能够识别的最直接语言，但是二进制位数太多，不方便记录，所以一般把二进制转化为八进制或十六进制。为什么不直接把二进制转化为十进制呢？因为二进制转化为十进制较麻烦，不够直观，而二进制转化为八进制或十六进制十分方便，3位二进制可转化为1位八进制，4位二进制可转化为1位十六进制，比如二进制111转化为八进制7，二进制1111转化为十六进制F。只有3位或4位二进制转化为十进制还是比较容易，但是如果多位二进制呢？就很麻烦了，比如二进制1111111111111111转化为十进制，很难秒算出来，需要借助计算器，但是转化为十六进制就不一样了，四位四位二进制合并为一位十六进制就可以了，即二进制（1111111111111111）=十六进制（FFFF），一目了然很方便，只要记住下图16个二进制转化为十六进制的数字即可。</p>
<p>十六进制表示：包括0-9的数字，及字母a-f，A-F，a 或者 A 表示10，B表示11，C表示12，D表示13，E表示14，F表示15，因此有  0~F 共16个数字，基数为16，加法运算时逢16进1，减法运算时借1当16。例如，数字  0、1、6、9、A、D、F、419、EA32、80A3、BC00 都是有效的十六进制。<br>4个二进制位能表示0-15共16个数，<br>就是为了简洁。例如一个16位的二进制数1010010111001011，无论写起来还是读起来，很费事儿，还容易出错，写成十六进制数A5CD，就方便多了，也不容易出错。</p>
<p>Python 中浮点数的运算存在误差</p>
<p>当带小数点的十进制转换成二进制的时候可能存在小数部分乘不尽的情况</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">1.2</span> - <span class="number">1.0</span>)  <span class="comment"># 0.19999999999999996</span></span><br><span class="line">print(<span class="number">0.1</span> + <span class="number">0.2</span>)  <span class="comment"># 0.30000000000000004</span></span><br><span class="line">print(<span class="number">0.1</span> + <span class="number">2</span>)  <span class="comment"># 2.1</span></span><br><span class="line">print(<span class="number">0.1</span> * <span class="number">2</span>)  <span class="comment"># 0.2</span></span><br><span class="line"></span><br><span class="line">print(<span class="number">1.2</span> - <span class="number">1.0</span> == <span class="number">0.2</span>)  <span class="comment"># False</span></span><br><span class="line">print(type(<span class="number">2</span> / <span class="number">2</span>))  <span class="comment"># &lt;class 'float'&gt;</span></span><br><span class="line"></span><br><span class="line">print(float(<span class="number">1</span>))   <span class="comment"># 1.0</span></span><br></pre></td></tr></tbody></table></figure>

<p>python中<code>0b</code>(数字0和小写字母B前缀)代表二进制数字</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">0b101</span>)  <span class="comment"># 5</span></span><br><span class="line">print(<span class="number">0b11</span>)  <span class="comment"># 3</span></span><br></pre></td></tr></tbody></table></figure>

<p>java中以<code>0</code>开头代表八进制数字，如：037，056<br>python中<code>0o</code>(数字0和小写字母O前缀)代表八进制数字，</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">0o11</span>)  <span class="comment"># 9</span></span><br><span class="line">print(<span class="number">0o110</span>)  <span class="comment"># 72</span></span><br></pre></td></tr></tbody></table></figure>

<p>java中以<code>0x</code>或<code>0X</code>开头代表十六进制数字，如：0x12，0xabcf，0XABCF<br>python中<code>0x</code>(数字0和小写字母X前缀)代表十六进制数字</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">0x101</span>)  <span class="comment"># 257</span></span><br><span class="line">print(<span class="number">0x1F</span>)  <span class="comment"># 31</span></span><br><span class="line">print(<span class="number">0x1f</span>)  <span class="comment"># 31</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>int()</code> 代表不同类型数据转换为10进制数字</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 字符串转int</span></span><br><span class="line"></span><br><span class="line">data = <span class="string">"11"</span></span><br><span class="line">int_data = int(data)  <span class="comment"># 默认10进制</span></span><br><span class="line">print(type(int_data), int_data)  <span class="comment"># &lt;class 'int'&gt; 11</span></span><br><span class="line">int_data = int(data, <span class="number">16</span>)  <span class="comment"># 16进制</span></span><br><span class="line">print(type(int_data), int_data)  <span class="comment"># &lt;class 'int'&gt; 17</span></span><br><span class="line"></span><br><span class="line">data = <span class="string">"21"</span></span><br><span class="line">int_data = int(data)  <span class="comment"># 默认10进制</span></span><br><span class="line">print(type(int_data), int_data)  <span class="comment"># &lt;class 'int'&gt; 21</span></span><br><span class="line">int_data = int(data, <span class="number">16</span>)  <span class="comment"># 16进制</span></span><br><span class="line">print(type(int_data), int_data)  <span class="comment"># &lt;class 'int'&gt; 33</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. int转字符串</span></span><br><span class="line">data_str = str(int_data)</span><br><span class="line">print(type(data_str), data_str)  <span class="comment"># &lt;class 'str'&gt; 33</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. float类型转换</span></span><br><span class="line">data_float = float(<span class="string">"3.1415"</span>)</span><br><span class="line">print(type(data_float), data_float)  <span class="comment"># &lt;class 'float'&gt; 3.1415</span></span><br><span class="line"></span><br><span class="line">float_str = str(data_float)</span><br><span class="line">print(type(float_str), float_str)  <span class="comment"># &lt;class 'str'&gt; 3.1415</span></span><br></pre></td></tr></tbody></table></figure>


<p><code>oct()</code>  代表不同类型数据转换为8进制数字</p>
<p><code>hex(x)</code>，将不同类型进制整数转换为以“0x”为前缀的小写十六进制数的字符串。如果 x 不是 Python int 对象，则必须定义返回整数的 <code>__index__()</code> 方法。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">print(hex(<span class="number">1</span>))  <span class="comment"># 0x1 补码</span></span><br><span class="line">print(hex(<span class="number">-1</span>))  <span class="comment"># -0x1 负号 + 原码 （Python 特色，Java 会直接输出补码）</span></span><br><span class="line"></span><br><span class="line">print(hex(<span class="number">3</span>), type(hex(<span class="number">3</span>)))  <span class="comment"># 0x3 &lt;class 'str'&gt;</span></span><br><span class="line">print(int(<span class="string">'3'</span>, <span class="number">16</span>), type(int(<span class="string">'3'</span>, <span class="number">16</span>)))  <span class="comment"># 3 &lt;class 'int'&gt;</span></span><br><span class="line">print(hex(<span class="number">0b11</span>))  <span class="comment"># 0x3  将2进制数字转换为2=16进制</span></span><br></pre></td></tr></tbody></table></figure>

<p>如果要将整数转换为大写或小写的十六进制字符串，并可选择有无“0x”前缀，则可以使用如下方法：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'%#x'</span> % <span class="number">3</span>, <span class="string">'%x'</span> % <span class="number">3</span>, <span class="string">'%X'</span> % <span class="number">3</span>, )</span><br><span class="line"><span class="comment"># 0x3 3 3</span></span><br><span class="line"></span><br><span class="line">print(format(<span class="number">3</span>, <span class="string">'#x'</span>), format(<span class="number">3</span>, <span class="string">'x'</span>), format(<span class="number">3</span>, <span class="string">'X'</span>))</span><br><span class="line"><span class="comment"># 0x3 3 3</span></span><br><span class="line">print(f'{3:#x}', f'{3:x}', f'{3:X}')</span><br><span class="line"><span class="comment"># 0x3 3 3</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'%#x'</span> % <span class="number">-3</span>, <span class="string">'%x'</span> % <span class="number">-3</span>, <span class="string">'%X'</span> % <span class="number">-3</span>, )</span><br><span class="line"><span class="comment"># -0x3 -3 -3</span></span><br><span class="line"></span><br><span class="line">print(format(<span class="number">-3</span>, <span class="string">'#x'</span>), format(<span class="number">-3</span>, <span class="string">'x'</span>), format(<span class="number">-3</span>, <span class="string">'X'</span>))</span><br><span class="line"><span class="comment"># -0x3 -3 -3</span></span><br><span class="line">print(f'{-3:#x}', f'{-3:x}', f'{-3:X}')</span><br><span class="line"><span class="comment"># -0x3 -3 -3</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>bin(x)</code> 将一个不同类型进制整数转变为一个前缀为“0b”的二进制数的字符串。结果是一个合法的 Python 表达式。<br>如果 x 不是 Python 的 <code>int</code> 对象，那它需要定义 <code>__index__()</code> 方法返回一个整数。<br>bin一个正数（十进制表示），输出的是它的原码的二进制表示<br>bin一个负数（十进制表示），输出的是它的原码的二进制表示加上个负号，而不是补码的形式。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(bin(<span class="number">3</span>), type(bin(<span class="number">3</span>)))  <span class="comment"># 0b11 &lt;class 'str'&gt;</span></span><br><span class="line">print(bin(<span class="number">-3</span>))  <span class="comment"># -0b11</span></span><br></pre></td></tr></tbody></table></figure>

<p>对数值进行与操作就获得补码形式的二进制表示</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">print(bin(<span class="number">5</span>))</span><br><span class="line"><span class="comment"># 0b101</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">-5</span>))</span><br><span class="line"><span class="comment"># -0b101</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">-5</span> &amp; <span class="number">0b1111</span>))  </span><br><span class="line"><span class="comment"># 0b1011</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">-5</span> &amp; <span class="number">0b11111</span>))  </span><br><span class="line"><span class="comment"># 0b11011</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">-5</span> &amp; <span class="number">0b1111111111111111</span>))</span><br><span class="line"><span class="comment"># 0b1111111111111011</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># bin一个负数（十六进制表示），输出的是对应的二进制表示。</span></span><br><span class="line">print(bin(<span class="number">-3</span> &amp; <span class="number">0xffffffff</span>))</span><br><span class="line"><span class="comment"># 0b11111111111111111111111111111101</span></span><br><span class="line">print(bin(<span class="number">0xfffffffd</span>))</span><br><span class="line"><span class="comment"># 0b11111111111111111111111111111101</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">-3</span> &amp; <span class="number">0b111</span>))</span><br><span class="line"><span class="comment"># 0b101</span></span><br><span class="line">print(bin(<span class="number">-3</span> &amp; <span class="number">0b1111111111111111</span>))</span><br><span class="line"><span class="comment"># 0b1111111111111101</span></span><br><span class="line"></span><br><span class="line">print(bin(<span class="number">0o7</span>))  <span class="comment"># 0b111 将8进制数字转换为2进制</span></span><br><span class="line">print(bin(<span class="number">0xE</span>))  <span class="comment"># 0b1110 将16进制数字转换为2进制</span></span><br></pre></td></tr></tbody></table></figure>

<p>If prefix “0b” is desired or not, you can use either of the following ways.<br>如果不一定需要前缀“0b”，还可以使用如下的方法。<br>用format字符串获取一个int的binary表示：<br><code>f"{a:b}"</code>：将a转换成binary的str。<br><code>f"{a:030b}"</code>：将a转换成binary的str，并在前面补0使其总位数是30。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">format(<span class="number">14</span>, <span class="string">'#b'</span>), format(<span class="number">14</span>, <span class="string">'b'</span>)</span><br><span class="line"><span class="comment"># ('0b1110', '1110')</span></span><br><span class="line">f'{14:#b}', f'{14:b}'</span><br><span class="line"><span class="comment"># ('0b1110', '1110')</span></span><br></pre></td></tr></tbody></table></figure>

<p>4bit有符号整型， 其数值范围为[-8， 7]<br>-2 + 3 可以通过补码计算 1110 + 0011 =(1) 0001</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span></span><br><span class="line">+   <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">-----------</span><br><span class="line">(<span class="number">1</span>) <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> # 注意溢出</span><br></pre></td></tr></tbody></table></figure>

<p>python 由于不知道符号位具体是第几位，因此需要进行的操作是</p>
<ol>
<li>将输入数字转化成无符号整数</li>
<li>计算无符号整数相加并的到结果</li>
<li>讲结果根据范围判定，映射为有符号整型</li>
</ol>
<p>转化为4bit无符号整数</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a &amp;= <span class="number">0xF</span> <span class="comment"># a = a &amp; 0b1111 = 1110 = 14</span></span><br><span class="line">b &amp;= <span class="number">0xF</span> <span class="comment"># b = 0011 = 3</span></span><br></pre></td></tr></tbody></table></figure>

<p>原码：直接将一个数值转化为二进制，其首位代表符号，<code>0</code> 为正， <code>1</code> 为负<br>正数：原码 = 反码 = 补码<br>负数反码：原码最高位符号位不变，其余为取反<br>负数补码：负数反码+1，即 符号位不变，各位取反再加 1</p>
<h4 id="补码特性"><a href="#补码特性" class="headerlink" title="补码特性"></a>补码特性</h4><p>1、一个负整数（或原码）与其补数（或补码）相加，和为模。<br>2、对一个整数的补码再求补码，等于该整数自身。<br>3、补码的正零与负零表示方法相同</p>
<ul>
<li>Python 负数的存储：<ul>
<li>获取负数的补码：<br>将整数与 0xffffffff 相与，<br>可理解为该数从 32 位开始到最高位全部置零，最高位为0为正数<br>从无限长度变为一个 32 位内二进制可以表示的正整数<br>一直循环左移并不会存在溢出的现象，模拟其他语言的32位溢出机制。<br>一个负整数（或原码）与其补数（或补码）相加，和为模。2 的32 次方 是模。<br>那么就是 2 的32 次方 然后 + n  这是在取一个负数的补码<br>就相当于  n &amp; 0xffffffff<br>高位第一位的数字取决于此数字是正数还是负数，是正数则为 0 ，是负数则为 1</li>
</ul>
</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(hex(<span class="number">1</span> &amp; <span class="number">0xffffffff</span>))  <span class="comment"># 0x1 正数补码</span></span><br><span class="line">print(hex(<span class="number">-1</span> &amp; <span class="number">0xffffffff</span>))  <span class="comment"># 0xffffffff 负数补码</span></span><br><span class="line">print(<span class="number">-1</span> &amp; <span class="number">0xffffffff</span>)  <span class="comment"># 4294967295（Python 将其认为正数）</span></span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>返回前数字还原 补码转原码：<br>若补码 a 为负数（第 32位是 1），<br>a ^ 0xffffffff 运算将 1 至 32 位按位取反；<br>~ 运算是将所有位的数字会取反；<br>因此， ~(a ^ 0xffffffff) 是将低的 1 至 32 位不变。<br>32 位以上的位取反，即 32位以上所有位全部置 1了，<br>对于32位的数字来说最高位是1则说明此数为负数<br>把这个负数补码恢复到 超过32位的 python 存储负数的形式，</li>
</ul>
<p>如果不对负数特殊处理，那么负数的前32位里的最高位还可能存在 0，最后输出的是大于32位的正数</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/di-gui/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/di-gui/" class="post-title-link" itemprop="url">递归</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-08-04 00:45:40" itemprop="dateModified" datetime="2021-08-04T00:45:40Z">2021-08-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>“””<br>在递归过程中，，函数可能会有多个位置将自身作为子例程调用<br>每当递归函数调用自身时，它都会将给定的问题拆解为子问题。<br>递归调用继续进行，直到到子问题无需进一步递归就可以解决的地步。</p>
<p>为了确保递归函数不会导致无限循环，它应具有以下属性：</p>
<ul>
<li>一个简单的基本案例（basic case）（一般情况），<br>能够不使用递归来产生答案的终止方案，必须要有终止条件，</li>
<li>一组规则，也称作递推关系（recurrence relation），可将所有其他情况拆分到基本案例。<br>不断调用自身，直到遇到终止条件后进行回溯，最终返回答案。</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span>(<span class="params">x</span>):</span></span><br><span class="line">    print(x)</span><br><span class="line">    func1(x - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        print(x)</span><br><span class="line">        func2(x + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func3</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        print(x)</span><br><span class="line">        func3(x - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func4</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        func4(x - <span class="number">1</span>)</span><br><span class="line">        print(x)</span><br></pre></td></tr></tbody></table></figure>
<p>func3和func4是递归，x为正整数，func3会连续输出x到1，func4会输出1 到x</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printReverse</span>(<span class="params">str</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> str:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    printReverse(str+<span class="number">1</span>)</span><br><span class="line">    print()</span><br></pre></td></tr></tbody></table></figure>

<p>python 自带求和<code>sum()</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(sum(range(<span class="number">1</span>, <span class="number">11</span>)))  <span class="comment"># 55</span></span><br></pre></td></tr></tbody></table></figure>

<p>高斯求和</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 循环</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum_number</span>(<span class="params">n</span>):</span></span><br><span class="line">    total = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">        total += i</span><br><span class="line">    <span class="keyword">return</span> total</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(sum_number(<span class="number">10</span>))  <span class="comment"># 5</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 递归</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum_number</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> n + sum_number(n - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(sum_number(<span class="number">10</span>))  <span class="comment"># 55</span></span><br></pre></td></tr></tbody></table></figure>

<p>基本情况：sum_number(0) = 0<br>其它情形: sum_number(n) = n + sum_number</p>
<p>sum_number(n-1)又是一次sum_number函数的调用，<br>不过参数的值变成了n-1，<br>要得sum_number(n)到的值就必须等待sum_number(n-1)的值被计算出来，<br>同样要得到sum_number(n-1)的值必须等待sum_number(n-2)的值，<br>如此一路推算下去，直到sum_number(0)，<br>因为if语句的存在，它不需要等待sum_number(-1)的计算了，而是直接给出结果0。<br>参数值由 10 9 8 7 6 5 4 3 2 1 0<br>sun_number(1)=1+sun_number(0)=1<br>sun_number(2)=2+sun_number(1)=2+1+sun_number(0)=2+1+0=3<br>sun_number(3)=3+sun_number(2)=3+3=6<br>….<br>然后程序一路返回，直到回到最初的sum_number(n)，并给出最终结果。<br>“””</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 求阶乘</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">F</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">or</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="comment"># 对应基本情形</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> F(n - <span class="number">1</span>) * n  <span class="comment"># 对应递归情形</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(F(<span class="number">4</span>))  <span class="comment"># 24</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string"> F(0) = 1, F(1) = 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">其它情形: F(n) = F(n-1) * n</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算s=a+aa+aaa+aaaa+aa...a，其中 a是一个数字。</span></span><br><span class="line"><span class="comment"># 例如2+22+222+2222+22222(此时共有5个数相加)，几个数相加由键盘控制。</span></span><br><span class="line"><span class="comment"># 其中，a 以及 n 由用户输入，但是我们在这里就直接给定了。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sss</span>(<span class="params">a, n</span>):</span></span><br><span class="line">    <span class="comment"># 这里我说明一下，直接用input函数得到的就是字符串，除非你已经做了转换</span></span><br><span class="line">    <span class="comment"># 所以,我们设定a、n都是字符串</span></span><br><span class="line">    n = int(n)  <span class="comment"># 转换</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> int(a)</span><br><span class="line">    <span class="keyword">return</span> sss(a, n - <span class="number">1</span>) + int(a * n)  <span class="comment"># 请思考这里a*n</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">"""基本情形：sss(a, 1) = a</span></span><br><span class="line"><span class="string">sss(a, 2) = a+aa=sss(a, 1)+aa</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">其它情形:</span></span><br><span class="line"><span class="string">sss(a, n) = sss(a, n-1) + a...a(共n项)""</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">print(sss(<span class="string">'2'</span>, <span class="string">'1'</span>))  <span class="comment"># 2</span></span><br><span class="line">print(sss(<span class="string">'2'</span>, <span class="string">'2'</span>))  <span class="comment"># 24</span></span><br><span class="line">print(<span class="string">'-----'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line">n = int(input(<span class="string">"请输入层数n："</span>))  <span class="comment"># &lt;class 'int'&gt;</span></span><br><span class="line">a = int(input(<span class="string">"请输入数字a："</span>))  <span class="comment"># &lt;class 'int'&gt;</span></span><br><span class="line"></span><br><span class="line">Tn = <span class="number">0</span>  <span class="comment"># 初始化数字叠加后的值</span></span><br><span class="line">Sn = []  <span class="comment"># 创建一个空列表，以便接收叠加后的数值</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(n):  <span class="comment"># 此处的循环表示，n为几，i就循环几次，</span></span><br><span class="line">    <span class="comment"># 也就是，层数为几，下面的循环体就执行几次</span></span><br><span class="line">    Tn = Tn + a  <span class="comment"># 将循环的值赋值给Tn</span></span><br><span class="line">    <span class="comment"># print("数字叠加后值为：", Tn)  # 打印出数字叠加后的值</span></span><br><span class="line">    Sn.append(Tn)  <span class="comment"># 将数字叠加后的值依次添加到Sn这个空的列表中</span></span><br><span class="line">    <span class="comment"># print("创建的数列为：", Sn)  # 打印出列表Sn中的所有值</span></span><br><span class="line">    a = a * <span class="number">10</span>  <span class="comment"># 为下一个数做循环准备</span></span><br><span class="line">print(<span class="string">"创建的数列为："</span>, Sn)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 法一</span></span><br><span class="line"><span class="comment"># sum_ = reduce(lambda x, y: x + y, Sn)  # 计算Sn的值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 法二</span></span><br><span class="line">sum_ = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Sn:</span><br><span class="line">    sum_ += i</span><br><span class="line">print(<span class="string">"计算的和为："</span>, sum_)  <span class="comment"># 打印出Sn的值</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = input(<span class="string">"a:"</span>)  <span class="comment"># &lt;class 'str'&gt;</span></span><br><span class="line">n = int(input(<span class="string">"n:"</span>))  <span class="comment"># &lt;class 'int'&gt;</span></span><br><span class="line">ls = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">    ls.append(i * a)  <span class="comment"># 字符串乘一个数</span></span><br><span class="line">sum = <span class="number">0</span></span><br><span class="line">print(ls)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ls:</span><br><span class="line">    sum += eval(i)  <span class="comment"># 字符串表达式</span></span><br><span class="line">print(sum)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getNum</span>(<span class="params">a, count</span>):</span></span><br><span class="line">    list1 = []</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    a = str(a)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, count + <span class="number">1</span>):</span><br><span class="line">        list1.append(int(a * i))</span><br><span class="line">        print(list1[i - <span class="number">1</span>], end=<span class="string">" "</span>)</span><br><span class="line">        <span class="keyword">if</span> i &lt; count:</span><br><span class="line">            print(<span class="string">"+"</span>, end=<span class="string">" "</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> list1:</span><br><span class="line">        res += j</span><br><span class="line">    print(<span class="string">"="</span>, res)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">getNum(<span class="number">2</span>, <span class="number">2</span>)  <span class="comment"># 2 + 22 = 24</span></span><br></pre></td></tr></tbody></table></figure>

<p>判断用户输入的数组的逆序数。<br>定义：OP(seq, n)为序列seq中前n项的逆序数</p>
<p>基本情形:<br>OP(seq[1…n], 1) = 0，对于只有一个元素的集合，逆序数必然只有0<br>其它情形:<br>OP(seq[1…n], n) = OP(seq[1…n, n-1] + F(n)，其中，F(n)是n关于seq[1…n-1]的逆序数.</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">OP</span>(<span class="params">seq, n</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="comment"># 不为0</span></span><br><span class="line">    Fn = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> seq[n - <span class="number">1</span>] &lt; seq[i]:</span><br><span class="line">            Fn += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> OP(seq, n - <span class="number">1</span>) + Fn</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = [<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">print(OP(s, len(s)))  <span class="comment"># 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># n=5 n-1-1=3</span></span><br><span class="line"><span class="comment"># 当i=0,seq[4]=1&lt;seq[0]=5</span></span><br><span class="line"><span class="comment"># 当i=1,seq[4]=1&lt;seq[1]=4</span></span><br><span class="line"><span class="comment"># 当i=2,seq[4]=1&lt;seq[2]=3</span></span><br><span class="line"><span class="comment"># 当i=3,seq[4]=1&lt;seq[3]=2</span></span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/bi-bao/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/bi-bao/" class="post-title-link" itemprop="url">闭包 Closure /'kləʊʒə/</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-08-13 09:56:57" itemprop="dateModified" datetime="2021-08-13T09:56:57Z">2021-08-13</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li><p>Python 原生支持闭包</p>
</li>
<li><p>绑定了外部作用域的变量的函数</p>
</li>
<li><p>即使程序离开外部作用域，如果闭包仍然可见，绑定变量不会销毁<br>即使外部函数结束了，但只要内部函数还在引用外部函数的变量，外部变量它就依然存在。</p>
</li>
<li><p>每次运行外部函数都会重新创建闭包</p>
</li>
<li><p>自由变量：不在当前函数定义的变量。</p>
</li>
<li><p>外函数outer中定义了嵌套内函数inner，</p>
</li>
<li><p>内部函数inner引用外部函数outer的自由变量，</p>
</li>
<li><p>当外部函数outer返回内部函数名inner时，即外函数的返回值是内函数的引用，<br>相关参数和变量都保存在返回的函数中</p>
</li>
<li><p>使用 <code>__closure__</code> 来查看闭包的内容</p>
</li>
</ul>
<h3 id="外函数返回了内函数的引用"><a href="#外函数返回了内函数的引用" class="headerlink" title="外函数返回了内函数的引用"></a>外函数返回了内函数的引用</h3><p>当进行a=1的时候，实际上在内存当中有一个地方存了值1，<br>然后用a这个变量名存了1所在内存位置的引用。<br>引用就好像c语言里的指针，可以把引用理解成地址。<br>a只不过是一个变量名字，a里面存的是1这个数值所在的地址，就是a里面存了数值1的引用。</p>
<p>相同的道理，在python中定义一个函数def demo():的时候，<br>内存当中会开辟一些空间，存下这个函数的代码、内部的局部变量等等。<br>这个demo只不过是一个变量名字，它里面存了这个函数所在位置的引用而已。<br>我们还可以进行x = demo， y = demo， 这样的操作就相当于，<br>把demo里存的东西赋值给x和y，这样x 和y 都指向了demo函数所在的引用，<br>在这之后我们可以用x() 或者 y() 来调用我们自己创建的demo() ，<br>调用的实际上根本就是一个函数，x、y和demo三个变量名存了同一个函数的引用。</p>
<p>对于闭包，在外函数outer中 最后return inner，<br>我们在调用外函数 demo = outer() 的时候，<br>outer返回了inner，inner是一个函数的引用，这个引用被存入了demo中。<br>所以接下来我们再进行demo() 的时候，相当于运行了inner函数。<br>一个函数，如果函数名后紧跟一对括号，相当于现在我就要调用这个函数，<br>如果不跟括号，相当于只是一个函数的名字，里面存了函数所在位置的引用，那它可以被到处传递，并且可以赋值给别的变量而不去执行它。</p>
<p>2 外函数把临时变量绑定给内函数：<br>一般情况下，如果一个函数结束，函数的内部所有东西都会释放掉，<br>还给内存，临时局部变量都会消失。<br>如果没有在函数中引用全局变量，或者仅引用局部变量，<br>在内函数给局部变量赋值python认为是一个局部变量，不能引用外部函数的环境变量，<br>都不会形成闭包</p>
<p>但是闭包是一种特殊情况，发现有自己的临时变量将来会在内部函数中用到，<br>自己在结束的时候，返回内函数的同时，会把外函数的临时变量绑定给了内部函数，<br>所以外函数已经结束了，调用内函数的时候仍然能够使用外函数的临时变量。</p>
<p>python中一切都是对象，虽然函数我们只定义了一次，<br>但是外函数在运行的时候，<br>实际上是按照里面代码执行的，<br>外函数里创建了一个函数，每次调用外函数，<br>它都创建一个代码、功能一样的内函数，<br>但是却创建了不同的对象，并且把每次传入的临时变量数值绑定给内函数，再把内函数引用返回。</p>
<p>特性：自由变量会和闭包函数同时存在，即闭包函数和外部变量会同时存在。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">curve_pre</span>():</span></span><br><span class="line">    a = <span class="number">25</span></span><br><span class="line">    b = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">curve</span>():</span></span><br><span class="line">        <span class="keyword">return</span> b * a</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> curve  <span class="comment"># 实质是返回了函数及现场环境变量</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = <span class="number">10</span>  <span class="comment"># a并没有在调用curve函数中起到作用</span></span><br><span class="line">r = curve_pre()</span><br><span class="line"></span><br><span class="line">print(r())  <span class="comment"># 50</span></span><br><span class="line">print(r.__closure__)</span><br><span class="line"><span class="comment"># (&lt;cell at 0x000001580A52B3A0: int object at 0x00007FFB6FC599A0&gt;, &lt;cell at 0x000001580A52B400: int object at 0x00007FFB6FC596C0&gt;)</span></span><br><span class="line">print(r.__closure__[<span class="number">0</span>].cell_contents)  <span class="comment"># 25</span></span><br><span class="line">print(r.__closure__[<span class="number">1</span>].cell_contents)  <span class="comment"># 2</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f1</span>():</span></span><br><span class="line">    a = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f2</span>():</span></span><br><span class="line">        <span class="comment"># a = 20  # a被python认为式一个局部变量，不是闭包</span></span><br><span class="line">        c = <span class="number">20</span> * a</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> f2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = f1()</span><br><span class="line">print(f)</span><br><span class="line"><span class="comment"># &lt;function f1.&lt;locals&gt;.f2 at 0x00000205E28F1670&gt;</span></span><br><span class="line"></span><br><span class="line">print(f.__closure__)  <span class="comment"># 判断是一个闭包</span></span><br><span class="line"><span class="comment"># (&lt;cell at 0x00000205E289B3A0: int object at 0x00007FFB6FC597C0&gt;,)</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">origin = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factory</span>(<span class="params">pos</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">go</span>(<span class="params">step</span>):</span></span><br><span class="line">        <span class="keyword">nonlocal</span> pos</span><br><span class="line">        new_pos = pos + step</span><br><span class="line">        pos = new_pos  <span class="comment"># origin被赋值，python认为式一个局部变量,</span></span><br><span class="line">        <span class="comment"># 不能引用外部函数的环境变量，不是闭包</span></span><br><span class="line">        <span class="keyword">return</span> new_pos</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> go</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tourist = factory(origin)</span><br><span class="line">print(tourist(<span class="number">2</span>))  <span class="comment"># 2</span></span><br><span class="line">print(tourist.__closure__[<span class="number">0</span>].cell_contents)  <span class="comment"># 2 查看内函数环境变量</span></span><br><span class="line">print(tourist(<span class="number">3</span>))  <span class="comment"># 5</span></span><br><span class="line">print(tourist.__closure__[<span class="number">0</span>].cell_contents)  <span class="comment"># 5 查看内函数环境变量</span></span><br><span class="line">print(tourist(<span class="number">6</span>))  <span class="comment"># 5 实质是返回了函数及现场环境变量</span></span><br><span class="line">print(tourist.__closure__[<span class="number">0</span>].cell_contents)  <span class="comment"># 11查看内函数环境变量</span></span><br><span class="line">print(origin)  <span class="comment"># 11 外部环境变量没改变</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>(<span class="params">y</span>):</span></span><br><span class="line">        <span class="keyword">return</span> x + y  <span class="comment"># inner函数引用了外部函数outer的变量x</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(outer(<span class="number">6</span>)(<span class="number">5</span>))  <span class="comment"># 11</span></span><br></pre></td></tr></tbody></table></figure>

<p>第一个括号传进去的值返回inner函数，其实就是返回6 + y，所以再传第二个参数进去，就可以得到返回值，6 + 5。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">a</span>):</span></span><br><span class="line">    <span class="comment"># a和b都是外函数的临时变量</span></span><br><span class="line">    b = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>():</span></span><br><span class="line">        print(a + b)  <span class="comment"># 在内函数中 用到了外函数的临时变量</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> inner  <span class="comment"># 外函数的返回值是内函数的引用和环境变量</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">        调用外函数传入参数5</span></span><br><span class="line"><span class="string">        此时外函数两个临时变量 a是5 b是10 ，</span></span><br><span class="line"><span class="string">        并创建了内函数，然后把内函数的引用返回存给了demo</span></span><br><span class="line"><span class="string">        外函数结束的时候发现内部函数将会用到自己的临时变量，</span></span><br><span class="line"><span class="string">        这两个临时变量就不会释放，会绑定给这个内部函数</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    demo = outer(<span class="number">5</span>)</span><br><span class="line">    <span class="comment"># demo存了外函数的返回值，也就是inner函数的引用，这里相当于执行inner函数</span></span><br><span class="line">    demo()  <span class="comment"># 15</span></span><br><span class="line"></span><br><span class="line">    demo2 = outer(<span class="number">7</span>)</span><br><span class="line">    demo2()  <span class="comment"># 17</span></span><br></pre></td></tr></tbody></table></figure>

<p>两次调用外部函数outer，分别传入的值是5和7。<br>内部函数只定义了一次，我们发现调用的时候，内部函数是能识别外函数的临时变量是不一样的。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>(<span class="params">y</span>):</span></span><br><span class="line">        <span class="keyword">nonlocal</span> x</span><br><span class="line">        x += y</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = outer(<span class="number">10</span>)</span><br><span class="line">print(a(<span class="number">1</span>))  <span class="comment"># 11</span></span><br><span class="line">print(a(<span class="number">3</span>))  <span class="comment"># 14，不是13</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span>():</span></span><br><span class="line">    fs = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">f</span>():</span></span><br><span class="line">            <span class="keyword">return</span> i * i</span><br><span class="line"></span><br><span class="line">        fs.append(f)</span><br><span class="line">    <span class="keyword">return</span> fs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f1, f2, f3 = count()</span><br><span class="line">print(f1())  <span class="comment"># 9</span></span><br><span class="line">print(f2())  <span class="comment"># 9</span></span><br><span class="line">print(f3())  <span class="comment"># 9</span></span><br><span class="line">print(f1.__closure__)  <span class="comment"># 判断是否为闭包</span></span><br><span class="line"><span class="comment"># (&lt;cell at 0x00000254B86EB910: int object at 0x00007FFE087E96E0&gt;,)</span></span><br><span class="line">print(f1.__closure__[<span class="number">0</span>].cell_contents)  <span class="comment"># 环境变量 3</span></span><br></pre></td></tr></tbody></table></figure>

<p>是开启一个函数执行过后消亡，但是闭包变量实际上只有一份，每次开启内函数都在使用同一份闭包变量x<br>why f1(), f2(), f3() returns 9, 9, 9 rather than 1, 4, 9?<br>原因就在于返回的函数引用了变量i，但它并非立刻执行。<br>等到3个函数都返回时，它们所引用的变量i已经变成了3，因此最终结果为9</p>
<p>修改闭包变量<br>要修改全局数据的时候有两种方法:<br>1 global 声明全局变量，声明变量n非内部函数的局部变量，否则内部函数只能引用，<br>       一旦修改会视其为局部变量，报错“局部变量在赋值之前被引用”。<br>         外函数的环境变量没被改变<br>2 全局变量是可变类型数据的时候可以修改 闭包更好<br>在闭包内函数中想修改闭包变量（外函数绑定给内函数的局部变量）的时候：<br>嵌套函数修改上层变量同样需要的关键字nonlocal 关键字声明<br>表示这个变量不是局部变量空间的变量，需要向上一层变量空间找这个变量。<br>闭包的环境变量可以记忆上次调用的状态，外函数的环境变量没被改变<br>使用闭包的过程中，一旦外函数被调用一次返回了内函数的引用，<br>虽然每次调用内函数，<br>是开启一个函数执行过后消亡，但是闭包变量实际上只有一份，<br>每次开启内函数都在使用同一份闭包变量</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span>(<span class="params">a</span>):</span>  <span class="comment"># outer是外部函数 a和b都是外函数的临时变量</span></span><br><span class="line">    b = <span class="number">10</span>  <span class="comment"># a和b都是闭包变量</span></span><br><span class="line">    c = [a]  <span class="comment"># 这里对应修改闭包变量的方法2</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span>():</span>  <span class="comment"># inner是内函数</span></span><br><span class="line">        <span class="comment"># 内函数中想修改闭包变量</span></span><br><span class="line">        <span class="comment"># 方法1 nonlocal关键字声明不是局部变量</span></span><br><span class="line">        <span class="keyword">nonlocal</span> b</span><br><span class="line">        b += <span class="number">1</span></span><br><span class="line">        print(b)</span><br><span class="line">        <span class="comment"># 方法二，把闭包变量修改成可变数据类型 比如列表</span></span><br><span class="line">        c[<span class="number">0</span>] += <span class="number">1</span></span><br><span class="line">        print(c[<span class="number">0</span>])</span><br><span class="line">        print(b)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 外函数的返回值是内函数的引用</span></span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    demo = outer(<span class="number">5</span>)</span><br><span class="line">    demo()</span><br><span class="line">    <span class="comment"># 11</span></span><br><span class="line">    <span class="comment"># 6</span></span><br><span class="line">    <span class="comment"># 11</span></span><br><span class="line">print(<span class="string">'----------'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>利用闭包返回一个计数器函数，每次调用它返回递增整数：<br>在内函数中，分别对闭包变量进行了修改，<br>打印出来的结果也确实是修改之后的结果。<br>以上两种方法就是内函数修改闭包变量的方法。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">adder</span>():</span></span><br><span class="line">    sum = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">value</span>):</span></span><br><span class="line">        <span class="keyword">nonlocal</span> sum</span><br><span class="line">        sum += value</span><br><span class="line">        <span class="keyword">return</span> sum</span><br><span class="line">    <span class="keyword">return</span> f</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_counter</span>():</span>  <span class="comment"># 是外部函数</span></span><br><span class="line">    i = <span class="number">0</span>  <span class="comment"># i都是闭包变量</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">counter</span>():</span>  <span class="comment"># 内函数</span></span><br><span class="line">        <span class="keyword">nonlocal</span> i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> counter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试:</span></span><br><span class="line">counterA = create_counter()</span><br><span class="line">print(counterA(), counterA(), counterA(), counterA(), counterA())  <span class="comment"># 1 2 3 4 5</span></span><br><span class="line">counterB = create_counter()</span><br><span class="line"><span class="keyword">if</span> [counterB(), counterB(), counterB(), counterB()] == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]:</span><br><span class="line">    print(<span class="string">'测试通过!'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'测试失败!'</span>)</span><br><span class="line"><span class="comment"># 测试通过!</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createCounter</span>():</span></span><br><span class="line">    i = [<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">counter</span>():</span></span><br><span class="line">        i[<span class="number">0</span>] = i[<span class="number">0</span>] + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> i[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> counter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试:</span></span><br><span class="line">counterA = createCounter()</span><br><span class="line">print(counterA(), counterA(), counterA(), counterA(), counterA())  <span class="comment"># 1 2 3 4 5</span></span><br><span class="line">counterB = createCounter()</span><br><span class="line"><span class="keyword">if</span> [counterB(), counterB(), counterB(), counterB()] == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]:</span><br><span class="line">    print(<span class="string">'测试通过!'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'测试失败!'</span>)</span><br><span class="line"><span class="comment"># 测试通过!</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cache</span>(<span class="params">func</span>):</span>  <span class="comment"># 定义装饰器，cache是外层函数</span></span><br><span class="line">    store = {} <span class="comment"># 外部变量</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @wraps(func)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_</span>(<span class="params">n</span>):</span>     <span class="comment"># 闭包函数</span></span><br><span class="line">        <span class="keyword">if</span> n <span class="keyword">in</span> store:</span><br><span class="line">            <span class="keyword">return</span> store[n]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res = func(n)</span><br><span class="line">            store[n] = res</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">return</span> _</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用装饰器的方式记录前面的结果</span></span><br><span class="line"><span class="meta">@cache</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span>(<span class="params">n</span>):</span>       <span class="comment"># 斐波那契数列</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> fib(n - <span class="number">1</span>) + fib(n - <span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>


<h4 id="C-中的闭包"><a href="#C-中的闭包" class="headerlink" title="C++中的闭包"></a>C++中的闭包</h4><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">adder</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">auto</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> [=] (<span class="keyword">int</span> value) <span class="keyword">mutable</span> {</span><br><span class="line">        sum += value;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    };</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>过去：stl 或者 boost 带有类似库<br>C++11及以后：支持闭包</p>
<h4 id="Java-中的闭包"><a href="#Java-中的闭包" class="headerlink" title="Java 中的闭包"></a>Java 中的闭包</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Function&lt;Integer, Integer&gt; <span class="title">adder</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">final</span> Holder&lt;Integer&gt; sum = <span class="keyword">new</span> Holder&lt;&gt;(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> (Integer value) -&gt; {</span><br><span class="line">        sum.value += value;</span><br><span class="line">        <span class="keyword">return</span> sum.value;</span><br><span class="line">    };</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>1.8以后：使用 Function 接口和 Lambda表达式来创建函数对象<br>匿名类或 Lambda 表达式均支持闭包</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/dui-lie-he-zhan/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/dui-lie-he-zhan/" class="post-title-link" itemprop="url">队列和栈</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-24 16:38:13" itemprop="dateModified" datetime="2021-04-24T16:38:13Z">2021-04-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h4 id="队列-是有序数据集合"><a href="#队列-是有序数据集合" class="headerlink" title="队列 是有序数据集合"></a>队列 是有序数据集合</h4><p>**队列和栈一样，队列是一种操作受限制的线性表。<br>进行删除操作的端称为队头，称为前端(front)，<br>进行插入操作的端称为队尾，称为后端(rear)。</p>
<p>数据项总是开始排在队伍的后端，慢慢向前走，直到排到最前面，轮到它的时候离开队列。<br>刚进来的数据排在后端，待在队伍里时间最长的在前端，<br>这种排列规则叫做FIFO(first-in first-out)，“先进先出”</p>
<p>在实际编码中不会自己来实现一个队列，<br>而是使用标准库中的queue，通过<code>from queue import Queue</code>来导入<code>Queue</code>类。线程<code>Queue</code>，</p>
<p>**</p>
<p>对列的添加       insert              append </p>
<p>队列的取值      列表[-1]            列表[0]</p>
<p>队列的删除       pop()                    pop(0)</p>
<p>push(1);push(2);pop(3);push(4); # 尾部插入<br>1234<br>pop(1),pop(2), 头部删除<br>34</p>
<p>一个Node对象如下示意图：<br>![]C:\python代码\牛客网剑指offer66题思路分析\图解说明\node对象.jpg</p>
<figure class="highlight plain"><figcaption><span>创建一个空队列，无参数，返回值是空队列</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">如果是一个空的队列，那head和tail都指向None。</span><br><span class="line">![](C:\python代码\牛客网剑指offer66题思路分析\图解说明\空队列.jpg)</span><br><span class="line"></span><br><span class="line">当队列里有一个元素时，head和tail两个指针都指向这个元素，next指向None</span><br><span class="line">示意图是这样的：</span><br><span class="line">![](C:\python代码\牛客网剑指offer66题思路分析\图解说明\队列.jpg)</span><br><span class="line"></span><br><span class="line">enqueue(item) 在队列尾部加入一个数据项，参数是数据项，无返回值</span><br><span class="line">当队列再增加一个元素时，而head指针不会发生改变，</span><br><span class="line">tail指针会移动到新增加的这个元素，</span><br><span class="line">前一个元素的next指针也会指向新元素，</span><br><span class="line">如下图：</span><br><span class="line">![](C:\python代码\牛客网剑指offer66题思路分析\图解说明\对列增加元素.jpg)</span><br><span class="line">___</span><br><span class="line"></span><br><span class="line">```isEmpty()``` 检测队列是否为空。无参数，返回布尔值。</span><br><span class="line">```size()``` 返回队列数据项的数量。无参数，返回一个整数。</span><br><span class="line"></span><br><span class="line">同栈一样，队列也可以用顺序表或者链表实现。</span><br><span class="line">我们假设队列里的元素有一个指针，最先加进元素的指针指向它下一个元素，依次类推，</span><br><span class="line">最后一个元素的指针是指向None。</span><br><span class="line">所以队列里的元素可以抽象出一个Queue类，会创建两个指针，</span><br><span class="line">一个head，指向队头的元素，</span><br><span class="line">一个tail，指向队尾的元素。</span><br><span class="line">同样像链表时的Node类一样有自己的数据和一个指向None的指针。</span><br><span class="line">```python</span><br><span class="line">class Node:</span><br><span class="line">    def __init__(self, value):</span><br><span class="line">        self.value = value</span><br><span class="line">        self.next = None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Queue:</span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.head = None</span><br><span class="line">        self.tail = None</span><br><span class="line"></span><br><span class="line">    def enqueue(self, value):</span><br><span class="line">        node = Node(value)  # 实列化节点</span><br><span class="line">        if self.head is None:</span><br><span class="line">            self.head = node</span><br><span class="line">            self.tail = node</span><br><span class="line">        else:</span><br><span class="line">            self.tail.next = node</span><br><span class="line">            self.tail = node</span><br><span class="line"></span><br><span class="line">    def dequeue(self):</span><br><span class="line">        if self.head is None:</span><br><span class="line">            raise Exception('This is a empty queue')</span><br><span class="line">        cur = self.head</span><br><span class="line">        self.head = cur.next</span><br><span class="line">        return cur.value</span><br><span class="line"></span><br><span class="line">    def is_empty(self):</span><br><span class="line">        return self.head is None</span><br><span class="line"></span><br><span class="line">    def size(self):</span><br><span class="line">        cur = self.head</span><br><span class="line">        count = 0</span><br><span class="line">        if cur is None:</span><br><span class="line">            return count</span><br><span class="line">        while cur.next is not None:</span><br><span class="line">            count += 1</span><br><span class="line">            cur = cur.next</span><br><span class="line">        return count + 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == '__main__':</span><br><span class="line">    q = Queue()  # 实列化队列</span><br><span class="line">    for i in range(5):</span><br><span class="line">        q.enqueue(i)</span><br><span class="line">    for _ in range(5):</span><br><span class="line">        print(q.dequeue())</span><br><span class="line">    print(q.is_empty())</span><br><span class="line">    print(q.dequeue())</span><br><span class="line">        # 0</span><br><span class="line">        # 1</span><br><span class="line">        # 2</span><br><span class="line">        # 3</span><br><span class="line">        # 4</span><br><span class="line">    print(q.is_empty())  # True</span><br><span class="line">    print(q.size())  # 0</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Queue</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="string">""" 使用列表[]实现队列 """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.items = []  <span class="comment"># 初始化一个[]对象</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_empty</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.items == []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">enqueue</span>(<span class="params">self, item</span>):</span></span><br><span class="line">        <span class="string">"""队列一端添加元素"""</span></span><br><span class="line">        self.items.insert(<span class="number">0</span>, item)</span><br><span class="line">        <span class="comment"># self.items.append(item)</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dequeue</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""队列另一端删除一个元素"""</span></span><br><span class="line">        <span class="keyword">return</span> self.items.pop()</span><br><span class="line">        <span class="comment"># return self.items.pop(0)</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">size</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""返回队列大小"""</span></span><br><span class="line">        <span class="keyword">return</span> len(self.items)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    q = Queue()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        q.enqueue(i)</span><br><span class="line">    print(q.size())  <span class="comment"># 5</span></span><br><span class="line">    print(q.is_empty())  <span class="comment"># False</span></span><br><span class="line">    print(q.dequeue())  <span class="comment"># 0</span></span><br><span class="line">    print(q.dequeue())  <span class="comment"># 1</span></span><br><span class="line">    print(q.dequeue())  <span class="comment"># 2</span></span><br></pre></td></tr></tbody></table></figure>

<hr>
<h1 id="优先级队列"><a href="#优先级队列" class="headerlink" title="优先级队列"></a>优先级队列</h1><p>是因为虽然名字有队列，但其实是使用堆来实现的。</p>
<h1 id="实现优先级队列"><a href="#实现优先级队列" class="headerlink" title="实现优先级队列"></a>实现优先级队列</h1><p>优先级队列(Priority Queue) 顾名思义，就是入队的时候可以给一个优先级，通常是个数字或者时间戳等，<br>当出队的时候我们希望按照给定的优先级出队，我们按照 TDD(测试驱动开发) 的方式先来写测试代码：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_priority_queue</span>():</span></span><br><span class="line">    size = <span class="number">5</span></span><br><span class="line">    pq = PriorityQueue(size)</span><br><span class="line">    pq.push(<span class="number">5</span>, <span class="string">'purple'</span>)    <span class="comment"># priority, value</span></span><br><span class="line">    pq.push(<span class="number">0</span>, <span class="string">'white'</span>)</span><br><span class="line">    pq.push(<span class="number">3</span>, <span class="string">'orange'</span>)</span><br><span class="line">    pq.push(<span class="number">1</span>, <span class="string">'black'</span>)</span><br><span class="line"></span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> pq.is_empty():</span><br><span class="line">        res.append(pq.pop())</span><br><span class="line">    <span class="keyword">assert</span> res == [<span class="string">'purple'</span>, <span class="string">'orange'</span>, <span class="string">'black'</span>, <span class="string">'white'</span>]</span><br></pre></td></tr></tbody></table></figure>

<p>上边就是期望的行为，写完测试代码后我们来编写优先级队列的代码，按照出队的时候最大优先级先出的顺序：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PriorityQueue</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, maxsize</span>):</span></span><br><span class="line">        self.maxsize = maxsize</span><br><span class="line">        self._maxheap = MaxHeap(maxsize)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span>(<span class="params">self, priority, value</span>):</span></span><br><span class="line">        <span class="comment"># 注意这里把这个 tuple push 进去，python 比较 tuple 从第一个开始比较</span></span><br><span class="line">        <span class="comment"># 这样就很巧妙地实现了按照优先级排序</span></span><br><span class="line">        entry = (priority, value)    <span class="comment"># 入队的时候会根据 priority 维持堆的特性</span></span><br><span class="line">        self._maxheap.add(entry)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span>(<span class="params">self, with_priority=False</span>):</span></span><br><span class="line">        entry = self._maxheap.extract()</span><br><span class="line">        <span class="keyword">if</span> with_priority:</span><br><span class="line">            <span class="keyword">return</span> entry</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> entry[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_empty</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> len(self._maxheap) == <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>



<p>Python 中使用 collections 中的函数 deque() double-ended queue<br>底层是链表，因此头部和尾部是等价的，其插入和删除操作在表的两端进行，都是 O(1) 时间复杂度；<br>删除队列头部的数据项，不需要参数，返回值是被删除的数据，<br>队列本身有变化，直接把head指针移动到下一个元素，再把值弹出即可。<br>是一种具有队列和栈的性质的数据结构。<br>但是对于列表可以很方便向后面去追加元素，但如果想在第一个位置插入元素就需要移动后面所有的元素，因此在这里效率不如 collections.deque() 。<br>deque对于list的性能优势，<br>主要是在两端反复添加大量元素时差异才会比较明显，<br>而对于构建一个全新的集合，list反而比deque还要快一些。</p>
<p>用python的list数据类型能比较容易的实现队列数据模型，<br>列表是 java c++ 中的数组，数组移除头部元素的方式 是把后面的元素全部往前移动一位，所以复杂度是 O(N) ；</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Deque</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="string">"""双端队列"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.items = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_empty</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""判断队列是否为空"""</span></span><br><span class="line">        <span class="keyword">return</span> self.items == []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_front</span>(<span class="params">self, item</span>):</span></span><br><span class="line">        <span class="string">"""在队列头部添加元素"""</span></span><br><span class="line">        self.items.insert(<span class="number">0</span>, item)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_rear</span>(<span class="params">self, item</span>):</span></span><br><span class="line">        <span class="string">"""在队列尾部添加元素"""</span></span><br><span class="line">        self.items.append(item)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop_front</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""队列头部删除一个元素"""</span></span><br><span class="line">        <span class="keyword">return</span> self.items.pop(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop_rear</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""队列尾部删除一个元素"""</span></span><br><span class="line">        <span class="keyword">return</span> self.items.pop()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">size</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""返回队列大小"""</span></span><br><span class="line">        <span class="keyword">return</span> len(self.items)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tarvel</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> self.items:</span><br><span class="line">            print(i, end=<span class="string">" "</span>)</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    deque = Deque()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        deque.add_front(i)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>, <span class="number">5</span>):</span><br><span class="line">        deque.add_rear(i)</span><br><span class="line">    deque.tarvel()</span><br><span class="line">    print(<span class="string">'---'</span>)</span><br><span class="line">    print(deque.size())</span><br><span class="line">    print(<span class="string">'---'</span>)</span><br><span class="line">    print(deque.pop_front())</span><br><span class="line">    print(deque.pop_front())</span><br><span class="line">    print(deque.pop_rear())</span><br><span class="line">    print(deque.pop_rear())</span><br><span class="line">    deque.tarvel()</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> <span class="number">1</span> <span class="number">0</span> <span class="number">3</span> <span class="number">4</span> <span class="string">---</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用collections模块deque()函数实现队列。</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Queue</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.items = deque()  <span class="comment"># 初始化一个deque对象</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">append</span>(<span class="params">self, val</span>):</span> </span><br><span class="line">        <span class="keyword">return</span> self.items.append(val)  <span class="comment"># 向队列右边添加元素</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span>(<span class="params">self</span>):</span>  </span><br><span class="line">        <span class="keyword">return</span> self.items.popleft()    <span class="comment"># 从队列左边取元素</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">empty</span>(<span class="params">self</span>):</span>        </span><br><span class="line">        <span class="keyword">return</span> len(self.items) == <span class="number">0</span>    <span class="comment"># 判断是不是空队列</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_queue</span>():</span></span><br><span class="line">    q = Queue()</span><br><span class="line">    q.append(<span class="number">0</span>)</span><br><span class="line">    q.append(<span class="number">1</span>)</span><br><span class="line">    q.append(<span class="number">2</span>)</span><br><span class="line">    print(q.pop())</span><br><span class="line">    print(q.pop())</span><br><span class="line">    print(q.pop())</span><br><span class="line"> </span><br><span class="line">test_queue()</span><br><span class="line"><span class="comment"># 输出结果：</span></span><br><span class="line"><span class="comment">#     0</span></span><br><span class="line"><span class="comment">#     1</span></span><br><span class="line"><span class="comment">#     2</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="栈（stack）又名堆栈，它是一种运算受限的线性表。"><a href="#栈（stack）又名堆栈，它是一种运算受限的线性表。" class="headerlink" title="栈（stack）又名堆栈，它是一种运算受限的线性表。"></a>栈（stack）又名堆栈，它是一种运算受限的线性表。</h4><p>其限制是仅允许在栈的栈顶进行插入和删除运算。<br>这一端被称为栈顶，相对地，把另一端称为栈底。<br>用 append() 方法把新元素放到栈顶元素的上面，使之成为新的栈顶元素，称作是进栈，入栈或者压栈  </p>
<p>从一个栈删除元素又称作出栈或退栈，用不指定索引的 pop() 方法可以把一个元素从堆栈顶释放删除，使其相邻的元素成为新的栈顶元素。</p>
<p>栈可以用顺序表实现，也可以用链表实现。<br>列表方法使得列表可以很方便的作为一个堆栈来使用</p>
<p>最先进入的元素最后一个被释放<br>先进后出 后进先出</p>
<p>栈的本质是递归。所以可以借助栈理解递归；<br>栈顶是递归终止条件，栈的每一层是递归的方法体</p>
<p>取值列表[-1]，因为它只能从栈顶来取值，相当于取列表的最后一个值，所以用索引-1.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">stack1 = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">stack1.append(<span class="number">6</span>)</span><br><span class="line">stack1.append(<span class="number">7</span>)</span><br><span class="line">print(stack1)  <span class="comment"># [3, 4, 5, 6, 7]</span></span><br><span class="line">print(stack1.pop())  <span class="comment"># 7</span></span><br><span class="line">print(stack1)  <span class="comment"># [3, 4, 5, 6]</span></span><br><span class="line">print(stack1.pop())  <span class="comment"># 6</span></span><br><span class="line">print(stack1.pop())  <span class="comment"># 5</span></span><br><span class="line">print(stack1)  <span class="comment"># [3, 4]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用列表[]实现栈</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.stack = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_empty</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""判断是否为空"""</span></span><br><span class="line">        <span class="keyword">return</span> self.stack == []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span>(<span class="params">self, element</span>):</span></span><br><span class="line">        <span class="string">"""添加一个新的元素item到栈顶"""</span></span><br><span class="line">        self.stack.append(element)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""弹出栈顶元素"""</span></span><br><span class="line">        <span class="keyword">return</span> self.stack.pop()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">peek</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.stack[<span class="number">-1</span>] <span class="keyword">if</span> self.stack <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">size</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""返回栈的元素个数"""</span></span><br><span class="line">        <span class="keyword">return</span> len(self.stack)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">stack = Stack()</span><br><span class="line">stack.push(<span class="number">1</span>)</span><br><span class="line">stack.push(<span class="number">2</span>)</span><br><span class="line">stack.push(<span class="number">3</span>)</span><br><span class="line">print(stack.pop())  <span class="comment"># 3</span></span><br><span class="line">print(stack)  <span class="comment"># &lt;__main__.Stack object at 0x0000024BAF626D60&gt;</span></span><br><span class="line">print(stack.peek())  <span class="comment"># 2</span></span><br><span class="line">print(stack.size())  <span class="comment"># 2</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用collections模块deque()函数实现栈</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.deque = deque()</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        self.deque.append(value) </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.deque.pop()  <span class="comment"># 默认从右边取</span></span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_stack</span>():</span></span><br><span class="line">    s = Stack()</span><br><span class="line">    s.push(<span class="number">0</span>)</span><br><span class="line">    s.push(<span class="number">1</span>)</span><br><span class="line">    s.push(<span class="number">2</span>)</span><br><span class="line">    print(s.pop())</span><br><span class="line">    print(s.pop())</span><br><span class="line">    print(s.pop())</span><br><span class="line"> </span><br><span class="line">test_stack()</span><br><span class="line"><span class="comment">#       2</span></span><br><span class="line"><span class="comment">#       1</span></span><br><span class="line"><span class="comment">#       0</span></span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/29/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/29/">29</a><span class="page-number current">30</span><a class="page-number" href="/page/31/">31</a><span class="space">&hellip;</span><a class="page-number" href="/page/35/">35</a><a class="extend next" rel="next" href="/page/31/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">外心人D</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
