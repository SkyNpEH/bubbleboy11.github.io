<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"bubbleboy11.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.6.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:type" content="website">
<meta property="og:title" content="外心人D的博客">
<meta property="og:url" content="https://bubbleboy11.github.io/page/32/index.html">
<meta property="og:site_name" content="外心人D的博客">
<meta property="og:description" content="本博客大多内容为慕课和网上博客，并非原创">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="外心人D">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://bubbleboy11.github.io/page/32/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/32/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>外心人D的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="外心人D的博客" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">外心人D的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">外心人D</p>
  <div class="site-description" itemprop="description">本博客大多内容为慕课和网上博客，并非原创</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">338</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">40</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



          </div>
        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/mian-xiang-dui-xiang-bian-cheng-oop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/mian-xiang-dui-xiang-bian-cheng-oop/" class="post-title-link" itemprop="url">面向对象编程OOP</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-07-06 09:45:35" itemprop="dateModified" datetime="2021-07-06T09:45:35Z">2021-07-06</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>面向对象编程 Object Oriented Programming OOP<br>设计思想是如何理解面向对象:<br>1.python一切皆对象，<br>面向对象是一种编程思想，是编程世界向现实世界的延伸，也就是说万物皆可描述，<br>2.我们用编程语言描述现实世界万物<br>3.把对象作为基本单元，把对象抽象成类(Class)，包含成员(属性)和方法(用来操作成员)。<br>根据Class创建Instance<br>类Class是一种抽象模板，类是现实世界或思维世界中的实体在计算机中的反映，类:是面向对象的一种表现形式<br>它将数据以及这些数据上的操作封装在一起，概念</p>
<p>对象：通过类定义的数据结构实例。对象包括两个数据成员（类变量和实例变量）和方法。值 身份id 类型 </p>
<p>Python 中使用类来实现。过程式编程(函数)，OOP(类)<br>(object)，表示该类是从哪个类继承下来的，<br>默认继承object类，可不写<br>创建类 类名首字母大写，不要下划线<br>类定义完成后，会在当前作用域中定义一个以类名为名字的命名空间。<br>类对象具有以下两种操作：<br>可以通过“类名()”的方式实例化一个对象。<br>可以通过“类名.类属性”的方式来访问一个类属性</p>
<p>定义实例方法（函数）：<br>实例方法关联的是对象，实例方法通常用来操作实例变量，<br><code>def __init__(self, name, *args,**kwargs):</code> 可以通过外部访问，是因为init前后分别有两个下划线‘__’, 这是python的内置命名风格，自己命名尽量不要这样做，创建实例的时候绑定属性到<code>self</code><br>第一个形参（实例变量）不是必须叫<code>self</code>，<code>self</code> 不是 python 关键字，（其他语言用<code>this</code>，其他和普通函数一样）<br>但是第一个参数代表的是表示创建类的实例本身（对象）</p>
<p>有了<code>__init__</code>方法，在创建实例的时候，就不能传入空的参数了，必须传入与<code>__init__</code>方法匹配的参数，<br>不需要给self传值，Python解释器自己会把实例变量传进去，</p>
<p><code>对象名=类名([实参])</code> 对象是类的实例化，形参写在类的构造函数中，<br>实例（Instance）则是根据类模板创建出来一个个具体的“对象”</p>
<p>要调用一个方法是通过需要有实例（实例变量，self），这种限制其实就是Python所谓的绑定概念</p>
<p>每个实例化的对象当使用完成之后，都会被内存管家回收，我们普通的进程也会伴随着创建与关闭的过程</p>
<p>Python类中定义的变量分为类变量和实例变量（也叫成员变量、对象变量），<br>类变量和实例变量都可以在类定义之后在定义</p>
<p>类变量直接定义在类里面（不在函数里面），前面不会有任何关键字<code>self</code>修饰。<br>类变量只会在用class关键字声明一个类时创建，且也只会保存在类的命名空间中，这个类的实例的命名空间中是没有的。<br>在类的内外部访问类变量，可以用<code>类名.类变量名</code>和<code>实例名.类变量名</code>， 访问的实际上是同一个类命名空间的同一个变量，所以类变量具有“一改全改”的特点。<br>实例方法里访问类变量<code>self.__class__.类变量名</code></p>
<p>采用<code>实例名.类变量</code>名的方式对类变量进行赋值时，<br>若该类变量是可变数据类型，则可以成功赋值该类变量，<br>否则会在该实例变量所在的名称空间中创建一个与该类变量同名的实例变量进行赋值，并不会对类变量进行赋值，<br>此时也无法再通过<code>实例名.类变量名</code>的方式读取该类变量。<br>但若‘实例名.类变量名’赋值的是可变数据类型，则可以对类变量进行赋值操作。</p>
<p>实例变量大都定义在实例函数里面，通过 <code>self.实例变量名</code> 的方式进行定义。<br>根据类创建的实例可以任意绑定属性。<br>实例变量保存在实例各自的命名空间中，各个实例拥有的数据都互相独立，互不影响；<br>不要对实例属性和类属性使用相同的名字，否则将产生难以发现的错误。<br>因为相同名称的实例属性将屏蔽掉类属性，<br>但是当你删除实例属性后，再使用相同的名称，访问到的将是类属性。</p>
<p><code>__dict__</code> 在类中代表类的全部属性的字典，在实例中代表对象的全部属性的字典 </p>
<h4 id="实例方法"><a href="#实例方法" class="headerlink" title="实例方法"></a>实例方法</h4><p>不需要装饰器修饰，<br>在声明时传入的第一个参数必须为 <code>self</code>，self指代的就是实例本身。<br>只能通过<code>实例名.实例方法名</code>调用，不可以通过<code>类名.实例方法名()</code>调用<br>如果要通过类来调用，<code>类名.实例方法名(实例名)</code>，必须必须<strong>显式</strong>地将实例当做参数传入。</p>
<p>用<code>self.变量名</code>访问 实例变量 和 类变量<br>实例方法能访问实例变量，静态方法和类方法则不能。<br>在类的外部访问添加实例变量，只能用<code>实例名.实例变量名</code>，类无权访问实例名。</p>
<p>在实例方法内部通过<code>类名.类变量名</code>和 <code>self.__class__.类变量名</code> 访问类变量。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params">object</span>):</span>  <span class="comment"># 类对象</span></span><br><span class="line">    name = <span class="string">'Ashe'</span>  <span class="comment"># 类变量 字符串不可变 直接在类里面定义</span></span><br><span class="line">    gender = <span class="string">'female'</span>  <span class="comment">#</span></span><br><span class="line">    place = [<span class="string">'China'</span>, <span class="string">'Beijing'</span>]  <span class="comment"># 类变量，列表可变</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, age</span>):</span>  <span class="comment"># 构造方法用来初始化成员(属性)，但是并没有初始化weight</span></span><br><span class="line">        self.name = name  <span class="comment"># 实例变量，在实例方法里通过self.xxx进行定义和读取与对象无关</span></span><br><span class="line">        self.age = age</span><br><span class="line">        weight = <span class="number">55</span>  <span class="comment"># 类变量不能再在数体内声明，在这个位置声明的又没有self关键字修饰，只能是一个局部变量</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_info</span>(<span class="params">self</span>):</span>  <span class="comment"># 操作成员(属性)的类的实例方法</span></span><br><span class="line">        print(self)</span><br><span class="line">        print(self.__class__)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 实例方法不可以直接访问类变量</span></span><br><span class="line">        <span class="comment"># print(gender)  # NameError: name 'gender' is not defined</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 实例方法可以这样访问类变量</span></span><br><span class="line">        <span class="comment"># 通过 p.name获取变量值的时候，首先会查找实例变量里有没有name属性，如果有则返回，</span></span><br><span class="line">        <span class="comment"># 如果没有就会去类变量里找，如果还是没有则会报错，但是不推荐</span></span><br><span class="line">        print(self.gender)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 实例方法访问类变量的正确打开方式</span></span><br><span class="line">        <span class="comment"># print(Person.name, Person.gender)</span></span><br><span class="line">        print(self.__class__.name, self.__class__.gender)</span><br><span class="line">        <span class="comment"># print(self.__class__.age)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 实例中代表对象的全部属性的字典</span></span><br><span class="line">        print(self.__dict__)</span><br><span class="line">        <span class="comment"># 实例方法可以这样访问实例变量</span></span><br><span class="line">        print(self.name, self.age)</span><br><span class="line">        <span class="comment"># print(self.weight)  # AttributeError: 'Person' object has no attribute 'weight'</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># print(self.__class__.__dict__)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># self.age = age  # 这是错误的，实例变量不能再这里声明</span></span><br><span class="line">    occupation = [<span class="string">'student'</span>]  <span class="comment"># 这是类变量，可以在函数体外，类内部任意位置</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(Person)  <span class="comment">#：&lt;class '__main__.Person'&gt;</span></span><br><span class="line">print(dir(Person))</span><br><span class="line"><span class="comment"># ['__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', 'gender', 'name', 'occupation', 'place', 'print_info']</span></span><br><span class="line"></span><br><span class="line">print(Person.name)  <span class="comment"># Ashe</span></span><br><span class="line">print(Person.gender)  <span class="comment"># female</span></span><br><span class="line"><span class="comment"># print(Person.age)  # AttributeError: 'Person' object has no attribute 'age'</span></span><br><span class="line"><span class="comment"># Person.print_info()</span></span><br><span class="line"><span class="comment"># TypeError: print_info() missing 1 required positional argument:</span></span><br><span class="line"><span class="comment">#  print_info是实例方法 类不可以直接调用实例方法</span></span><br><span class="line"></span><br><span class="line">p = Person(<span class="string">'Bart Simpson'</span>, <span class="number">18</span>)  <span class="comment"># 实例对象</span></span><br><span class="line">print(p)  <span class="comment"># &lt;__main__.Person object at 0x0000028104DC0AC0&gt;</span></span><br><span class="line">print(dir(p))</span><br><span class="line"><span class="comment"># ['__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', 'age', 'gender', 'name', 'occupation', 'place', 'print_info']</span></span><br><span class="line">p.print_info()  <span class="comment"># python封装特性</span></span><br><span class="line"><span class="comment"># &lt;__main__.Person object at 0x0000028104DC0AC0&gt;</span></span><br><span class="line"><span class="comment"># &lt;class '__main__.Person'&gt;</span></span><br><span class="line"><span class="comment"># female</span></span><br><span class="line"><span class="comment"># Ashe female</span></span><br><span class="line"><span class="comment"># {'name': 'Bart Simpson', 'age': 18} 没有weight属性</span></span><br><span class="line"><span class="comment"># Bart Simpson 18</span></span><br><span class="line"></span><br><span class="line">Person.print_info(p)  <span class="comment"># 通过类访问实例方法时，必须显式地将实例当做参数传入</span></span><br><span class="line"><span class="comment"># &lt;__main__.Person object at 0x0000028104DC0AC0&gt;</span></span><br><span class="line"><span class="comment"># &lt;class '__main__.Person'&gt;</span></span><br><span class="line"><span class="comment"># female</span></span><br><span class="line"><span class="comment"># Ashe female</span></span><br><span class="line"><span class="comment"># {'name': 'Bart Simpson', 'age': 18}</span></span><br><span class="line"><span class="comment"># Bart Simpson 18</span></span><br><span class="line"></span><br><span class="line">print(p.__dict__)  <span class="comment"># {'name': 'Bart Simpson', 'age': 18} 没有weight属性</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当通过 p.name获取变量值的时候，首先会查找实例变量里有没有name属性，如果有则返回，如果没有就会去类变量里找，如果还是没有则会报错</span></span><br><span class="line">print(p.name, p.age)  <span class="comment"># Bart Simpson 18 是实例变量</span></span><br><span class="line">print(p.gender, id(p.gender) == id(Person.gender))  <span class="comment"># female True 类变量</span></span><br><span class="line"><span class="comment"># print(p.weight)  # AttributeError: 'Person' object has no attribute 'weight'</span></span><br><span class="line"></span><br><span class="line">p.occupation.append(<span class="string">'programmer'</span>)</span><br><span class="line">print(p.occupation)  <span class="comment"># ['student', 'programmer']</span></span><br><span class="line">print(Person.occupation)  <span class="comment"># ['student', 'programmer']</span></span><br><span class="line"></span><br><span class="line">print(Person.name</span><br><span class="line">      )  <span class="comment"># Ashe 类变量为不可变对象，在该实例变量所在的名称空间中创建一个与该类变量同名的实例变量进行赋值，并不会对类变量进行赋值，</span></span><br><span class="line"><span class="comment"># print(Person.age)  # AttributeError: type object 'Person' has no attribute 'age'</span></span><br><span class="line"></span><br><span class="line">p.place[<span class="number">1</span>] = <span class="string">'Guilin'</span></span><br><span class="line">print(p.place)  <span class="comment"># ['China', 'Guilin']</span></span><br><span class="line">print(Person.place)  <span class="comment"># ['China', 'Guilin']</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在类定义和声明实例对象结束之后再定义绑定一个实例变量</span></span><br><span class="line">p.height = <span class="number">1.8</span>  <span class="comment"># 为 p 添加一个实例变量 height 属性</span></span><br><span class="line">print(p.height)  <span class="comment"># 1.8 与对象无关</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 声明类对象结束之后 为Person类添加绑定一个类变量</span></span><br><span class="line">Person.behavior = <span class="string">'study'</span>  <span class="comment"># 这是一个类变量</span></span><br><span class="line">print(Person.behavior)  <span class="comment"># study</span></span><br><span class="line">print(p.behavior)  <span class="comment"># study</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="访问可见性问题"><a href="#访问可见性问题" class="headerlink" title="访问可见性问题"></a>访问可见性问题</h3><p>对于上面的代码，有C++、Java、C#等编程经验的程序员可能会问，我们给<code>Student</code>对象绑定的<code>name</code>和<code>age</code>属性到底具有怎样的访问权限（也称为可见性）。<br>因为在很多面向对象编程语言中，我们通常会将对象的属性设置为私有的（private）或受保护的（protected），简单的说就是不允许外界访问，<br>而对象的方法通常都是公开的（public），因为公开的方法就是对象能够接受的消息。</p>
<p>在Python中，属性和方法的访问权限只有两种，也就是公开的和私有的，<br>如果希望属性是私有的，在给属性命名时可以用两个下划线作为开头，<br>下面的代码可以验证这一点。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Course</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, price, url, pk</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.price = price</span><br><span class="line">        self._url = url  <span class="comment">#大家都认可的一种编码规范，这种权限级别的控制 java是可以做到</span></span><br><span class="line">        self.__pk = pk  <span class="comment">#大家都认可的一种编码规范，这种权限级别的控制 java是可以做到</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">course1 = Course(<span class="string">"django"</span>, <span class="number">100</span>, <span class="string">"https://imooc.com"</span>, <span class="number">1</span>)</span><br><span class="line">print(course1._url) <span class="comment"># https://imooc.com</span></span><br><span class="line">print(course1.__pk) <span class="comment"># AttributeError: 'Course' object has no attribute '__pk'</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, foo</span>):</span></span><br><span class="line">        self.__foo = foo</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__bar</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(self.__foo)</span><br><span class="line">        print(<span class="string">'__bar'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    test = Test(<span class="string">'hello'</span>)</span><br><span class="line">    <span class="comment"># AttributeError: 'Test' object has no attribute '__bar'</span></span><br><span class="line">    test.__bar()</span><br><span class="line">    <span class="comment"># AttributeError: 'Test' object has no attribute '__foo'</span></span><br><span class="line">    print(test.__foo)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure>

<p>但是，Python并没有从语法上严格保证私有属性或方法的私密性，它只是给私有的属性和方法换了一个名字来妨碍对它们的访问，事实上如果你知道更换名字的规则仍然可以访问到它们，下面的代码就可以验证这一点。<br>之所以这样设定，可以用这样一句名言加以解释，就是"<strong>We are all consenting adults here</strong>"。<br>因为绝大多数程序员都认为开放比封闭要好，而且程序员要自己为自己的行为负责。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, foo</span>):</span></span><br><span class="line">        self.__foo = foo</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__bar</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(self.__foo)</span><br><span class="line">        print(<span class="string">'__bar'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    test = Test(<span class="string">'hello'</span>)</span><br><span class="line">    test._Test__bar()</span><br><span class="line">    print(test._Test__foo)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure>

<p>在实际开发中，我们并不建议将属性设置为私有的，因为这会导致子类无法访问（后面会讲到）。<br>所以大多数Python程序员会遵循一种命名惯例就是让属性名以单下划线开头来表示属性是受保护的，本类之外的代码在访问这样的属性时应该要保持慎重。<br>这种做法并不是语法上的规则，单下划线开头的属性和方法外界仍然是可以访问的，所以更多的时候它是一种暗示或隐喻，<br>大家都认可的一种编码规范，这种权限级别的控制 java是可以做到<br>关于这一点可以看看我的<a target="_blank" rel="noopener" href="http://blog.csdn.net/jackfrued/article/details/79521404">《Python - 那些年我们踩过的那些坑》</a>文章中的讲解</p>
<p>变量名前加单下划线<code>_</code>表示的是 protected 类型的变量，即保护类型只能允许其本身与子类进行访问，如：<code>self._sex = 0</code> ，实例不要访问，大家都认可的一种编码规范，这种权限级别的控制 java是可以做到</p>
<p>变量名前加双下划线<code>__</code>表示的是 私有类型(private)的变量,<br>成员私有 类的私有属性<br>在变量或方法名前加__，则变为私有private私有属性，在类外部无法直接进行访问、设置<br>只能是允许这个类本身内部的方法进行访问了。如：<code>self.__private_attrs</code>。<br>在创建私有的实例时，实际python会把变量名改为<code>_类名__变量名</code>，实际是创建了新变量<code>_类名__变量名</code>。<br>严格来讲python并没有真正的私有变量，<br>可以通过 <code>对象名._类名__变量名</code> 在外部修改和访问私有变量<code>__变量名</code> </p>
<p>类的私有方法<br>__private_method：两个下划线开头，声明该方法为私有方法，只能在类的内部调用，不能在类的外部调用。在外部不可以通过<code>类名.__方法名</code>  self.__private_methods。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>:</span></span><br><span class="line">    __name = <span class="string">"张三"</span>  <span class="comment"># 私有变量 单侧双下滑线加名字</span></span><br><span class="line">    school = <span class="string">"北大"</span></span><br><span class="line"></span><br><span class="line">print(dir(Student))  <span class="comment"># student对象的方法和属性</span></span><br><span class="line">[<span class="string">'_Student__name'</span>, <span class="string">'__class__'</span>, <span class="string">'__delattr__'</span>, <span class="string">'__dict__'</span>, <span class="string">'__dir__'</span>, <span class="string">'__doc__'</span>, <span class="string">'__eq__'</span>, <span class="string">'__format__'</span>, <span class="string">'__ge__'</span>, <span class="string">'__getattribute__'</span>, <span class="string">'__gt__'</span>, <span class="string">'__hash__'</span>, <span class="string">'__init__'</span>, <span class="string">'__init_subclass__'</span>, <span class="string">'__le__'</span>, </span><br><span class="line"><span class="string">'__lt__'</span>, <span class="string">'__module__'</span>, <span class="string">'__ne__'</span>, <span class="string">'__new__'</span>, <span class="string">'__reduce__'</span>, <span class="string">'__reduce_ex__'</span>, <span class="string">'__repr__'</span>, <span class="string">'__setattr__'</span>, <span class="string">'__sizeof__'</span>, <span class="string">'__str__'</span>, <span class="string">'__subclasshook__'</span>, <span class="string">'__weakref__'</span>, <span class="string">'school'</span>]</span><br></pre></td></tr></tbody></table></figure>
<p>没有<code>__name</code>这个属性<br>第一个内置方法<code>Student__name</code><br>有最后一个属性<code>school</code></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>:</span></span><br><span class="line">    __name = <span class="string">"张三"</span>  <span class="comment"># 把私有变量名改为`_类名__变量名</span></span><br><span class="line">    school = <span class="string">"北大"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(Student.school)  <span class="comment"># 北大</span></span><br><span class="line"><span class="comment"># print(Student.__name)  # AttributeError: type object 'Student' has no attribute '__name</span></span><br><span class="line">print(Student._Student__name)  <span class="comment"># 张三</span></span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>:</span></span><br><span class="line">    name = <span class="string">"四毛"</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__kaoshi</span>(<span class="params">self</span>):</span>  <span class="comment"># 私有方法</span></span><br><span class="line">        print(<span class="string">"学生考试"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(dir(Student))</span><br><span class="line"><span class="comment"># ['_Student__kaoshi', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', 'name'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Student._Student__kaoshi()  # TypeError: __kaoshi() missing 1 required positional argument: 'self'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = Student()</span><br><span class="line">print(dir(s))</span><br><span class="line"><span class="comment"># ['_Student__kaoshi', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', 'name']</span></span><br><span class="line">s._Student__kaoshi()  <span class="comment"># 通过dir(s)找到，类似于私有变量</span></span><br><span class="line"><span class="comment"># 学生考试</span></span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, score</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__score = score</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__check_score</span>(<span class="params">self, score</span>):</span></span><br><span class="line">        <span class="keyword">if</span> score &gt; <span class="number">100</span> <span class="keyword">or</span> score &lt; <span class="number">0</span>:</span><br><span class="line">            print(<span class="string">"分数必须在0-100之间"</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">marking</span>(<span class="params">self, score</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.__check_score(score):</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.__score = score</span><br><span class="line">        print(self.__name + <span class="string">"的当前分数："</span> + str(self.__score))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prt</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(self)</span><br><span class="line">        print(self.__class__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">stu = Student(<span class="string">'gwf'</span>,<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这样操作虽然是可以的，但是这不是我们在方法中定义的私有变量__score,而是基于python动态语言的特性，又创建了一个__score的变量</span></span><br><span class="line">stu.__score = <span class="number">-1</span></span><br><span class="line">print(stu.__score)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 真正我们创建的私有变量，在python中是以_Student__score(_类名__私有变量名)进行保存的</span></span><br><span class="line">print(stu.__dict__)</span><br><span class="line"><span class="comment"># 上面代码打印的结果为{'name': 'gwf', '_Student__score': 10, '__score': -1}</span></span><br><span class="line"><span class="comment"># 可以通过stu._Student__score 访问到真正的私有变量，但是不推荐这样做</span></span><br><span class="line">print(stu._Student__score) <span class="comment"># 输出 10 </span></span><br><span class="line"></span><br><span class="line">t = Student(<span class="number">10</span>)</span><br><span class="line">t.print_name()</span><br><span class="line"><span class="comment"># t.prt()</span></span><br><span class="line"><span class="comment"># print(t)</span></span><br><span class="line"><span class="comment"># print('---')</span></span><br><span class="line"><span class="comment"># print(t.__class__)</span></span><br><span class="line"><span class="comment"># &lt;__main__.Student object at 0x0000017325E28080&gt;</span></span><br><span class="line"><span class="comment"># &lt;class '__main__.Student'&gt;</span></span><br><span class="line"><span class="comment"># &lt;__main__.Student object at 0x0000017325E28080&gt;</span></span><br><span class="line"><span class="comment"># &lt;class '__main__.Student'&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>classmethod</code> / <code>staticmethod</code>  (它们两个经常被用作类方法的装饰器)</p>
<ul>
<li>都可以通过 <code>ClassName.method()</code> 的方式调用</li>
<li>都不能访问实例方法</li>
</ul>
<h4 id="类方法：定义加-classmethod装饰器来修饰"><a href="#类方法：定义加-classmethod装饰器来修饰" class="headerlink" title="类方法：定义加@classmethod装饰器来修饰"></a>类方法：定义加<code>@classmethod</code>装饰器来修饰</h4><p>该方法与类绑定，而不是与实例对象绑定，<br>第一个形参是 <code>cls</code> 代表的是调用的类本身，类方法不会被自动调用，<br>通过<code>类名.方法名()</code>和<code>实例名.方法名()</code>两种方法进行调用 （但是不建议用对象调用类方法，毕竟逻辑不符），<br>在类方法中用<code>类名.类变量名</code>和<code>cls.类变量名</code>访问和操作类变量，也就能操作类的实例化对象，比如单例模式<br>在类方法中不可以访问实例变量。<br>self.class 则指向类。<br>通过self.class.xxx访问类变量</p>
<p>跟类有关系，又需要类/实例参与的情况下用类方法。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>:</span></span><br><span class="line">    name = <span class="string">"四毛"</span></span><br><span class="line">    sum_student = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod  # 类方法，类可以直接调用，可以操作类变量</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">study</span>(<span class="params">cls</span>):</span></span><br><span class="line">        print(<span class="string">'当前类名为：{}'</span>.format(cls.__name__))</span><br><span class="line">        print(cls.name + <span class="string">"student study"</span>)</span><br><span class="line">        cls.name = <span class="string">"五毛"</span></span><br><span class="line">        print(cls.name + <span class="string">"student study"</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_and_print_sum</span>(<span class="params">cls</span>):</span></span><br><span class="line">        cls.sum_student += <span class="number">1</span></span><br><span class="line">        print(cls.sum_student, id(cls.sum_student))</span><br><span class="line">        print(Student.sum_student, id(Student.sum_student))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(dir(Student))</span><br><span class="line"><span class="comment"># ['__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', 'add_and_print_sum', 'name', 'study', 'sum_student']</span></span><br><span class="line"></span><br><span class="line">Student.study()</span><br><span class="line"><span class="comment"># 当前类名为：Student</span></span><br><span class="line"><span class="comment"># 四毛student study</span></span><br><span class="line"><span class="comment"># 五毛student study</span></span><br><span class="line">Student.add_and_print_sum()</span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line">s = Student()</span><br><span class="line">print(dir(s))</span><br><span class="line"><span class="comment"># ['__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', 'add_and_print_sum', 'name', 'study', 'sum_student']</span></span><br><span class="line"></span><br><span class="line">s.study()</span><br><span class="line"><span class="comment"># 当前类名为：Student</span></span><br><span class="line"><span class="comment"># 五毛student study</span></span><br><span class="line"><span class="comment"># 五毛student study</span></span><br><span class="line"></span><br><span class="line">s.add_and_print_sum()</span><br><span class="line"><span class="comment"># 2 140718899369664</span></span><br><span class="line"><span class="comment"># 2 140718899369664</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="静态方法"><a href="#静态方法" class="headerlink" title="静态方法"></a>静态方法</h4><p>在定义时，使用<code>@staticmethod</code>装饰器来修饰</p>
<p>不用传第一个参数 <code>cls</code>或<code>self</code>关键字即可进行创建的方法。<br>在调用过程时，无需将类实例化，通过<code>类名.方法名()</code>和<code>实例名.方法名()</code>的方式调用。<br>在静态方法内部，只能通过<code>类名.类变量名</code>的方式访问类变量。</p>
<p>静态方法一般使用场景就是和类相关的操作，<br>但是不能操作类变量和类的实例变量，其实跟类并没有什么关系，完全独立的 脱离了类，相当于给了它一个作用范围，让它可以在类里面去使用，<br>完全可以放到类之外，并没有引用当前类的任何东西，本来该放到外面的函数只是给塞到类里。<br>使用起来和普通函数一样，只不过放在类里去组织</p>
<p>经常有一些跟类有关系的功能，但在运行时又不需要实例和类参与的情况下需要用到静态方法<br>哪怕只想放在这个相关类的中，没有其他关系，也就是说可以直接另写一个函数解决, 但这样同样会扩散代码，造成维护困难。<br>多用于写工具</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>:</span></span><br><span class="line">    name = <span class="string">"四毛"</span></span><br><span class="line">    sum_student = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod  # 静态方法 脱离了类而存在的，</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>():</span></span><br><span class="line">        print(Student.name, <span class="string">"run"</span>)</span><br><span class="line">        <span class="comment"># print(cls.name, "run")  # NameError: name 'cls' is not defined</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod  # 静态方法 脱离了类而存在的，</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">jump</span>(<span class="params">cls</span>):</span></span><br><span class="line">        cls.name = <span class="string">"六毛"</span></span><br><span class="line">        print(<span class="string">"student jump "</span>)</span><br><span class="line">        print(cls.name)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod  # 静态方法 脱离了类而存在的，</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sit</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.name = <span class="string">"六毛"</span></span><br><span class="line">        print(<span class="string">"student sit "</span>)</span><br><span class="line">        print(self.name)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">x, y</span>):</span></span><br><span class="line">        <span class="comment"># 访问类变量(所有地方都可以这样访问类变量)</span></span><br><span class="line">        print(Student.sum_student + x + y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(dir(Student))</span><br><span class="line"><span class="comment"># ['__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', 'add', 'jump', 'name', 'run', 'sit', 'sum_student']</span></span><br><span class="line">Student.run()  <span class="comment"># 四毛 run</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Student.jump("hahaha")  # AttributeError: 'str' object has no attribute 'name'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Student.sit("hahaha")  # AttributeError: 'str' object has no attribute 'name'</span></span><br><span class="line"></span><br><span class="line">Student.add(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># 5</span></span><br><span class="line"></span><br><span class="line">s = Student()</span><br><span class="line">print(dir(s))</span><br><span class="line"><span class="comment"># ['__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', 'add', 'jump', 'name', 'run', 'sit', 'sum_student']</span></span><br><span class="line">s.run()  <span class="comment"># 四毛 run</span></span><br><span class="line"></span><br><span class="line">s.add(<span class="number">1</span>, <span class="number">5</span>)</span><br><span class="line"><span class="comment"># 6</span></span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, x, y</span>):</span></span><br><span class="line">        self.x = x</span><br><span class="line">        self.y = y</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># 下面两句等价</span></span><br><span class="line">        <span class="comment"># return '点的位置:({0}, {1})'.format(self.x, self.y)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'点的位置:({self.x}, {self.y})'</span>.format(self=self)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    p = Point(<span class="number">4</span>, <span class="number">2</span>)</span><br><span class="line">    print(dir(p))  <span class="comment"># 点的位置:(4, 2)</span></span><br><span class="line">    <span class="comment"># ['__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', 'x', 'y']</span></span><br><span class="line">    print(p.__dict__)  <span class="comment"># {'x': 4, 'y': 2}</span></span><br><span class="line">    print(p)  <span class="comment"># 点的位置:(4, 2)</span></span><br><span class="line">    print(str(Point(<span class="number">4</span>, <span class="number">2</span>)))  <span class="comment"># 点的位置:(4, 2)</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDate</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="string">"""自己实现的日期类"""</span></span><br><span class="line">    source = <span class="string">'ioomc'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, month, day</span>):</span></span><br><span class="line">        <span class="string">"""构造方法"""</span></span><br><span class="line">        self.month = month</span><br><span class="line">        self.day = day</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">validate_month</span>(<span class="params">month</span>):</span></span><br><span class="line">        <span class="string">"""静态方法，自定义验证我们的月份是否合法"""</span></span><br><span class="line">        month = int(month)</span><br><span class="line">        print(<span class="string">'类的属性: {}'</span>.format(MyDate.source))</span><br><span class="line">        <span class="comment"># return month &gt;= 1 and month &lt;= 12</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> &lt;= month &lt;= <span class="number">12</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    my_date = MyDate(<span class="number">5</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 静态方法的调用</span></span><br><span class="line">    print(MyDate.validate_month(<span class="string">'15'</span>))</span><br><span class="line">    <span class="comment"># 类的属性: ioomc</span></span><br><span class="line">    <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line">    print(my_date.validate_month(<span class="string">'11'</span>))</span><br><span class="line">    <span class="comment"># 类的属性: ioomc</span></span><br><span class="line">    <span class="comment"># True</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>(<span class="params">object</span>):</span>  </span><br><span class="line">    num = <span class="number">1</span>  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">printd</span>(<span class="params">self</span>):</span>  </span><br><span class="line">        print(<span class="string">'printd'</span>)  </span><br><span class="line"> </span><br><span class="line"><span class="meta">    @staticmethod  </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">static_printd</span>():</span>                   <span class="comment"># 没有传入表示自身类的cls参数</span></span><br><span class="line">        print(<span class="string">'static_printd'</span>)  </span><br><span class="line">        print(A.num)  </span><br><span class="line"> </span><br><span class="line"><span class="meta">    @classmethod  </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">class_printd</span>(<span class="params">cls</span>):</span>              <span class="comment"># 传入表示自身类的cls参数</span></span><br><span class="line">        print(<span class="string">'class_printd'</span>)  </span><br><span class="line">        print(cls.num)  </span><br><span class="line">        cls().printd()  </span><br><span class="line">  </span><br><span class="line">shiliA = A()</span><br><span class="line">A.class_printd() </span><br><span class="line">shiliA.class_printd() </span><br><span class="line"></span><br><span class="line">A.static_printd()  </span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/python-chang-yong-nei-zhi-suan-fa-he-shu-ju-jie-gou/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/python-chang-yong-nei-zhi-suan-fa-he-shu-ju-jie-gou/" class="post-title-link" itemprop="url">Python常用内置算法和数据结构</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-07-02 11:41:00" itemprop="dateModified" datetime="2021-07-02T11:41:00Z">2021-07-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>按ctrl 左键可以查看数据结构的源码实现</p>
<h1 id="Python常用内置算法和数据结构"><a href="#Python常用内置算法和数据结构" class="headerlink" title="Python常用内置算法和数据结构"></a>Python常用内置算法和数据结构</h1><table>
<thead>
<tr>
<th>数据结构/算法</th>
<th>语言内置</th>
<th>内置库</th>
</tr>
</thead>
<tbody><tr>
<td>线性结构</td>
<td>list(列表)/tuple(元祖)</td>
<td>array(数组，不常用)/collections.namedtuple</td>
</tr>
<tr>
<td>链式结构</td>
<td></td>
<td>collections.deque(双端队列)</td>
</tr>
<tr>
<td>字典结构</td>
<td>dict(字典)</td>
<td>collections.Counter(计数器)/OrderedDict(有序字典)/defaultdict</td>
</tr>
<tr>
<td>集合结构</td>
<td>set(集合)/frozenset(不可变集合)</td>
<td></td>
</tr>
<tr>
<td>排序算法</td>
<td>sorted</td>
<td></td>
</tr>
<tr>
<td>二分算法</td>
<td></td>
<td>bisect模块</td>
</tr>
<tr>
<td>堆算法</td>
<td></td>
<td>heapq模块</td>
</tr>
<tr>
<td>缓存算法</td>
<td></td>
<td>functools.lru_cache(Least Recent Used, python3)</td>
</tr>
</tbody></table>
<p>有序数据类型：字符串，列表，元组，集合，字典<br>一般情况下，有序数据类型，可以索引，切片，连接，重复<br>但字典除外，因为d[key]=value</p>
<h3 id="frozenset固定集合"><a href="#frozenset固定集合" class="headerlink" title="frozenset固定集合"></a>frozenset固定集合</h3><p>是不可变、无序的，含有唯一元素的不可迭代的集合，<br>作用：固定集合可以作为字典的键，还可以作为字典的值</p>
<p><code>class frozenset([iterable])</code> 固定集合的构造函数<br>iterable – 可迭代的对象，比如列表、字典、元组等等。<br>用可迭代对象创建一个固定的、不能再添加或删除任何元素的集合，返回新的 frozenset 对象，<br>如果不提供任何参数，默认会生成空的固定集合</p>
<p>为什么需要冻结的集合（即不可变的集合）呢？因为在集合的关系中，有集合的中的元素是另一个集合的情况，但是普通集合（set）本身是可变的，那么它的实例就不能放在另一个集合中（set中的元素必须是不可变类型）。</p>
<p>所以，frozenset提供了不可变的集合的功能，当集合不可变时，它就满足了作为集合中的元素的要求，就可以放在另一个集合中了。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;a = frozenset(range(<span class="number">10</span>))     <span class="comment"># 生成一个新的不可变集合</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line">frozenset([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = frozenset(<span class="string">'runoob'</span>) </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b</span><br><span class="line">frozenset([<span class="string">'b'</span>, <span class="string">'r'</span>, <span class="string">'u'</span>, <span class="string">'o'</span>, <span class="string">'n'</span>])   <span class="comment"># 创建不可变集合</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="collections是Python内建的一个集合模块，提供的一些内置数据结构拓展"><a href="#collections是Python内建的一个集合模块，提供的一些内置数据结构拓展" class="headerlink" title="collections是Python内建的一个集合模块，提供的一些内置数据结构拓展"></a><code>collections</code>是Python内建的一个集合模块，提供的一些内置数据结构拓展</h3><p>力扣提交时环境中已经有<code>import collections</code></p>
<h3 id="namedtuple"><a href="#namedtuple" class="headerlink" title="namedtuple()"></a>namedtuple()</h3><p>factory function for creating tuple subclasses with named fields<br>创建命名元组子类的工厂函数  具名元组<br>接受类型的名称和属性列表创建一个自定义的 tuple 对象，并且规定了tuple元素的个数，<br>并可以用属性而不是索引来引用tuple的某个元素。<br>作用场景：通过下标不太可读通过属性名称变得比较可读。<br>它具备tuple的不变性</p>
<p>tuple可以表示一个元组，是不可变的集合,例如一个点的二维坐标就可以这样表示成p=(1,2)<br>但是，(1,2)很难看出这个tuple是用来表示一个坐标的</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line">Point = collections.namedtuple(<span class="string">'Point'</span>, <span class="string">'x,y'</span>)  <span class="comment"># 定义一个tuple对象</span></span><br><span class="line">p = Point(<span class="number">1</span>, <span class="number">2</span>)  <span class="comment"># 给x赋值1，y赋值2</span></span><br><span class="line">print(p.x)  <span class="comment"># 1</span></span><br><span class="line">print(p.y)  <span class="comment"># 2</span></span><br><span class="line">print(p[<span class="number">0</span>])  <span class="comment"># 1</span></span><br><span class="line">print(p[<span class="number">1</span>])  <span class="comment"># 2</span></span><br><span class="line">print(p.x == p[<span class="number">0</span>])  <span class="comment"># True</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>deque /dek/<br>list-like container with fast appends and pops on either end<br>类似列表(list)的容器，实现了在两端快速添加(append)和弹出(pop)<br>是为了高效实现插入和删除操作的双向列表，<br>deque可以方便实现 queue (队列 ) / stack (栈)。</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line">de = collections.deque()  <span class="comment"># 定义deque对象</span></span><br><span class="line">print(de)  <span class="comment"># deque([])</span></span><br><span class="line">de.append(<span class="number">1</span>)  <span class="comment"># 右边添加1元素</span></span><br><span class="line">de.appendleft(<span class="number">0</span>)  <span class="comment"># 左边添加0元素</span></span><br><span class="line">print(de)  <span class="comment"># deque([0, 1])</span></span><br><span class="line">de.pop()  <span class="comment"># 1 输出右边元素</span></span><br><span class="line">de.popleft()  <span class="comment"># 0 输出左边元素</span></span><br><span class="line">print(de)  <span class="comment"># deque([])</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>Counter<br>dict subclass for counting hashable objects<br>字典的子类，提供了可哈希对象的计数功能，值是一个字典</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> collections</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c = collections.Counter()   <span class="comment"># 定义Counter对象</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c = collections.Counter(<span class="string">'abcab'</span>) <span class="comment"># 统计字符数目</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c</span><br><span class="line">Counter({<span class="string">'a'</span>: <span class="number">2</span>, <span class="string">'b'</span>: <span class="number">2</span>, <span class="string">'c'</span>: <span class="number">1</span>})   <span class="comment"># 值是一个字典，a是有2个，b是有2个，c是有1个</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c[<span class="string">'a'</span>]  <span class="comment"># 统计字符串每个字符个数</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c.most_common() <span class="comment"># 获取从大到小每个字符数量</span></span><br><span class="line">[(<span class="string">'a'</span>, <span class="number">2</span>), (<span class="string">'b'</span>, <span class="number">2</span>), (<span class="string">'c'</span>, <span class="number">1</span>)]</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> ch <span class="keyword">in</span> <span class="string">'programming'</span>:</span><br><span class="line">      c[ch]=c[ch]+<span class="number">1</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c</span><br><span class="line">Counter({<span class="string">'g'</span>:<span class="number">2</span>,<span class="string">'m'</span><span class="number">2</span>,<span class="string">'r'</span>:<span class="number">2</span>,<span class="string">'a'</span>:<span class="number">1</span>,<span class="string">'i'</span>:<span class="number">1</span>,<span class="string">'o'</span>:<span class="number">1</span>,<span class="string">'n'</span>:<span class="number">1</span>,<span class="string">'p'</span>:<span class="number">1</span>})</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>OrderedDict</li>
</ul>
<p>dict subclass that remembers the order entries were added<br>字典的子类，保存了他们被添加的顺序，key 顺序是第一次插入的顺序。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> collections</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>od = collections.OrderedDict()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>od[<span class="string">'c'</span>] = <span class="string">'c'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>od[<span class="string">'a'</span>] = <span class="string">'a'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>od[<span class="string">'b'</span>] = <span class="string">'b'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(od.keys())</span><br><span class="line">[<span class="string">'c'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>]   <span class="comment"># key的顺序是第一次插入的顺序。</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>defaultdict<br>dict subclass that calls a factory function to supply missing values<br>defaultdict字典的子类，提供了一个工厂函数，为字典查询提供一个默认值</li>
</ul>
<figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> collections</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dd = collections.defaultdict(int) <span class="comment"># 第一个参数必须是可调用的，否则为None</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dd[<span class="string">'a'</span>]  <span class="comment"># 不存在的key默认为0</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dd[<span class="string">'b'</span>] += <span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dd</span><br><span class="line">defaultdict(&lt;class 'int'&gt;, {'a': 0, 'b': 1})</span><br></pre></td></tr></tbody></table></figure>

<h3 id="Python-dict-set-底层都是哈希表"><a href="#Python-dict-set-底层都是哈希表" class="headerlink" title="Python dict/set 底层都是哈希表"></a>Python dict/set 底层都是哈希表</h3><ul>
<li>哈希表的实现原理，底层其实就是一个数组，通过哈希函数把相应的元素映射到一个数组槽里面。</li>
<li>根据哈希函数快速定位一个元素，平均查找时间复杂度O(1)，查找和插入的速度极快，不会随着key的增加而变慢；二分查找</li>
<li>不断加入元素会引起哈希表重新开辟空间，拷贝之前元素到新数组，需要占用大量的内存，内存浪费多。</li>
<li>dict是用来存储键值对（key-value）结构的数据的，</li>
<li>set没有存储对应的value，其实也是存储的键值对，只是默认键和值是相同的,</li>
</ul>
<p>dict是python中的一个可变的数据类型，用{}表示，dict curly bracket 花括号<br>dict的key必须是不可变的数据类型对象，同一个字典中的键必须唯一，如果出现多个相同的键，则最新的键会被记住<br>而value的数据类型可以任意<br>python删除字典key时，会在当前座位下留有特殊标记，当查找key时,遇到了特殊标记座位时,会进行2次探测，伪删除和探测链，探测链断了元素就找不到了</p>
<p>新版哈希表结构：</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Indices</span><br><span class="line">----------------------------------------------------</span><br><span class="line">None | index | None | None | index | None | index ...</span><br><span class="line">----------------------------------------------------</span><br><span class="line"></span><br><span class="line">Entries</span><br><span class="line">--------------------</span><br><span class="line">hash0   key0  value0</span><br><span class="line">---------------------</span><br><span class="line">hash1   key1  value1</span><br><span class="line">---------------------</span><br><span class="line">hash2   key2  value2</span><br><span class="line">---------------------</span><br><span class="line"><span class="code">        ...</span></span><br><span class="line">---------------------</span><br></pre></td></tr></tbody></table></figure>

<p>集合并不支持索引操作，因为集合本质上是一个哈希表，和列表不一样。所以，同样不可以放入可变对象，<br>因为无法判断两个可变对象是否相等，<br>也就无法保证set内部“不会有重复元素”。</p>
<p>{0, 1, 2} set 无序，不能通过索引访问，不重复，用来去重<br>set() 创建一个空集合，<br>{}新建一个空字典<br>{} - {}求两个集合的差集，去掉相同的元素，以前面集合为标准，从一个集合里面去掉后面集合特有的元素<br>{} &amp; {}求两个集合的交集，找两个集合的公有元素<br>{} | {}求两个集合的并集，把两个集合合并在一起，按照从前往后的顺序，去掉相同的元素</p>
<h3 id="Python中list-tuple区别"><a href="#Python中list-tuple区别" class="headerlink" title="Python中list/tuple区别"></a>Python中list/tuple区别</h3><ul>
<li>都是线性结构、支持下标访问</li>
<li>list是可变对象，查找和删除的时间复杂度是O(n)，添加的时间复杂度是O(1)<br>没有办法作为字典的key，因为list有可能因为添加新的元素而导致内存地址的更换<br>list既可以当栈、也可以当队列，通过数组实现，而不是链表；<br>因此，每当执行 insert(0, val) 操作时，<br>需要将元素都向后移动一位才可插入，复杂度 O(N) ；<br>这和insert方法不同，是根据索引值来判断插入到链表的哪个位置。<br>python中的list是python的内置数据类型，list中的数据类不必相同的，<br>在list中的数据类型保存的是数据的存放的地址，简单的说就是指针，并非数据，这样保存一个list就太麻烦了，<br>例如list1=[1,2,3,’a’]需要4个指针和四个数据，增加了存储和消耗cpu。</li>
</ul>
<p>numpy的array的中的类型必须全部相同。<br>array底层是C语言。有步长strides,dimensions,data三属性。固定类型的numpy类型的数组array缺乏这种灵活，但是更方便进行存储和处理数据。</p>
<ul>
<li>tuple是保存的引用不可变，你没法替换这个对象，但是如果它本身就是一个可变对象，是可以修改这个引用指向的可变对象，比如tuple中包容可变对象，如果tuple里面保存一个list，list本身还是可变的。 parenthese 圆括号，有序的 不变的顺序表<br>可以作为字典的key，可以用在字符串格式化中。</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">print((), type(()))</span><br><span class="line"><span class="comment"># () &lt;class 'tuple'&gt; 空元组</span></span><br><span class="line">print((<span class="number">3</span>), type((<span class="number">3</span>)))</span><br><span class="line"><span class="comment"># 3 &lt;class 'int'&gt;</span></span><br><span class="line">print((<span class="number">3</span>, ), type((<span class="number">3</span>,)))</span><br><span class="line"><span class="comment"># (3,) &lt;class 'tuple'&gt; 只有一个元组元素后面要加逗号</span></span><br></pre></td></tr></tbody></table></figure>

<p>1.list和tuple其实是用链表顺序存储的，也就是前一个元素中存储了下一个元素的位置，这样只要找到第一个元素的位置就可以顺藤摸瓜找到所有元素的位置，所以list的名字其实就是个指针，指向list的第一个元素的位置。list的插入和删除等可以直接用链表的方式进行，比如我要在第1个元素和第2个元素中间插入一个元素，那么直接在链表的最后面（我们假设这个list只有两个元素，那么也就是在第3个元素的位置上）插入这个元素，然后把第一个元素指针指向这个元素（第3个位置），然后再把新插入的元素的指针指向原来的第2个元素，这样插入操作就完成了。读取这个list的时候，先用list的名字（就是个指针，指向第1个元素的位置）找到第一个元素，然后用第1一个元素的指针找到第2个元素（位置3），然后用第2个元素的指针找到第3个元素（位置2），以此类推。所以list的顺序和内存中的实际顺序其实不一定完全对应。这种存储方式占用空间小，浪费内存很少。<br>因为要按照链表一个一个找下去，查找和插入的时间随着元素的增加而增加；</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">s = set([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">print(s)  <span class="comment"># {1, 2, 3}</span></span><br><span class="line">s.add(<span class="number">4</span>)</span><br><span class="line">print(s)  <span class="comment"># {1, 2, 3, 4}</span></span><br><span class="line">s.remove(<span class="number">4</span>)</span><br><span class="line">print(s)  <span class="comment"># {1, 2, 3}</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t = ([<span class="number">1</span>], <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">print(t[<span class="number">0</span>])  <span class="comment"># [1]</span></span><br><span class="line">t[<span class="number">0</span>].append(<span class="number">1</span>)</span><br><span class="line">print(t)</span><br><span class="line"><span class="comment"># ([1, 1], 2, 3)  # 第一个列表对象元素虽然改变，但它依然是这个列表对象</span></span><br><span class="line"></span><br><span class="line">print(t[<span class="number">2</span>])  <span class="comment"># 3，不可变对象</span></span><br><span class="line">t[<span class="number">2</span>] = <span class="number">3</span>  <span class="comment"># TypeError: 'tuple' object does not support item assignment</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">t = (<span class="number">1</span>, <span class="string">'23'</span>, [<span class="number">123</span>, <span class="string">'abc'</span>], (<span class="string">'python'</span>, <span class="string">'learn'</span>))</span><br><span class="line">tls = list(t)  <span class="comment">#tuple--&gt;list</span></span><br><span class="line">print(tls)</span><br><span class="line"><span class="comment"># [1, '23', [123, 'abc'], ('python', 'learn')]</span></span><br><span class="line"></span><br><span class="line">t_tuple = tuple(tls)  <span class="comment">#list--&gt;tuple</span></span><br><span class="line">print(t_tuple)</span><br><span class="line"><span class="comment"># (1, '23', [123, 'abc'], ('python', 'learn'))</span></span><br></pre></td></tr></tbody></table></figure>

<p>常用函数<br>list<br><code>min(list_name)</code> <code>max(list_name)</code> <code>sum(list_name)</code><br><code>len(list_name)</code></p>
<p><code>list.index(x[, start[, end]])</code><br>从列表中找出某个值第一个匹配项的索引位置<br>x– 查找的对象。<br>start– 可选，查找的起始位置。<br>end– 可选，查找的结束位置。<br>返回：查找对象的索引位置，如果没有找到对象则抛出异常。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">list1 = [<span class="string">'Google'</span>, <span class="string">'Runoob'</span>, <span class="string">'Taobao'</span>]</span><br><span class="line">print(<span class="string">'Google 索引值为'</span>, list1.index(<span class="string">'Google'</span>))</span><br><span class="line"><span class="comment"># Google 索引值为 0</span></span><br><span class="line">print(<span class="string">'Runoob 索引值为'</span>, list1.index(<span class="string">'Runoob'</span>))</span><br><span class="line"><span class="comment"># Runoob 索引值为 1</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'Taobao 索引值为'</span>, list1.index(<span class="string">'Taobao'</span>))</span><br><span class="line"><span class="comment"># Taobao 索引值为 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 从指定位置开始搜索</span></span><br><span class="line">print(<span class="string">'Runoob 索引值为'</span>, list1.index(<span class="string">'Runoob'</span>, <span class="number">1</span>))</span><br><span class="line"><span class="comment"># Runoob 索引值为 1</span></span><br><span class="line"><span class="comment"># print('Runoob 索引值为', list1.index('Runoob', 2))</span></span><br><span class="line"><span class="comment"># ValueError: 'Runoob' is not in list</span></span><br><span class="line"></span><br><span class="line">list1 = [<span class="string">'Google'</span>, <span class="string">'Runoob'</span>, <span class="string">'Taobao'</span>]</span><br><span class="line">list2 = [<span class="string">'Runoob'</span>, <span class="string">'Taobao'</span>, <span class="string">'Google'</span>]</span><br><span class="line">dic = {}</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(list2)):</span><br><span class="line">    dic[list2[i]] = i</span><br><span class="line">    print(dic)</span><br><span class="line"><span class="comment"># {'Runoob': 0}</span></span><br><span class="line"><span class="comment"># {'Runoob': 0, 'Taobao': 1}</span></span><br><span class="line"><span class="comment"># {'Runoob': 0, 'Taobao': 1, 'Google': 2}</span></span><br><span class="line"><span class="comment"># {'Runoob': 0, 'Taobao': 1, 'Google': 2}</span></span><br><span class="line"></span><br><span class="line">print(list1[<span class="number">0</span>])  <span class="comment"># Google</span></span><br><span class="line">i = dic[list1[<span class="number">0</span>]]</span><br><span class="line">print(i)  <span class="comment"># 2</span></span><br><span class="line"></span><br><span class="line">x = dict()</span><br><span class="line">print(x)  <span class="comment"># {}</span></span><br><span class="line"></span><br><span class="line">dict2 = {val: idx <span class="keyword">for</span> idx, val <span class="keyword">in</span> enumerate(list2)}</span><br><span class="line">print(dict2)</span><br><span class="line"><span class="comment"># {'Runoob': 0, 'Taobao': 1, 'Google': 2}</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>.remove(具体内容)</code> 根据值移除元素<br><code>del a[索引号]</code><br><code>list.pop([index=-1])</code>移除列表中指定索引号一个元素（默认最后一个元素），并且返回该元素的值。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">list1 = [<span class="string">'Google'</span>, <span class="string">'Runoob'</span>, <span class="string">'Taobao'</span>, <span class="string">"Yahoo"</span>]</span><br><span class="line">list1.pop()  <span class="comment"># 括号里没有参数，表示删除list数组中最后一个元素</span></span><br><span class="line">print(<span class="string">"列表现在为 : "</span>, list1)</span><br><span class="line"><span class="comment"># 列表现在为 :  ['Google', 'Runoob', 'Taobao']</span></span><br><span class="line">list_pop = list1.pop(<span class="number">1</span>)</span><br><span class="line">print(<span class="string">"删除的项为 :"</span>, list_pop)</span><br><span class="line"><span class="comment"># 删除的项为 : Runoob</span></span><br><span class="line">print(<span class="string">"列表现在为 : "</span>, list1)</span><br><span class="line"><span class="comment"># 列表现在为 :  ['Google', 'Taobao']</span></span><br><span class="line">print(<span class="string">"删除的项为 :"</span>, list1.pop(<span class="number">0</span>), <span class="string">"，列表现在为 : "</span>, list1)</span><br><span class="line"><span class="comment"># 删除的项为 : Google ，列表现在为 :  ['Taobao']</span></span><br></pre></td></tr></tbody></table></figure>

<p><code> .sort(key=lambda x: x[0], reverse=True)</code><br><code> .sort(key=lambda x:(-x[1],x[0],x[2]))</code><br><code> .sort(key=lambda x:(-x[1],x[0],x[2]))</code><br>默认是升序，加个符号变降序，可做多级排序。<br><code>sorted()</code> 不在本地做排序</p>
<p><code>.reverse()</code>函数用于反向列表中元素。不能将字符串反转。<br><code>.reversed()</code>函数是返回序列seq的反向访问的迭代子。参数可以是列表，元组，字符串</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 组织列表 sort() 永久性排序 abcde正向或逆向顺序排序</span></span><br><span class="line">che = [<span class="string">"motuo"</span>, <span class="string">"qiche"</span>, <span class="string">"zixingche"</span>, <span class="string">'huoche'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 倒着打印列表  永久性的修改顺序 也可以随时改回来</span></span><br><span class="line">che = [<span class="string">"motuo"</span>, <span class="string">"qiche"</span>, <span class="string">"zixingche"</span>, <span class="string">'huoche'</span>]</span><br><span class="line"><span class="comment"># 倒着打印</span></span><br><span class="line">che.reverse()</span><br><span class="line">print(che)</span><br><span class="line"><span class="comment"># ['huoche', 'zixingche', 'qiche', 'motuo']</span></span><br><span class="line"><span class="comment"># 再次倒着改回</span></span><br><span class="line">che.reverse()</span><br><span class="line">print(che)</span><br><span class="line"><span class="comment"># ['motuo', 'qiche', 'zixingche', 'huoche']</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># "iloveChina".reverse()  # 直接将字符串用reverse异常，reverse适用于list(列表)</span></span><br><span class="line">a= <span class="string">"ilovechina"</span>[::<span class="number">-1</span>]</span><br><span class="line">print(a)</span><br><span class="line">b = <span class="string">''</span>.join(reversed(<span class="string">'ilovechina'</span>))</span><br><span class="line">print(b)</span><br></pre></td></tr></tbody></table></figure>

<p>元素 in list_name，内部是实现了一个魔法方法 <code>__contains__</code><br><code>.append</code><br><code>.insert(序号，内容)</code><br>函数参数是可以是任意一个元素，<br>作用是在列表的最后添加上这个新元素。</p>
<p>变量<br><code>float(‘inf’)</code></p>
<p>字典 无序<br><code>keys()</code> 查询字典的键<br><code>.values()</code> 查询字典的值<br><code>.items()</code> 返回的是元组</p>
<p><code>dict.get(key, default=None)</code> 查询某个键是否存在，<br>key – 字典中要查找的键。<br>default – 如果指定键的值不存在时，返回该默认值。<br>返回指定键的值，如果值不在字典中或不存在此键，返回默认值None。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字典的查询</span></span><br><span class="line">dict1 = {<span class="string">'name'</span>: <span class="string">'Ashe'</span>, <span class="string">'age'</span>: <span class="number">18</span>, <span class="string">'male'</span>: <span class="string">'男'</span>}</span><br><span class="line">print(dict1.keys())  <span class="comment"># dict_keys(['name', 'age', 'male'])</span></span><br><span class="line">print(dict1.values())  <span class="comment"># dict_values(['Ashe', 18, '男'])</span></span><br><span class="line">print(dict1.items())</span><br><span class="line"><span class="comment"># dict_items([('name', 'Ashe'), ('age', 18), ('male', '男')])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断key是否在字典里</span></span><br><span class="line">print(<span class="string">'name'</span> <span class="keyword">in</span> dict1)  <span class="comment"># True，效率高</span></span><br><span class="line">print(<span class="string">'name'</span> <span class="keyword">in</span> dict1.keys())  <span class="comment"># True 效率低，要先生成遍历字典的所有内容一个列表，这样字典的优势就没有了</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印dict1的键</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dict1.keys():</span><br><span class="line">    print(i)</span><br><span class="line">    <span class="comment"># name</span></span><br><span class="line">    <span class="comment"># age</span></span><br><span class="line">    <span class="comment"># male</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印dict的值</span></span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> dict1.values():</span><br><span class="line">    print(v)  <span class="comment">#Ashe 18 男</span></span><br><span class="line">    <span class="comment"># Ashe</span></span><br><span class="line">    <span class="comment"># 18</span></span><br><span class="line">    <span class="comment"># 男</span></span><br></pre></td></tr></tbody></table></figure>

<p>打印字典的键值：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">dict1 = {<span class="string">'name'</span>: <span class="string">'Ashe'</span>, <span class="string">'age'</span>: <span class="number">18</span>, <span class="string">'male'</span>: <span class="string">'男'</span>}</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dict1.items():</span><br><span class="line">    print(i)</span><br><span class="line">    <span class="comment"># ('name', 'Ashe')</span></span><br><span class="line">    <span class="comment"># ('age', 18)</span></span><br><span class="line">    <span class="comment"># 'male', '男')</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> dict1.items():</span><br><span class="line">    print(k, v)</span><br><span class="line">    <span class="comment"># name Ashe</span></span><br><span class="line">    <span class="comment"># age 18</span></span><br><span class="line">    <span class="comment"># male 男</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dict1 = {<span class="string">'name'</span>: <span class="string">'Ashe'</span>, <span class="string">'age'</span>: <span class="number">18</span>, <span class="string">'male'</span>: <span class="string">'男'</span>}</span><br><span class="line">print(dict1.get(<span class="string">'name'</span>))  <span class="comment"># Ashe</span></span><br><span class="line">print(dict1.get(<span class="string">'address'</span>))  <span class="comment"># None</span></span><br><span class="line">print(dict1.get(<span class="string">'address'</span>, <span class="string">'没有此键'</span>))  <span class="comment"># 没有此键</span></span><br><span class="line">print(dict1.get(<span class="string">'name'</span>, <span class="string">'age'</span>))  <span class="comment"># Ashe</span></span><br><span class="line">print(dict1.get(<span class="string">'age'</span>, <span class="string">'name'</span>))  <span class="comment"># 18</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">a = {<span class="string">'x'</span>: <span class="number">1</span>}</span><br><span class="line">print(a[<span class="string">'x'</span>])  <span class="comment"># 1</span></span><br><span class="line"><span class="comment"># print(a[1]) # KeyError:1</span></span><br><span class="line">b = {(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>): <span class="string">'test'</span>}</span><br><span class="line">print(b[(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)])  <span class="comment"># test</span></span><br><span class="line"><span class="comment"># c = {[1, 2, 3]: 'test'}</span></span><br><span class="line"><span class="comment"># print(c[[1, 2, 3]])  # TypeError: unhashable type: 'list'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(a.keys())  <span class="comment"># dict_keys(['x'])</span></span><br><span class="line">print(a.values())  <span class="comment"># dict_values([1])</span></span><br><span class="line">print(b.keys())  <span class="comment"># dict_keys([(1, 2, 3)])</span></span><br><span class="line">print(b.values())  <span class="comment"># dict_values(['test'])</span></span><br><span class="line"></span><br><span class="line">print(a.get(<span class="string">'x'</span>))  <span class="comment"># 1</span></span><br><span class="line">print(a.get(<span class="string">'x'</span>, <span class="number">4</span>))  <span class="comment"># 1 指定的键的值不存在，返回默认值</span></span><br><span class="line">print(a.get(<span class="number">4</span>))  <span class="comment"># None 指定的键的值不存在，返回默认值None</span></span><br><span class="line"></span><br><span class="line">print(b.get((<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)))  <span class="comment"># test</span></span><br><span class="line">print(b.get(<span class="string">'y'</span>))  <span class="comment"># None，指定键的值不存在时，返回该默认值None。</span></span><br><span class="line">print(b.get(<span class="string">'y'</span>, <span class="number">2</span>))  <span class="comment"># 2，如果指定键的值不存在时，返回该默认值2。</span></span><br></pre></td></tr></tbody></table></figure>

<p>dict有两种增加的方法<br>如果没有的键值对，则进行添加，如果有，则将值进行覆盖</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dict1={<span class="string">'name'</span>:<span class="string">'Ashe'</span>,<span class="string">'age'</span>:<span class="number">18</span>,<span class="string">'male'</span>:<span class="string">'男'</span>}</span><br><span class="line">print(dict1)</span><br><span class="line">dict1[<span class="string">'high'</span>]=<span class="number">185</span></span><br><span class="line">print(dict1)  <span class="comment"># {'name': 'Ashe', 'age': 18, 'male': '男', 'high': 185}</span></span><br><span class="line">dict1[<span class="string">'age'</span>]=<span class="number">16</span></span><br><span class="line">print(dict1) <span class="comment">#  {'name': 'Ashe', 'age': 16, 'male': '男', 'high': 185}</span></span><br></pre></td></tr></tbody></table></figure>

<p>如果有键值对，不做任何改变，没有键值对，才进行添加</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">dict1 = {<span class="string">'name'</span>: <span class="string">'Ashe'</span>, <span class="string">'age'</span>: <span class="number">18</span>, <span class="string">'male'</span>: <span class="string">'男'</span>}</span><br><span class="line">dict1.setdefault(<span class="string">"weight"</span>)</span><br><span class="line">print(dict1)</span><br><span class="line"><span class="comment"># {'name': 'Ashe', 'age': 16, 'male': '男', 'high': 185, 'weight': None}</span></span><br><span class="line">dict1.setdefault(<span class="string">'weight'</span>, <span class="string">'65kg'</span>)</span><br><span class="line">print(dict1)</span><br><span class="line"><span class="comment"># {'name': 'Ashe', 'age': 16, 'male': '男', 'high': 185, 'weight': None}</span></span><br><span class="line">dict1.setdefault(<span class="string">'address'</span>, <span class="string">'北京'</span>)</span><br><span class="line">print(dict1)</span><br><span class="line"><span class="comment"># {'name': 'Ashe', 'age': 16, 'male': '男', 'high': 185, 'weight': None, 'address': '北京'}</span></span><br><span class="line">dict1.setdefault(<span class="string">'address'</span>, <span class="string">'桂林'</span>)</span><br><span class="line">print(dict1)</span><br><span class="line"><span class="comment"># {'name': 'Ashe', 'age': 16, 'male': '男', 'high': 185, 'weight': None, 'address': '北京'}</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>pop()</code>删除，如果有键，则删除，有返回值，如果没有则会报错，如果不希望出现报错信息，可以在删除的后面添加信息</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">delDict={<span class="string">'name'</span>: <span class="string">'Ashe'</span>, <span class="string">'age'</span>: <span class="number">16</span>, <span class="string">'male'</span>: <span class="string">'男'</span>, <span class="string">'high'</span>: <span class="number">185</span>, <span class="string">'weight'</span>: <span class="literal">None</span>, <span class="string">'address'</span>: <span class="string">'北京'</span>}</span><br><span class="line">print(delDict.pop(<span class="string">'age'</span>))  <span class="comment"># 16</span></span><br><span class="line">print(delDict)  <span class="comment">#{'name': 'Ashe', 'male': '男', 'high': 185, 'weight': None, 'address': '北京'}</span></span><br><span class="line">print(delDict.pop(<span class="string">'职业'</span>,<span class="string">'没有此键'</span>))  <span class="comment">#没有此键</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> a[<span class="string">'x'</span>]  <span class="comment"># 删除key</span></span><br><span class="line">print(a[<span class="string">'y'</span>])  <span class="comment"># 2</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>pop(key[,default])</code><br>删除字典给定键 key 所对应的值，返回值为被删除的值。<br>key: 要删除的键值<br>default: 如果没有 key，返回 default 值</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">site = {<span class="string">'name'</span>: <span class="string">'菜鸟教程'</span>, <span class="string">'alexa'</span>: <span class="number">10000</span>, <span class="string">'url'</span>: <span class="string">'www.runoob.com'</span>}</span><br><span class="line">pop_obj = site.pop(<span class="string">'name'</span>)</span><br><span class="line">print(pop_obj)  <span class="comment"># 菜鸟教程</span></span><br><span class="line"></span><br><span class="line">dict1 = {<span class="number">1</span>: <span class="string">"a"</span>, <span class="number">2</span>: [<span class="number">1</span>, <span class="number">2</span>]}</span><br><span class="line">print(dict1.pop(<span class="number">1</span>), dict1)</span><br><span class="line"><span class="comment"># a {2: [1, 2]}</span></span><br><span class="line">print(dict1.pop(<span class="number">3</span>, <span class="string">"nokey"</span>), dict1)  <span class="comment"># 设置默认值，必须添加，否则报错</span></span><br><span class="line"><span class="comment"># nokey {2: [1, 2]}</span></span><br><span class="line">print(dict1.pop(<span class="number">3</span>), dict1)  <span class="comment"># 没用设置默认值，报错</span></span><br><span class="line"><span class="comment"># Traceback (most recent call last):</span></span><br><span class="line"><span class="comment">#   print(dict1.pop(3), dict1)</span></span><br><span class="line"><span class="comment"># KeyError: 3</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>popitem()</code>删除，随机删除，返回的是一个元组，元组里面存储的删除的键值</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">delDict = {</span><br><span class="line">    <span class="string">'name'</span>: <span class="string">'Ashe'</span>,</span><br><span class="line">    <span class="string">'age'</span>: <span class="number">16</span>,</span><br><span class="line">    <span class="string">'male'</span>: <span class="string">'男'</span>,</span><br><span class="line">    <span class="string">'high'</span>: <span class="number">185</span>,</span><br><span class="line">    <span class="string">'weight'</span>: <span class="literal">None</span>,</span><br><span class="line">    <span class="string">'address'</span>: <span class="string">'北京'</span></span><br><span class="line">}</span><br><span class="line">print(delDict.pop(<span class="string">'age'</span>))  <span class="comment"># 16</span></span><br><span class="line">print(delDict)</span><br><span class="line"><span class="comment"># {'name': 'Ashe', 'male': '男', 'high': 185, 'weight': None, 'address': '北京'}</span></span><br><span class="line">print(delDict.pop(<span class="string">'职业'</span>, <span class="string">'没有此键'</span>))  <span class="comment"># 没有此键</span></span><br><span class="line"></span><br><span class="line">print(delDict.popitem())</span><br><span class="line"><span class="comment"># ('address', '北京') 随机删除，返回值是删除的键值对</span></span><br><span class="line">print(delDict)</span><br><span class="line"><span class="comment"># {'name': 'Ashe', 'male': '男', 'high': 185, 'weight': None}</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>del()</code>可以删除整个字典，也可以删除字典的某个键，如果删除的键不存在，则会出现报错</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">delDict = {<span class="string">'name'</span>: <span class="string">'Ashe'</span>, <span class="string">'male'</span>: <span class="string">'男'</span>, <span class="string">'high'</span>: <span class="number">185</span>, <span class="string">'weight'</span>: <span class="literal">None</span>}</span><br><span class="line"><span class="keyword">del</span> delDict[<span class="string">'name'</span>]</span><br><span class="line">print(delDict)  <span class="comment"># {'male': '男', 'high': 185, 'weight': None}</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用del清空列表</span></span><br><span class="line"><span class="keyword">del</span> delDict</span><br><span class="line">print(delDict)  <span class="comment"># NameError: name 'delDict' is not defined</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>.clear()</code>清空列表也可以使用，该函数没有任何返回值</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">delDict = {<span class="string">'name'</span>: <span class="string">'Ashe'</span>, <span class="string">'male'</span>: <span class="string">'男'</span>, <span class="string">'high'</span>: <span class="number">185</span>, <span class="string">'weight'</span>: <span class="literal">None</span>}</span><br><span class="line">print(delDict.clear())  <span class="comment"># None</span></span><br><span class="line">print(delDict)  <span class="comment"># {}</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改字典</span></span><br><span class="line">x = {<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="number">2</span>}</span><br><span class="line">y = {<span class="string">'c'</span>: <span class="number">3</span>, <span class="string">'d'</span>: <span class="number">4</span>}</span><br><span class="line">x.update(y)  <span class="comment"># 这里注意我是直接改变的x变量，具体根据程序逻辑来定，可以用其它变量接受。</span></span><br><span class="line">print(x)  <span class="comment"># {'a': 1, 'b': 2, 'c': 3, 'd': 4}</span></span><br><span class="line"></span><br><span class="line">x = {<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="number">2</span>}</span><br><span class="line">y = {<span class="string">'a'</span>: <span class="number">3</span>, <span class="string">'d'</span>: <span class="number">4</span>}</span><br><span class="line">x.update(y)  <span class="comment"># 这里注意我是直接改变的x变量，具体根据程序逻辑来定，可以用其它变量接受。</span></span><br><span class="line">print(x)  <span class="comment"># {'a': 3, 'b': 2, 'd': 4}</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字典合并的方法</span></span><br><span class="line">print(<span class="string">'===='</span>)</span><br><span class="line">x = {<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="number">2</span>}</span><br><span class="line">y = {<span class="string">'c'</span>: <span class="number">3</span>, <span class="string">'d'</span>: <span class="number">4</span>}</span><br><span class="line"><span class="comment"># 法一</span></span><br><span class="line">z = {}</span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> x.items():</span><br><span class="line">    z[k] = v</span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> y.items():</span><br><span class="line">    z[k] = v</span><br><span class="line">print(z)</span><br><span class="line"><span class="comment"># {'a': 1, 'b': 2, 'c': 3, 'd': 4}</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 法二</span></span><br><span class="line">q = {**x, **y}</span><br><span class="line">print(q)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'^^^^^^^'</span>)</span><br><span class="line">a = {<span class="string">"A"</span>: <span class="number">1</span>, <span class="string">"B"</span>: <span class="number">2</span>}</span><br><span class="line">b = {<span class="string">"A"</span>: <span class="number">3</span>, <span class="string">"D"</span>: <span class="number">4</span>}</span><br><span class="line"></span><br><span class="line">print({**a, **b})</span><br><span class="line"><span class="comment"># {'A': 3, 'B': 2, 'D': 4}  # 这里取的是b中的A，即b覆盖了a</span></span><br><span class="line">print(<span class="string">'-----'</span>)</span><br><span class="line">print(dict(a, **b))</span><br><span class="line"><span class="comment"># {'A': 3, 'B': 2, 'D': 4}</span></span><br></pre></td></tr></tbody></table></figure>

<p>字符串<br>是否包含某个子串<code>print("慕课网" in name)  # True</code><br><code>string.index(sub_string, start, end)</code>返回开始的索引值，没找到则抛出异常。</p>
<p><code>str.startswith(substr, beg=0, end=len(string))</code> 检查字符串是否是以指定子字符串开头，如果是则返回 True，否则返回 False。如果参数 beg 和 end 指定值，则在指定范围内检查。beg – 开始索引，默认为0。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">str = <span class="string">"this is string example....wow!!!"</span></span><br><span class="line">print(str.startswith(<span class="string">'this'</span>))</span><br><span class="line"><span class="comment"># True 字符串是否以 this 开头</span></span><br><span class="line">print(str.startswith(<span class="string">'string'</span>, <span class="number">8</span>))</span><br><span class="line"><span class="comment"># True 从第九个字符开始的字符串是否以 string 开头</span></span><br><span class="line">print(str.startswith(<span class="string">'this'</span>, <span class="number">2</span>, <span class="number">4</span>))</span><br><span class="line"><span class="comment"># False 从第2个字符开始到第四个字符结束的字符串是否以 this 开头</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>str.endswith(substr, beg=0, end=len(string))</code></p>
<p><code>str.find(str, beg=0, end=len(string))</code> 检测字符串中是否包含子字符串 str ，如果指定 beg（开始） 和 end（结束） 范围，则检查是否包含在指定范围内，如果指定范围内如果包含指定索引值，返回的是索引值在字符串中的起始位置。如果不包含索引值，返回-1。<br>beg – 开始索引，默认为0。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">info = <span class="string">'abca'</span></span><br><span class="line">print(info.find(<span class="string">'a'</span>))  <span class="comment"># 0 从下标0开始，查找在字符串里第一个出现的子串</span></span><br><span class="line">print(info.find(<span class="string">'a'</span>, <span class="number">1</span>))  <span class="comment"># 3 从下标1开始，查找在字符串里第一个出现的子串</span></span><br><span class="line">print(info.find(<span class="string">'3'</span>))  <span class="comment"># -1 查找不到</span></span><br><span class="line"></span><br><span class="line">str1 = <span class="string">"Runoob example....wow!!!"</span></span><br><span class="line">str2 = <span class="string">"exam"</span></span><br><span class="line"></span><br><span class="line">print(str1.find(str2))  <span class="comment"># 7</span></span><br><span class="line">print(str1.find(str2, <span class="number">5</span>))  <span class="comment"># 7  第2个参数5，表示从素引5的位置开始往后查找</span></span><br><span class="line">print(str1.find(str2, <span class="number">10</span>))  <span class="comment"># -1</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>str.lstrip([chars])</code> 方法用于截掉字符串左边的空格或指定字符。<br><code>str.rstrip([chars])</code> 方法用于截掉字符串右边的空格或指定字符。</p>
<p>从左到右移除字符串的指定字符，<br><code>.strip()</code>无字符集参数或为 None 时 去除首位空格<br>匹配时不是按照整个字符串匹配的，而是一个个匹配的。<br>移除所有属于字符集子串的字符一旦不属于则停止移除并返回字符串副本。</p>
<p>chars –指定截取的字符。<br>返回截掉字符串左边的空格或指定字符后生成的新字符串。</p>
<p><code>.strip().strip(‘-a’)</code>去除首位空格和字符</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">str = <span class="string">"     this is string example....wow!!!     "</span></span><br><span class="line">print(str.lstrip())</span><br><span class="line"><span class="comment"># this is string example....wow!!!</span></span><br><span class="line"></span><br><span class="line">str = <span class="string">"88888888this is string example....wow!!!8888888"</span></span><br><span class="line">print(str.lstrip(<span class="string">'8'</span>))</span><br><span class="line"><span class="comment"># this is string example....wow!!!8888888</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'www.example.com'</span>.lstrip(<span class="string">'we.'</span>))</span><br><span class="line"><span class="comment"># xample.com</span></span><br><span class="line">print(<span class="string">'www.example.com'</span>.lstrip(<span class="string">'we'</span>))</span><br><span class="line"><span class="comment"># '.example.com'</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'www.example.com'</span>.lstrip(<span class="string">'e'</span>))</span><br><span class="line"><span class="comment"># 'www.example.com'</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'www.example.com'</span>.lstrip(<span class="string">'cmowz.'</span>))</span><br><span class="line"><span class="comment"># 'example.com'</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'www.example.com'</span>.lstrip(<span class="string">'cmoz.'</span>))</span><br><span class="line"><span class="comment"># 'www.example.com'</span></span><br><span class="line"></span><br><span class="line">message = <span class="string">"\tpython xue xi\t"</span></span><br><span class="line"><span class="comment"># 每个单词的首字母大写的写法</span></span><br><span class="line">print(message.title())</span><br><span class="line"><span class="comment"># 单词全部大写的写法</span></span><br><span class="line">print(message.upper())</span><br><span class="line"><span class="comment"># 单词全部小写的写法</span></span><br><span class="line">print(message.lower())</span><br><span class="line"><span class="comment"># 去除字符串前面的空白</span></span><br><span class="line">print(message.lstrip())</span><br><span class="line"><span class="comment"># 去除字符串后面的空白</span></span><br><span class="line">print(message.rstrip())</span><br><span class="line"><span class="comment"># 去除字符串两边的空白</span></span><br><span class="line">print(message.strip())</span><br><span class="line"><span class="comment">#         Python Xue Xi</span></span><br><span class="line"><span class="comment">#         PYTHON XUE XI</span></span><br><span class="line"><span class="comment">#         python xue xi</span></span><br><span class="line"><span class="comment"># python xue xi        </span></span><br><span class="line"><span class="comment">#         python xue xi</span></span><br><span class="line"><span class="comment"># python xue xi    </span></span><br></pre></td></tr></tbody></table></figure>

<p>S[:3]+S[5:] 拼接字符串，去除某个字符</p>
<p><code>.replace(‘a’,’b’)</code> 替换字符</p>
<p><code>re.sub(‘a’,’b’,s)</code> 替换字符</p>
<p><code>ord(a)</code>它以一个字符（长度为1）作为参数，返回对应的 ascii-&gt;gbk-&gt;unicode 数值（返回值是对应的十进制整数），并不是简单意义上ascii码值并不准确，<br>如果所给的 Unicode 字符超出了你的 Python 定义范围，则会引发一个 TypeError 的异常。<br>因为python里不像C++那样两个字符相减可以求出ASCII数值差</p>
<p><code>chr(a)</code> 函数（对于8位的ASCII字符串）或 unichr() 函数（对于Unicode对象）的配对函数 是ord的逆过程，将ASCII数值转化成该编码对应的字符</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">print(ord(<span class="string">' '</span>), type(ord(<span class="string">' '</span>)))  <span class="comment"># 32 &lt;class 'int'&gt; 空格的ascii码</span></span><br><span class="line">print(ord(<span class="string">'0'</span>))  <span class="comment"># 48</span></span><br><span class="line">print(ord(<span class="string">'1'</span>))  <span class="comment"># 49</span></span><br><span class="line">print(ord(<span class="string">'2'</span>))  <span class="comment"># 50</span></span><br><span class="line">print(ord(<span class="string">'2'</span>), type(ord(<span class="string">'2'</span>)))  <span class="comment"># 50  &lt;class 'int'&gt;</span></span><br><span class="line">print(ord(<span class="string">'3'</span>))  <span class="comment"># 51</span></span><br><span class="line"><span class="comment"># print(ord('10')) TypeError: ord() expected a character, but string of length 2 found</span></span><br><span class="line">print(ord(<span class="string">'A'</span>))  <span class="comment"># 65</span></span><br><span class="line">print(ord(<span class="string">'B'</span>))  <span class="comment"># 66</span></span><br><span class="line">print(ord(<span class="string">'C'</span>))  <span class="comment"># 67</span></span><br><span class="line">print(ord(<span class="string">'a'</span>))  <span class="comment"># 97</span></span><br><span class="line">print(ord(<span class="string">'b'</span>))  <span class="comment"># 98</span></span><br><span class="line">print(ord(<span class="string">'c'</span>))  <span class="comment"># 99</span></span><br><span class="line">print(ord(<span class="string">'华'</span>))  <span class="comment"># 21326 中文对应的Unicode</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">print(chr(<span class="number">32</span>))  <span class="comment"># 空格</span></span><br><span class="line">print(chr(<span class="number">50</span>), type(chr(<span class="number">50</span>)))  <span class="comment"># 2  &lt;class 'str'&gt;</span></span><br><span class="line">print(chr(<span class="number">65</span>))  <span class="comment"># A</span></span><br><span class="line">print(chr(<span class="number">97</span>))  <span class="comment"># a</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">upper_letters = list(chr(x) <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">65</span>, <span class="number">91</span>))</span><br><span class="line">lower_letters = list(chr(x) <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">97</span>, <span class="number">123</span>))</span><br><span class="line">number = list(chr(x) <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">48</span>, <span class="number">58</span>))</span><br><span class="line"></span><br><span class="line">print(*upper_letters)</span><br><span class="line"><span class="comment"># A B C D E F G H I J K L M N O P Q R S T U V W X Y Z</span></span><br><span class="line">print(*lower_letters)</span><br><span class="line"><span class="comment"># a b c d e f g h i j k l m n o p q r s t u v w x y z</span></span><br><span class="line">print(*number)</span><br><span class="line"><span class="comment"># 0 1 2 3 4 5 6 7 8 9</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>str.title()</code> 方法返回”标题化”的字符串，就是说所有单词的首个字母转化为大写，其余字母均为小写<br>返回”标题化”的字符串,就是说所有单词的首字母都转化为大写。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">str = <span class="string">"this is string example from runoob....wow!!!"</span></span><br><span class="line">print(str.title())</span><br><span class="line"><span class="comment"># This Is String Example From Runoob....Wow!!! </span></span><br></pre></td></tr></tbody></table></figure>

<p>非字母后的第一个字母将转换为大写字母</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">txt = <span class="string">"hello b2b2b2 and 3g3g3g"</span></span><br><span class="line">print(txt.title())  <span class="comment"># Hello B2B2B2 And 3G3G3G</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>str.split(str="", num=string.count(str))</code><br>通过指定分隔符对字符串进行切片，不是对列表对象切片<br>返回分割后的字符串列表。<br>如果第二个参数 num 有指定值，则分割为 num+1 个子字符串。<br>str – 分隔符，默认为所有的空字符，包括空格、换行(\n)、制表符(\t)等。<br>num – 分割次数。默认为 -1, 即分隔所有。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="string">"http://www.baidu.com/python/image/123456.jpg"</span></span><br><span class="line">print(url.split())  <span class="comment"># 以空格为分隔符</span></span><br><span class="line"><span class="comment"># ['http://www.baidu.com/python/image/123456.jpg']</span></span><br><span class="line">print(url.split(<span class="string">"/"</span>))  <span class="comment"># 以“/” 进行分隔</span></span><br><span class="line"><span class="comment"># ['http:', '', 'www.baidu.com', 'python', 'image', '123456.jpg']</span></span><br><span class="line">print(url.split(<span class="string">'/'</span>, <span class="number">1</span>))  <span class="comment"># 以 / 为分隔符，分割为2个字符串列表</span></span><br><span class="line"><span class="comment"># ['http:', '/www.baidu.com/python/image/123456.jpg']</span></span><br><span class="line">print(url.split(<span class="string">"/"</span>)[<span class="number">-1</span>])  <span class="comment"># 分隔符分割后列表最后一个元素(字符串类型），图片名称的获取</span></span><br><span class="line"><span class="comment"># 123456.jpg</span></span><br><span class="line">print(url.split(<span class="string">"/"</span>)[<span class="number">0</span>])  <span class="comment"># 分隔符分割后列表第一个元素(字符串类型）</span></span><br><span class="line"><span class="comment"># http:</span></span><br><span class="line">print(url[<span class="number">1</span>:<span class="number">-1</span>], type(url[<span class="number">1</span>:<span class="number">-1</span>]))  <span class="comment"># 切片，去除第一个和最后一个元素</span></span><br><span class="line"><span class="comment"># ttp://www.baidu.com/python/image/123456.jp &lt;class 'str'&gt;</span></span><br><span class="line">print(url[<span class="number">1</span>:<span class="number">-1</span>].split(<span class="string">"/"</span>)[<span class="number">0</span>])  <span class="comment"># 列表第一个元素(字符串类型）</span></span><br><span class="line"><span class="comment"># ttp:</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">"[http://www.baidu.com/python/image/123456.jpg]"</span></span><br><span class="line">print(url[:], type(url[:]))</span><br><span class="line"><span class="comment"># [http://www.baidu.com/python/image/123456.jpg] &lt;class 'str'&gt;</span></span><br><span class="line">print(url[:].split(<span class="string">"/"</span>)[<span class="number">0</span>])  <span class="comment"># 列表第一个元素(字符串类型）</span></span><br><span class="line"><span class="comment"># [http:</span></span><br><span class="line"></span><br><span class="line">data = <span class="string">'[1, 2, 3, null, 4, 5, null]'</span></span><br><span class="line">print(data[<span class="number">1</span>:<span class="number">-1</span>], type(data[<span class="number">1</span>:<span class="number">-1</span>]))</span><br><span class="line"><span class="comment"># 1, 2, 3, null, 4, 5, null &lt;class 'str'&gt;</span></span><br><span class="line">print(data[<span class="number">1</span>:<span class="number">-1</span>].split(<span class="string">','</span>), type(data[<span class="number">1</span>:<span class="number">-1</span>].split(<span class="string">','</span>)))</span><br><span class="line"><span class="comment"># ['1', ' 2', ' 3', ' null', ' 4', ' 5', ' null'] &lt;class 'list'&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>str.splitlines([keepends])</code><br>按照行(‘\r’, ‘\r\n’, \n’)分隔，返回一个包含各行作为元素的列表，<br>keepends – 在输出结果里是否去掉换行符(‘\r’, ‘\r\n’, \n’)，<br>默认为 <code>False</code>，不包含换行符，<br>如果为 <code>True</code>，则保留换行符。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'ab c\n\nde fg\rkl\r\n'</span>.splitlines())</span><br><span class="line"><span class="comment"># ['ab c', '', 'de fg', 'kl']</span></span><br><span class="line">print(<span class="string">'ab c\n\nde fg\rkl\r\n'</span>.splitlines(<span class="literal">True</span>))</span><br><span class="line"><span class="comment"># ['ab c\n', '\n', 'de fg\r', 'kl\r\n']</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="39-sep-39-join-seq"><a href="#39-sep-39-join-seq" class="headerlink" title="'sep'.join(seq)"></a><code>'sep'.join(seq)</code></h3><p>以sep作为分隔符，将seq所有的元素合并成一个新的字符串<br>将字符串、元组、列表中的元素以指定的字符(分隔符)连接生成一个新的字符串</p>
<p>参数说明<br>sep：分隔符。string（字符串），可以为空<br>seq：要连接的元素列表、字符串、元组、字典<br>返回值：返回一个以分隔符sep连接各个元素后生成的字符串</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对字符串进行操作</span></span><br><span class="line">print(<span class="string">':'</span>.join(<span class="string">"hello good boy "</span>))</span><br><span class="line"><span class="comment"># h:e:l:l:o: :g:o:o:d: :b:o:y:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用字符串把字符串列表里的字符串连接起来</span></span><br><span class="line"><span class="comment"># 用空字符串''隔开</span></span><br><span class="line">print(<span class="string">''</span>.join([<span class="string">"hello"</span>, <span class="string">"world"</span>, <span class="string">"!"</span>]))  <span class="comment"># helloworld!</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用' '隔开，用空格</span></span><br><span class="line">print(<span class="string">' '</span>.join([<span class="string">"hello"</span>, <span class="string">"world"</span>, <span class="string">"!"</span>]))  <span class="comment"># hello world !</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用'-'隔开</span></span><br><span class="line">print(<span class="string">'-'</span>.join([<span class="string">"hello"</span>, <span class="string">"world"</span>, <span class="string">"!"</span>]))  <span class="comment"># hello-world-!</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对元组进行操作</span></span><br><span class="line">seq3 = (<span class="string">'hello'</span>, <span class="string">'good'</span>, <span class="string">'boy'</span>)</span><br><span class="line">print(<span class="string">':'</span>.join(seq3))</span><br><span class="line"><span class="comment"># hello:good:boy</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对字典进行操作</span></span><br><span class="line">seq4 = {<span class="string">'hello'</span>: <span class="number">1</span>, <span class="string">'good'</span>: <span class="number">2</span>, <span class="string">'boy'</span>: <span class="number">3</span>}</span><br><span class="line">print(<span class="string">':'</span>.join(seq4))</span><br><span class="line"><span class="comment"># hello:good:boy</span></span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/sql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/sql/" class="post-title-link" itemprop="url">sql</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-06-28 14:34:27" itemprop="dateModified" datetime="2021-06-28T14:34:27Z">2021-06-28</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>mysql命令行中执行多行命令时，<br>如果前边输入的命令发生错误，<br>通过<code>\c</code>来取消当前的命令，重新进入“mysql-&gt;”提示符</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br></pre></td><td class="code"><pre><span class="line">```\q```退出mysql</span><br><span class="line">```\h```帮助信息</span><br><span class="line">```\d```改变执行符号</span><br><span class="line">```\s```显示服务器状态</span><br><span class="line"></span><br><span class="line">### 整数类型范围</span><br><span class="line">1，tinyint类型占用的字节最小，表示1字节整数。取值范围也是最小的。</span><br><span class="line">2，smalllint类，表示2个字节整数。</span><br><span class="line">3，mediumint类型占用的字节最大，表示3字节整数。</span><br><span class="line">4，int类型，表示4字节整数，和integer类型的字节数和取值范围是一样的，</span><br><span class="line">5，bigint类型占用的字节最大，表示8字节整数。气质范围是最大的。</span><br><span class="line"></span><br><span class="line">属性 字段约束</span><br><span class="line">任何整数类型后面都可以加一个```unsigned```属性，表示数据是无符号的，即非负整数。</span><br><span class="line">用此类型可以增加数据长度。</span><br><span class="line">例如如果tinyint最大是127，那tinyint unsigned最大就可以到127 * 2。</span><br><span class="line">例如：int类型的整数，有符号值：-128到127，无符号值：0到255。</span><br><span class="line">不同类型的整数类型的字节数不同，根据类型所占的字节数可以算出该类型的取值范围。</span><br><span class="line">比如intyint的空间是一个字节，一个字节是8位。那么</span><br><span class="line">tinyint无符号数的最大值就是2的8次-1，也就是255。</span><br><span class="line">tinyint有符号数的最大值就是2的7次-1，也就是127。</span><br><span class="line"></span><br><span class="line">default</span><br><span class="line"></span><br><span class="line">zerofill。该属性参数表示数字不足的显示空间由0来填补。</span><br><span class="line">使用zerofill参数时，MySQL会自动加上unsinged属性。</span><br><span class="line">那么该整数类型只能表示无符号数，其显示宽度比默认宽度小1。</span><br><span class="line">默认没有零填充</span><br><span class="line"></span><br><span class="line">整数类型还有一个auto_increment属性，该属性可是使字段成为自增字段，具有该属性的字段，在插入新的记录时，该字段的值都会在前一条记录的基础上1。所以这个时候就不用人为的设值了呢，一般用来主键的设置上该属性。</span><br><span class="line">主键约束PRIMARY KEY(字段名)，自带索引，不能为null，不能重复</span><br><span class="line">为表加上一个列用来存储唯一标志即主键列建议用数字类型，</span><br><span class="line">检索速度快，加上auoto_increment自增长</span><br><span class="line">非空约束 not null</span><br><span class="line">唯一约束 unique 可以为NULL，如果不为NULL，必须唯一</span><br><span class="line">外键约束 foreign key （子表字段名）reference 父表名(字段名) 保持关联数据的逻辑性</span><br><span class="line">MySQL中显示的字段名是：外键属性名_id。</span><br><span class="line"></span><br><span class="line">数据类型参数是整数数据类型的名称</span><br><span class="line"></span><br><span class="line">定义后面Length字段，并不是指的数值范围，而是指数据库里面可见的最大数据的长度。</span><br><span class="line">int(5)就是指定int类型的显示字符的长度是5，始终是4个字节，可以存1234</span><br><span class="line">INT(11)表示长度为11的INT类型，对大多数应用是没有意义的,它不会限制值的合法范围,只会影响显示字符的个数，只是当定义了UNSIGNED ZEROFILL属性配合使用才有意义。</span><br><span class="line"></span><br><span class="line">`int(3) zerofill`自动填充0，可以存1234，012</span><br><span class="line">`int(5) zerofill`自动填充0，可以存01234，00012</span><br><span class="line">假定类型设定为INT(5)，属性为UNSIGNED ZEROFILL，如果用户插入的数据为12的话，那么数据库实际存储数据为00012。</span><br><span class="line"></span><br><span class="line">### 实数类型</span><br><span class="line">DECIMAL可存储比 BIGINT还大的整数，存储精确的小数</span><br><span class="line">FLOAT和 DOUBLE 是有取值范围的，支持使用标准的浮点进行近似计算</span><br><span class="line">FLOAT类型数据可以存储至多8位十进制数，并在内存中占4字节。</span><br><span class="line">DOUBLE类型数据可以存储至多18位十进制数，并在内存中占8字节。</span><br><span class="line"></span><br><span class="line">### 字符串类型</span><br><span class="line">VARCHAR、CHAR、TEXT、BLOB</span><br><span class="line">VARCHAR类型用于存储可变长字符串,它比定长类型更节省空间</span><br><span class="line">VARCHAR使用1或2个额外字节记录字符串的长度,</span><br><span class="line">列长度小于255字节,使用1个字节表示,否则用2个</span><br><span class="line">内部存储varchar是存入的实际字符数+1个字节（n&lt;=255）或2个字节(n&gt;255)，</span><br><span class="line">VARCHAR长度，如果存储内容超出指定长度，会被截断</span><br><span class="line">VARCHAR值保存时不进行填充。当值保存和检索时尾部的空格仍保留</span><br><span class="line"></span><br><span class="line">CHAR是定长的，根据定义的字符串长度分配足够的空间</span><br><span class="line">CHAR会根据需要采用空格进行填充以方便比较</span><br><span class="line">CHAR适合存储很短的字符串,或者所有值都接近同一个长度</span><br><span class="line">CHAR存储的内容超出设置的长度时，内容同样会被截断。</span><br><span class="line"></span><br><span class="line">当保存CHAR值时，在它们的右边填充空格以达到指定的长度。当检索到CHAR值时，尾部的空格被删除掉。</span><br><span class="line">在存储或检索过程中不进行大小写转换。</span><br><span class="line">CHAR存储定长数据很方便，</span><br><span class="line">CHAR字段上的索引效率级高，</span><br><span class="line">对于经常变更的数据,CHAR比 VARCHAR更好,CHAR不容易产生碎片</span><br><span class="line">对于非常短的列,CHAR比 VARCHAR在存储空间上更有效率</span><br><span class="line">只分配真正需要的空间,更长的列会消耗更多的内存</span><br><span class="line"></span><br><span class="line">定义一个CHAR[10]和VARCHAR[10],如果存进去的是‘ABCD’, char(10)不论你存储的数据是否达到了10个字节，都要占去10个字节的空间,不足的自动用空格填充，除了字符‘ABCD’外，后面跟六个空格，而varchar(50)中50的含义是最多存放50个字符，VARCHAR的长度变为4了，</span><br><span class="line">取数据的时候，CHAR类型的要用trim()去掉多余的空格，而VARCHAR类型是不需要的。</span><br><span class="line">char(16)表示固定长度字符串，长度为16、</span><br><span class="line">varchar(16)表示可变长度字符串，长度为16、</span><br><span class="line"></span><br><span class="line">text表示字符串类型，内部存储text是实际字符数+2个字节。能存储大字符串，最多存储65535字节数据</span><br><span class="line">尽量避免使用BLOB/TEXT类型，查询会使用临时表,导致严重的性能开销。</span><br><span class="line"></span><br><span class="line">请说明varchar和text的区别</span><br><span class="line">varchar可指定字符数，text不能指定，</span><br><span class="line">text类型不能有默认值。</span><br><span class="line">varchar可直接创建索引，text创建索引要指定前多少个字符。</span><br><span class="line">varchar查询速度快于text，在都创建索引的情况下，text的索引几乎不起作用。</span><br><span class="line"></span><br><span class="line">### 枚举类型（ENUM），</span><br><span class="line">把不重复的数据存储为一个预定义的集合。</span><br><span class="line">有时可以使用ENUM代替常用的字符串类型。</span><br><span class="line">ENUM存储非常紧凑，会把列表值压缩到一个或两个字节。</span><br><span class="line">ENUM在内部存储时，其实存的是整数。</span><br><span class="line">尽量避免使用数字作为ENUM枚举的常量，因为容易混乱。</span><br><span class="line">排序是按照内部存储的整数</span><br><span class="line">枚举表会使表大小大大减小</span><br><span class="line"></span><br><span class="line">### 日期和时间类型</span><br><span class="line">尽量使用timestamp，空间效率高于datetime，</span><br><span class="line">用整数保存时间戳通常不方便处理。</span><br><span class="line">如果需要存储微妙，可以使用bigint存储。</span><br><span class="line"></span><br><span class="line">```SELECT CURRENT_DATE();```获取当前日期</span><br><span class="line"></span><br><span class="line">### InnoDB表引擎，默认事务型引擎</span><br><span class="line">数据存储在共享表空间,可以通过配置分开，也就是多个表和索引都存储在一个表空间中，可以通过配置文件改变此配置。</span><br><span class="line">对主键查询的性能高于其他类型的存储引擎</span><br><span class="line">内部做了很多优化,从磁盘读取数据时自动在内存构建hash索引，插入数据时自动构建插入缓冲区</span><br><span class="line">通过一些机制和工具支持真正的热备份</span><br><span class="line">- 支持崩溃后的安全恢复、回滚，适合对数据安全性较高的业务场景</span><br><span class="line">- 支持事务 提供了对数据库ACID事务的支持；</span><br><span class="line">- 支持行级锁和表锁，提供了数据库的并发操作能力，主键有效才能确定扫描范围，行级锁才有效；主键无效不能确定扫描范围</span><br><span class="line">- 支持外键约束，在范式设计的原则下，保证数据的完整性</span><br><span class="line">- 不支持全文索引</span><br><span class="line">- 插入缓冲（insert buffer)</span><br><span class="line">- 二次写(double write)</span><br><span class="line">- 自适应哈希索引(ahi)</span><br><span class="line">- 预读(read ahead)</span><br><span class="line">- 没有保存表的行数</span><br><span class="line"></span><br><span class="line">### MyISAM表引擎</span><br><span class="line">- 表数据的存储分为三个文件</span><br><span class="line">  - ```myisam_table.MYD```存储数据文件</span><br><span class="line">  - ```myisam_table.MYI```存储索引文件，如果索引越多跟的当数据变化时要更新的索引文件也就一个</span><br><span class="line">  - ```myisam_table.frm```存储表结构、表定义</span><br><span class="line">其中```myisam_table```表名称 </span><br><span class="line">- 在进行数据的备份、迁移、恢复等操作时,非常的容易。只要对文件进行操作就可以</span><br><span class="line">- 拥有全文索引、压缩、空间函数</span><br><span class="line">- 不支持外键</span><br><span class="line">- 不支持事务安全，但每次读的操作是具有原子性的，所以不必担心脏读等情况</span><br><span class="line">- 只支持表锁，没有行级锁</span><br><span class="line">- 不支持崩溃后的安全恢复</span><br><span class="line">- 存储了表的行数</span><br><span class="line">- 设计简单，某些场景下性能很好，例如获取整个表有多少条数据，性能很高。</span><br><span class="line">- 全文索引不是很常用，不如使用外部的ElasticSearch或Lucene。</span><br><span class="line"></span><br><span class="line">### 其他表引擎</span><br><span class="line">Archive、Blackhole、CSV、Memory</span><br><span class="line"></span><br><span class="line">### 锁机制</span><br><span class="line">表锁是日常开发当中常见的问题,因此也是面试当中最常见的考察点,</span><br><span class="line">当多个查询同一时刻进行数据修改时,就会产生并发控制的问题</span><br><span class="line"></span><br><span class="line">#### 共享锁和排他锁，其实就是读锁和写锁</span><br><span class="line">读锁：共享的，不堵塞，多个用户可以同时读一个资源，互不干扰。</span><br><span class="line">写锁：排他的，一个写锁会阻塞其他的读锁和写锁，这样可以只允许一个用户进行写入，防止其他用户读取正在写入的资源。</span><br><span class="line"></span><br><span class="line">#### 锁粒度</span><br><span class="line">行锁，最大程度的支持并发处理，但是也带来了最大的锁开销</span><br><span class="line">表锁，系统性能开销最小，会锁定整张表，MyIsam使用表锁。</span><br><span class="line"></span><br><span class="line">### 存储过程</span><br><span class="line">为以后的使用而保存的一条或多条 MySQL语句的集合</span><br><span class="line">存储过程就是有业务逻辑和流程的集合</span><br><span class="line">可以在存储过程中创建表，更新数据，删除等等</span><br><span class="line"></span><br><span class="line">使用场景：</span><br><span class="line">通过把处理封装在容易使用的单元中，简化复杂的操作</span><br><span class="line">保证数据的一致性</span><br><span class="line">简化对变动的管理</span><br><span class="line"></span><br><span class="line">### 触发器</span><br><span class="line">是指一段代码，当触发某个事件时，自动执行这些代码。</span><br><span class="line">提供给程序员和数据分析员来保证数据完整性的一种方法，</span><br><span class="line">它是与表事件相关的特殊的存储过程</span><br><span class="line">使用场景</span><br><span class="line">可通过数据库中的相关表实现级联更改</span><br><span class="line">实时监控某张表中的某个字段的更改而需要做出相应的处理</span><br><span class="line">某些业务编号的生成等</span><br><span class="line">滥用会造成数据库及应用程序的维护困难</span><br><span class="line"></span><br><span class="line">在MySQL数据库中有如下六种</span><br><span class="line">1、Before Insert</span><br><span class="line">2、After Insert</span><br><span class="line">3、Before Update</span><br><span class="line">4、After Update</span><br><span class="line">5、Before Delete</span><br><span class="line">6、After Delete</span><br><span class="line"></span><br><span class="line">十进制的浮点数转换从二进制的浮点数会丢失数据</span><br><span class="line"></span><br><span class="line">IP 该如何保存?</span><br><span class="line">最简单的办法是使用字符串（varchar）来保存，如果从效率考虑的话，</span><br><span class="line">可以将ip 保存为整型（unsigned int），</span><br><span class="line">使用 mysql 提供的函数将 ip 转换为整型，然后存储即可。</span><br><span class="line">MySQL 函数：inet_aton()和 inet_ntoa</span><br><span class="line"></span><br><span class="line">为什么要进行数据库优化</span><br><span class="line">1、避免网站出现访问错误</span><br><span class="line">1）数据库链接timout产生页面5xx错误</span><br><span class="line">2）慢查询造成的页面无法加载</span><br><span class="line">3）阻塞造成数据无法提交</span><br><span class="line">2、增加数据库的稳定性</span><br><span class="line">1）很多数据库问题都是由于低效的查询引起的</span><br><span class="line">2）随着时间的推移，系统变得极其臃肿，数据库中的数据越来越大，数据检索越来越困难，整个系统带来的资源消耗就越来越大，系统越发不稳定</span><br><span class="line">3、优化用户体验</span><br><span class="line">1）流畅的页面访问速度</span><br><span class="line">2）良好的网站功能体验</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql数据库优化层面</span><br><span class="line"></span><br><span class="line">1、商业需求层面</span><br><span class="line"></span><br><span class="line">1）不合理需求造成资源投入产出比过低</span><br><span class="line"></span><br><span class="line">2）无用的功能堆积使得系统过度繁杂，影响整体新能</span><br><span class="line"></span><br><span class="line">&nbsp;</span><br><span class="line"></span><br><span class="line">2、系统架构层面</span><br><span class="line"></span><br><span class="line">1）数据库中存放的数据都是适合在数据库中存放么？</span><br><span class="line"></span><br><span class="line">#例如多媒体文件,寻找第三方存储服务器，例如fastdfs，oss</span><br><span class="line"></span><br><span class="line">#流水队列数据，不断的insert update会不停的膨胀，日志不停的翻倍堆积，解决方式：消息队列削峰</span><br><span class="line"></span><br><span class="line">#超大文本数据，性能低下和空间占用问题</span><br><span class="line"></span><br><span class="line">2）合理利用应用层的Cache机制</span><br><span class="line"></span><br><span class="line">#活跃的变化较少的数据使用缓存来缓解数据库的压力</span><br><span class="line"></span><br><span class="line">3）数据层实现尽量精简</span><br><span class="line"></span><br><span class="line">#合理的利用索引和函数机制等，解决性能提升</span><br><span class="line"></span><br><span class="line">&nbsp;</span><br><span class="line"></span><br><span class="line">3、SQL及索引优化层面</span><br><span class="line"></span><br><span class="line">1）根据需求写出良好的SQL，并创建有效的索引，实现某一种需求可以有多重写法，我们就要选择一种最高效的写法，SQL优化</span><br><span class="line"></span><br><span class="line">2）SQL优化的目的之一就是减少中间结果集，降低物理IO，例如多表关联查询</span><br><span class="line"></span><br><span class="line">&nbsp;</span><br><span class="line"></span><br><span class="line">4、数据库表结构优化</span><br><span class="line"></span><br><span class="line">1）根据数据库的范式，设计表结构，表结构设计的好坏直接关系到SQL语句的复杂程度</span><br><span class="line"></span><br><span class="line">2）适当的将表进行拆分，原本需要做join的查询，只需要一张单表查询就可以</span><br><span class="line"></span><br><span class="line">&nbsp;</span><br><span class="line"></span><br><span class="line">5、系统配置优化</span><br><span class="line"></span><br><span class="line">1）大多数运行在Linux机器上，如tcp链接数的限制、打开文件数的限制，安全性的限制，因为我们要对这些配置进行相应的优化</span><br><span class="line"></span><br><span class="line">&nbsp;</span><br><span class="line"></span><br><span class="line">6、硬件配置优化</span><br><span class="line"></span><br><span class="line">1）数据库主机的IO性能是最需要优先考虑的因素</span><br><span class="line"></span><br><span class="line">2）数据库主机和普通的应用程序服务器相比，资源要相对集中很多，单台主机上所需要进行的计算量自然也比较多，所以数据库主机的CPU处理能力也是一个重要因素</span><br><span class="line"></span><br><span class="line">3）数据库主机的网络设备（网卡）的性能也可能成为系统的瓶颈</span><br><span class="line"></span><br><span class="line">&nbsp;</span><br><span class="line"></span><br><span class="line">慢查询</span><br><span class="line"></span><br><span class="line">1、检查慢查询开关</span><br><span class="line">show variables like '%slow_query_log%';</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2、设置检查慢开关</span><br><span class="line"></span><br><span class="line">set global slow_query_log=on;</span><br><span class="line"></span><br><span class="line">&nbsp;</span><br><span class="line"></span><br><span class="line">3、慢查日志判断标准</span><br><span class="line"></span><br><span class="line">show variables like 'long_query_time';</span><br><span class="line"></span><br><span class="line">&nbsp;</span><br><span class="line"></span><br><span class="line">4、设置慢查日志时间，以秒为单位</span><br><span class="line"></span><br><span class="line">set global long_query_time=1;</span><br><span class="line">————————————————</span><br><span class="line">版权声明：本文为CSDN博主「power_kai」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。</span><br><span class="line">原文链接：https://blog.csdn.net/popping_kai/article/details/109657749</span><br><span class="line"></span><br><span class="line">解题方法</span><br><span class="line">对于此类考题，先说明如何定位低效SQL语句，然后根据SQL语句可能低效的原因做排查，先从索引着手，如果索引没有问题，考虑以上几个方面，数据访问的问题，长难查询句的问题还是一些特定类型优化的问题，逐一回答。</span><br><span class="line"></span><br><span class="line">请简述项目中优化SQL语句执行效率的方法，从哪些方面，SQL语句性能如何分析？</span><br><span class="line">考点分析：SQL语句查询速度慢的方法</span><br><span class="line">延伸考点：</span><br><span class="line">优化查询过程中的数据访问</span><br><span class="line">优化长难的查询语句</span><br><span class="line">优化特定类型的查询语句</span><br><span class="line"></span><br><span class="line">排查查询速度慢的原因</span><br><span class="line">1. 开启并且查询慢查询日志，慢查询通常是缺少索引，索引不合理或者业务代码实现导致</span><br><span class="line">开启慢查询功能</span><br><span class="line">slow_query_log_file 慢查询日志文件路径</span><br><span class="line">slow_query_log 用于指定是否打开慢查询日志</span><br><span class="line">long_query_time 超过多少秒的查询就写入日志</span><br><span class="line">2. 调整数据修改索引；业务代码层限制不合理访问，如：因为数据类型不匹配导致全表扫描；一次获取太多数据等</span><br><span class="line"></span><br><span class="line">查找分析查询速度慢的原因</span><br><span class="line">1. 记录慢查询日志。分析查询日志，不要直接打开慢查询日志进行分析，这样比较浪费时间和精力，可以使用pt-query-digest工具进行分析</span><br><span class="line">如何排查慢查询？ </span><br><span class="line">2. 使用show profile，通过临时表的主键ID去查一条sql语句是在什么地方发生慢的操作。</span><br><span class="line">```sql</span><br><span class="line">set profiling=1; # 开启，服务器上所有执行语句会记录执行时间，存到临时表中</span><br><span class="line">mysql&gt; show profiles; # 查看临时表</span><br><span class="line">+----------+------------+-------------------+</span><br><span class="line">| Query_ID | Duration   | Query             |</span><br><span class="line">+----------+------------+-------------------+</span><br><span class="line">|        1 | 0.00315025 | SELECT DATABASE() |</span><br><span class="line">|        2 | 0.04271325 | select * from a   |</span><br><span class="line">+----------+------------+-------------------+</span><br><span class="line">2 rows in set, 1 warning (0.00 sec)</span><br></pre></td></tr></tbody></table></figure>

<p>show profile for query 临时表ID，通过临时表的主键ID去查一条sql语句是在什么地方发生慢的操作。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show profile for query 2;</span><br><span class="line">+<span class="comment">----------------------+----------+</span></span><br><span class="line">| Status               | Duration |</span><br><span class="line">+<span class="comment">----------------------+----------+</span></span><br><span class="line">| starting             | 0.001101 |</span><br><span class="line">| checking permissions | 0.000016 |</span><br><span class="line">| Opening tables       | 0.037732 |</span><br><span class="line">| init                 | 0.000040 |</span><br><span class="line">| System <span class="keyword">lock</span>          | <span class="number">0.000021</span> |</span><br><span class="line">| optimizing           | <span class="number">0.000006</span> |</span><br><span class="line">| <span class="keyword">statistics</span>           | <span class="number">0.002043</span> |</span><br><span class="line">| preparing            | <span class="number">0.000025</span> |</span><br><span class="line">| executing            | <span class="number">0.000003</span> |</span><br><span class="line">| Sending <span class="keyword">data</span>         | <span class="number">0.001608</span> |</span><br><span class="line">| <span class="keyword">end</span>                  | <span class="number">0.000006</span> |</span><br><span class="line">| <span class="keyword">query</span> <span class="keyword">end</span>            | <span class="number">0.000007</span> |</span><br><span class="line">| closing <span class="keyword">tables</span>       | <span class="number">0.000013</span> |</span><br><span class="line">| freeing items        | <span class="number">0.000071</span> |</span><br><span class="line">| cleaning up          | <span class="number">0.000022</span> |</span><br><span class="line">+<span class="comment">----------------------+----------+</span></span><br><span class="line"><span class="number">15</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> <span class="keyword">warning</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>

<ol start="3">
<li><p>使用show status<br>show status会返回一些计数器，<br>show global status会查看所有服务器级别的所有计数<br>有时根据这些计数，可以推测出哪些操作代价较高或者消耗时间多</p>
</li>
<li><p>show processlist</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show processlist;</span><br><span class="line">+<span class="comment">----+------+-----------------+------+---------+------+----------+------------------+</span></span><br><span class="line">| Id | User | Host            | db   | Command | Time | State    | Info             |</span><br><span class="line">+<span class="comment">----+------+-----------------+------+---------+------+----------+------------------+</span></span><br><span class="line">|  3 | root | localhost:14778 | test | Query   |    0 | starting | <span class="keyword">show</span> <span class="keyword">processlist</span> |</span><br><span class="line">+<span class="comment">----+------+-----------------+------+---------+------+----------+------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p>观察是否有大量线程处于不正常的状态或特征</p>
</li>
<li><p>使用<code>explain sql语句</code>执行计划 分析查询性能 单条SQL语句、排查索引问题，注意格式化 \G 输出后不需要加分号。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> <span class="keyword">select</span> * <span class="keyword">from</span> ...;</span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p>说明：关于MySQL更多的知识尤其是性能调优和运维方面的内容，推荐大家阅读网易出品的《深入浅出MySQL（第2版）》，网易出品必属精品。</p>
</blockquote>
</li>
</ol>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from a;</span><br><span class="line">+<span class="comment">----+-------------+-------+------------+------+---------------+------+---------+</span></span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len |</span><br><span class="line">+<span class="comment">----+-------------+-------+------------+------+---------------+------+---------+</span></span><br><span class="line">|  1 | SIMPLE      | a     | NULL       | ALL  | NULL          | NULL | NULL    |</span><br><span class="line">+<span class="comment">----+-------------+-------+------------+------+---------------+------+---------+</span></span><br><span class="line">1 row in <span class="keyword">set</span>, <span class="number">1</span> <span class="keyword">warning</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from a\G  -- 注意:格式化输出内容，\G相当于;</span><br><span class="line">*************************** 1. row **********</span><br><span class="line">           id: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: a</span><br><span class="line">   partitions: NULL</span><br><span class="line">         type: ALL</span><br><span class="line">possible_keys: NULL</span><br><span class="line">          key: NULL</span><br><span class="line">      key_len: NULL</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 2</span><br><span class="line">     filtered: 100.00</span><br><span class="line">        Extra: NULL</span><br><span class="line">1 row in <span class="keyword">set</span>, <span class="number">1</span> <span class="keyword">warning</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>

<p><code>explain</code>结果解析：</p>
<h4 id="id列"><a href="#id列" class="headerlink" title="id列"></a>id列</h4><p>数字越大越先执行，如果数字一样大，那么就往从上往下依次执行，id列为null就标识这个是一个结果集，不需要使用它来进行查询</p>
<h4 id="select-type列"><a href="#select-type列" class="headerlink" title="select_type列"></a>select_type列</h4><p>表示select操作的类型，常见的值有SIMPLE（简单查询，没有使用子查询或者表连接查询）、PRIMARY（主查询，外层的查询）、UNION（并集操作中的第二个或者后面的查询）、SUBQUERY（子查询中的第一个SELECT）等。<br>simple:标识不需要union操作或者不包含子查询的简单select查询，有链接查询时，外层的查询为simple，且只有一个<br>primary:一个需要union操作或者含有子查询的select，位于最外层的查询，select_type即为primary，且只有一个<br>union:union连接的两个select查询，第一个查询是dervied派生表，除了第一个表外，第二个以后的表select_type都union<br>union_result:包含union的结果集，在union和union all语句中，因为它不需要参与查询，所以id字段为null<br>dependent_union:与union一样，出现在union或者union all语句中，但是这个查询要受到外部查询的影响 #explain select * from film_category where film_id in (select film_id from film&nbsp; union all select film_id from film_actor)\G</p>
<p>subquery:除了from子句中包含的子查询外，其他地方出现的子查询都可能是subquery</p>
<p>dependent_subquery:与dependent union类似，标识subquery的查询要收到外部表查询的影响</p>
<p>derived:from字段中出现的子查询，也叫做派生表，其他数据库中可能叫做内联视图或者嵌套select</p>
<p>materialization:物化通过将子查询结果作为一个临时表来加快查询速度，正常来说是常驻内存，下次查询会再次引用临时表</p>
<h4 id="table列-输出结果的表。"><a href="#table列-输出结果的表。" class="headerlink" title="table列 输出结果的表。"></a>table列 输出结果的表。</h4><p>显示的查询表明，如果查询使用了别名，那么这里显示的是别名，如果不涉及对数据表的操作，<br>那么这里显示null，如果显示为监控好括起来<derived n="">就表示这个是临时表，后边的N就是<br>执行计划中的id，标识结果来自于这个查询产生，如果是尖括号括起来的&lt;union M,N&gt;，与<derived n="">类似，也是一个临时表，标识这个结果来自于union查询的id为M,N的结果集</derived></derived></p>
<h4 id="type列：MySQL在表中找到所需行的方式，也称为访问类型，常见的值有："><a href="#type列：MySQL在表中找到所需行的方式，也称为访问类型，常见的值有：" class="headerlink" title="type列：MySQL在表中找到所需行的方式，也称为访问类型，常见的值有："></a>type列：MySQL在表中找到所需行的方式，也称为访问类型，常见的值有：</h4><ul>
<li>ALL：全表扫描数据文件（遍历全表找到匹配的行），然后再在server层进行过滤返回符合要求的记录</li>
<li>index：索引全表扫描，（遍历整个索引），把索引从头到尾扫一遍，常见于使用索引列就可以处理不需要读取数据文件的查询，可以使用索引排序或者分组查询</li>
<li>range：索引范围扫描，常见于使用&gt;,&lt;is null,between,in,like等运算符的查询中</li>
<li>ref：非唯一索引扫描或唯一索引的前缀扫描，不像eq_ref那样要求链接顺序，也没有主键和唯一索引的要求，只要使用相等条件检索时就可能出现，常见与服务索引的等值查找或者多列主键、唯一索引中，使用第一个列之外的列作为等值查找也会出现，总之，返回数据不唯一的等值查找就可能出现</li>
<li>eq_ref：唯一索引扫描 出现在要链接多个表的查询计划中，驱动表循环获取数据，这行数据是第二个表的主键或者唯一索引，作为条件查询只返回一条数据，且必须为not null,唯一索引和主键是多列时，所有的列都用作比较时才会出现eq_ref</li>
<li>NULL：不用访问表或者索引</li>
<li>const / system：表中最多有一行匹配<br>system:表中只有一行数据或者是空表，且只能用于myisam和memory表，如果是Innodb引擎，type列在这个情况通常都是all或者index<br>const:使用唯一索引或者主键，返回记录一定是1行记录的等值where条件时，通常type是const，其他数据库也叫做唯一索引扫描</li>
</ul>
<p>fulltext:全文索引检索，全文索引的优先级很高，若全文索引和普通索引同时存在时，mysql不管代价，优先选择使用全文索引<br>ref_on_null:与ref方法类似，只是增加了null值的比较，实际用的不多<br>unique_subquery:用于where中的in形式子查询，子查询返回不重复唯一值<br>index_subquery:用于in形式子查询使用到了辅助索引或者in常数列表，子查询可能返回重复值，可以使用索引将子查询去重<br>index_merge:标识查询使用了两个以上的索引，最后取交际或者并集，常见and，or的条件使用了不同的索引，官方排序这个ref_or_null之后，但是实际上由于要取多个索引，性能可能大部分时间不如range</p>
<p>type列总结<br>依次性能从好到差:system，const，eq_ref,ref,fulltext,ref_or_null,unique_subquery,index,subquery,range,index_merge,index,ALL,除了all之外，其他的type都已使用到索引，除了index_merge之外，取它的type只可以用到一个索引，好的sql查询至少要达到range级别，最好要达到ref级别</p>
<p>&nbsp;</p>
<h4 id="possible-key列：查询时可能用到的索引。"><a href="#possible-key列：查询时可能用到的索引。" class="headerlink" title="possible_key列：查询时可能用到的索引。"></a>possible_key列：查询时可能用到的索引。</h4><p>查询可能使用到的索引</p>
<h4 id="key：实际使用的索引。"><a href="#key：实际使用的索引。" class="headerlink" title="key：实际使用的索引。"></a>key：实际使用的索引。</h4><p>查询真正使用到的索引</p>
<h4 id="key-len列：使用到索引字段的长度。"><a href="#key-len列：使用到索引字段的长度。" class="headerlink" title="key_len列：使用到索引字段的长度。"></a>key_len列：使用到索引字段的长度。</h4><p>用于处理查询的索引长度，如果是单列索引，那就是整个索引长度，如果是多列索引，那么查询不一定都能使用到所有的列，具体使用到了多少个列索引，这里就会计算机进去，没有使用的列不会计算进去，留意下这个列的值，算一下你的多列索引总长度就知道有没有使用到所有列了，另外，key_len自己算where条件用到的索引长度，而排序和分组就算用到了索引，也不会计算到key_len中</p>
<h4 id="ref列"><a href="#ref列" class="headerlink" title="ref列"></a>ref列</h4><p>如果是使用的常数等值查询，这里会显示const，如果是连接查询，被驱动表的执行计划这里会显示驱动表的关联字段，如果是条件使用了表达式或者函数，或者条件列发生了内部隐式转换，这里可能显示为func</p>
<p>&nbsp;</p>
<h4 id="row列：扫描行的数量。"><a href="#row列：扫描行的数量。" class="headerlink" title="row列：扫描行的数量。"></a>row列：扫描行的数量。</h4><p>这里是执行计划中估算的扫描行数，不是精确数值</p>
<p>&nbsp;</p>
<h4 id="extra列：额外的信息（执行情况的说明或描述）"><a href="#extra列：额外的信息（执行情况的说明或描述）" class="headerlink" title="extra列：额外的信息（执行情况的说明或描述）"></a>extra列：额外的信息（执行情况的说明或描述）</h4><p>no table used:不带from字句的查询或者From dual查询</p>
<p>NULL：查询的列未被索引覆盖，并且where筛选条件是索引的前导列，意味着用到了索引，但是部分字段未被索引覆盖，必须通过“回表”来实现，不是纯粹地用到了索引，也不是完全没用到索引</p>
<p>Using where Using index:查询的列被索引覆盖，并且where筛选条件是索引列，但是不是索引的前导列，意味着无法直接通过索引查找来查询到符合条件的数据</p>
<p>Using index condition:与Using where类似，查询的列不完全被索引覆盖，where条件中是一个前导列的范围</p>
<p>Using temporary:标识使用了临时表存储中间结果。临时表可以是内存临时表和磁盘临时表，执行计划中看不出来，需要查看status变量，used_tmp_table,used_tmp_disk_table才能看出来</p>
<p>Using filesort:mysql会对结果使用一个外部索引排序，而不是按索引次序从表里读取行，此时mysql会根据联接类型浏览所有符合条件的记录，并保存排序关键字和行指针，然后排序关键字并按顺序检索信息，这种情况下一般也是要考虑使用索引优化</p>
<p>Using intersect:表示使用and的各个索引的条件，该信息表示从处理结果获得交集</p>
<p>Using union:表示使用or连接各个使用索引的条件时候，该信息表示从处理结果获取并集</p>
<p>Using sort_union和Using sort_intersection:用and和or查询信息量大时，先查询主键，然后进行排序合并后返回结果集</p>
<p>Fistnatcg(tb_name):5.6.X开始引入的优化子查询的新特性之一，常见于where字句含有in()类型的子查询，如果表内的数据量比较大，就可能出现这个</p>
<p>Loosescan(m…n):5.6.x之后引入的优化子查询的新特性之一，在in()类型的子查询中，子查询返回的可能有重复记录时，就可能出现这个</p>
<p>&nbsp;</p>
<h4 id="filtered列"><a href="#filtered列" class="headerlink" title="filtered列"></a>filtered列</h4><p>使用explain extended时会出现这个列，5.7之后的版本默认就有了这个字段，不需要使用explain extended了，这个字段表示存储引擎返回的数据在server层过滤后，剩下多少满足条件的查询记录数据量的比例，注意是百分比，不是具体记录数</p>
<h4 id="join-buffer-size"><a href="#join-buffer-size" class="headerlink" title="join_buffer_size"></a>join_buffer_size</h4><p>mysql连接缓冲区的大小，这个是在关联时候必不可少的，主要是控制关联时候加载驱动表的数据进入到缓冲区大小，如果缓冲区开辟的越大，说明存储的表偏移量数据越多，查询效率越快</p>
<h4 id="缓冲区处理零时临时处理数据的大小"><a href="#缓冲区处理零时临时处理数据的大小" class="headerlink" title="缓冲区处理零时临时处理数据的大小"></a>缓冲区处理零时临时处理数据的大小</h4><p>show rariables like ‘%sort_buffer_size%’;</p>
<h4 id="二次读取缓冲区的大小"><a href="#二次读取缓冲区的大小" class="headerlink" title="二次读取缓冲区的大小"></a>二次读取缓冲区的大小</h4><p>show rariables like ‘%read_rnd_buffer_size%’;</p>
<p>优化查询过程中的数据访问<br>访问数据太多导致查询性能下降<br>确定应用程序是否在检索大量超过需要的数据，可能是太多行或列<br>确认MySQL服务器是否在分析大量不必要的数据行<br>避免犯如下SQL语句错误<br>查询不需要的数据。解决办法：使用limit解决<br>多表关联返回全部列。解决办法：指定列名<br>总是返回全部列。解决办法：避免使用 SELECT *<br>重复查询相同的数据。解决办法：可以缓存数据，下次直接读取缓存<br>是否在扫描额外的记录。解决办法：<br>使用explain进行分析，如果发现查询需要扫描大量的数据，但只返回少数的行，可以通过如下技巧去优化：<br>使用索引覆盖扫描，把所有的列都放到索引中，这样存储引擎不需要回表获取对应行就可以返回结果。<br>改变数据库和表的结构，修改数据表范式<br>重写SQL语句，让优化器可以以更优的方式执行查询。</p>
<p>优化长难的查询语句<br>一个复杂查询还是多个简单查询<br>MySQL内部每秒能扫描内存中上百万行数据，相比之下，响应数据给客户端就要慢得多<br>使用尽可能小的查询是好的，但是有时将一个大的查询分解为多个小的查询是很有必要的。<br>切分查询<br>将一个大的查询分为多个小的相同的查询<br>一次性删除1000万的数据要比一次删除1万，暂停一会的方案更加损耗服务器开销。</p>
<p>分解关联查询，<br>将一条关联语句分解成多条SQL来执行<br>让缓存的效率更高。<br>执行单个查询可以减少锁的竞争。<br>在应用层做关联更容易对数据库进行拆分。<br>查询效率会有大幅提升。<br>较少冗余记录的查询。</p>
<p>优化特定类型的查询语句<br>count(列名) 返回指定列的值的数目，包含非空值的记录数<br>会忽略列值为空（这里的空不是只空字符串或者0，而是表示null）的计数，<br>&nbsp;即某个字段值为NULL时，不统计。<br>count(字段) 会统计该字段在表中出现的次数，忽略字段为null 的情况。即&nbsp;不统计字段为null 的记录。&nbsp;&nbsp;<br>count(*)会忽略所有的列，直接统计所有列数，相当于行数，不会忽略列值为NULL&nbsp;&nbsp;比count(列名)效率高</p>
<p>返回表中包含空值的记录数<br>count(1) 会统计表中的所有的记录数，包含字段为null 的记录<br>包括了忽略所有列，用1代表代码行，<br>COUNT(DISTINCT column_name) 函数返回指定列的不同值的数目、<br>不重复的记录条数</p>
<p>GROUP BY product_type<br>HAVING count(*) &gt; 1 #分组内的化为一行的数量</p>
<p>MyISAM中，没有任何where条件的count(<em>)非常快。<br>当有where条件时，MyISAM的count统计不一定比其它引擎快。<br>可以使用explain查询近似值，用近似值替代count(</em>)<br>增加汇总表<br>使用缓存</p>
<p>优化GROUP BY和DISTINCT<br>这两种查询据可以使用索引来优化，是最有效的优化方法<br>关联查询中，使用标识列分组的效率更高<br>如果不需要ORDER BY，进行GROUP BY时加ORDER BY NULL，MySQL不会再进行文件排序。<br>WITH ROLLUP超级聚合，可以挪到应用程序处理</p>
<p>优化LIMIT分页<br>LIMIT偏移量大的时候，查询效率较低<br>可以记录上次查询的最大ID，下次查询时直接根据该ID来查询</p>
<p>常规sql优化思路（众多解决方案之一）<br>1、查看slow-log，分析slow-log，分析出查询慢的语句。<br>2、按照一定优先级，进行一个一个的排查所有慢语句。<br>3、分析top sql，进行explain调试，查看语句执行时间。<br>4、调整索引或语句本身。</p>
<p>SQL语句优化的一些方法？<br>1.对查询进行优化，应尽量避免全表扫描，首先应考虑在 where 及 order by 涉及的列上建立索引。<br>2.应尽量避免在 where 子句中对字段进行 null 值判断，否则将导致引擎放弃使用索引而进行全表扫描，如：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> t <span class="keyword">where</span> <span class="keyword">num</span> <span class="keyword">is</span> <span class="literal">null</span></span><br></pre></td></tr></tbody></table></figure>
<p>可以在num上设置默认值0，确保表中num列没有null值，然后这样查询：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> t <span class="keyword">where</span> <span class="keyword">num</span>=</span><br></pre></td></tr></tbody></table></figure>
<p>3.应尽量避免在 where 子句中使用!=或&lt;&gt;操作符，否则引擎将放弃使用索引而进行全表扫描。<br>4.应尽量避免在 where 子句中使用or 来连接条件，否则将导致引擎放弃使用索引而进行全表扫描，如：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> t <span class="keyword">where</span> <span class="keyword">num</span>=<span class="number">10</span> <span class="keyword">or</span> <span class="keyword">num</span>=<span class="number">20</span></span><br></pre></td></tr></tbody></table></figure>
<p>可以这样查询：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> </span><br><span class="line"><span class="keyword">from</span> t </span><br><span class="line"><span class="keyword">where</span> <span class="keyword">num</span>=<span class="number">10</span> </span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> t <span class="keyword">where</span> <span class="keyword">num</span>=<span class="number">20</span></span><br></pre></td></tr></tbody></table></figure>

<p>5.in 和 not in 也要慎用，否则会导致全表扫描，如：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> t <span class="keyword">where</span> <span class="keyword">num</span> <span class="keyword">in</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>) </span><br></pre></td></tr></tbody></table></figure>
<p>对于连续的数值，能用 between 就不要用 in 了：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> t <span class="keyword">where</span> <span class="keyword">num</span> <span class="keyword">between</span> <span class="number">1</span> <span class="keyword">and</span> <span class="number">3</span></span><br></pre></td></tr></tbody></table></figure>

<p>6.下面的查询也将导致全表扫描：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> t <span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">like</span> <span class="string">'%李%'</span></span><br></pre></td></tr></tbody></table></figure>
<p>若要提高效率，可以考虑全文检索。</p>
<ol start="7">
<li>如果在 where 子句中使用参数，也会导致全表扫描。因为SQL只有在运行时才会解析局部变量，但优化程序不能将访问计划的选择推迟到运行时；它必须在编译时进行选择。然而，如果在编译时建立访问计划，变量的值还是未知的，因而无法作为索引选择的输入项。如下面语句将进行全表扫描：<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> t <span class="keyword">where</span> <span class="keyword">num</span>=@<span class="keyword">num</span></span><br></pre></td></tr></tbody></table></figure>
可以改为强制查询使用索引：<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> t <span class="keyword">with</span>(<span class="keyword">index</span>(索引名)) <span class="keyword">where</span> <span class="keyword">num</span>=@<span class="keyword">num</span></span><br></pre></td></tr></tbody></table></figure>

</li>
</ol>
<p>8.应尽量避免在 where 子句中对字段进行表达式操作，这将导致引擎放弃使用索引而进行全表扫描。如：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> t <span class="keyword">where</span> <span class="keyword">num</span>/<span class="number">2</span>=<span class="number">100</span></span><br></pre></td></tr></tbody></table></figure>
<p>应改为:</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> t <span class="keyword">where</span> <span class="keyword">num</span>=<span class="number">100</span>*<span class="number">2</span></span><br></pre></td></tr></tbody></table></figure>

<p>9.应尽量避免在where子句中对字段进行函数操作，这将导致引擎放弃使用索引而进行全表扫描。如：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> t <span class="keyword">where</span> <span class="keyword">substring</span>(<span class="keyword">name</span>,<span class="number">1</span>,<span class="number">3</span>)=<span class="string">'abc'</span></span><br></pre></td></tr></tbody></table></figure>
<p>name以abc开头的id应改为:</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> t <span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">like</span> <span class="string">'abc%'</span></span><br></pre></td></tr></tbody></table></figure>

<p>10.不要在 where 子句中的“=”左边进行函数、算术运算或其他表达式运算，否则系统将可能无法正确使用索引。</p>
<p>分区表的工作原理<br>对用户而言，分区表是一个独立的逻辑表，但是底层MySQL将其分成了多个物理子表，这对用户来说是透明的，每一个分区表都会使用一个独立的表文件。</p>
<p>如图所示：MySQL将表分成多个物理字表，但PHP客户端并无感知，仍然认为操作的是一个表。</p>
<p>创建表时使用partition by子句定义每个分区存放的数据，执行查询时，优化器会根据分区定义过滤那些没有需要的数据的分区，这样只需要查询数据所在分区即可。</p>
<p>这样子表相对于未分区的表来说占用空间小，数据量更小，因此操作速度更快。</p>
<p>分区的主要目的是将数据按照一个较粗的粒度分在不同的表中，这样可以将相关的数据存放在一起，而且如果想一次性的删除整个分区的数据也和方便。</p>
<p>适用场景<br>1、表非常大，无法全部存在内存，或者只在表的最后有热点数据，其他都是历史数据。<br>2、分区表的数据更易维护，可以对独立的分区进行独立的操作。<br>3、分区表的数据可以分布在不同的机器上，从而高效适用资源。<br>4、可以使用分区表来避免某些特殊的瓶颈<br>5、可以备份和恢复独立的分区<br>限制<br>1、一个表最多只能有1024个分区<br>2、5.1版本中，分区表表达式必须是整数，5.5可以使用列分区<br>3、分区表字段如果有主键和唯一索引列，那么主键列和唯一索引列都必须包含进来<br>4、分区表中无法使用外键约束<br>5、需要对现有表的结构进行修改<br>6、所有分区都必须使用相同的存储引擎<br>7、分区函数中可以使用的函数和表达式会有一些限制<br>8、某些存储引擎不支持分区<br>9、对于MyISAM的分区表，不能使用load index into cache<br>10、对于MyISAM表，使用分区表时需要打开更多的文件描述符</p>
<p>分库分表的工作原理<br>通过一些HASH算法或者工具实现将一张数据表垂直或者水平进行物理切分<br>适用场景<br>1、单表记录条数达到百万或千万级别时<br>2、解决表锁的问题<br>分表方式<br>水平分割：表很大，分割后可以降低在查询时需要读的数据和索引的页数，同时也降低了索引的层数，提高查询次数</p>
<p>适用场景<br>1、表中的数据本身就有独立性，例如表中分表记录各个地区的数据或者不同时期的数据，特别是有些数据常用，有些不常用。<br>2、需要把数据存放在多个介质上。</p>
<p>水平切分的缺点<br>1、给应用增加复杂度，通常查询时需要多个表名，查询所有数据都需UNION操作<br>2、在许多数据库应用中，这种复杂度会超过它带来的优点，查询时会增加读一个索引层的磁盘次数</p>
<p>垂直分表<br>把主键和一些列放在一个表，然后把主键和另外的列放在另一个表中<br>适用场景<br>1、如果一个表中某些列常用，另外一些列不常用<br>2、可以使数据行变小，一个数据页能存储更多数据，查询时减少I/O次数<br>垂直分表缺点<br>管理冗余列，查询所有数据需要join操作</p>
<p>分表缺点<br>有些分表的策略基于应用层的逻辑算法，一旦逻辑算法改变，整个分表逻辑都会改变，扩展性较差<br>对于应用层来说，逻辑算法增加开发成本</p>
<p>MySQL的复制原理及负载均衡<br>MySQL主从复制工作原理<br>在主库上把数据更高记录到二进制日志<br>从库将主库的日志复制到自己的中继日志<br>从库读取中继日志的事件，将其重放到从库数据中</p>
<p>MySQL主从复制解决的问题<br>数据分布：随意开始或停止复制，并在不同地理位置分布数据备份<br>负载均衡：降低单个服务器的压力<br>高可用和故障切换：帮助应用程序避免单点失败<br>升级测试：可以用更高版本的MySQL作为从库</p>
<p>解题方法<br>充分掌握分区分表的工作原理和适用场景，在面试中，此类题通常比较灵活，会给一些现有公司遇到问题的场景，大家可以根据分区分表，MySQL复制、负载均衡的适用场景来根据情况进行回答</p>
<p>问:28：设定网站用户数量在千万级，但是活跃用户数量只有1%，如何通过优化数据库提高活跃用户访问速度？<br>可以使用MySQL的分区，把活跃用户分在一个区，不活跃用户分在另外一个区，本身活跃用户区数据量比较少，因此可以提高活跃用户访问速度。<br>还可以水平分表，把活跃用户分在一张表，不活跃用户分在另一张表，可以提高活跃用户访问速度。</p>
<p>常见的web安全问题,原理和防范措施。安全意识<br>◆SQL注入<br>◆XSS(跨站脚本攻击, Cross-Site Scripting)<br>◆CSRF(跨站请求伪造, Cross- site request forgery)</p>
<p>web 安全一大原则：永远不要相信用户的任何输入<br>对输入参数做好检查(类型和范围)；过滤和转义特殊字符<br>不要直接拼接sql，使用ORM 有安全性考虑，通过传参的形式不会有 sql 注入问题，<br>查询错误信息不要返回给用户，将错误记录到日志，<br>不要明文存储敏感信息。<br>1、定期做数据备份<br>2、不给查询用户root权限，合理分配权限<br>3、关闭远程访问数据库权限<br>4、修改root口令，不用默认口令，使用较复杂的口令<br>5、删除多余的用户<br>6、改变root用户的名称<br>7、限制一般用户浏览其它库<br>8、限制用户对数据文件的访问权限 后端<br>前端的参数检查，权限控制仅仅是为了防止用户错误的输入或访问，稍微会使用浏览器的开发者工具的，都可以绕过，更别说爬虫，</p>
<p>问题29：SQL语句应该考虑哪些安全性？SQL查询的安全方案、MySQL的其它安全设置<br>解题方法<br>SQL安全的优先考虑SQL注入的防护手段。</p>
<p>sql语句是解释性语言，<br>SQL注入的关键是单引号的闭合，</p>
<ul>
<li>通过构造特殊的输入参数传入Web应用，</li>
<li>通常由于程序员未对输入过滤，直接动态拼接 SQL 产生</li>
<li>可以使用开源工具 sqlmap，SQLninja 检测</li>
</ul>
<p>SQL注入（SQLi）是一种注入攻击，可以执行恶意SQL语句。<br>它通过将任意SQL代码插入数据库查询，使攻击者能够完全控制Web应用程序后面的数据库服务器。<br>攻击者可以使用SQL注入漏洞绕过应用程序安全措施；<br>可以绕过网页或Web应用程序的身份验证和授权，并检索整个SQL数据库的内容；<br>还可以使用SQL注入来添加，修改和删除数据库中的记录。</p>
<p>1、使用预处理语句防止SQL注入，</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">id</span> = ?</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">SQL注入代码演示示例</span></span><br><span class="line"><span class="string">    1）创建users表和插入相应信息</span></span><br><span class="line"><span class="string">`</span><span class="string">``</span><span class="keyword">sql</span></span><br><span class="line"> <span class="comment">--  创建users数据表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`users`</span>(</span><br><span class="line">    <span class="string">`id`</span> <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    <span class="string">`name`</span> <span class="built_in">VARCHAR</span>(<span class="number">45</span>) <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`email`</span> <span class="built_in">VARCHAR</span>(<span class="number">45</span>) <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`password`</span> <span class="built_in">VARCHAR</span>(<span class="number">45</span>) <span class="literal">NULL</span>,</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line"> <span class="comment">-- 插入users表三条数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">users</span> (<span class="keyword">name</span>,email,<span class="keyword">password</span>) <span class="keyword">values</span> (<span class="string">'zhangsan'</span>,<span class="string">'zhangsan@qq.com'</span>,<span class="keyword">md5</span>(<span class="string">'zhangsan123'</span>));</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">users</span> (<span class="keyword">name</span>,email,<span class="keyword">password</span>) <span class="keyword">values</span> (<span class="string">'lisi'</span>,<span class="string">'lisi@qq.com'</span>,<span class="keyword">md5</span>(<span class="string">'lisi123'</span>));</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">users</span> (<span class="keyword">name</span>,email,<span class="keyword">password</span>) <span class="keyword">values</span> (<span class="string">'wangwu'</span>,<span class="string">'wangwu@qq.com'</span>,<span class="keyword">md5</span>(<span class="string">'wangwu123'</span>));</span><br></pre></td></tr></tbody></table></figure>

<p> 2） 存在SQL漏洞代码示例：在终端下输入名称和密码然后查询用户信息</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sql_inject_demo.py</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> MySQLdb   <span class="comment"># pip install mysqlclient</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 新建数据库链接</span></span><br><span class="line">db = MySQLdb.connect(</span><br><span class="line">    host=<span class="string">'localhost'</span>,</span><br><span class="line">    user=<span class="string">'root'</span>,</span><br><span class="line">    passwd=<span class="string">'123456'</span>,</span><br><span class="line">    db=<span class="string">'test'</span></span><br><span class="line">)</span><br><span class="line">cur = db.cursor()</span><br><span class="line"> </span><br><span class="line">name = input(<span class="string">'Enter name: '</span>)</span><br><span class="line">print(<span class="string">'您输入的用户name是: {}'</span>.format(name))</span><br><span class="line">password = input(<span class="string">'Enter password：'</span>)</span><br><span class="line">print(<span class="string">'您输入的密码是: {}'</span>.format(password))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接拼接 sql 参数,使用md5的 password</span></span><br><span class="line">sql = <span class="string">"SELECT * FROM users WHERE name='"</span> + name + <span class="string">"'"</span>+<span class="string">"AND password=md5('"</span> + password + <span class="string">"')"</span></span><br><span class="line">print(sql)</span><br><span class="line">cur.execute(sql)</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> cur.fetchall():</span><br><span class="line">    print(<span class="string">'查询结果：'</span>, row)</span><br><span class="line"><span class="comment"># 关闭连接</span></span><br><span class="line">db.close()</span><br></pre></td></tr></tbody></table></figure>

<p> 3）SQL注入演示结果<br>运行后再终端输入</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 输入正确的用户名和密码</span></span><br><span class="line">Enter name: lisi</span><br><span class="line">您输入的用户name是: lisi</span><br><span class="line">Enter password：lisi123</span><br><span class="line">您输入的密码是: lisi123</span><br><span class="line">SELECT * FROM users WHERE name='lisi'AND password=md5('lisi123')</span><br><span class="line">查询结果：(2, 'lisi', 'lisi@qq.com', 'c3cb6d12c40908943b64bc0681af47db')</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 输出错误密码</span></span><br><span class="line">Enter name: lisi</span><br><span class="line">您输入的用户name是: lisi</span><br><span class="line">Enter password：1234</span><br><span class="line">您输入的密码是: 1234</span><br><span class="line">SELECT * FROM users WHERE name='lisi'AND password=md5('1234')</span><br><span class="line"><span class="meta">#</span><span class="bash"> 没有返回查询结果用户信息的一行，说明密码不正确</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 因为代码有sql注入漏洞，在用户名后面加入中线，这里还输错误密码，</span></span><br><span class="line">Enter name: lisi' -- '   # -- 中线前后都有空格，中线在sql语句中表示注释 ，--后面的部分当作注释，不起作用</span><br><span class="line">您输入的用户name是: lisi' -- '</span><br><span class="line">Enter password：123456 </span><br><span class="line">您输入的密码是: 123456</span><br><span class="line">SELECT * FROM users WHERE name='lisi' -- ''AND password=md5('123456')</span><br><span class="line">查询结果：(2, 'lisi', 'lisi@qq.com', 'c3cb6d12c40908943b64bc0681af47db')</span><br><span class="line"><span class="meta">#</span><span class="bash"> 还是返回查询结果，这里就是通过SQL注入方式绕过网站的安全验证</span></span><br></pre></td></tr></tbody></table></figure>

<p>4）怎么修复sql注入问题，其实只要把使用拼接的地方直接换成占位符就可以</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 只需要修改成以下方式</span></span><br><span class="line">sql = <span class="string">"SELECT * from users WHERE name=%s and password=md5(%s)"</span></span><br><span class="line">print(sql)</span><br><span class="line">cur.execute(sql, (name, password)) <span class="comment"># execute它会自动执行转义操作</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Enter name: lisi' -- '</span><br><span class="line">您输入的用户name是: lisi' -- '</span><br><span class="line">Enter password：123456</span><br><span class="line">您输入的密码是: 123456</span><br><span class="line">SELECT * from users WHERE name=%s and password=md5(%s)</span><br><span class="line"><span class="meta">#</span><span class="bash"> 没有返回查询结果用户信息的一行，说明密码不正确，并没有像上面的一样绕过安全验证</span></span><br></pre></td></tr></tbody></table></figure>

<p>数据库的三大范式：<br>第一范式:  每一列都不可以再拆分；<br>第二范式：在第一范式的基础上，非主键列完全依赖于主键，而不是主键的一部分。<br>第三范式：在第二范式的基础上，非主键完全依赖于主键，而不是其他的非主键。关联性，每列都与主键有直接关系,不存在传递依赖</p>
<p><code>select version();</code>查询数据库版本<br><code>select database();</code>查询数据库名</p>
<ol>
<li>数据类型为int(11)，注意到后面的数字11，这表示的是该数据类型指定的显示宽度，指定能够显示的数值中数字的个数。其他数据类型也可以在定义表结构的时候指定所需要的显示宽度，如果不指定，则系统为每一种类型指定默认的宽度。</li>
<li>MySQL使用浮点数和定点数表示小数。单精度浮点类型有两种：单精度浮点型(float)和双精度浮点型(double)。定点类型只有一种：decimal。浮点类型和定点类型都可以用(M，N)来表示，其中M称为进度，表示总共的位数；N称为标度，表示的是小数的位数。</li>
<li>不论是定点还是浮点类型，如果用户指定的进度超出了进度范围，这回四舍五入进行处理。</li>
<li>浮点数相对于定点数的有点是在长度一定的情况下，浮点数能够表示更大的数据范围，它的缺点是会引起进度问题。</li>
<li>MySQL中，定点数以字符串的形式存储，在对进度要求比较高的时候(比如货币和科学计算)使用decimal的类型比较好，另外两个浮点数进行减法和比较运算时也容易出现问题，所以在使用浮点型时需要注意，尽避免做浮点数比较。</li>
<li>保存为YEAR类型时，既可以传入整型，也可以传入字符型。若是插入超过了YEAR类型的取值范围，值将被转换为2000。</li>
<li>保存为TIME类型时，如果不合法，存储时将变为00:00:00。</li>
<li>可以使用字符串类型或者数字类型的数据插入DATE类型数据，只要符合DATE的日期格式即可。</li>
<li>MySQL允许“不严格”的语法：任何标点符号都可以用作日期部分之间的间隔符。例如“98-10-19”、“98.10.18”、“98/10/19”和“98@10@19@”都是等价的，这些字也是可以正确的插入到数据库的。</li>
<li>插入DATETIME类型数据时，可以使用字符串类型和数字类型的数据插入，只要符合DATETIME的日期格式即可。例如：“YYYY-MM-DD HH:MM:SS”、“YYYYMMDDHHMMSS”、或者用数字YYYYMMDDHHMMSS、YYMMDDHHMMSS表示均可。</li>
<li>MySQL允许“不严格”语法：任何标点符号都可以用作日期部分或者时间部分之间的间隔，例如：“98-10-19 12:12:12”、“98.10.19 12+12+12”、“98@10@9 12<em>12</em>12”、“98#10#19 12:12:12”都是等效且被允许的。</li>
<li>字符串类型用来存储字符串数据，除了可以存储字符串数据外，还可以存储其他数据，比如图片、声音的二进制数据。</li>
<li>MySQL至此两类字符型数据：文本字符串和二进制字符串。</li>
<li>VARCHAR、TEXT、BLOB都是变长类型，对于其存储需求取决于列值得实际长度，而不是取决于类型的最大可能长度。例如，一个VARCHAR(10)能保存最大长度为10个字符的一个字符串，实际的存储需要字符串实际长度L加上一个字节(用于记录字符串的长度)。对于字符串“abcd”，L是4，而存储需要5个字节。</li>
<li>CHAR(M)为固定长度的字符串，在定义时指定字符串长度。当保存时在右侧填充空格到指定的长度。M表示列长度，M的范围是0~255个字符。当检索到CHAR值时，尾部的空格将被删除。</li>
<li>VARCHAR(M)是可变长的字符串，M表示最大列长度。M的范围是0~65535.VARCHAR在只保存和检索时尾部的空格人保留。</li>
<li>等于运算符(=)不能用于null的判断，但是安全等于运算符(&lt;=&gt;)可以。</li>
<li>用LIKE匹配字符时：<br>　　“%”匹配任何数目的字符，甚至包括零字符<br>　　“_”只能匹配一个字符。</li>
<li>如果想删除表中所有记录，除了使用DELETE FROM 表名 表名 的方式之外，还可以使用TRUNCATETABLE语句，TRUNCATE将直接删除原来的表，并重新创建一个新的表。TRUNCATE直接说删除表而不是删除记录，因此执行速度比DELETE快。</li>
</ol>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/vue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/vue/" class="post-title-link" itemprop="url">vue</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-07-02 08:17:42" itemprop="dateModified" datetime="2021-07-02T08:17:42Z">2021-07-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Vetur VUE语言包<br>没有安装该插件之前之前编写后缀名为.vue的文件时代码是白色的</p>
<h3 id="广泛使用的前端开发框架"><a href="#广泛使用的前端开发框架" class="headerlink" title="广泛使用的前端开发框架"></a>广泛使用的前端开发框架</h3><p>-PC端网页<br>-移动端H5站点<br>-小程序<br>-App(安卓、ios)</p>
<h3 id="用于开发单页面应用"><a href="#用于开发单页面应用" class="headerlink" title="用于开发单页面应用"></a>用于开发单页面应用</h3><p>-只有一个HTML页面( Single Page web Application,SPA)<br>-使用 JavaScript动态切换HTML内容</p>
<h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ul>
<li>用户体验更好</li>
<li>减轻服务器的压力</li>
<li>前后端完全分离,通过接口( Restful api)进行通信</li>
<li>接口代码的复用</li>
</ul>
<p>1.体积小<br>压缩后33K<br>2.更高的运行效率<br>基于虚拟dom,一种可以预先通过 JavaScript进行各种计算,把最终的DOM操作<br>计算出来并优化的技术,由于这个DOM操作属于预处理操作,并没有真实的操<br>作DOM,所以叫做虚拟DOM<br>3.双向数据绑定<br>让开发者不用再去操作dom对象,把更多的精力投入到业务逻辑上<br>4生态丰富、学习成本低<br>市场上拥有大量成熟、稳定的基于 vue.S的u框架、常用组件!拿来<br>即用实现快速开发!<br>对初学者友好、入门容易、学习资料多;</p>
<p>Vue生态圈<br>-官方维护开发的框架及扩展<br>-第三方UI框架、组件库<br>如:实战中要使用的 VantUI<br>-基于 Node.js的模块<br>-完整的技术文档和学习资料</p>
<p>vue项目</p>
<ul>
<li><p>方式一:引用 vue.js 文件，我们仍然推荐从CDN服务器加载它。</p>
 <figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 本地加载 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./vue.Js&gt;&lt;/script&gt;</span></span></span><br><span class="line"><span class="tag"><span class="string">&lt;!-- CDN加载 --&gt;</span></span></span><br><span class="line"><span class="tag"><span class="string">&lt;script src="</span><span class="attr">https:</span>//<span class="attr">cdn.jsdelivr.net</span>/<span class="attr">npm</span>/<span class="attr">vue</span>"&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>方式二: 使用脚手架 - vue-cli</p>
</li>
</ul>
<p>Vue为商业项目开发提供了非常便捷的脚手架工具vue-cli，通过工具可以省去手工配置开发环境、测试环境和运行环境的步骤，让开发者只需要关注要解决的问题。</p>
<ol>
<li>安装脚手架。</li>
<li>创建项目。</li>
<li>安装依赖包。</li>
<li>运行项目。</li>
</ol>
<p>vue的实例</p>
<ul>
<li><p>示例代码<br><code>var app= new Vue(options)</code></p>
</li>
<li><p><code>el</code>参数<br>挂载到某个HTML标签</p>
</li>
<li><p><code>data</code>参数/属性</p>
<ul>
<li>存放当前组件所需要的数据</li>
<li>它是响应式的,data某一属性改变当值发生改变的同时，视图也会改变，浏览器dom结构当中会自动跟随改变<br>放在data中的属性。</li>
</ul>
</li>
<li><p><code>computed</code>计算属性</p>
<ul>
<li>用于复杂的逻辑</li>
<li>定义的js函数没有形式参数</li>
<li>必须有返回值，使用插值语法，在界面上显示</li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">computed: {</span><br><span class="line">    a() {</span><br><span class="line"></span><br><span class="line">    },</span><br><span class="line">    b() {</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p><code>methods</code>参数，不能少复数的<code>s</code></p>
<ul>
<li>可以直接通过∨ue实例访问的方法</li>
<li>定义的js函数有形式参数，可以相互调用</li>
<li>处理js事件</li>
</ul>
</li>
<li><p><code>template</code>参数</p>
</li>
<li><p>模板,如果不指定,则使用默认的html模板</p>
<ul>
<li>有template参数选项，可以通过 <code>render</code>参数从组建渲染,将其作为模板编译成render函数。</li>
<li>如果没有template选项，则将外部HTML作为模板编译。</li>
<li>template中的模板优先级要高于outer HTML的优先级。</li>
</ul>
</li>
</ul>
<p>MVVM架构<br>       View Model<br>View  DOM Listeners =&gt; model<br>(DOM)  Directives       JavaScript Object<br>        DOM操作</p>
<p>Vue.js中 ViewModel层处理了DOM的操作，使我们的开发更简单</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue实现<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/vue.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>表单操作<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- v-model, @click都是vue.js的属性  --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">v-model</span>=<span class="string">"username"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 点击事件--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"提交"</span> @<span class="attr">click</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>{{ uname }}<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>动态列表<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"加载"</span> @<span class="attr">click</span>=<span class="string">"load"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"item in dataList"</span>&gt;</span>{{item}}<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> app = <span class="keyword">new</span> Vue({</span></span><br><span class="line"><span class="javascript">            el: <span class="string">"#app"</span>,  <span class="comment">// Vue实例接管el指定的标签id ="app"当中所有的内容</span></span></span><br><span class="line"><span class="javascript">            data: { <span class="attr">username</span>: <span class="string">'admin'</span>, <span class="attr">dataList</span>: [] },</span></span><br><span class="line">            computed: {</span><br><span class="line">                uname() {</span><br><span class="line"><span class="javascript">                    <span class="comment">// 类方法中的this指向类的实例</span></span></span><br><span class="line"><span class="javascript">                    <span class="keyword">return</span> <span class="built_in">this</span>.username[<span class="number">0</span>] + <span class="string">"***"</span></span></span><br><span class="line">                }</span><br><span class="line">            },</span><br><span class="line">            methods: {</span><br><span class="line">                submit() {</span><br><span class="line"><span class="javascript">                    <span class="built_in">console</span>.log(<span class="string">"获取表单的值："</span>, <span class="built_in">this</span>.username)</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">this</span>.load()</span></span><br><span class="line">                },</span><br><span class="line">                load() {</span><br><span class="line"><span class="javascript">                    <span class="built_in">this</span>.dataList = [<span class="string">'Beijing'</span>, <span class="string">'Shanghai'</span>, <span class="string">'Guangzhou'</span>, <span class="string">'Shenzhen'</span>]</span></span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        })</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>在通过live server在浏览器中，F12或右键inspector-console，<br>点击提交按钮，控制台会输出<code>获取表单的值： admin</code><br>页面会加载’Beijing’, ‘Shanghai’, ‘Guangzhou’, ‘Shenzhen’</p>
<h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><p>对于一个程序或Vue.js中的一个实例来说，其生命周期经过一系列的初始化过程开始创建，<br>一个程序本身和程序中的每一个实例和组件都存在生命周期。<br>生命周期：就是从一个组件或实例开始初始化、创建实例到该实例被销毁的过程。</p>
<p>在这个生命周期之间，进行初始化事件，进行数据的观测，可以看到在created的时候数据已经和data属性进行绑定<br>每个 Vue 实例在被创建时都要经过一系列的初始化过程——例如，需要设置数据监听、编译模板、将实例挂载到 DOM 并在数据变化时更新 DOM 等。同时在这个过程中也会运行一些叫做生命周期钩子的函数，这给了用户在不同阶段添加自己的代码的机会。</p>
<h3 id="钩子函数-不能使用箭头函数"><a href="#钩子函数-不能使用箭头函数" class="headerlink" title="钩子函数 不能使用箭头函数"></a>钩子函数 不能使用箭头函数</h3><p>Vue实例从创建到销毁的过程中 ，这些过程中会伴随着一些函数的自调用，在某一个时间点Vue实例会自动执行的函数称为钩子函数。<br>为什么叫做钩子呢？原因是对于某个实例事件发生后需要响应已经预设好的代码，即某一个钩子钩住了一个实例的状态或者事件。</p>
<ol>
<li><p>beforeCreate<br>在实例初始化之后，数据观测 (data observer) 和 event/watcher 事件配置之前被调用。此时的 data 和 methods 中的 数据都还没有没初始化。</p>
</li>
<li><p>created<br>在实例创建完成后被立即调用。在这一步，实例已完成以下的配置：数据观测 (data observer)，属性和方法的运算，watch/event 事件回调。也就是此时 data 和 methods已经初始化完成了。然而，挂载阶段还没开始，<code>$el</code> 属性目前尚不可用。 页面还没有渲染出来。<br>注意：<br>如果要调用 methods 中的方法，或者操作 data 中的数据，最早只能在 created 中进行操作。</p>
</li>
<li><p>beforeMount</p>
</li>
</ol>
<ul>
<li>如果有<code>el</code>和<code>template</code>，在挂载开始之前被调用。此时页面上还看不到真实的数据，因为模板在内存中编译完成了，但是还没有把模板渲染到页面中。<br>注意：<br>在 beforeMount 执行的时候，页面中的元素还没有被真正替换过来，显示的是之前写的一些模板字符串。</li>
</ul>
<p>以下代码在浏览器显示是一级标题的test，<code>template: '&lt;h1&gt;test&lt;/h1&gt;'</code>替换了<code>el: '#app'</code>也就是替换了<code>id="app"</code>为<code>&lt;div&gt;</code>的所有内容</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue实现<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/vue.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>表单操作<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">v-model</span>=<span class="string">"username"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"提交"</span> @<span class="attr">click</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>动态列表<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"加载"</span> @<span class="attr">click</span>=<span class="string">"load"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue({  <span class="comment">// app是全局变量，在浏览器控制台输入app可以访问到此象</span></span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line"><span class="handlebars"><span class="xml">        template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>test<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>',</span></span></span><br><span class="line">        data: {</span><br><span class="line"><span class="javascript">            username: <span class="string">'admin'</span>,</span></span><br><span class="line">            dataList: []</span><br><span class="line">        },</span><br><span class="line">        methods: {</span><br><span class="line">            submit() {</span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">'获取表单的值：'</span>, <span class="built_in">this</span>.username)</span></span><br><span class="line">            },</span><br><span class="line">            load() {</span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.dataList = [<span class="string">'北京'</span>, <span class="string">'上海'</span>, <span class="string">'广州'</span>, <span class="string">'深圳'</span>]</span></span><br><span class="line">            }</span><br><span class="line">        },</span><br><span class="line"><span class="javascript">        beforeCreate() {  <span class="comment">// 没有箭头函数</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeCreate'</span>)</span></span><br><span class="line"><span class="javascript">            <span class="comment">// console.log(this.load())</span></span></span><br><span class="line">        },</span><br><span class="line"><span class="javascript">        <span class="comment">// beforeCreate: () =&gt; {</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//   console.log('beforeCreate')</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//   // console.log(this.load())</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// },</span></span></span><br><span class="line">        created() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'created'</span>)</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="built_in">this</span>.load())</span></span><br><span class="line">        },</span><br><span class="line">        beforeMount() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeMount'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        mounted() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'mounted'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        beforeDestroy() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeDestroy'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        destroyed() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'destroyed'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        beforeUpdate() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeUpdate'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        updated() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'updated'</span>)</span></span><br><span class="line">        }</span><br><span class="line">    })</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">beforeCreate</span></span><br><span class="line"><span class="selector-tag">created</span></span><br><span class="line"><span class="selector-tag">undefined</span></span><br><span class="line"><span class="selector-tag">beforeMount</span></span><br><span class="line"><span class="selector-tag">mounted</span></span><br><span class="line"><span class="selector-tag">indexVue</span><span class="selector-class">.html</span><span class="selector-pseudo">:98</span> <span class="selector-tag">Live</span> <span class="selector-tag">reload</span> <span class="selector-tag">enabled</span>.</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>如果没有<code>el</code>，浏览器显示<code>id="app"</code>为<code>&lt;div&gt;</code>的所有内容</li>
</ul>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue实现<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/vue.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>表单操作<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">v-model</span>=<span class="string">"username"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"提交"</span> @<span class="attr">click</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>动态列表<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"加载"</span> @<span class="attr">click</span>=<span class="string">"load"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue({  <span class="comment">// app是全局变量，在浏览器控制台输入app可以访问到此象</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// el: '#app',</span></span></span><br><span class="line"><span class="handlebars"><span class="xml">        template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>test<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>',</span></span></span><br><span class="line">        data: {</span><br><span class="line"><span class="javascript">            username: <span class="string">'admin'</span>,</span></span><br><span class="line">            dataList: []</span><br><span class="line">        },</span><br><span class="line">        methods: {</span><br><span class="line">            submit() {</span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">'获取表单的值：'</span>, <span class="built_in">this</span>.username)</span></span><br><span class="line">            },</span><br><span class="line">            load() {</span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.dataList = [<span class="string">'北京'</span>, <span class="string">'上海'</span>, <span class="string">'广州'</span>, <span class="string">'深圳'</span>]</span></span><br><span class="line">            }</span><br><span class="line">        },</span><br><span class="line"><span class="javascript">        beforeCreate() {  <span class="comment">// 没有箭头函数</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeCreate'</span>)</span></span><br><span class="line"><span class="javascript">            <span class="comment">// console.log(this.load())</span></span></span><br><span class="line">        },</span><br><span class="line"><span class="javascript">        <span class="comment">// beforeCreate: () =&gt; {</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//   console.log('beforeCreate')</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//   // console.log(this.load())</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// },</span></span></span><br><span class="line">        created() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'created'</span>)</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="built_in">this</span>.load())</span></span><br><span class="line">        },</span><br><span class="line">        beforeMount() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeMount'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        mounted() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'mounted'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        beforeDestroy() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeDestroy'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        destroyed() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'destroyed'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        beforeUpdate() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeUpdate'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        updated() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'updated'</span>)</span></span><br><span class="line">        }</span><br><span class="line">    })</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight actionscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">beforeCreate</span><br><span class="line">created</span><br><span class="line"><span class="literal">undefined</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>如果没有<code>el</code>，在手动<code>$mount('#app')</code>指定挂载到</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue实现<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/vue.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>表单操作<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">v-model</span>=<span class="string">"username"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"提交"</span> @<span class="attr">click</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>动态列表<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"加载"</span> @<span class="attr">click</span>=<span class="string">"load"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue({  <span class="comment">// app是全局变量，在浏览器控制台输入app可以访问到此象</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// el: '#app',</span></span></span><br><span class="line"><span class="handlebars"><span class="xml">        template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>test<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>',</span></span></span><br><span class="line">        data: {</span><br><span class="line"><span class="javascript">            username: <span class="string">'admin'</span>,</span></span><br><span class="line">            dataList: []</span><br><span class="line">        },</span><br><span class="line">        methods: {</span><br><span class="line">            submit() {</span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">'获取表单的值：'</span>, <span class="built_in">this</span>.username)</span></span><br><span class="line">            },</span><br><span class="line">            load() {</span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.dataList = [<span class="string">'北京'</span>, <span class="string">'上海'</span>, <span class="string">'广州'</span>, <span class="string">'深圳'</span>]</span></span><br><span class="line">            }</span><br><span class="line">        },</span><br><span class="line"><span class="javascript">        beforeCreate() {  <span class="comment">// 没有箭头函数</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeCreate'</span>)</span></span><br><span class="line"><span class="javascript">            <span class="comment">// console.log(this.load())</span></span></span><br><span class="line">        },</span><br><span class="line"><span class="javascript">        <span class="comment">// beforeCreate: () =&gt; {</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//   console.log('beforeCreate')</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//   // console.log(this.load())</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// },</span></span></span><br><span class="line">        created() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'created'</span>)</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="built_in">this</span>.load())</span></span><br><span class="line">        },</span><br><span class="line">        beforeMount() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeMount'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        mounted() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'mounted'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        beforeDestroy() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeDestroy'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        destroyed() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'destroyed'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        beforeUpdate() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeUpdate'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        updated() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'updated'</span>)</span></span><br><span class="line">        }</span><br><span class="line"><span class="javascript">    }).$mount(<span class="string">'#app'</span>)</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">indexVue</span><span class="selector-class">.html</span><span class="selector-pseudo">:37</span> <span class="selector-tag">beforeCreate</span></span><br><span class="line"><span class="selector-tag">indexVue</span><span class="selector-class">.html</span><span class="selector-pseudo">:45</span> <span class="selector-tag">created</span></span><br><span class="line"><span class="selector-tag">indexVue</span><span class="selector-class">.html</span><span class="selector-pseudo">:46</span> <span class="selector-tag">undefined</span></span><br><span class="line"><span class="selector-tag">indexVue</span><span class="selector-class">.html</span><span class="selector-pseudo">:49</span> <span class="selector-tag">beforeMount</span></span><br><span class="line"><span class="selector-tag">indexVue</span><span class="selector-class">.html</span><span class="selector-pseudo">:52</span> <span class="selector-tag">mounted</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>如果没有<code>template</code>和<code>el</code>属性，浏览器显示<code>id="app"</code>为<code>&lt;div&gt;</code>的所有内容</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue实现<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/vue.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>表单操作<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">v-model</span>=<span class="string">"username"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"提交"</span> @<span class="attr">click</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>动态列表<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"加载"</span> @<span class="attr">click</span>=<span class="string">"load"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue({  <span class="comment">// app是全局变量，在浏览器控制台输入app可以访问到此象</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// el: '#app',</span></span></span><br><span class="line"><span class="handlebars"><span class="xml">        // template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>test<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>',</span></span></span><br><span class="line">        data: {</span><br><span class="line"><span class="javascript">            username: <span class="string">'admin'</span>,</span></span><br><span class="line">            dataList: []</span><br><span class="line">        },</span><br><span class="line">        methods: {</span><br><span class="line">            submit() {</span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">'获取表单的值：'</span>, <span class="built_in">this</span>.username)</span></span><br><span class="line">            },</span><br><span class="line">            load() {</span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.dataList = [<span class="string">'北京'</span>, <span class="string">'上海'</span>, <span class="string">'广州'</span>, <span class="string">'深圳'</span>]</span></span><br><span class="line">            }</span><br><span class="line">        },</span><br><span class="line"><span class="javascript">        beforeCreate() {  <span class="comment">// 没有箭头函数</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeCreate'</span>)</span></span><br><span class="line"><span class="javascript">            <span class="comment">// console.log(this.load())</span></span></span><br><span class="line">        },</span><br><span class="line"><span class="javascript">        <span class="comment">// beforeCreate: () =&gt; {</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//   console.log('beforeCreate')</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">//   // console.log(this.load())</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// },</span></span></span><br><span class="line">        created() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'created'</span>)</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="built_in">this</span>.load())</span></span><br><span class="line">        },</span><br><span class="line">        beforeMount() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeMount'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        mounted() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'mounted'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        beforeDestroy() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeDestroy'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        destroyed() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'destroyed'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        beforeUpdate() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeUpdate'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        updated() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'updated'</span>)</span></span><br><span class="line">        }</span><br><span class="line"><span class="javascript">    }).$mount(<span class="string">'#app'</span>)</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight mipsasm"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">beforeCreate</span></span><br><span class="line"><span class="keyword">created</span></span><br><span class="line"><span class="keyword">undefined</span></span><br><span class="line"><span class="keyword">beforeMount</span></span><br><span class="line"><span class="keyword">mounted</span></span><br></pre></td></tr></tbody></table></figure>
<p>在浏览器控制台输入<code>app</code></p>
<figure class="highlight vim"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app</span><br><span class="line"><span class="keyword">wn</span>&nbsp;{_uid: <span class="number">0</span>, _isVue: true, $option<span class="variable">s:</span> {…}, _renderProxy: <span class="keyword">wn</span>, _self: <span class="keyword">wn</span>,&nbsp;…}$attr<span class="variable">s:</span> (...)$children: []$createElemen<span class="variable">t:</span> ƒ (<span class="keyword">e</span>,n,r,i)$<span class="keyword">e</span><span class="variable">l:</span> div#app$listener<span class="variable">s:</span> (...)$option<span class="variable">s:</span> {component<span class="variable">s:</span> {…}, directive<span class="variable">s:</span> {…}, <span class="built_in">filter</span><span class="variable">s:</span> {…}, _base: ƒ, dat<span class="variable">a:</span> ƒ,&nbsp;…}$paren<span class="variable">t:</span> undefined$ref<span class="variable">s:</span> {}$roo<span class="variable">t:</span> <span class="keyword">wn</span>&nbsp;{_uid: <span class="number">0</span>, _isVue: true, $option<span class="variable">s:</span> {…}, _renderProxy: <span class="keyword">wn</span>, _self: <span class="keyword">wn</span>,&nbsp;…}$scopedSlot<span class="variable">s:</span> {}$slot<span class="variable">s:</span> {}$vnode: undefineddataLis<span class="variable">t:</span> (...)load: ƒ ()submi<span class="variable">t:</span> ƒ ()username: (...)_c: ƒ (<span class="keyword">e</span>,n,r,i)_dat<span class="variable">a:</span> {__ob__: we}_directInactive: false_event<span class="variable">s:</span> {}_hasHookEven<span class="variable">t:</span> false_inactive: null_isBeingDestroyed: false_isDestroyed: false_isMounted: true_isVue: true_renderProxy: <span class="keyword">wn</span>&nbsp;{_uid: <span class="number">0</span>, _isVue: true, $option<span class="variable">s:</span> {…}, _renderProxy: <span class="keyword">wn</span>, _self: <span class="keyword">wn</span>,&nbsp;…}_self: <span class="keyword">wn</span>&nbsp;{_uid: <span class="number">0</span>, _isVue: true, $option<span class="variable">s:</span> {…}, _renderProxy: <span class="keyword">wn</span>, _self: <span class="keyword">wn</span>,&nbsp;…}_staticTree<span class="variable">s:</span> null_uid: <span class="number">0</span>_vnode: <span class="keyword">pe</span>&nbsp;{<span class="keyword">ta</span><span class="variable">g:</span> <span class="string">"div"</span>, dat<span class="variable">a:</span> {…}, children: Array(<span class="number">11</span>), tex<span class="variable">t:</span> undefined, elm: div#app,&nbsp;…}_watcher: fn&nbsp;{<span class="keyword">vm</span>: <span class="keyword">wn</span>, deep: false, user: false, lazy: false, <span class="keyword">sync</span>: false,&nbsp;…}_watcher<span class="variable">s:</span> [fn]$dat<span class="variable">a:</span> (...)$isServer: (...)$prop<span class="variable">s:</span> (...)$ssrContex<span class="variable">t:</span> (...)<span class="built_in">get</span> $attr<span class="variable">s:</span> ƒ ()<span class="keyword">set</span> $attr<span class="variable">s:</span> ƒ (t)<span class="built_in">get</span> $listener<span class="variable">s:</span> ƒ ()<span class="keyword">set</span> $listener<span class="variable">s:</span> ƒ (t)<span class="built_in">get</span> dataLis<span class="variable">t:</span> ƒ ()<span class="keyword">set</span> dataLis<span class="variable">t:</span> ƒ (<span class="keyword">e</span>)<span class="built_in">get</span> username: ƒ ()<span class="keyword">set</span> username: ƒ (<span class="keyword">e</span>)__proto__: Object</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p>在浏览器控制台输入<code>app.$destroy()</code></p>
<figure class="highlight stata"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">app</span>.<span class="variable">$destroy</span>()</span><br><span class="line">beforeDestroy</span><br><span class="line">destroyed</span><br></pre></td></tr></tbody></table></figure>

<ol start="4">
<li>mounted</li>
</ol>
<ul>
<li>如果有<code>el</code>，实例被挂载后调用，这时 <code>el</code> 被新创建的 <code>vm.$el</code> 替换了。此时数据已经真实渲染到页面上了。<br>mounted 是实例创建期间的最后一个生命周期函数，当执行完 mounted 就表示，实例已经被完全创建好了。</li>
</ul>
<p>注意：<br>mounted 不会保证所有的子组件也都一起被挂载。如果你希望等到整个视图都渲染完毕，可以在 mounted 内部使用 vm.$nextTick：</p>
<ol start="5">
<li>beforeUpdate Update<br>当vue发现data中的数据发生了改变，会触发对应组件的重新渲染，先后调用beforeUpdate和updated钩子函数。</li>
</ol>
<p>console能打印出来并不一定就是有“值”，console当打印出来的是基本数据类型时候当然没问题，否则对于复杂数据类型是会发生改变的，因为只是地址引用而已</p>
<p>在通过live server在浏览器中，F12或右键inspect-console，<br>点击提交按钮，控制台会输出</p>
<p>以下代码在浏览器显示是一级标题的test，<code>template: '&lt;h1&gt;test&lt;/h1&gt;'</code>替换了<code>el: '#app'</code>也就是替换了<code>id="app"</code>为<code>&lt;div&gt;</code>的所有内容</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue实现<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/vue.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>表单操作<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">v-model</span>=<span class="string">"username"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"提交"</span> @<span class="attr">click</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>动态列表<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"加载"</span> @<span class="attr">click</span>=<span class="string">"load"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"item in dataList"</span>&gt;</span>{{ item }}<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> app = <span class="keyword">new</span> Vue({</span></span><br><span class="line"><span class="javascript">        <span class="comment">// el: '#app',</span></span></span><br><span class="line"><span class="handlebars"><span class="xml">        // template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>test<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>',</span></span></span><br><span class="line">        data: {</span><br><span class="line"><span class="javascript">            username: <span class="string">'admin'</span>,</span></span><br><span class="line">            dataList: []</span><br><span class="line">        },</span><br><span class="line">        methods: {</span><br><span class="line">            submit() {</span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">'获取表单的值：'</span>, <span class="built_in">this</span>.username)</span></span><br><span class="line">            },</span><br><span class="line">            load() {</span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.dataList = [<span class="string">'北京'</span>, <span class="string">'上海'</span>, <span class="string">'广州'</span>, <span class="string">'深圳'</span>]</span></span><br><span class="line">            }</span><br><span class="line">        },</span><br><span class="line"><span class="javascript">        beforeCreate: <span class="function">() =&gt;</span> {  <span class="comment">// 有箭头函数</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeCreate'</span>)</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="built_in">this</span>)  <span class="comment">// window 指向window</span></span></span><br><span class="line"><span class="javascript">            <span class="comment">// console.log(this.load())  // 报错，不可以调用vue的实例的方法</span></span></span><br><span class="line">        },</span><br><span class="line"><span class="javascript">        created() {  <span class="comment">// 没有箭头函数</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'created'</span>)</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="built_in">this</span>)  <span class="comment">// wn  指向vue的实例</span></span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="built_in">this</span>.load())  <span class="comment">// 可以调用vue的实例的方法</span></span></span><br><span class="line">        },</span><br><span class="line">        beforeMount() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeMount'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        mounted() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'mounted'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        beforeDestroy() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeDestroy'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        destroyed() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'destroyed'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        beforeUpdate() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'beforeUpdate'</span>)</span></span><br><span class="line">        },</span><br><span class="line">        updated() {</span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'updated'</span>)</span></span><br><span class="line">        }</span><br><span class="line">    })</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight groovy"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">beforeCreate</span><br><span class="line">Window&nbsp;{<span class="attr">window:</span> Window, <span class="attr">self:</span> Window, <span class="attr">document:</span> document, <span class="attr">name:</span> <span class="string">""</span>, <span class="attr">location:</span> Location,&nbsp;…}</span><br><span class="line">created</span><br><span class="line">wn&nbsp;{<span class="attr">_uid:</span> <span class="number">0</span>, <span class="attr">_isVue:</span> <span class="literal">true</span>, <span class="attr">$options:</span> {…}, <span class="attr">_renderProxy:</span> wn, <span class="attr">_self:</span> wn,&nbsp;…}</span><br><span class="line">undefined</span><br></pre></td></tr></tbody></table></figure>

<hr>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue实现<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/vue.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>{{ message }}<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> app = <span class="keyword">new</span> Vue({</span></span><br><span class="line"><span class="javascript">            el: <span class="string">"#app"</span>,</span></span><br><span class="line">            data() {</span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> { <span class="attr">message</span>: <span class="string">"Hello World"</span> }</span></span><br><span class="line">            },</span><br><span class="line"><span class="javascript">            created: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">"created"</span>)</span></span><br><span class="line">            },</span><br><span class="line"><span class="javascript">            beforeCreate: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">"beforeCreate"</span>)</span></span><br><span class="line">            },</span><br><span class="line"><span class="javascript">            beforeMount: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">"beforeMount"</span>)</span></span><br><span class="line">            },</span><br><span class="line"><span class="javascript">            beforeUpdate: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">"beforeUpdate"</span>)</span></span><br><span class="line">            },</span><br><span class="line"><span class="javascript">            mounted: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">"mounted"</span>)</span></span><br><span class="line">            },</span><br><span class="line"><span class="javascript">            beforeDestroy: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">"beforeDestroy"</span>)</span></span><br><span class="line">            },</span><br><span class="line"><span class="javascript">            updated: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">"updated"</span>)</span></span><br><span class="line">            },</span><br><span class="line"><span class="javascript">            destroyed: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">"destroyed"</span>)</span></span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">        }</span><br><span class="line">        )</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight mipsasm"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">beforeCreate</span></span><br><span class="line"><span class="keyword">created</span></span><br><span class="line"><span class="keyword">beforeMount</span></span><br><span class="line"><span class="keyword">mounted</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>vue生命周期学习<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/vue/2.4.2/vue.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>{{message}}<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue({</span></span><br><span class="line"><span class="javascript">    el: <span class="string">'#app'</span>,</span></span><br><span class="line">    data: {</span><br><span class="line"><span class="javascript">      message: <span class="string">'Vue的生命周期'</span></span></span><br><span class="line">    },</span><br><span class="line"><span class="javascript">    beforeCreate: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.group(<span class="string">'------beforeCreate创建前状态------'</span>);</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span> , <span class="string">"el     : "</span> + <span class="built_in">this</span>.$el); <span class="comment">//undefined</span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"data   : "</span> + <span class="built_in">this</span>.$data); <span class="comment">//undefined </span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"message: "</span> + <span class="built_in">this</span>.message) </span></span><br><span class="line">    },</span><br><span class="line"><span class="javascript">    created: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.group(<span class="string">'------created创建完毕状态------'</span>);</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"el     : "</span> + <span class="built_in">this</span>.$el); <span class="comment">//undefined</span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"data   : "</span> + <span class="built_in">this</span>.$data); <span class="comment">//已被初始化 </span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"message: "</span> + <span class="built_in">this</span>.message); <span class="comment">//已被初始化</span></span></span><br><span class="line">    },</span><br><span class="line"><span class="javascript">    beforeMount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.group(<span class="string">'------beforeMount挂载前状态------'</span>);</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"el     : "</span> + (<span class="built_in">this</span>.$el)); <span class="comment">//已被初始化</span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="built_in">this</span>.$el);</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"data   : "</span> + <span class="built_in">this</span>.$data); <span class="comment">//已被初始化  </span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"message: "</span> + <span class="built_in">this</span>.message); <span class="comment">//已被初始化  </span></span></span><br><span class="line">    },</span><br><span class="line"><span class="javascript">    mounted: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.group(<span class="string">'------mounted 挂载结束状态------'</span>);</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"el     : "</span> + <span class="built_in">this</span>.$el); <span class="comment">//已被初始化</span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="built_in">this</span>.$el);    </span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"data   : "</span> + <span class="built_in">this</span>.$data); <span class="comment">//已被初始化</span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"message: "</span> + <span class="built_in">this</span>.message); <span class="comment">//已被初始化 </span></span></span><br><span class="line">    },</span><br><span class="line"><span class="javascript">    beforeUpdate: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.group(<span class="string">'beforeUpdate 更新前状态===============》'</span>);</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"el     : "</span> + <span class="built_in">this</span>.$el);</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="built_in">this</span>.$el);   </span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"data   : "</span> + <span class="built_in">this</span>.$data); </span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"message: "</span> + <span class="built_in">this</span>.message); </span></span><br><span class="line">    },</span><br><span class="line"><span class="javascript">    updated: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.group(<span class="string">'updated 更新完成状态===============》'</span>);</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"el     : "</span> + <span class="built_in">this</span>.$el);</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="built_in">this</span>.$el); </span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"data   : "</span> + <span class="built_in">this</span>.$data); </span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"message: "</span> + <span class="built_in">this</span>.message); </span></span><br><span class="line">    },</span><br><span class="line"><span class="javascript">    beforeDestroy: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.group(<span class="string">'beforeDestroy 销毁前状态===============》'</span>);</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"el     : "</span> + <span class="built_in">this</span>.$el);</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="built_in">this</span>.$el);    </span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"data   : "</span> + <span class="built_in">this</span>.$data); </span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"message: "</span> + <span class="built_in">this</span>.message); </span></span><br><span class="line">    },</span><br><span class="line"><span class="javascript">    destroyed: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.group(<span class="string">'destroyed 销毁完成状态===============》'</span>);</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"el     : "</span> + <span class="built_in">this</span>.$el);</span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="built_in">this</span>.$el);  </span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"data   : "</span> + <span class="built_in">this</span>.$data); </span></span><br><span class="line"><span class="javascript">      <span class="built_in">console</span>.log(<span class="string">"%c%s"</span>, <span class="string">"color:red"</span>,<span class="string">"message: "</span> + <span class="built_in">this</span>.message)</span></span><br><span class="line">    }</span><br><span class="line">  })</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight ldif"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">------beforeCreate创建前状态------</span></span><br><span class="line"><span class="attribute">el     </span>: undefined</span><br><span class="line"><span class="attribute">data   </span>: undefined</span><br><span class="line"><span class="attribute">message</span>: undefined</span><br><span class="line"><span class="literal">------created创建完毕状态------</span></span><br><span class="line"><span class="attribute">el     </span>: undefined</span><br><span class="line"><span class="attribute">data   </span>: [object Object]</span><br><span class="line"><span class="attribute">message</span>: Vue的生命周期</span><br><span class="line"><span class="literal">------beforeMount挂载前状态------</span></span><br><span class="line"><span class="attribute">el     </span>: [object HTMLDivElement]</span><br><span class="line">&lt;div id=​"app"&gt;​…​&lt;/div&gt;​</span><br><span class="line"><span class="attribute">data   </span>: [object Object]</span><br><span class="line"><span class="attribute">message</span>: Vue的生命周期</span><br><span class="line"><span class="literal">------mounted 挂载结束状态------</span></span><br><span class="line"><span class="attribute">el     </span>: [object HTMLDivElement]</span><br><span class="line">&lt;div id=​"app"&gt;​…​&lt;/div&gt;​</span><br><span class="line"><span class="attribute">data   </span>: [object Object]</span><br><span class="line"><span class="attribute">message</span>: Vue的生命周期</span><br></pre></td></tr></tbody></table></figure>

<p>Vue CLI<br>-快速搭建项目<br>-内置 Babel、 ESlint、 PostCSS等插件<br>-基于 webpack,Webpack是一个前端资源加载、打包工具。它将根据模块间的依赖关系进行静态分析，然后根据指定的规则生成相应的静态资源。其实现了代码转换，将开发文件转化为基础的HTML、CSS、JavaScript文件等功能。可灵活配置，<br>-图形化的创建和管理工具</p>
<p>npm（node package manager）：<br>nodejs的包管理器，用于node插件管理（包括安装、卸载、管理依赖等）<br>cnpm:因为npm安装插件是从国外服务器下载，受网络的影响比较大，可能会出现异常，如果npm的服务器在中国就好了，<br>所以我们乐于分享的淘宝团队干了这事。<br>来自官网：“这是一个完整 npmjs.org 镜像，你可以用此代替官方版本(只读)，同步频率目前为 10分钟 一次以保证尽量与官方服务同步。”</p>
<p><code>npm install -g cnpm --registry=https://registry.npm.taobao.org</code><br>D:\Program Files\nodejs\node_global\node_modules</p>
<p>安装一个项目所需要的包在项目主目录下执行<code>cnpm install</code>命令，生成<code>node_modules</code>目录文件夹<br>启动项目执行<code>cnpm run dev</code>命令，启动后可以访问<code>localhost:8080</code></p>
<h3 id="创建第一个Vue项目"><a href="#创建第一个Vue项目" class="headerlink" title="创建第一个Vue项目"></a>创建第一个Vue项目</h3><ul>
<li>切换项目路径<br><code>cd C:\Vue\</code></li>
<li>命令行创建，<br><code>vue create project_name</code><br><code>vue create hello-world</code></li>
<li>图形化界面创建<br><code>Vue ui</code></li>
<li>命令行启动，确定已经切换项目路径<br><code>npm run serve</code>不是<code>server</code></li>
</ul>
<h3 id="项目结构分析"><a href="#项目结构分析" class="headerlink" title="项目结构分析"></a>项目结构分析</h3><p>理解∨ue的项目结构才能开发单页面应用</p>
<ul>
<li>文件解释<ul>
<li><code>package.json</code>——项目描述文件（包含一些依赖配置）</li>
<li><code>vue.config.js</code>——配置文件扩展</li>
<li><code>src/</code>——源代码</li>
<li><code>dist/</code>——构建后的代码（混合、压缩）</li>
<li><code>public/</code>——公共的静态文件</li>
<li><code>node_modules/</code>——项目依赖的安装目录，对应python的site-packages</li>
</ul>
</li>
</ul>
<p>vue项目模板</p>
<ul>
<li><code>src/assets</code>:存放突变</li>
<li><code>src/components</code>:存放一组件文件</li>
<li><code>components/HelloWorld.vue</code>欢迎页面中的样式</li>
<li><code>src/App.vue</code> 项目入口文件，我们也可以直接将组建写这里，而不使用<br>Vue根组件，可以通过 render参数从组件渲染</li>
<li><code>src/mian.js</code> 程序的逻辑入口文件，项目核心文件</li>
<li>新建目录<code>src/views</code>，存放页面组件</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue3</span></span><br><span class="line"><span class="keyword">import</span> { createApp } <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.vue'</span></span><br><span class="line"></span><br><span class="line">createApp(App).mount(<span class="string">'#app'</span>)</span><br><span class="line"><span class="comment">// Vue3里面没有全局的Vue，但是有个新的全局API：createApp</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue2.X</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span></span><br><span class="line"></span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* eslint-disable no-new */</span></span><br><span class="line"><span class="keyword">new</span> Vue({</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    components: { App },</span><br><span class="line">    template: <span class="string">'&lt;App/&gt;'</span></span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>
<p>public/index.html 模板文件</p>
<h3 id="面向组件编程"><a href="#面向组件编程" class="headerlink" title="面向组件编程"></a>面向组件编程</h3><p>组件化开发方式<br>把一个页面按照模块拆分成N个小块<br>做一个组件，只需要导入和组件相关的元素即可，从而加大了项目的纯度。</p>
<h4 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h4><p>带有一个名字：<br>可复用的 Vue 实例，<br>与<code>new vue</code>接收相同的选项，例如 <code>data</code>、<code>computed</code>、<code>watch</code>、<code>methods</code> 以及生命周期钩子等。<br>仅有的例外是像 <code>el</code> 这样根实例特有的选项。</p>
<ul>
<li>按模块划分的前端代码片段，可分离</li>
<li>可复用的前端代码片段，每个组件都会各自独立</li>
<li>容易维护的前端代码片段<br>一个组件的模板必须有一个根节点<br>为了能在模板中使用，这些组件必须先注册以便 Vue 能够识别。</li>
</ul>
<h4 id="创建局部组件"><a href="#创建局部组件" class="headerlink" title="创建局部组件"></a>创建局部组件</h4><p>全局注册所有的组件意味着即便你已经不再使用一个组件了，它仍然会被包含在你最终的构建结果中。这造成了用户下载的 JavaScript 的无谓的增加。</p>
<p>创建vue对象，在vue函数的一个参数是一个对象形式，在对象内申明一个compoents属性，在内部进行组件的局部注册<br>对于 components 对象中的每个 property 来说，其 property 名就是自定义元素的名字，其 property 值就是这个组件的选项对象。</p>
<p>通过一个普通的 JavaScript 对象来定义组件</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ComponentA = { <span class="comment">/* ... */</span> }</span><br><span class="line"><span class="keyword">var</span> ComponentB = { <span class="comment">/* ... */</span> }</span><br><span class="line"><span class="keyword">var</span> ComponentC = { <span class="comment">/* ... */</span> }</span><br></pre></td></tr></tbody></table></figure>

<p>在 <code>components</code> 选项中定义你想要使用的组件</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue({</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    components: {</span><br><span class="line">        <span class="string">'component-a'</span>: ComponentA,</span><br><span class="line">        <span class="string">'component-b'</span>: ComponentB,</span><br><span class="line">        App: {</span><br><span class="line">            template: <span class="string">""</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<p>局部注册的组件在其子组件中不可用。<br>例如，如果你希望 <code>ComponentA</code> 在 <code>ComponentB</code> 中可用，则你需要这样写：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ComponentA = { <span class="comment">/* ... */</span> }</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ComponentB = {</span><br><span class="line">  components: {</span><br><span class="line">    <span class="string">'component-a'</span>: ComponentA</span><br><span class="line">  },</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="创建全局组件"><a href="#创建全局组件" class="headerlink" title="创建全局组件"></a>创建全局组件</h4><p>全局注册的组件可以用在其被注册之后的任何 (通过 <code>new Vue</code>) 新创建的 Vue 根实例，<br>也包括其组件树中的所有子组件的模板中。<br>在所有子组件中也是如此，也就是说这三个组件在各自内部也都可以相互使用。</p>
<ul>
<li>步骤一:新建组件vue文件，不写<code>.vue</code>后缀<br><code>Vue.component()</code>第一个参数是组件名称，第二个参数一对象的形式描述组件,ba’han</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Vue.component(<span class="string">'my-component-name'</span>, {</span><br><span class="line">    <span class="comment">// … options ...</span></span><br><span class="line">    data: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            count: <span class="number">0</span></span><br><span class="line">        }</span><br><span class="line">    },</span><br><span class="line">    template: <span class="string">'&lt;button v-on:click="count++"&gt;You clicked me {{ count }} times.&lt;/button&gt;'</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>在一个通过 new Vue 创建的 Vue 根实例中，把这个组件作为自定义元素来使用：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue({ <span class="attr">el</span>: <span class="string">'#components-demo'</span> })</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"components-demo"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 将组件进行任意次数的复用 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">my-component-name</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">my-component-name</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">my-component-name</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>步骤二:导入该组件</li>
<li>步骤三:注册该组件</li>
<li>步骤四:使用该组件</li>
</ul>
<h4 id="组件的复用"><a href="#组件的复用" class="headerlink" title="组件的复用"></a>组件的复用</h4><p>组件中的<code>data</code>属性必须是一个函数<br>一定要在<code>main.js</code>里面。<br>并不是像这样直接提供一个对象：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data: {</span><br><span class="line">  count: <span class="number">0</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>取而代之的是，一个组件的 <code>data</code> 选项必须是一个函数，</p>
<blockquote>
<p>因此每个实例可以维护一份被返回对象的独立的拷贝：</p>
</blockquote>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">return</span> {</span><br><span class="line">    count: <span class="number">0</span></span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="在模块系统中局部注册"><a href="#在模块系统中局部注册" class="headerlink" title="在模块系统中局部注册"></a>在模块系统中局部注册</h3><p>使用了诸如 Babel 和 webpack 的模块系统。<br>在这些情况下，我们推荐创建一个 <code>components</code> 目录，并将每个组件放置在其各自的文件中。<br>然后你需要在局部注册之前导入每个你想使用的组件。<br>使用<code>export default</code>命令，为模块指定默认输出，这样就不需要知道所要加载模块的变量名。</p>
<p>例如，在一个假设的 <code>ComponentB.js</code> 或 <code>ComponentB.vue</code> 文件中：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ComponentA <span class="keyword">from</span> <span class="string">'./ComponentA'</span></span><br><span class="line"><span class="keyword">import</span> ComponentC <span class="keyword">from</span> <span class="string">'./ComponentC'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> {</span><br><span class="line">  components: {</span><br><span class="line">    ComponentA,</span><br><span class="line">    ComponentC</span><br><span class="line">  },</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>现在 <code>ComponentA</code> 和 <code>ComponentC</code> 都可以在 <code>ComponentB</code> 的模板中使用了</p>
<h3 id="基础组件的自动化全局注册"><a href="#基础组件的自动化全局注册" class="headerlink" title="基础组件的自动化全局注册"></a>基础组件的自动化全局注册</h3><p>可能你的许多组件只是包裹了一个输入框或按钮之类的元素，是相对通用的。<br>我们有时候会把它们称为基础组件，它们会在各个组件中被频繁的用到。</p>
<p>所以会导致很多组件里都会有一个包含基础组件的长列表：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> BaseButton <span class="keyword">from</span> <span class="string">'./BaseButton.vue'</span></span><br><span class="line"><span class="keyword">import</span> BaseIcon <span class="keyword">from</span> <span class="string">'./BaseIcon.vue'</span></span><br><span class="line"><span class="keyword">import</span> BaseInput <span class="keyword">from</span> <span class="string">'./BaseInput.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> {</span><br><span class="line">  components: {</span><br><span class="line">    BaseButton,</span><br><span class="line">    BaseIcon,</span><br><span class="line">    BaseInput</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>而只是用于模板中的一小部分：</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">BaseInput</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-model</span>=<span class="string">"searchText"</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">keydown.enter</span>=<span class="string">"search"</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">BaseButton</span> @<span class="attr">click</span>=<span class="string">"search"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">BaseIcon</span> <span class="attr">name</span>=<span class="string">"search"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">BaseButton</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>如果你恰好使用了 webpack (或在内部使用了 webpack 的 Vue CLI 3+)，那么就可以使用 require.context 只全局注册这些非常通用的基础组件。<br>这里有一份可以让你在应用入口文件 (比如 src/main.js) 中全局导入基础组件的示例代码：</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> upperFirst <span class="keyword">from</span> <span class="string">'lodash/upperFirst'</span></span><br><span class="line"><span class="keyword">import</span> camelCase <span class="keyword">from</span> <span class="string">'lodash/camelCase'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> requireComponent = <span class="built_in">require</span>.context(</span><br><span class="line">  <span class="comment">// 其组件目录的相对路径</span></span><br><span class="line">  <span class="string">'./components'</span>,</span><br><span class="line">  <span class="comment">// 是否查询其子目录</span></span><br><span class="line">  <span class="literal">false</span>,</span><br><span class="line">  <span class="comment">// 匹配基础组件文件名的正则表达式</span></span><br><span class="line">  /Base[A-Z]\w+\.(vue|js)$/</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">requireComponent.keys().forEach(<span class="function"><span class="params">fileName</span> =&gt;</span> {</span><br><span class="line">  <span class="comment">// 获取组件配置</span></span><br><span class="line">  <span class="keyword">const</span> componentConfig = requireComponent(fileName)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取组件的 PascalCase 命名</span></span><br><span class="line">  <span class="keyword">const</span> componentName = upperFirst(</span><br><span class="line">    camelCase(</span><br><span class="line">      <span class="comment">// 获取和目录深度无关的文件名</span></span><br><span class="line">      fileName</span><br><span class="line">        .split(<span class="string">'/'</span>)</span><br><span class="line">        .pop()</span><br><span class="line">        .replace(<span class="regexp">/\.\w+$/</span>, <span class="string">''</span>)</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 全局注册组件</span></span><br><span class="line">  Vue.component(</span><br><span class="line">    componentName,</span><br><span class="line">    <span class="comment">// 如果这个组件选项是通过 `export default` 导出的，</span></span><br><span class="line">    <span class="comment">// 那么就会优先使用 `.default`，</span></span><br><span class="line">    <span class="comment">// 否则回退到使用模块的根。</span></span><br><span class="line">    componentConfig.default || componentConfig</span><br><span class="line">  )</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>
<p>记住全局注册的行为必须在根 Vue 实例 (通过 new Vue) 创建之前发生。</p>
<h3 id="模板语法"><a href="#模板语法" class="headerlink" title="模板语法"></a>模板语法</h3><ul>
<li>显示普通文本<br><code>&lt;span&gt;消息内容:{{msg}}&lt;/span&gt;</code></li>
<li>JavaScript表达式<br><code>{{ msg.split('').reverse.join('')}}</code><br><code>{{ result &gt;0? 'YES':'NO'}}</code></li>
</ul>
<p>指令(Directives)是带有<code>v-</code>前缀的特殊属性</p>
<ul>
<li>富文本(HTML)<br><code>span V-html="rawHtml"&gt;&lt;/span&gt;</code></li>
<li>普通文本(text<br><code>span V-text="rawHtml"&gt;&lt;/span&gt;</code></li>
</ul>
<h4 id="V-bind"><a href="#V-bind" class="headerlink" title="V-bind"></a>V-bind</h4><ul>
<li><p>作用<br>响应式的更新HTML属性<br>数据双向绑定：<br>数据和页面的双向绑定，修改任何一个，另一个都会同步变化，MVVM也是这个概念，Angular、Vue都实现了数据双向绑定。</p>
</li>
<li><p>常用的场景<br>设置 class, style、href、src等<br><code>&lt;a v-bind:href="url"&gt;...&lt;/a&gt;</code>等同于<code>&lt;a :href="url"&gt;...&lt;/a&gt;</code></p>
</li>
<li><p>设置class</p>
<ul>
<li>对象语法<br><code>v-bind:class="{active:isActive, 'text-danger': hasError }</code></li>
<li>数组语法<br><code>bind:class="[{ active:isActive }, errorClass]"</code><br>加冒号<code>:</code>是<code>v-bind</code>语法</li>
</ul>
</li>
<li><p>设置style</p>
<ul>
<li><p>对象语法<br><code>v-bind:style="{ color: activeColor, fontSize:fontSize +'px'}"</code></p>
</li>
<li><p>数组语法<br><code>v-bind:style="[baseStyles, overridingStyles]"</code></p>
</li>
<li><p>浏览器适配(默认自动适配)<br><code>:style="{display:['-Webkit-box', '-ms-flexbox','flex']}</code></p>
</li>
</ul>
</li>
</ul>
<h4 id="v-if"><a href="#v-if" class="headerlink" title="v-if"></a>v-if</h4><p><code>v-else</code>元素必须紧跟在带<code>v-if</code>或者<code>v-else-if</code>的元素的后面<br>不满足条件时，在dom里面找不到元素</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">"score&gt;=90"</span>&gt;</span>A<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else-if</span>=<span class="string">"score &gt;=80"</span>&gt;</span>B<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else-if</span>=<span class="string">"score &gt;=60"</span>&gt;</span>C<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else</span>&gt;</span>D<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="v-show"><a href="#v-show" class="headerlink" title="v-show"></a>v-show</h4><p>通过切换css的 display属性来控制元素的显示与隐藏<br>不满足条件时，在dom里面能找到元素</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-show</span>=<span class="string">"hasError"</span>&gt;</span>还有错误哦!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="V-tor"><a href="#V-tor" class="headerlink" title="V-tor"></a>V-tor</h4><ul>
<li>基本语法</li>
</ul>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"item in items"</span> <span class="attr">:key</span>=<span class="string">"item id"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">"item of items"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>key的作用<br>渲染性能优化（修改DOM还是替换DOM）</p>
</li>
<li><p>渲染数组</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"(item, index) in items"</span> <span class="attr">:key</span>=<span class="string">"index"</span>&gt;</span></span><br><span class="line">{{index}}-{{item.message}}</span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>渲染对象</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"(value, key, index) in object"</span> <span class="attr">:key</span>=<span class="string">"index"</span>&gt;</span></span><br><span class="line">{{index}}.{{key}}:{{value}}</span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h4 id="v-on-指令监听-DOM-事件"><a href="#v-on-指令监听-DOM-事件" class="headerlink" title="v-on 指令监听 DOM 事件"></a><code>v-on</code> 指令监听 DOM 事件</h4><p>v-on指令后面“:”后的参数是要触发的事件类型。<br>v-on的事件类型由参数指定。<br><code>&lt;button v-on:click="counter += 1"&gt;Add 1&lt;/button&gt;</code><br><code>&lt;button @click="counter += 1"&gt;Add 1&lt;/button&gt;</code></p>
<h3 id="鼠标事件修饰符"><a href="#鼠标事件修饰符" class="headerlink" title="鼠标事件修饰符"></a>鼠标事件修饰符</h3><ul>
<li>阻止事件冒泡<br><code>&lt;a v-on:click.stop="doThis"&gt;&lt;/a&gt;</code></li>
<li>阻止默认行为<br><code>&lt;a v-on:click.prevent="doThis"&gt;&lt;/a&gt;</code></li>
<li>点击事件只触发一次<br><code>&lt;a v-on:click.once="doThis"&gt;&lt;/a&gt;</code></li>
</ul>
<h3 id="键盘事件"><a href="#键盘事件" class="headerlink" title="键盘事件"></a>键盘事件</h3><ul>
<li><p>监听事件 每次输入键盘抬起的时候<br><code>&lt;input type="text" v-on:keyup="submit"&gt;</code><br><code>&lt;input type="text" @keyup="submit"&gt;</code></p>
</li>
<li><p>监听回车键<br><code>&lt;input type="text" v-on:keyup.enter="submit"&gt;</code><br><code>&lt;input type="text" @keyup.enter="submit"&gt;</code></p>
</li>
<li><p>监听删除、退格键<br><code>&lt;input type="text" v-on:keyup.delete="submit"&gt;</code><br>`&lt;input type=”text” @keyup=”submit”&gt;</p>
</li>
</ul>
<h3 id="表单输入绑定"><a href="#表单输入绑定" class="headerlink" title="表单输入绑定"></a>表单输入绑定</h3><ul>
<li>基本语法<br><code>&lt;input v-model="message"&gt;</code></li>
<li>单选、多选的绑定</li>
</ul>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">"hobby"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">:value</span>=<span class="string">"opion"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-for</span>=<span class="string">"(opion, index) in opitons"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:key</span>=<span class="string">"index"</span>&gt;</span>{{opion.text}}<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>您选择了： {{hobby.text}}<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>修饰符：检索代码量<br><code>trim</code>自动过滤首位输入的空白<br><code>number</code>自动转为数值类型</li>
</ul>
<h3 id="过滤器是一个JavaScript函数"><a href="#过滤器是一个JavaScript函数" class="headerlink" title="过滤器是一个JavaScript函数"></a>过滤器是一个JavaScript函数</h3><p>但是在 vue3.x 中过滤器属性已删除，不再支持</p>
<h4 id="过滤器的注册"><a href="#过滤器的注册" class="headerlink" title="过滤器的注册"></a>过滤器的注册</h4><ul>
<li>在组件内注册,在该组件内使用</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">filters: {</span><br><span class="line">  priceFormat: <span class="function"><span class="keyword">function</span>(<span class="params">price</span>) </span>{</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 过滤器的内容 格式化价格显示</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">if</span> (price === <span class="literal">undefined</span> || price === <span class="literal">null</span> || <span class="built_in">isNaN</span>(price)) {</span><br><span class="line">      <span class="keyword">return</span> price</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'￥'</span> + (price).toFixed(<span class="number">2</span>)</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>过滤器的使用</p>
<ul>
<li>方式一:在双大括号中 已经过时？<br><code>{{ message |priceFormat }}</code></li>
<li>方式二:在v-bind中<br><code>&lt;div v-bind:id="rawld | priceFormat"&gt;&lt;/div&gt;</code></li>
</ul>
</li>
<li><p>全局注册,在所有组件内均可使用</p>
</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Vue.filter(<span class="string">'priceFormat'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>{</span><br><span class="line">    <span class="comment">//过滤器的内容</span></span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<p>组件中的常见的通信方式</p>
<ul>
<li>参数传递</li>
<li>全局共享<ul>
<li>浏览器的存储(storage、 cookie)</li>
<li>Vuex</li>
</ul>
</li>
</ul>
<p>父组件到子组件的数据传递</p>
<ul>
<li>传递方式<br>为子组件定义<code>props</code>属性</li>
<li>传递的数据类型<br>数值、布尔值、数组、对象</li>
<li>添加数据类型验证</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">props: {</span><br><span class="line">  userName1: {</span><br><span class="line">    type:<span class="built_in">String</span>,</span><br><span class="line">    required:<span class="literal">true</span></span><br><span class="line">  }</span><br><span class="line">},</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>设置默认值<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">props: {</span><br><span class="line">  userName1: {</span><br><span class="line">    type:<span class="built_in">Number</span>,</span><br><span class="line">    <span class="keyword">default</span>:<span class="literal">true</span></span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p><code>type</code>所支持的类型</p>
<ul>
<li>String:字符串</li>
<li>Object:对象</li>
<li>Number:数字</li>
<li>Date:日期</li>
<li>Boolean:布尔值</li>
<li>Function:方法/函数</li>
<li>Array:数组</li>
<li>Symbol</li>
</ul>
<p>子组件到父组件的数据传递</p>
<ul>
<li>在子组件触发自定义事件<br><code>this.$emit('myEvent')</code></li>
<li>在父组件监听事件<br><code>&lt;my-component v-on:myEvent="doSomething"&gt;&lt;my-component&gt;</code></li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/jian-zhi-offer40-50/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/jian-zhi-offer40-50/" class="post-title-link" itemprop="url">剑指offer40 -50</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-06-27 08:15:24" itemprop="dateModified" datetime="2021-06-27T08:15:24Z">2021-06-27</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="字符串比较大小就是字典序的大小"><a href="#字符串比较大小就是字典序的大小" class="headerlink" title="字符串比较大小就是字典序的大小"></a>字符串比较大小就是字典序的大小</h2><p>字符串的比较是通过 内置函数 ord() 获得每个字符的 Unicode 编码进行大小比较</p>
<p>单个字符<br>常见ASCII码的大小规则：<code>0～9　&lt;　A～Z　&lt;　a～z</code>。<br>1）数字比字母要小。如 “7”&lt;“F”；<br>2）数字0比数字9要小，并按0到9顺序递增。<br>3）字母A比字母Z要小，并按A到Z顺序递增。<br>4）同个字母的大写字母比小写字母要小32。如“A”&lt;“a” 。</p>
<p>多个字符<br>按位进行字符比对，从字符串的第一个字符开始比较，谁的ASCII码大谁就大。<br>只有首字符相同、再去比较下一个字符，以此类推。如果都相同则相等</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'xnjilhntm'</span>==<span class="string">'xnjilhntm'</span>)   <span class="comment"># True</span></span><br><span class="line">print(<span class="string">'xnjilhntm'</span>&lt;<span class="string">'xnjilhntz'</span>)  <span class="comment"># True</span></span><br><span class="line">print(<span class="string">'abbbbbbb'</span>&gt;<span class="string">'b'</span>)  <span class="comment"># False</span></span><br><span class="line">print(<span class="string">''</span>&gt;<span class="string">'a'</span>)  <span class="comment"># False</span></span><br><span class="line">print(<span class="string">'A'</span>&gt;<span class="string">'a'</span>)  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'3'</span> &gt; <span class="string">'20'</span> &gt; <span class="string">'100'</span>)  <span class="comment"># True</span></span><br><span class="line">print(<span class="string">'20'</span> &lt; <span class="string">'200'</span>)  <span class="comment"># True</span></span><br><span class="line">print(max([<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>]))  <span class="comment"># 3</span></span><br><span class="line">print(max([<span class="string">'31'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>]))  <span class="comment"># 31</span></span><br><span class="line">print(max([<span class="string">'13'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>]))  <span class="comment"># 3</span></span><br><span class="line">print(max([<span class="string">'10'</span>, <span class="string">'11'</span>, <span class="string">'12'</span>]))  <span class="comment"># 12</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="179-最大数"><a href="#179-最大数" class="headerlink" title="179. 最大数"></a>179. 最大数</h2><p>给定一组非负整数 nums，重新排列它们每个数字的顺序（每个数字不可拆分）使之组成一个最大的整数。</p>
<p>注意：输出结果可能非常大，所以你需要返回一个字符串而不是整数。</p>
<p>示例 1：</p>
<figure class="highlight lsl"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [<span class="number">10</span>,<span class="number">2</span>]</span><br><span class="line">输出：<span class="string">"210"</span></span><br></pre></td></tr></tbody></table></figure>
<p>示例 2：</p>
<figure class="highlight lsl"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [<span class="number">3</span>,<span class="number">30</span>,<span class="number">34</span>,<span class="number">5</span>,<span class="number">9</span>]</span><br><span class="line">输出：<span class="string">"9534330"</span></span><br></pre></td></tr></tbody></table></figure>
<p>示例 3：</p>
<figure class="highlight lsl"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [<span class="number">1</span>]</span><br><span class="line">输出：<span class="string">"1"</span></span><br></pre></td></tr></tbody></table></figure>
<p>示例 4：</p>
<figure class="highlight lsl"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [<span class="number">10</span>]</span><br><span class="line">输出：<span class="string">"10"</span></span><br></pre></td></tr></tbody></table></figure>

<p>想法<br>为了构建最大数字，希望越高位的数字越大越好。</p>
<p>设计一个类似从高位开始的基数排序。但在处理不同位长数的排序时，我发现很难给出一个统一的大小判别规律，例如962,96,9的最优排序是996962，而162,16,1的最优排序是162161。因此这个思路就只能毙掉了</p>
<p>算法<br>首先，将每个整数变成字符串。然后进行排序。<br>如果仅按降序排序，有相同的开头数字的时候会出现问题。<br>比方说，样例 2 按降序排序得到的数字是 95343303 ，<br>然而交换 3 和 30 的位置可以得到正确答案 9534330 。</p>
<p>例如962,96,9962,96,9的最优排序是996962996962,<br>而162,16,1162,16,1的最优排序是162161162161。</p>
<p>因此，每一对数在排序的比较过程中，比较两种连接顺序哪一种更好。<br>可以证明这样的做法是正确的：</p>
<p>假设（不是一般性），某一对整数 a 和 b ，的比较结果是 a 应该在 b 前面，<br>这意味着 a⌢b&gt;b⌢a ，其中 ⌢ 表示连接。<br>如果排序结果是错的，说明存在一个 c ， b 在 c 前面且 c 在 a 的前面。<br>这产生了矛盾，因为 a⌢b&gt;b⌢a 和 b⌢c&gt;c⌢b 意味着 a⌢c&gt;c⌢a 。<br>换言之，我们的自定义比较方法保证了传递性，所以这样子排序是对的。</p>
<p>一旦数组排好了序，最“重要”的数字会在最前面。<br>有一个需要注意的情况是如果数组只包含 0 ，我们直接返回结果 0 即可。<br>否则，我们用排好序的数组形成一个字符串并返回。</p>
<p>反证法：<br>假设存在一个最大序列不满足该排序规则，<br>那么至少存在两个数字的顺序不按上述传递性的定义排列，<br>如……s2s1…….，其中s2s1 &lt; s1s2。接下来，其他字符串的位置不变，<br>按照传递性定义，将s2和s1交换位置后，<br>可证明……s1s2…… &gt; ……s2s1……，这与假设不符，<br>即……s2s1…….并不是最大序列，所以最优序列必定满足上述传递性的定义。</p>
<p>已知：s1应该在s2前边，s2应该在s3前边；<br>求证：s1应该在s3前边。<br>证明：<br>假设“s3在s1前面”成立，则结合已知“s2应该在s3前边”，推出“s2在s1前面”，与已知“s1应该在s2前边”矛盾，故假设不成立，得证。</p>
<ul>
<li><p>时间复杂度：O(nlgn)<br>尽管我们在比较函数中做了一些额外的工作，但是这只是一个常数因子。</p>
</li>
<li><p>空间复杂度：O(n)<br>用了 O(n) 的额外空间去保存 nums 的副本。<br>尽管我们就地进行了一些额外的工作，但最后返回的数组需要 O(n) 的空间。<br>因此，需要的额外空间与 nums 大小成线性关系。</p>
</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">```key```仅仅支持接受一个参数的函数，该函数用于从从每个被排序元素中提取一个比较键(例如，key=str.lower)。对列表中每个项对应的键计算一次，并返回另一个用以排序的值的可调用对象用于整个排序过程。</span><br><span class="line">None的默认值意味着列表项是直接排序的，不需要计算单独的键值。就无法实现两个参数之间的对比</span><br><span class="line">这里传入一个类名，生成的实际上是这个类对象。</span><br><span class="line"></span><br><span class="line">&gt;```sorted()```在对元素进行默认排序是从低到高时会用到小于号&lt;</span><br><span class="line"></span><br><span class="line">经历如下过程：</span><br><span class="line">- 从元素a(用a指代待排序列表中的元素)中提取比较键：LargerNumKey(a)类对象</span><br><span class="line">- 比较这些类对象的大小，&lt;调用LargerNumKey类的自定义的富比较函数__lt__进行排序. </span><br><span class="line">这样就实现了按自定义排序规则进行排序。</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line">from typing import List</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class LargerNumKey(str):</span><br><span class="line">    # LargerNumKey类继承了字符串str类，数组中所有元素类型改为字符串</span><br><span class="line">    # 所以可以直接使用类名作为函数</span><br><span class="line">    def __lt__(x, y):</span><br><span class="line">        """重写了富比较方法"""</span><br><span class="line">        # x 就是 self, 正常点的写法 就是 __lt__(self, y)</span><br><span class="line">        # self 只是惯例，可以叫其他名字</span><br><span class="line">        # 本题根据官方题解的字符排列传导性，</span><br><span class="line">        # x + y &gt; y + x 等价于 x 必须排在 y 的前面，即compare函数返回 -1</span><br><span class="line">        # x + y &lt; y + x 等价于 y 必须排在 x 的前面，即compare函数返回 1</span><br><span class="line">        return x + y &gt; y + x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Solution:</span><br><span class="line">    def largestNumber(self, nums: List[int]) -&gt; str:</span><br><span class="line">        # key指向一个类，利用了类的实例化生成类对象用作比较键。</span><br><span class="line">        # sorted(map(str, nums), key=LargerNumKey) 比较的是字符串大小，我之前想的是根据 __lt__(x, y) 返回的布尔值比较大小。</span><br><span class="line">        largest_num = ''.join(sorted(map(str, nums), key=LargerNumKey))</span><br><span class="line">        # If, after being sorted, the largest number is `0`, the entire number is zero.</span><br><span class="line">        return '0' if largest_num[0] == '0' else largest_num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == "__main__":</span><br><span class="line">    arr = [10, 3, 20]</span><br><span class="line">    s = Solution()</span><br><span class="line">    print(s.largestNumber(arr))  # 32010</span><br><span class="line">    print(s.largestNumber([824, 8247]) == '8248247')</span><br><span class="line">    print(s.largestNumber([0, 0]) == '0')</span><br><span class="line">    print(s.largestNumber([1, 1, 1]) == '111')</span><br><span class="line">    print(s.largestNumber([3, 30, 34, 5, 9]) == "9534330")</span><br><span class="line">    print(s.largestNumber([10, 2]) == '210')</span><br><span class="line">    print(s.largestNumber([0, 2]) == '20')</span><br><span class="line">    print(s.largestNumber([1]) == '1')</span><br><span class="line">    print(s.largestNumber([0]) == '0')</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sqf"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">arr = [<span class="number">10</span>, <span class="number">3</span>, <span class="number">20</span>]</span><br><span class="line">key=LargerNumKey继承 <span class="built_in">str</span> 的，把int变成<span class="built_in">str</span></span><br><span class="line">x 就是 self</span><br><span class="line"></span><br><span class="line">开始执行<span class="built_in">sort</span>()</span><br><span class="line">默认排序是从低到高，两个元素比较用到小于号&lt;，调用<span class="variable">__lt__</span>(x, y)</span><br><span class="line"></span><br><span class="line"><span class="variable">__lt__</span>(<span class="string">'3'</span>, <span class="string">'10'</span>)</span><br><span class="line">x = <span class="string">'3'</span> y = <span class="string">'10'</span>  </span><br><span class="line"><span class="string">'3'</span> + <span class="string">'10'</span> &gt; <span class="string">'10'</span> + <span class="string">'3'</span>  </span><br><span class="line">返回<span class="literal">True</span></span><br><span class="line">所以 <span class="string">'3'</span> &lt; <span class="string">'10'</span>为 <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="variable">__lt__</span>(<span class="string">'20'</span>, <span class="string">'3'</span>)</span><br><span class="line">x = <span class="string">'20'</span> y = <span class="string">'3'</span>  </span><br><span class="line"><span class="string">'20'</span> + <span class="string">'3'</span> &gt; <span class="string">'3'</span> + <span class="string">'20'</span>  </span><br><span class="line">返回<span class="literal">False</span></span><br><span class="line">所以 <span class="string">'20'</span> &lt; <span class="string">'3'</span>为 <span class="literal">False</span></span><br><span class="line">即<span class="string">'3'</span> &lt; <span class="string">'20'</span>为 <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="variable">__lt__</span>(<span class="string">'20'</span>, <span class="string">'10'</span>)</span><br><span class="line">x = <span class="string">'20'</span> y = <span class="string">'10'</span>  </span><br><span class="line"><span class="string">'20'</span> + <span class="string">'10'</span> &gt; <span class="string">'10'</span> + <span class="string">'20'</span>  </span><br><span class="line">返回<span class="literal">True</span></span><br><span class="line">所以 <span class="string">'20'</span> &lt; <span class="string">'10'</span>为 <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">所以<span class="string">"10"</span>, <span class="string">"3"</span>, <span class="string">"20"</span>的从小到大的顺序为[<span class="string">"3"</span>, <span class="string">"20"</span>, <span class="string">"10"</span>]</span><br><span class="line">largest_num = <span class="string">''</span>.<span class="built_in">join</span>([<span class="string">"3"</span>, <span class="string">"20"</span>, <span class="string">"10"</span>]) = <span class="string">'32010'</span></span><br><span class="line">largest_num[<span class="number">0</span>] == <span class="string">'3'</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StrLt</span>(<span class="params">str</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__lt__</span>(<span class="params">self, y</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self + y &gt; y + self</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestNumber</span>(<span class="params">self, nums: List[int]</span>) -&gt; str:</span></span><br><span class="line"></span><br><span class="line">        nums.sort(key=StrLt)</span><br><span class="line">        res = <span class="string">""</span>.join(map(str, nums))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"0"</span> <span class="keyword">if</span> res[<span class="number">0</span>] == <span class="string">"0"</span> <span class="keyword">else</span> res</span><br></pre></td></tr></tbody></table></figure>

<p>把sorted的reverse参数设置为True，排序的顺序是大到小。<br>__lt__方法的返回值和小于的原意一样，<br>可以直接用&lt;、&gt;来比较两个类实例的大小关系，<br>也可以将类传入sorted和sort函数的key参数中，用于类元素组成的序列等的排序。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LargerNumKey</span>(<span class="params">str</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__lt__</span>(<span class="params">x, y</span>):</span></span><br><span class="line">        <span class="keyword">return</span> x + y &lt; y + x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestNumber</span>(<span class="params">self, nums</span>):</span></span><br><span class="line">        largest_num = <span class="string">''</span>.join(</span><br><span class="line">            sorted(map(str, nums), key=LargerNumKey, reverse=<span class="literal">True</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'0'</span> <span class="keyword">if</span> largest_num[<span class="number">0</span>] == <span class="string">'0'</span> <span class="keyword">else</span> largest_num</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LargerNumKey</span>(<span class="params">str</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__gt__</span>(<span class="params">x, y</span>):</span></span><br><span class="line">        <span class="keyword">return</span> x + y &gt; y + x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestNumber</span>(<span class="params">self, nums</span>):</span></span><br><span class="line">        largest_num = <span class="string">''</span>.join(</span><br><span class="line">            sorted(map(str, nums), key=LargerNumKey, reverse=<span class="literal">True</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'0'</span> <span class="keyword">if</span> largest_num[<span class="number">0</span>] == <span class="string">'0'</span> <span class="keyword">else</span> largest_num</span><br></pre></td></tr></tbody></table></figure>

<p>法二<br>不再让LargerNumKey类去继承str类，<br>这个函数的比较实现依赖传入参数value的类型，只要value类型支持‘+’和比较运算符，这个函数就能正常工作。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LargerNumKey</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        self.value = value</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__lt__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.value + other.value &gt; other.value + self.value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestNumber</span>(<span class="params">self, nums</span>):</span></span><br><span class="line">        ans = <span class="string">''</span>.join(sorted(map(str, nums), key=LargerNumKey))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'0'</span> <span class="keyword">if</span> ans[<span class="number">0</span>] == <span class="string">'0'</span> <span class="keyword">else</span> ans</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestNumber</span>(<span class="params">self, nums: List[int]</span>) -&gt; str:</span></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">cmp_large</span>:</span></span><br><span class="line">            <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, value</span>):</span></span><br><span class="line">                self.value = str(value)</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">def</span> <span class="title">__lt__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">                <span class="keyword">return</span> self.value + other.value &gt; other.value + self.value</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">def</span> <span class="title">__gt__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">                <span class="keyword">return</span> self.value + other.value &lt; other.value + self.value</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">                <span class="keyword">return</span> self.value + other.value == other.value + self.value</span><br><span class="line"></span><br><span class="line">        res = [cmp_large(value) <span class="keyword">for</span> value <span class="keyword">in</span> nums]</span><br><span class="line">        ans = <span class="string">""</span>.join(a.value <span class="keyword">for</span> a <span class="keyword">in</span> sorted(res))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'0'</span> <span class="keyword">if</span> ans[<span class="number">0</span>] == <span class="string">'0'</span> <span class="keyword">else</span> ans</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestNumber</span>(<span class="params">self, nums: List[int]</span>) -&gt; str:</span></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">large_num</span>(<span class="params">str</span>):</span></span><br><span class="line">            <span class="function"><span class="keyword">def</span> <span class="title">__lt__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">                <span class="keyword">return</span> self + other &gt; other + self</span><br><span class="line"></span><br><span class="line">        largest_num = <span class="string">""</span>.join(sorted(map(str, nums), key=large_num))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'0'</span> <span class="keyword">if</span> largest_num[<span class="number">0</span>] == <span class="string">'0'</span> <span class="keyword">else</span> largest_num</span><br></pre></td></tr></tbody></table></figure>

<p>假设a,b,c分别有m,n,k位数<br>ab &gt; ba =&gt; a * 10^n + b &gt; b * 10^m+ a<br>bc &gt; cb =&gt; b * 10^k + c &gt; c * 10^n + b)<br>可以推出: a * 10^k + c &gt; c * 10^m + a =&gt; ac &gt; ca<br>a=123 b=34，m=3,n=2<br>ab=12334=123*10^2+34;</p>
<p>法三：<br>cmp_to_key 函数，接收比较函数cmp(x, y) 接受两个参数用于比较 2 个对象</p>
<ul>
<li>返回1，是 x &gt; y，</li>
<li>返回-1，表示 x &lt; y，</li>
<li>返回0，表示 x == y</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestNumber</span>(<span class="params">self, nums: List[int]</span>) -&gt; str:</span></span><br><span class="line">        <span class="keyword">from</span> functools <span class="keyword">import</span> cmp_to_key</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">cmp</span>(<span class="params">x, y</span>):</span></span><br><span class="line">            <span class="keyword">if</span> x + y &gt; y + x:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">            <span class="keyword">elif</span> x + y &lt; y + x:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        ans = <span class="string">""</span>.join(sorted(map(str, nums), key=cmp_to_key(cmp)))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'0'</span> <span class="keyword">if</span> ans[<span class="number">0</span>] == <span class="string">'0'</span> <span class="keyword">else</span> ans</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight stylus"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nums = [<span class="number">3</span>, <span class="number">20</span>]</span><br><span class="line"><span class="function"><span class="title">cmp</span><span class="params">(x, y)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">cmp</span><span class="params">(<span class="string">'20'</span>, <span class="string">'3'</span>)</span></span></span><br><span class="line"><span class="string">'20'</span> + <span class="string">'3'</span> &lt; <span class="string">'3'</span> + <span class="string">'20'</span></span><br><span class="line"><span class="string">'203'</span> &lt; <span class="string">'320'</span></span><br><span class="line">return <span class="number">1</span></span><br><span class="line"><span class="string">'20'</span> &gt; <span class="string">'3'</span> </span><br><span class="line"><span class="string">'3'</span> &lt; <span class="string">'20'</span></span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestNumber</span>(<span class="params">self, nums: List[int]</span>) -&gt; str:</span></span><br><span class="line">        <span class="keyword">from</span> functools <span class="keyword">import</span> cmp_to_key</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">cmp</span>(<span class="params">a, b</span>):</span>  <span class="comment"># eg.30&lt;3</span></span><br><span class="line">            <span class="keyword">if</span> a + b &lt; b + a:  <span class="comment"># 30+3&lt;3+30-&gt;-1</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">            <span class="keyword">elif</span> a + b &gt; b + a:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        res = <span class="string">''</span>.join(</span><br><span class="line">            sorted(map(str, nums), key=cmp_to_key(cmp), reverse=<span class="literal">True</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'0'</span> <span class="keyword">if</span> res[<span class="number">0</span>] == <span class="string">'0'</span> <span class="keyword">else</span> res</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight stylus"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">nums = [<span class="number">3</span>, <span class="number">20</span>]</span><br><span class="line"><span class="function"><span class="title">cmp</span><span class="params">(x, y)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">cmp</span><span class="params">(<span class="string">'3'</span>, <span class="string">'20'</span>)</span></span></span><br><span class="line"><span class="string">'3'</span> + <span class="string">'20'</span> &gt; <span class="string">'20'</span> + <span class="string">'3'</span></span><br><span class="line"><span class="string">'320'</span> &gt; <span class="string">'203'</span></span><br><span class="line">return <span class="number">1</span></span><br><span class="line"><span class="string">'3'</span> &gt; <span class="string">'20'</span> </span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight stylus"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">nums = [<span class="number">3</span>, <span class="number">20</span>]</span><br><span class="line"><span class="function"><span class="title">cmp</span><span class="params">(x, y)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">cmp</span><span class="params">(<span class="string">'3'</span>, <span class="string">'20'</span>)</span></span></span><br><span class="line"><span class="string">'3'</span> + <span class="string">'20'</span> &gt; <span class="string">'20'</span> + <span class="string">'3'</span></span><br><span class="line">return <span class="number">1</span></span><br><span class="line"><span class="string">'3'</span> &gt; <span class="string">'20'</span> </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">cmp</span><span class="params">(<span class="string">'10'</span>, <span class="string">'3'</span>)</span></span></span><br><span class="line"><span class="string">'10'</span> + <span class="string">'3'</span> &lt; <span class="string">'3'</span> + <span class="string">'10'</span></span><br><span class="line">return -<span class="number">1</span></span><br><span class="line"><span class="string">'10'</span> &lt; <span class="string">'3'</span> </span><br><span class="line"><span class="string">'3'</span> &gt; <span class="string">'10'</span> </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">cmp</span><span class="params">(<span class="string">'10'</span>, <span class="string">'20'</span>)</span></span></span><br><span class="line"><span class="string">'10'</span> + <span class="string">'20'</span> &lt; <span class="string">'20'</span> + <span class="string">'10'</span></span><br><span class="line">return -<span class="number">1</span></span><br><span class="line"><span class="string">'10'</span> &lt; <span class="string">'20'</span> </span><br><span class="line"><span class="string">'20'</span> &gt; <span class="string">'10'</span> </span><br></pre></td></tr></tbody></table></figure>

<p>如果是int对象比较大小，一般用 x - y来返回，这样就可以很形象的体现两者之间的位置关系了。<br>把数字转换成字符串。然后需要定义一种比较两个数的规则，<br>即把数字m和n拼接为mn，nm，只需要按照字符串大小的比较。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestNumber</span>(<span class="params">self, nums</span>):</span></span><br><span class="line">        <span class="keyword">from</span> functools <span class="keyword">import</span> cmp_to_key</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">str_cmp</span>(<span class="params">a, b</span>):</span></span><br><span class="line">            <span class="keyword">return</span> int(a + b) - int(b + a)</span><br><span class="line"></span><br><span class="line">        strs = [str(i) <span class="keyword">for</span> i <span class="keyword">in</span> nums]</span><br><span class="line">        strs.sort(key=cmp_to_key(str_cmp), reverse=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> str(int(<span class="string">''</span>.join(strs)))</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight stylus"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">strs = [<span class="string">'10'</span>, <span class="string">'3'</span>, <span class="string">'20'</span>]</span><br><span class="line"><span class="function"><span class="title">cmp</span><span class="params">(<span class="string">'3'</span>, <span class="string">'20'</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">int</span><span class="params">(a + b)</span></span> - int(<span class="selector-tag">b</span> + a)</span><br><span class="line"><span class="function"><span class="title">int</span><span class="params">(<span class="string">'3'</span> + <span class="string">'20'</span>)</span></span> - int(<span class="string">'20'</span> + <span class="string">'3'</span>)</span><br><span class="line"><span class="number">320</span> - <span class="number">203</span> = <span class="number">117</span></span><br><span class="line"><span class="string">'3'</span> &gt; <span class="string">'20'</span> </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">cmp</span><span class="params">(<span class="string">'10'</span>, <span class="string">'3'</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">int</span><span class="params">(<span class="string">'10'</span> + <span class="string">'3'</span>)</span></span> - int(<span class="string">'3'</span> + <span class="string">'10'</span>)</span><br><span class="line"><span class="number">103</span> - <span class="number">310</span> = -<span class="number">207</span> </span><br><span class="line"><span class="string">'10'</span> &lt; <span class="string">'3'</span> </span><br><span class="line"><span class="string">'3'</span> &gt; <span class="string">'10'</span> </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">cmp</span><span class="params">(<span class="string">'10'</span>, <span class="string">'20'</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">int</span><span class="params">(<span class="string">'10'</span> + <span class="string">'20'</span>)</span></span> - int(<span class="string">'20'</span> + <span class="string">'10'</span>)</span><br><span class="line"><span class="number">1020</span> - <span class="number">2010</span> = -<span class="number">990</span></span><br><span class="line"><span class="string">'10'</span> &lt; <span class="string">'20'</span> </span><br><span class="line"><span class="string">'20'</span> &gt; <span class="string">'10'</span> </span><br><span class="line"></span><br><span class="line">-<span class="number">990</span> &lt; -<span class="number">207</span> &lt; <span class="number">117</span></span><br><span class="line">strs = [<span class="string">'3'</span>, <span class="string">'20'</span>, <span class="string">'10'</span>]</span><br></pre></td></tr></tbody></table></figure>

<p>返回大于0的值代表x&gt;y，令x排在y后面</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestNumber</span>(<span class="params">self, nums: List[int]</span>) -&gt; str:</span></span><br><span class="line">        <span class="keyword">from</span> functools <span class="keyword">import</span> cmp_to_key</span><br><span class="line">        <span class="comment"># 比较两个数xy和yx的大小</span></span><br><span class="line">        key = cmp_to_key(<span class="keyword">lambda</span> x, y: int(y + x) - int(x + y))</span><br><span class="line">        <span class="comment"># lstrip() 方法: 截掉字符串左边的空格或指定字符  0012-&gt;12</span></span><br><span class="line">        res = <span class="string">''</span>.join(sorted(map(str, nums), key=key)).lstrip(<span class="string">'0'</span>)</span><br><span class="line">        <span class="keyword">return</span> res <span class="keyword">or</span> <span class="string">'0'</span></span><br></pre></td></tr></tbody></table></figure>

<p>冒泡<br>把需要判断的两个连续的字符串连起来，直接比较大小，然后根据比较的大小来决定需不需要做交换。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestNumber</span>(<span class="params">self, nums: List[int]</span>) -&gt; str:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,len(nums)-i<span class="number">-1</span>):</span><br><span class="line">                <span class="keyword">if</span> str(nums[j]) + str(nums[j+<span class="number">1</span>]) &lt; str(nums[j+<span class="number">1</span>])+ str(nums[j]):</span><br><span class="line">                    nums[j] ,nums[j+<span class="number">1</span>] =nums[j+<span class="number">1</span>], nums[j]</span><br><span class="line">        res=<span class="string">""</span>.join(str(i) <span class="keyword">for</span> i <span class="keyword">in</span> nums)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"0"</span> <span class="keyword">if</span> nums[<span class="number">0</span>]==<span class="number">0</span> <span class="keyword">else</span> res</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestNumber</span>(<span class="params">self, nums</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(nums) - i - <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> str(nums[j]) + str(nums[j + <span class="number">1</span>]) &gt; str(nums[j + <span class="number">1</span>]) + str(nums[j]):</span><br><span class="line">                    nums[j], nums[j + <span class="number">1</span>] = nums[j + <span class="number">1</span>], nums[j]</span><br><span class="line">        s = <span class="string">''</span></span><br><span class="line">        <span class="keyword">if</span> nums[<span class="number">-1</span>] == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span>(<span class="string">'0'</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> nums:</span><br><span class="line">            s = str(i) + s</span><br><span class="line">        <span class="keyword">return</span> s</span><br></pre></td></tr></tbody></table></figure>

<p>本质是排序算法，只是在判断大小的地方，把直接通过数学&lt;、&gt;的地方改成compare函数；<br>快速排序实现</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestNumber</span>(<span class="params">self, nums</span>):</span></span><br><span class="line">        self.quickSort(nums, <span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">        <span class="comment"># 边界case</span></span><br><span class="line">        <span class="keyword">if</span> nums[<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"0"</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>.join((str(n) <span class="keyword">for</span> n <span class="keyword">in</span> nums))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">quickSort</span>(<span class="params">self, nums, L, R</span>):</span></span><br><span class="line">        <span class="keyword">if</span> L &lt; R:</span><br><span class="line">            p = self.partition(nums, L, R)</span><br><span class="line">            self.quickSort(nums, L, p - <span class="number">1</span>)</span><br><span class="line">            self.quickSort(nums, p + <span class="number">1</span>, R)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partition</span>(<span class="params">self, nums, L, R</span>):</span></span><br><span class="line">        plv = nums[L]</span><br><span class="line"></span><br><span class="line">        i = L + <span class="number">1</span></span><br><span class="line">        j = R</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> i &lt;= j:</span><br><span class="line">            <span class="keyword">if</span> self.custom_compare(nums[i], plv) == <span class="number">-1</span>:</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> self.custom_compare(nums[j], plv) == <span class="number">1</span>:</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h2 id="剑指-Offer-45-把数组排成最小的数"><a href="#剑指-Offer-45-把数组排成最小的数" class="headerlink" title="剑指 Offer 45. 把数组排成最小的数"></a>剑指 Offer 45. 把数组排成最小的数</h2><p><strong>输入一个非负整数数组，把数组里所有数字拼接起来排成一个数，打印能拼接出的所有数字中最小的一个。</strong></p>
<blockquote>
<p>输出结果可能非常大，所以你需要返回一个字符串而不是整数<br>拼接起来的数字可能会有前导 0，最后结果不需要去掉前导 0</p>
</blockquote>
<p>示例 1:</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: [<span class="number">10</span>,<span class="number">2</span>]</span><br><span class="line">输出: <span class="string">"102"</span></span><br></pre></td></tr></tbody></table></figure>

<p>示例 2:</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: [<span class="number">3</span>,<span class="number">30</span>,<span class="number">34</span>,<span class="number">5</span>,<span class="number">9</span>]</span><br><span class="line">输出: <span class="string">"3033459"</span></span><br></pre></td></tr></tbody></table></figure>

<p>本题的“数字”指的就是每个元素整体</p>
<p>放数字的顺序肯定是先放第一位(最左边一位)最小的元素，如果第一位相等，比较第二位….，以此类推。<br>排列大小比较和字符串大小有点区别，比如 3 和 30，明显 30 排在前面比较好，</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(ord(<span class="string">"3"</span> &gt; <span class="string">"30"</span>))  <span class="comment"># TypeError: ord() expected a character, but string of length 2 found</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight 1c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">字典序方法</span><br><span class="line"><span class="string">"330"</span> &gt; <span class="string">"303"</span></span><br><span class="line"><span class="string">"3"</span> + <span class="string">"30"</span> &gt; <span class="string">"30"</span> + <span class="string">"3"</span></span><br><span class="line"><span class="string">"3"</span> &gt; <span class="string">"30"</span></span><br></pre></td></tr></tbody></table></figure>

<p>解题思路：</p>
<ul>
<li><p>此题求拼接起来的 “最小数字” ，本质上是一个排序问题。</p>
</li>
<li><p>排序判断规则： 设 nums 任意两数字的字符串格式 x 和 y ，则</p>
<ul>
<li>若拼接字符串 x + y &gt; y + x ，则 x &gt; y ；</li>
<li>反之，若 x + y &lt; y + x ，则 x &lt; y ；<br>不能加等于，要执行严格弱序，编译器发现相等会反序参数调用。也就是说a compare b和b compare a的结果必须是相反的。  </li>
</ul>
</li>
<li><p>根据以上规则，套用任何排序方法对 nums 执行排序即可。</p>
</li>
</ul>
<p>算法流程：</p>
<ol>
<li>初始化： 字符串列表 strs ，保存各数字的字符串格式；</li>
<li>列表排序： 应用以上 “排序判断规则” ，对 strs 执行排序；</li>
<li>返回值： 拼接 strs 中的所有字符串，并返回。</li>
</ol>
<p>复杂度分析：<br>时间复杂度 O(NlogN) ： N 为最终返回值的字符数量（ strs 列表的长度 ≤ N ）；使用快排或内置函数的平均时间复杂度为 O(NlogN) ，最差为 O(N^2) 。<br>空间复杂度 O(N) ： 字符串列表 strs 占用线性大小的额外空间。</p>
<p>法一<br>快速排序：</p>
<ul>
<li>需修改快速排序函数中的排序判断规则。字符串大小（字典序）对比的实现方法：</li>
</ul>
<p>跟 l 还是 r 比取决于我们把哪个元素看作”哨兵“，跟 l 比也可以，<br>如果要用 l ，哨兵 i, j 的移动先后顺序也要对换<br>因为最后要把 strs[i], strs[l] 交换，因此要保证 ``strs[i] &gt; strs[l]` （和 r 的情况正好相反），这样交换后才符合快排定义。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minNumber</span>(<span class="params">self, nums: List[int]</span>) -&gt; str:</span></span><br><span class="line"></span><br><span class="line">        arr = [str(i) <span class="keyword">for</span> i <span class="keyword">in</span> nums]</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">left, right</span>):</span></span><br><span class="line">            <span class="keyword">if</span> left &gt;= right: <span class="keyword">return</span> </span><br><span class="line">            low, high = left, right</span><br><span class="line">            target = arr[left]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> left &lt; right:</span><br><span class="line">                <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> arr[right] + target &gt;= target + arr[right] : right -= <span class="number">1</span></span><br><span class="line">                arr[left] = arr[right]</span><br><span class="line">                <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> arr[left] + target &lt;= target + arr[left]: left += <span class="number">1</span></span><br><span class="line">                arr[right] = arr[left]</span><br><span class="line">            </span><br><span class="line">            arr[left] = target</span><br><span class="line">            quick_sort(low, left<span class="number">-1</span>)</span><br><span class="line">            quick_sort(right+<span class="number">1</span>, high)</span><br><span class="line"></span><br><span class="line">        quick_sort(<span class="number">0</span>, len(arr)<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>.join(arr)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minNumber</span>(<span class="params">self, nums: List[int]</span>) -&gt; str:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">fast_sort</span>(<span class="params">l, r</span>):</span></span><br><span class="line">            <span class="keyword">if</span> l &gt;= r: <span class="keyword">return</span></span><br><span class="line">            i, j = l, r</span><br><span class="line">            <span class="keyword">while</span> i &lt; j:</span><br><span class="line">                <span class="keyword">while</span> strs[j] + strs[l] &gt;= strs[l] + strs[j] <span class="keyword">and</span> i &lt; j:</span><br><span class="line">                    j -= <span class="number">1</span>  <span class="comment"># 先移动 j</span></span><br><span class="line">                <span class="keyword">while</span> strs[i] + strs[l] &lt;= strs[l] + strs[i] <span class="keyword">and</span> i &lt; j:</span><br><span class="line">                    i += <span class="number">1</span></span><br><span class="line">                strs[i], strs[j] = strs[j], strs[i]</span><br><span class="line">            strs[i], strs[l] = strs[l], strs[i]</span><br><span class="line">            fast_sort(l, i - <span class="number">1</span>)</span><br><span class="line">            fast_sort(i + <span class="number">1</span>, r)</span><br><span class="line"></span><br><span class="line">        strs = [str(num) <span class="keyword">for</span> num <span class="keyword">in</span> nums]</span><br><span class="line">        fast_sort(<span class="number">0</span>, len(strs) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>.join(strs)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    nums1 = [<span class="number">10</span>, <span class="number">2</span>]</span><br><span class="line">    nums2 = [<span class="number">3</span>, <span class="number">30</span>, <span class="number">34</span>, <span class="number">5</span>, <span class="number">9</span>]</span><br><span class="line">    print(solution.minNumber(nums1))  <span class="comment"># 102</span></span><br><span class="line">    <span class="comment"># print(solution.minNumber(nums2))  # 3033459</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight lsl"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">nums = [<span class="number">3</span>, <span class="number">30</span>, <span class="number">34</span>, <span class="number">5</span>, <span class="number">9</span>]</span><br><span class="line">strs = ['<span class="number">3</span>', '<span class="number">30</span>', '<span class="number">34</span>', '<span class="number">5</span>', '<span class="number">9</span>']</span><br><span class="line">fast_sort(<span class="number">0</span>, len(strs) - <span class="number">1</span>)</span><br><span class="line">fast_sort(<span class="number">0</span>, <span class="number">5</span> - <span class="number">1</span>)</span><br><span class="line">fast_sort(<span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line">i = l = <span class="number">0</span>, j = r = <span class="number">4</span></span><br><span class="line">strs[j] + strs[l] &gt;= strs[l] + strs[j] and i &lt; j</span><br><span class="line">strs[<span class="number">4</span>] + strs[<span class="number">0</span>] &gt; strs[<span class="number">0</span>] + strs[<span class="number">4</span>] and <span class="number">0</span> &lt; <span class="number">4</span></span><br><span class="line">'<span class="number">9</span>' + '<span class="number">3</span>' &gt; '<span class="number">3</span>' + '<span class="number">9</span>' and <span class="number">0</span> &lt; <span class="number">4</span></span><br><span class="line">j = j - <span class="number">1</span> = <span class="number">4</span> - <span class="number">1</span> = <span class="number">0</span> = <span class="number">3</span></span><br><span class="line">strs[<span class="number">3</span>] + strs[<span class="number">0</span>] &gt; strs[<span class="number">0</span>] + strs[<span class="number">3</span>] and <span class="number">0</span> &lt; <span class="number">3</span></span><br><span class="line">'<span class="number">5</span>' + '<span class="number">3</span>' &gt; '<span class="number">3</span>' + '<span class="number">5</span>' and <span class="number">0</span> &lt; <span class="number">3</span></span><br><span class="line">j = j - <span class="number">1</span> = <span class="number">3</span> - <span class="number">1</span> = <span class="number">0</span> = <span class="number">2</span></span><br><span class="line">strs[<span class="number">2</span>] + strs[<span class="number">0</span>] &gt; strs[<span class="number">0</span>] + strs[<span class="number">2</span>] and <span class="number">0</span> &lt; <span class="number">2</span></span><br><span class="line">'<span class="number">34</span>' + '<span class="number">3</span>' &gt; '<span class="number">3</span>' + '<span class="number">34</span>' and <span class="number">0</span> &lt; <span class="number">2</span></span><br><span class="line">j = j - <span class="number">1</span> = <span class="number">2</span> - <span class="number">1</span> = <span class="number">0</span> = <span class="number">1</span></span><br><span class="line">strs[<span class="number">1</span>] + strs[<span class="number">0</span>] &lt; strs[<span class="number">0</span>] + strs[<span class="number">1</span>] and <span class="number">0</span> &lt; <span class="number">1</span></span><br><span class="line">'<span class="number">30</span>' + '<span class="number">3</span>' &lt; '<span class="number">3</span>' + '<span class="number">30</span>' and <span class="number">0</span> &lt; <span class="number">1</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = j </span><br><span class="line">strs[i], strs[j] = strs[j], strs[i]</span><br><span class="line">strs[<span class="number">1</span>], strs[<span class="number">1</span>] = strs[<span class="number">1</span>], strs[<span class="number">1</span>]</span><br><span class="line">跳出循环</span><br><span class="line">strs[i], strs[l] = strs[l], strs[i]</span><br><span class="line">strs[<span class="number">1</span>], strs[<span class="number">0</span>] = strs[<span class="number">0</span>], strs[<span class="number">1</span>]</span><br><span class="line">strs = ['<span class="number">30</span>', '<span class="number">3</span>', '<span class="number">34</span>', '<span class="number">5</span>', '<span class="number">9</span>']</span><br><span class="line"></span><br><span class="line">fast_sort(l, i - <span class="number">1</span>)</span><br><span class="line">fast_sort(<span class="number">0</span>, <span class="number">1</span> - <span class="number">1</span>)</span><br><span class="line">fast_sort(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">i = <span class="number">0</span> = j</span><br><span class="line">return</span><br><span class="line"></span><br><span class="line">fast_sort(i + <span class="number">1</span>, r)</span><br><span class="line">fast_sort(<span class="number">1</span> + <span class="number">1</span>, <span class="number">4</span>)</span><br><span class="line">fast_sort(<span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">i = l = <span class="number">2</span>, j = r = <span class="number">4</span></span><br><span class="line">strs[j] + strs[l] &gt;= strs[l] + strs[j] and i &lt; j</span><br><span class="line">strs[<span class="number">4</span>] + strs[<span class="number">2</span>] &gt; strs[<span class="number">2</span>] + strs[<span class="number">4</span>] and <span class="number">2</span> &lt; <span class="number">4</span></span><br><span class="line">'<span class="number">9</span>' + '<span class="number">34</span>' &gt; '<span class="number">34</span>' + '<span class="number">9</span>' and <span class="number">2</span> &lt; <span class="number">4</span></span><br><span class="line">j = j - <span class="number">1</span> = <span class="number">4</span> - <span class="number">1</span> = <span class="number">0</span> = <span class="number">3</span></span><br><span class="line">strs[<span class="number">3</span>] + strs[<span class="number">2</span>] &gt; strs[<span class="number">2</span>] + strs[<span class="number">3</span>] and <span class="number">2</span> &lt; <span class="number">3</span></span><br><span class="line">'<span class="number">5</span>' + '<span class="number">34</span>' &gt; '<span class="number">34</span>' + '<span class="number">5</span>' and <span class="number">2</span> &lt; <span class="number">3</span></span><br><span class="line">j = j - <span class="number">1</span> = <span class="number">3</span> - <span class="number">1</span> = <span class="number">0</span> = <span class="number">2</span> = i</span><br><span class="line">strs[i], strs[j] = strs[j], strs[i]</span><br><span class="line">strs[<span class="number">2</span>], strs[<span class="number">2</span>] = strs[<span class="number">2</span>], strs[<span class="number">2</span>]</span><br><span class="line">跳出循环</span><br><span class="line">strs[i], strs[l] = strs[l], strs[i]</span><br><span class="line">strs[<span class="number">2</span>], strs[<span class="number">2</span>] = strs[<span class="number">2</span>], strs[<span class="number">2</span>]</span><br><span class="line">strs = ['<span class="number">30</span>', '<span class="number">3</span>', '<span class="number">34</span>', '<span class="number">5</span>', '<span class="number">9</span>']</span><br><span class="line"></span><br><span class="line">fast_sort(l, i - <span class="number">1</span>)</span><br><span class="line">fast_sort(<span class="number">2</span>, <span class="number">2</span> - <span class="number">1</span>)</span><br><span class="line">fast_sort(<span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">return</span><br><span class="line"></span><br><span class="line">fast_sort(i + <span class="number">1</span>, r)</span><br><span class="line">fast_sort(<span class="number">2</span> + <span class="number">1</span>, <span class="number">4</span>)</span><br><span class="line">fast_sort(<span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">i = l = <span class="number">3</span>, j = r = <span class="number">4</span></span><br><span class="line">strs[j] + strs[l] &gt;= strs[l] + strs[j] and i &lt; j</span><br><span class="line">strs[<span class="number">4</span>] + strs[<span class="number">3</span>] &gt; strs[<span class="number">3</span>] + strs[<span class="number">4</span>] and <span class="number">3</span> &lt; <span class="number">4</span></span><br><span class="line">'<span class="number">9</span>' + '<span class="number">5</span>' &gt; '<span class="number">5</span>' + '<span class="number">9</span>' and <span class="number">3</span> &lt; <span class="number">4</span></span><br><span class="line">j = j - <span class="number">1</span> = <span class="number">4</span> - <span class="number">1</span> = <span class="number">0</span> = <span class="number">3</span> = i</span><br><span class="line">strs[i], strs[j] = strs[j], strs[i]</span><br><span class="line">strs[<span class="number">3</span>], strs[<span class="number">3</span>] = strs[<span class="number">3</span>], strs[<span class="number">3</span>]</span><br><span class="line">跳出循环</span><br><span class="line">strs[i], strs[l] = strs[l], strs[i]</span><br><span class="line">strs[<span class="number">3</span>], strs[<span class="number">3</span>] = strs[<span class="number">3</span>], strs[<span class="number">3</span>]</span><br><span class="line">strs = ['<span class="number">30</span>', '<span class="number">3</span>', '<span class="number">34</span>', '<span class="number">5</span>', '<span class="number">9</span>']</span><br><span class="line"></span><br><span class="line">fast_sort(i + <span class="number">1</span>, r)</span><br><span class="line">fast_sort(<span class="number">3</span> + <span class="number">1</span>, <span class="number">4</span>)</span><br><span class="line">fast_sort(<span class="number">4</span>, <span class="number">4</span>)</span><br><span class="line">reuturn</span><br><span class="line"></span><br><span class="line">return ''.join(strs) = '<span class="number">3303459</span>'</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight lsl"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">nums = [<span class="number">10</span>, <span class="number">2</span>]</span><br><span class="line">strs = ['<span class="number">10</span>', '<span class="number">2</span>']</span><br><span class="line">fast_sort(<span class="number">0</span>, len(strs) - <span class="number">1</span>)</span><br><span class="line">fast_sort(<span class="number">0</span>, <span class="number">2</span> - <span class="number">1</span>)</span><br><span class="line">fast_sort(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">i = l = <span class="number">0</span>, j = r = <span class="number">1</span></span><br><span class="line">strs[j] + strs[l] &gt;= strs[l] + strs[j] and i &lt; j</span><br><span class="line">strs[<span class="number">1</span>] + strs[<span class="number">0</span>] &gt; strs[<span class="number">0</span>] + strs[<span class="number">1</span>] and <span class="number">0</span> &lt; <span class="number">1</span></span><br><span class="line">'<span class="number">2</span>' + '<span class="number">10</span>' &gt; '<span class="number">10</span>' + '<span class="number">2</span>' and <span class="number">0</span> &lt; <span class="number">1</span></span><br><span class="line">j = j - <span class="number">1</span> = <span class="number">1</span> - <span class="number">1</span> = <span class="number">0</span> = i</span><br><span class="line"></span><br><span class="line">strs[j] + strs[l] &gt;= strs[l] + strs[j] and i &lt; j</span><br><span class="line">strs[<span class="number">1</span>] + strs[<span class="number">0</span>] &gt;= strs[<span class="number">0</span>] + strs[<span class="number">1</span>] and <span class="number">0</span> &lt; <span class="number">1</span></span><br><span class="line">j = j - <span class="number">1</span> = <span class="number">1</span> - <span class="number">1</span> = <span class="number">0</span> = i</span><br><span class="line">strs[i], strs[j] = strs[j], strs[i]</span><br><span class="line">strs[<span class="number">0</span>], strs[<span class="number">0</span>] = strs[<span class="number">0</span>], strs[<span class="number">0</span>]</span><br><span class="line">j = <span class="number">0</span> = i</span><br><span class="line"></span><br><span class="line">strs[i], strs[j] = strs[j], strs[i]</span><br><span class="line">strs[<span class="number">0</span>], strs[<span class="number">0</span>] = strs[<span class="number">0</span>], strs[<span class="number">0</span>]</span><br><span class="line">跳出循环</span><br><span class="line">strs[i], strs[l] = strs[l], strs[i]</span><br><span class="line">strs[<span class="number">0</span>], strs[<span class="number">0</span>] = strs[<span class="number">0</span>], strs[<span class="number">0</span>]</span><br><span class="line">strs = ['<span class="number">10</span>', '<span class="number">2</span>']</span><br><span class="line"></span><br><span class="line">fast_sort(l, i - <span class="number">1</span>)</span><br><span class="line">fast_sort(<span class="number">0</span>, <span class="number">0</span> - <span class="number">1</span>)</span><br><span class="line">fast_sort(<span class="number">0</span>, <span class="number">-1</span>)</span><br><span class="line">i = l = <span class="number">0</span> &gt; j = r = <span class="number">-1</span></span><br><span class="line">return</span><br><span class="line"></span><br><span class="line">fast_sort(i + <span class="number">1</span>, r)</span><br><span class="line">fast_sort(<span class="number">0</span> + <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">fast_sort(<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">i = l = <span class="number">1</span> = j = r </span><br><span class="line">return</span><br><span class="line"></span><br><span class="line">return ''.join(strs) = '<span class="number">102</span>'</span><br></pre></td></tr></tbody></table></figure>

<p>本文排序规则的传递性证明：</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">字符串 xy &lt; yx , yz &lt; zy ，需证明 xz &lt; zx 一定成立。</span><br><span class="line"></span><br><span class="line">设十进制数 x, y, z 分别有 a, b, c 位，则有：</span><br><span class="line">（左边是字符串拼接，右边是十进制数计算，两者等价）</span><br><span class="line">xy = x * <span class="number">10</span>^b + y </span><br><span class="line">yx = y * <span class="number">10</span>^a + x</span><br><span class="line"></span><br><span class="line">则 xy &lt; yx 可转化为：</span><br><span class="line">x * <span class="number">10</span>^b + y &lt; y * <span class="number">10</span>^a + x</span><br><span class="line">x (<span class="number">10</span>^b - <span class="number">1</span>) &lt; y (<span class="number">10</span>^a - <span class="number">1</span>)</span><br><span class="line">x / (<span class="number">10</span>^a - <span class="number">1</span>) &lt; y / (<span class="number">10</span>^b - <span class="number">1</span>)     ①</span><br><span class="line"></span><br><span class="line">同理， 可将 yz &lt; zy 转化为：</span><br><span class="line">y / (<span class="number">10</span>^b - <span class="number">1</span>) &lt; z / (<span class="number">10</span>^c - <span class="number">1</span>)     ②</span><br><span class="line"></span><br><span class="line">将 ① ② 合并，整理得：</span><br><span class="line">x / (<span class="number">10</span>^a - <span class="number">1</span>) &lt; y / (<span class="number">10</span>^b - <span class="number">1</span>) &lt; z / (<span class="number">10</span>^c - <span class="number">1</span>)</span><br><span class="line">x / (<span class="number">10</span>^a - <span class="number">1</span>) &lt; z / (<span class="number">10</span>^c - <span class="number">1</span>)</span><br><span class="line">x (<span class="number">10</span>^c - <span class="number">1</span>) &lt; z (<span class="number">10</span>^a - <span class="number">1</span>)</span><br><span class="line">x * <span class="number">10</span>^c + z &lt; z * <span class="number">10</span>^a + x</span><br><span class="line">∴  可推出 xz &lt; zx ，传递性证毕</span><br></pre></td></tr></tbody></table></figure>

<p>跟 l 还是 r 比取决于我们把哪个元素看作”哨兵“，跟 r 比也可以，<br>如果要用 r ，哨兵 i, j 的移动先后顺序也要对换<br>因为最后要把 strs[i], strs[r] 交换，因此要保证 ``strs[i] &gt; strs[r]` （和 l 的情况正好相反），这样交换后才符合快排定义。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minNumber</span>(<span class="params">self, nums: List[int]</span>) -&gt; str:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">fast_sort</span>(<span class="params">l , r</span>):</span></span><br><span class="line">            <span class="keyword">if</span> l &gt;= r: <span class="keyword">return</span></span><br><span class="line">            i, j = l, r</span><br><span class="line">            <span class="keyword">while</span> i &lt; j:</span><br><span class="line">                <span class="keyword">while</span> strs[i] + strs[r] &lt;= strs[r] + strs[i] <span class="keyword">and</span> i &lt; j:</span><br><span class="line">                    i += <span class="number">1</span>  <span class="comment"># 先移动 i</span></span><br><span class="line">                <span class="keyword">while</span> strs[j] + strs[r] &gt;= strs[r] + strs[j] <span class="keyword">and</span> i &lt; j: </span><br><span class="line">                    j -= <span class="number">1</span></span><br><span class="line">                strs[i], strs[j] = strs[j], strs[i]</span><br><span class="line">            strs[i], strs[r] = strs[r], strs[i]</span><br><span class="line">            fast_sort(l, i - <span class="number">1</span>)</span><br><span class="line">            fast_sort(i + <span class="number">1</span>, r)</span><br><span class="line">        </span><br><span class="line">        strs = [str(num) <span class="keyword">for</span> num <span class="keyword">in</span> nums]</span><br><span class="line">        fast_sort(<span class="number">0</span>, len(strs) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>.join(strs)</span><br></pre></td></tr></tbody></table></figure>

<p>函数 A 内部 定义 函数B ，则 B 的用途就是让 A 去调用的。函数 A 外，是无法访问函数 B 的，可以运行以下代码理解：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minNumber</span>(<span class="params">self, nums: List[int]</span>) -&gt; str:</span></span><br><span class="line">        strs = [str(num) <span class="keyword">for</span> num <span class="keyword">in</span> nums]</span><br><span class="line">        fast_sort(<span class="number">0</span>, len(strs) - <span class="number">1</span>) <span class="comment"># 报错 not defined</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>.join(strs)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">fast_sort</span>(<span class="params">l , r</span>):</span></span><br><span class="line">            <span class="keyword">if</span> l &gt;= r: <span class="keyword">return</span></span><br><span class="line">            i, j = l, r</span><br><span class="line">            <span class="keyword">while</span> i &lt; j:</span><br><span class="line">                <span class="keyword">while</span> strs[j] + strs[l] &gt;= strs[l] + strs[j] <span class="keyword">and</span> i &lt; j: j -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">while</span> strs[i] + strs[l] &lt;= strs[l] + strs[i] <span class="keyword">and</span> i &lt; j: i += <span class="number">1</span></span><br><span class="line">                strs[i], strs[j] = strs[j], strs[i]</span><br><span class="line">            strs[i], strs[l] = strs[l], strs[i]</span><br><span class="line">            fast_sort(l, i - <span class="number">1</span>)</span><br><span class="line">            fast_sort(i + <span class="number">1</span>, r)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>

<p>内置函数：<br>需定义排序规则：<br>Python 定义在函数 sort_rule(x, y) 中；<br>本题可以转化为排序问题，因此我们要定义一个“有效的排序规则”，然后按照这个排序规则、使用任意排序方法，将数组排序~<br>3.8 新版功能.<br><code>functools.cmp_to_key(func)</code><br>将(旧式的)比较函数转换为新式的 key function . 在类似于 sorted() ， min() ， max() ， heapq.nlargest() ， heapq.nsmallest() ， itertools.groupby() 等函数的 key 参数中使用。此函数主要用作将 Python 2 程序转换至新版的转换工具，以保持对比较函数的兼容。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minNumber</span>(<span class="params">self, nums: List[int]</span>) -&gt; str:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">sort_rule</span>(<span class="params">x, y</span>):</span></span><br><span class="line">            a, b = x + y, y + x</span><br><span class="line">            <span class="keyword">if</span> a &gt; b: <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> a &lt; b: <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        strs = [str(num) <span class="keyword">for</span> num <span class="keyword">in</span> nums]</span><br><span class="line">        strs.sort(key=functools.cmp_to_key(sort_rule))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>.join(strs)</span><br></pre></td></tr></tbody></table></figure>


<p>key 指向这个cmpSmaller ，然后sorted调用过程中，会强制转换类型 将原先的 str 字符串类型改为 这个 cmpSmaller 类型，然后排序的时候，就会调用这个 重写 的 <strong>lt</strong> 方法，从而使用了自定义的 排序规则，得到了最终结果。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cmpSmaller</span>(<span class="params">str</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__lt__</span>(<span class="params">self, y</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self + y &lt; y + self  <span class="comment"># 字符串拼接比较(两两比较)</span></span><br><span class="line">    <span class="comment"># 按由小到大来排列</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minNumber</span>(<span class="params">self, nums: List[int]</span>) -&gt; str:</span></span><br><span class="line">        res=sorted(map(str, nums),key=cmpSmaller)</span><br><span class="line">        smallest = <span class="string">''</span>.join(res)</span><br><span class="line">        <span class="keyword">return</span> smallest</span><br></pre></td></tr></tbody></table></figure>


<p>冒泡</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minNumber</span>(<span class="params">self, nums: List[int]</span>) -&gt; str:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</span><br><span class="line">            nums[i] = str(nums[i])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>,len(nums)):</span><br><span class="line">                <span class="keyword">if</span> nums[i] + nums[j] &gt; nums[j] + nums[i]:</span><br><span class="line">                    nums[i], nums[j] = nums[j], nums[i]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>.join(nums)</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h2 id="386-字典序排数"><a href="#386-字典序排数" class="headerlink" title="386. 字典序排数"></a>386. 字典序排数</h2><p><strong>给定一个整数&nbsp;n, 返回从&nbsp;1&nbsp;到&nbsp;n&nbsp;的字典顺序。</strong></p>
<p>例如，<br>给定 n =13，返回 [1,10,11,12,13,2,3,4,5,6,7,8,9] 。</p>
<p>例子是1在10之前<br>数字最高位是以1-9开头的，<br>给你一个数字1，把这个数字开头的，并且不大于n的所有数字按照位数由低到高依次排列<br>给你一个数字2，把这个数字开头的，并且不大于n的所有数字按照位数由低到高依次排列<br>当两个数字最高位相同的时候，就需要比较其次高位，比较方式与最高位的比较方式是一致的，也就是递归下去。（这是我的理解，可能有点不太准确）</p>
<p>将n个数按照一定的顺序构建成树，然后从左到右对每棵树进行dfs就行了</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">                    root</span><br><span class="line">            /           |            |          \  </span><br><span class="line">            <span class="number">1</span>            <span class="number">2</span>            <span class="number">3</span>    ...     <span class="number">9</span></span><br><span class="line">        /      \       \ </span><br><span class="line">      <span class="number">10</span>        <span class="number">11</span>    </span><br><span class="line">   /  |   \     /  |  |  \ </span><br><span class="line"><span class="number">100</span>  <span class="number">101</span>   <span class="number">109</span> <span class="number">110</span></span><br></pre></td></tr></tbody></table></figure>

<p>时间复杂度: O(N)，使用了递归，时间复杂度为进入递归函数的次数，我们遍历了每一个结点<br>空间复杂度: O(1)</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lexicalOrder</span>(<span class="params">self, n: int</span>) -&gt; List[int]:</span></span><br><span class="line">        res = []</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">dfs</span>(<span class="params">cur</span>):</span>  <span class="comment"># N叉树 深度优先搜索 对每棵树进行dfs cur为根结点</span></span><br><span class="line">            <span class="keyword">if</span> cur &gt; n:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            res.append(cur)</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">10</span>):  <span class="comment"># 遍历0 ~ 9</span></span><br><span class="line">                dfs(cur * <span class="number">10</span> + j)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">10</span>):  <span class="comment"># 遍历1 ~ 9</span></span><br><span class="line">            dfs(i)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = Solution()</span><br><span class="line">print(s.lexicalOrder(<span class="number">13</span>))</span><br><span class="line"><span class="comment"># [1, 10, 11, 12, 13, 2, 3, 4, 5, 6, 7, 8, 9]</span></span><br><span class="line">print(s.lexicalOrder(<span class="number">0</span>))  <span class="comment"># []</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">13</span></span><br><span class="line">res = []</span><br><span class="line"></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line">dfs(<span class="number">1</span>)</span><br><span class="line">    cur = <span class="number">1</span> &lt; n = <span class="number">13</span></span><br><span class="line">    res.append(cur)</span><br><span class="line">    res= [<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">    dfs(<span class="number">1</span> * <span class="number">10</span> + <span class="number">0</span>)</span><br><span class="line">    dfs(<span class="number">10</span>)</span><br><span class="line">        cur = <span class="number">10</span> &lt; n = <span class="number">13</span></span><br><span class="line">        res.append(cur)</span><br><span class="line">        res= [<span class="number">1</span>, <span class="number">10</span>]</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">        dfs(<span class="number">10</span> * <span class="number">10</span> + <span class="number">0</span>)</span><br><span class="line">        dfs(<span class="number">100</span>)</span><br><span class="line">            cur = <span class="number">100</span> &gt; n = <span class="number">13</span></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        j = <span class="number">1</span></span><br><span class="line">        dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">        dfs(<span class="number">10</span> * <span class="number">10</span> + <span class="number">1</span>)</span><br><span class="line">        dfs(<span class="number">101</span>)</span><br><span class="line">            cur = <span class="number">101</span> &gt; n = <span class="number">13</span></span><br><span class="line">            <span class="keyword">return</span>        </span><br><span class="line">        ....</span><br><span class="line">        j = <span class="number">9</span></span><br><span class="line">        dfs(cur * <span class="number">10</span> + <span class="number">9</span>)</span><br><span class="line">        dfs(<span class="number">10</span> * <span class="number">10</span> + <span class="number">9</span>)</span><br><span class="line">        dfs(<span class="number">109</span>)</span><br><span class="line">            cur = <span class="number">109</span> &gt; n = <span class="number">13</span></span><br><span class="line">            <span class="keyword">return</span>               </span><br><span class="line"></span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">    dfs(<span class="number">1</span> * <span class="number">10</span> + <span class="number">1</span>)</span><br><span class="line">    dfs(<span class="number">11</span>)</span><br><span class="line">        cur = <span class="number">11</span> &lt; n = <span class="number">13</span></span><br><span class="line">        res.append(cur)</span><br><span class="line">        res= [<span class="number">1</span>, <span class="number">10</span>, <span class="number">11</span>]</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">        dfs(<span class="number">11</span> * <span class="number">10</span> + <span class="number">0</span>)</span><br><span class="line">        dfs(<span class="number">110</span>)</span><br><span class="line">            cur = <span class="number">110</span> &gt; n = <span class="number">13</span></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        j = <span class="number">1</span></span><br><span class="line">        dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">        dfs(<span class="number">11</span> * <span class="number">10</span> + <span class="number">1</span>)</span><br><span class="line">        dfs(<span class="number">111</span>)</span><br><span class="line">            cur = <span class="number">111</span> &gt; n = <span class="number">13</span></span><br><span class="line">            <span class="keyword">return</span>  </span><br><span class="line">        ....</span><br><span class="line">        j = <span class="number">9</span></span><br><span class="line">        dfs(cur * <span class="number">10</span> + <span class="number">9</span>)</span><br><span class="line">        dfs(<span class="number">11</span> * <span class="number">10</span> + <span class="number">9</span>)</span><br><span class="line">        dfs(<span class="number">119</span>)</span><br><span class="line">            cur = <span class="number">119</span> &gt; n = <span class="number">13</span></span><br><span class="line">            <span class="keyword">return</span>      </span><br><span class="line"></span><br><span class="line">    j = <span class="number">2</span></span><br><span class="line">    dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">    dfs(<span class="number">1</span> * <span class="number">10</span> + <span class="number">2</span>)</span><br><span class="line">    dfs(<span class="number">12</span>)</span><br><span class="line">        cur = <span class="number">12</span> &lt; n = <span class="number">13</span></span><br><span class="line">        res.append(cur)</span><br><span class="line">        res= [<span class="number">1</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">        dfs(<span class="number">12</span> * <span class="number">10</span> + <span class="number">0</span>)</span><br><span class="line">        dfs(<span class="number">120</span>)</span><br><span class="line">            cur = <span class="number">120</span> &gt; n = <span class="number">13</span></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        j = <span class="number">1</span></span><br><span class="line">        dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">        dfs(<span class="number">12</span> * <span class="number">10</span> + <span class="number">1</span>)</span><br><span class="line">        dfs(<span class="number">121</span>)</span><br><span class="line">            cur = <span class="number">121</span> &gt; n = <span class="number">13</span></span><br><span class="line">            <span class="keyword">return</span>  </span><br><span class="line">        ....</span><br><span class="line">        j = <span class="number">9</span></span><br><span class="line">        dfs(cur * <span class="number">10</span> + <span class="number">9</span>)</span><br><span class="line">        dfs(<span class="number">12</span> * <span class="number">10</span> + <span class="number">9</span>)</span><br><span class="line">        dfs(<span class="number">129</span>)</span><br><span class="line">            cur = <span class="number">129</span> &gt; n = <span class="number">13</span></span><br><span class="line">            <span class="keyword">return</span>  </span><br><span class="line"></span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">    dfs(<span class="number">1</span> * <span class="number">10</span> + <span class="number">3</span>)</span><br><span class="line">    dfs(<span class="number">13</span>)</span><br><span class="line">        cur = <span class="number">13</span> = n</span><br><span class="line">        res.append(cur)</span><br><span class="line">        res= [<span class="number">1</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>]</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">        dfs(<span class="number">13</span> * <span class="number">10</span> + <span class="number">0</span>)</span><br><span class="line">        dfs(<span class="number">130</span>)</span><br><span class="line">            cur = <span class="number">130</span> &gt; n = <span class="number">13</span></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        j = <span class="number">1</span></span><br><span class="line">        dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">        dfs(<span class="number">13</span> * <span class="number">10</span> + <span class="number">1</span>)</span><br><span class="line">        dfs(<span class="number">131</span>)</span><br><span class="line">            cur = <span class="number">131</span> &gt; n = <span class="number">13</span></span><br><span class="line">            <span class="keyword">return</span>  </span><br><span class="line"></span><br><span class="line">        ....</span><br><span class="line"></span><br><span class="line">        j = <span class="number">9</span></span><br><span class="line">        dfs(cur * <span class="number">10</span> + <span class="number">9</span>)</span><br><span class="line">        dfs(<span class="number">13</span> * <span class="number">10</span> + <span class="number">9</span>)</span><br><span class="line">        dfs(<span class="number">139</span>)</span><br><span class="line">            cur = <span class="number">139</span> &gt; n = <span class="number">13</span></span><br><span class="line">            <span class="keyword">return</span>  </span><br><span class="line"></span><br><span class="line">    j = <span class="number">4</span></span><br><span class="line">    dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">    dfs(<span class="number">1</span> * <span class="number">10</span> + <span class="number">4</span>)</span><br><span class="line">    dfs(<span class="number">14</span>)</span><br><span class="line">        cur = <span class="number">14</span> &gt; n = <span class="number">13</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    j = <span class="number">5</span></span><br><span class="line">    dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">    dfs(<span class="number">1</span> * <span class="number">10</span> + <span class="number">5</span>)</span><br><span class="line">    dfs(<span class="number">15</span>)</span><br><span class="line">        cur = <span class="number">15</span> &gt; n = <span class="number">13</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    j = <span class="number">9</span></span><br><span class="line">    dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">    dfs(<span class="number">1</span> * <span class="number">10</span> + <span class="number">9</span>)</span><br><span class="line">    dfs(<span class="number">19</span>)</span><br><span class="line">        cur = <span class="number">19</span> &gt; n = <span class="number">13</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">i = <span class="number">2</span></span><br><span class="line">dfs(<span class="number">2</span>)</span><br><span class="line">    cur = <span class="number">2</span> &lt; n = <span class="number">13</span></span><br><span class="line">    res.append(cur)</span><br><span class="line">    res= [<span class="number">1</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">    dfs(<span class="number">2</span> * <span class="number">10</span> + <span class="number">0</span>)</span><br><span class="line">    dfs(<span class="number">20</span>)</span><br><span class="line">        cur = <span class="number">20</span> &gt; n = <span class="number">13</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">i = <span class="number">3</span></span><br><span class="line">dfs(<span class="number">3</span>)</span><br><span class="line">    cur = <span class="number">3</span> &lt; n = <span class="number">13</span></span><br><span class="line">    res.append(cur)</span><br><span class="line">    res= [<span class="number">1</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    dfs(cur * <span class="number">10</span> + j)</span><br><span class="line">    dfs(<span class="number">3</span> * <span class="number">10</span> + <span class="number">0</span>)</span><br><span class="line">    dfs(<span class="number">30</span>)</span><br><span class="line">        cur = <span class="number">30</span> &gt; n = <span class="number">13</span></span><br><span class="line">        <span class="keyword">return</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lexicalOrder</span>(<span class="params">self, n: int</span>) -&gt; List[int]:</span></span><br><span class="line">        self.n, self.res = n, []</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">dfs</span>(<span class="params">cur</span>):</span> </span><br><span class="line">            <span class="keyword">if</span> cur &gt; self.n: <span class="keyword">return</span> </span><br><span class="line">            self.res.append(cur)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">                dfs(<span class="number">10</span> * cur + i)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">            dfs(i)</span><br><span class="line">        <span class="keyword">return</span> self.res</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lexicalOrder</span>(<span class="params">self, n: int</span>) -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">return</span> sorted(range(<span class="number">1</span>, n+<span class="number">1</span>), key=str) </span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lexicalOrder</span>(<span class="params">self, n: int</span>) -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">return</span> sorted(list(range(<span class="number">1</span>,n+<span class="number">1</span>)),key=<span class="keyword">lambda</span> x:str(x))</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h2 id="剑指-Offer-19-正则表达式匹配"><a href="#剑指-Offer-19-正则表达式匹配" class="headerlink" title="剑指 Offer 19. 正则表达式匹配"></a>剑指 Offer 19. 正则表达式匹配</h2><p><strong>请实现一个函数用来匹配包含<code>'. '</code>和<code>'*'</code>的正则表达式。模式中的字符<code>'.'</code>表示任意一个字符，而<code>'*'</code>表示它前面的字符可以出现任意次（含0次）。在本题中，匹配是指字符串的所有字符匹配整个模式。例如，字符串<code>"aaa"</code>与模式<code>"a.a"</code>和<code>"ab*ac*a"</code>匹配，但与<code>"aa.a"</code>和<code>"ab*a"</code>均不匹配。</strong></p>
<p>示例 1:</p>
<figure class="highlight makefile"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">输入:</span></span><br><span class="line">s = <span class="string">"aa"</span></span><br><span class="line">p = <span class="string">"a"</span></span><br><span class="line"><span class="section">输出: false</span></span><br><span class="line"><span class="section">解释: "a" 无法匹配 "aa" 整个字符串。</span></span><br></pre></td></tr></tbody></table></figure>

<p>示例 2:</p>
<figure class="highlight smalltalk"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">输入:</span><br><span class="line">s = <span class="comment">"aa"</span></span><br><span class="line">p = <span class="comment">"a*"</span></span><br><span class="line">输出: <span class="keyword">true</span></span><br><span class="line">解释: 因为 <span class="string">'*'</span> 代表可以匹配零个或多个前面的那一个元素, 在这里前面的元素就是 <span class="string">'a'</span>。因此，字符串 <span class="comment">"aa"</span> 可被视为 <span class="string">'a'</span> 重复了一次。</span><br></pre></td></tr></tbody></table></figure>

<p>示例 3:</p>
<figure class="highlight makefile"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">输入:</span></span><br><span class="line">s = <span class="string">"ab"</span></span><br><span class="line">p = <span class="string">".*"</span></span><br><span class="line"><span class="section">输出: true</span></span><br><span class="line"><span class="section">解释: ".*" 表示可匹配零个或多个（'*'）任意字符（'.'）。</span></span><br></pre></td></tr></tbody></table></figure>

<p>示例 4:</p>
<figure class="highlight smalltalk"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">输入:</span><br><span class="line">s = <span class="comment">"aab"</span></span><br><span class="line">p = <span class="comment">"c*a*b"</span></span><br><span class="line">输出: <span class="keyword">true</span></span><br><span class="line">解释: 因为 <span class="string">'*'</span> 表示零个或多个，这里 <span class="string">'c'</span> 为 <span class="number">0</span> 个, <span class="string">'a'</span> 被重复一次。因此可以匹配字符串 <span class="comment">"aab"</span>。</span><br></pre></td></tr></tbody></table></figure>
<p>示例 5:</p>
<figure class="highlight makefile"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">输入:</span></span><br><span class="line">s = <span class="string">"mississippi"</span></span><br><span class="line">p = <span class="string">"mis*is*p*."</span></span><br><span class="line"><span class="section">输出: false</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>s 可能为空，且只包含从 a-z 的小写字母。</li>
<li>p 可能为空，且只包含从 a-z 的小写字母以及字符 . 和 <em>，无连续的 ‘</em>‘。</li>
</ul>
<p>解题思路：</p>
<blockquote>
<p>设 s 的长度为 n ， p 的长度为 m ；将 s 的第 i 个字符记为 s_i ，p 的第 j 个字符记为 p_j ，将 s 的前 i 个字符组成的子字符串记为 s[:i] , 同理将 p 的前 j 个字符组成的子字符串记为 p[:j] 。</p>
</blockquote>
<blockquote>
<p>因此，本题可转化为求 s[:n] 是否能和 p[:m] 匹配。</p>
</blockquote>
<p>总体思路是从 s[:1] 和 p[:1] 是否能匹配开始判断，每轮添加一个字符并判断是否能匹配，直至添加完整个字符串 s 和 p 。展开来看，假设 s[:i] 与 p[:j] 可以匹配，那么下一状态有两种：</p>
<ol>
<li>添加一个字符 s_{i+1} 后是否能匹配？</li>
<li>添加字符 p_{j+1} 后是否能匹配？</li>
</ol>
<p>因此，本题的状态共有 m×n 种，应定义状态矩阵 dp ，dp[i][j] 代表 s[:i] 与 p[:j] 是否可以匹配。</p>
<p>做好状态定义，接下来就是根据 「<code>普通字符</code>」 , 「<code>.</code>」 , 「<code>*</code>」三种字符的功能定义，分析出动态规划的转移方程。</p>
<h3 id="动态规划解析："><a href="#动态规划解析：" class="headerlink" title="动态规划解析："></a>动态规划解析：</h3><ul>
<li><p>状态定义： 设动态规划矩阵 <code>dp</code> ， <code>dp[i][j]</code> 代表字符串 <code>s</code> 的前 <code>i</code> 个字符和 <code>p</code> 的前 <code>j</code> 个字符能否匹配。</p>
</li>
<li><p>转移方程： 需要注意，由于 <code>dp[0][0]</code> 代表的是空字符的状态， 因此 <code>dp[i][j]</code> 对应的添加字符是 <code>s[i - 1]</code> 和 <code>p[j - 1]</code> 。</p>
</li>
</ul>
<p>当 <code>p[j - 1] = '*'</code> 时， dp[i][j] 在当以下任一情况为 truetrue 时等于 truetrue ：</p>
<p>dp[i][j - 2]： 即将字符组合 p[j - 2] * 看作出现 0 次时，能否匹配；<br>dp[i][j - 1]： 即将字符组合 p[j - 2] * 看作出现 1 次时，能否匹配；<br>dp[i - 1][j] 且 s[i - 1] = p[j - 2]: 即让字符 p[j - 2] 多出现 1 次时，能否匹配；<br>dp[i - 1][j] 且 p[j - 2] = ‘.’: 即让字符 ‘.’ 多出现 1 次时，能否匹配；<br>当 p[j - 1] != ‘*’ 时， dp[i][j] 在当以下任一情况为 truetrue 时等于 truetrue ：</p>
<p>dp[i - 1][j - 1] 且 s[i - 1] = p[j - 1]： 即让字符 p[j - 1] 多出现一次时，能否匹配；<br>dp[i - 1][j - 1] 且 p[j - 1] = ‘.’： 即将字符 . 看作字符 s[i - 1] 时，能否匹配；<br>初始化： 需要先初始化 dp 矩阵首行，以避免状态转移时索引越界。</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">```dp[0][j] = dp[0][j - 2]``` 且 ```p[j - 1] = '*'```： 首行 s 为空字符串，因此当 p 的偶数位为 * 时才能够匹配（即让 p 的奇数位出现 0 次，保持 p 是空字符串）。因此，循环遍历字符串 p ，步长为 2（即只看偶数位）。</span><br><span class="line"></span><br><span class="line">- 返回值： ```dp``` 矩阵右下角字符，代表字符串 s 和 p 能否匹配。</span><br><span class="line"></span><br><span class="line">时间复杂度 O(MN) ： 其中 M, N 分别为 ```s``` 和 ```p``` 的长度，状态转移需遍历整个 ```dp``` 矩阵。</span><br><span class="line">空间复杂度 O(MN) ： 状态矩阵 ```dp``` 使用 O(MN) 的额外空间。</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line">class Solution:</span><br><span class="line">    def isMatch(self, s: str, p: str) -&gt; bool:</span><br><span class="line">        m, n = len(s) + 1, len(p) + 1</span><br><span class="line">        dp = [[False] * n for _ in range(m)]</span><br><span class="line">        dp[0][0] = True</span><br><span class="line">        # 初始化首行</span><br><span class="line">        for j in range(2, n, 2):</span><br><span class="line">            dp[0][j] = dp[0][j - 2] and p[j - 1] == '*'</span><br><span class="line">        # 状态转移</span><br><span class="line">        for i in range(1, m):</span><br><span class="line">            for j in range(1, n):</span><br><span class="line">                if p[j - 1] == '*':</span><br><span class="line">                    if dp[i][j - 2]:</span><br><span class="line">                        dp[i][j] = True  # 1.</span><br><span class="line">                    elif dp[i][j - 1]:</span><br><span class="line">                        dp[i][j] = True  # 2.</span><br><span class="line">                    elif dp[i - 1][j] and s[i - 1] == p[j - 2]:</span><br><span class="line">                        dp[i][j] = True  # 3.</span><br><span class="line">                    elif dp[i - 1][j] and p[j - 2] == '.':</span><br><span class="line">                        dp[i][j] = True  # 4.</span><br><span class="line">                else:</span><br><span class="line">                    if dp[i - 1][j - 1] and s[i - 1] == p[j - 1]:</span><br><span class="line">                        dp[i][j] = True  # 1.</span><br><span class="line">                    elif dp[i - 1][j - 1] and p[j - 1] == '.':</span><br><span class="line">                        dp[i][j] = True  # 2.</span><br><span class="line">        return dp[-1][-1]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == '__main__':</span><br><span class="line">    solution = Solution()</span><br><span class="line">    nums1 = 'aaa'</span><br><span class="line">    nums2 = 'ab*.*'</span><br><span class="line">    print(solution.isMatch(nums1, nums2))  # True</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight markdown"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">s = 'aaa'</span><br><span class="line">p = 'ab<span class="emphasis">*.*</span>'</span><br><span class="line">m = len(s) + 1 = 4</span><br><span class="line">n = len(p) + 1 = 6</span><br><span class="line"></span><br><span class="line"><span class="emphasis">_ = 0</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">dp = [</span></span><br><span class="line"><span class="emphasis">    [False, False, False, False, False, False, False, False], </span></span><br><span class="line"><span class="emphasis">    [False, False, False, False, False, False, False, False], </span></span><br><span class="line"><span class="emphasis">    [False, False, False, False, False, False, False, False], </span></span><br><span class="line"><span class="emphasis">    [False, False, False, False, False, False, False, False] </span></span><br><span class="line"><span class="emphasis">    ]</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">dp[<span class="string">0</span>][<span class="symbol">0</span>] = True</span></span><br><span class="line"><span class="emphasis">dp = [</span></span><br><span class="line"><span class="emphasis">    [True, False, False, False, False, False, False, False], </span></span><br><span class="line"><span class="emphasis">    [False, False, False, False, False, False, False, False], </span></span><br><span class="line"><span class="emphasis">    [False, False, False, False, False, False, False, False], </span></span><br><span class="line"><span class="emphasis">    [False, False, False, False, False, False, False, False] </span></span><br><span class="line"><span class="emphasis">    ]</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">j = 2   </span></span><br><span class="line"><span class="emphasis">dp[<span class="string">0</span>][<span class="symbol">j</span>] = dp[<span class="string">0</span>][<span class="symbol">j - 2</span>]</span></span><br><span class="line"><span class="emphasis">dp[<span class="string">0</span>][<span class="symbol">2</span>] = dp[<span class="string">0</span>][<span class="symbol">2 - 2</span>]</span></span><br><span class="line"><span class="emphasis">dp[<span class="string">0</span>][<span class="symbol">2</span>] = dp[<span class="string">0</span>][<span class="symbol">0</span>]</span></span><br><span class="line"><span class="emphasis">p[j - 1] == '*'</span></span><br><span class="line"><span class="emphasis">p[2 - 1] == '*'</span></span><br><span class="line"><span class="emphasis">p[1] == '*'</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">j = 4</span></span><br><span class="line"><span class="emphasis">dp[<span class="string">0</span>][<span class="symbol">4</span>] = dp[<span class="string">0</span>][<span class="symbol">4 - 2</span>]</span></span><br><span class="line"><span class="emphasis">dp[<span class="string">0</span>][<span class="symbol">4</span>] = dp[<span class="string">0</span>][<span class="symbol">2</span>]</span></span><br><span class="line"><span class="emphasis">p[j - 1] == '*'</span></span><br><span class="line"><span class="emphasis">p[4 - 1] == '*'</span></span><br><span class="line"><span class="emphasis">p[3] == '*'</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">i = 1</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">    j = 1</span></span><br><span class="line"><span class="emphasis">    p[j - 1] == p[1 - 1] == p[0] = 'a' != '*'</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">    dp[<span class="string">i - 1</span>][<span class="symbol">j - 1</span>] = dp[<span class="string">1 - 1</span>][<span class="symbol">1 - 1</span>]  = dp[<span class="string">0</span>][<span class="symbol">0</span>] = True</span></span><br><span class="line"><span class="emphasis">    s[i - 1] = s[1 - 1] == s[0] = 'a' = p[1 - 1] = p[0]</span></span><br><span class="line"><span class="emphasis">    dp[<span class="string">i</span>][<span class="symbol">j</span>] = dp[<span class="string">1</span>][<span class="symbol">1</span>] = True</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">    dp = [</span></span><br><span class="line"><span class="emphasis">        [True, False, False, False, False, False, False, False], </span></span><br><span class="line"><span class="emphasis">        [False, True, False, False, False, False, False, False], </span></span><br><span class="line"><span class="emphasis">        [False, False, False, False, False, False, False, False], </span></span><br><span class="line"><span class="emphasis">        [False, False, False, False, False, False, False, False] </span></span><br><span class="line"><span class="emphasis">        ]</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">    j = 2</span></span><br><span class="line"><span class="emphasis">    p[j - 1] == p[2 - 1] == p[1] = 'b' != '*'</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">    dp[<span class="string">i - 1</span>][<span class="symbol">j - 1</span>] = dp[<span class="string">1 - 1</span>][<span class="symbol">2 - 1</span>]  = dp[<span class="string">0</span>][<span class="symbol">1</span>] = True</span></span><br><span class="line"><span class="emphasis">    s[i - 1] = s[1 - 1] == s[0] = 'a' != p[2 - 1] = p[1] = 'b'</span></span><br><span class="line"><span class="emphasis">    False</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">    dp[<span class="string">i - 1</span>][<span class="symbol">j - 1</span>] = dp[<span class="string">1 - 1</span>][<span class="symbol">2 - 1</span>] = dp[<span class="string">0</span>][<span class="symbol">1</span>] = False</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">    j = 3</span></span><br><span class="line"><span class="emphasis">    p[j - 1] == p[3 - 1] == p[2] = '*'</span></span><br><span class="line"><span class="emphasis">    dp[<span class="string">i</span>][<span class="symbol">j - 2</span>] = dp[<span class="string">1</span>][<span class="symbol">3 - 2</span>] = dp[<span class="string">1</span>][<span class="symbol">1</span>] = True</span></span><br><span class="line"><span class="emphasis">    dp[<span class="string">i</span>][<span class="symbol">j</span>] = dp[<span class="string">1</span>][<span class="symbol">3</span>] = True</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">    dp = [</span></span><br><span class="line"><span class="emphasis">        [True, False, False, False, False, False, False, False], </span></span><br><span class="line"><span class="emphasis">        [False, True, False, True, False, False, False, False], </span></span><br><span class="line"><span class="emphasis">        [False, False, False, False, False, False, False, False], </span></span><br><span class="line"><span class="emphasis">        [False, False, False, False, False, False, False, False] </span></span><br><span class="line"><span class="emphasis">        ]</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">    j = 4</span></span><br><span class="line"><span class="emphasis">    p[j - 1] == p[4 - 1] == p[3] = '.' != '*'</span></span><br><span class="line"><span class="emphasis">    dp[<span class="string">i - 1</span>][<span class="symbol">j - 1</span>] = dp[<span class="string">1 - 1</span>][<span class="symbol">4 - 1</span>] = dp[<span class="string">0</span>][<span class="symbol">3</span>] = False</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">    j = 5</span></span><br><span class="line"><span class="emphasis">    p[j - 1] == p[5 - 1] == p[4] = '*'</span></span><br><span class="line"><span class="emphasis">    dp[<span class="string">i</span>][<span class="symbol">j - 2</span>] = dp[<span class="string">1</span>][<span class="symbol">5 - 2</span>] = dp[<span class="string">1</span>][<span class="symbol">3</span>] = True</span></span><br><span class="line"><span class="emphasis">    dp[<span class="string">i</span>][<span class="symbol">j</span>] = dp[<span class="string">1</span>][<span class="symbol">5</span>] = True</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">    dp = [</span></span><br><span class="line"><span class="emphasis">        [True, False, False, False, False, False], </span></span><br><span class="line"><span class="emphasis">        [False, True, False, True, False, True], </span></span><br><span class="line"><span class="emphasis">        [False, False, False, False, False, False], </span></span><br><span class="line"><span class="emphasis">        [False, False, False, False, False, False] </span></span><br><span class="line"><span class="emphasis">        ]</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">i = 2</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">    j = 1</span></span><br><span class="line"><span class="emphasis">    p[j - 1] == p[1 - 1] == p[0] = 'a' != '*'</span></span><br><span class="line"><span class="emphasis">    dp[<span class="string">i - 1</span>][<span class="symbol">j - 1</span>] = dp[<span class="string">2 - 1</span>][<span class="symbol">1 - 1</span>]  = dp[<span class="string">1</span>][<span class="symbol">0</span>] = False</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">    j = 2</span></span><br><span class="line"><span class="emphasis">    p[j - 1] == p[2 - 1] == p[1] = 'b' != '*'</span></span><br><span class="line"><span class="emphasis">    dp[<span class="string">i - 1</span>][<span class="symbol">j - 1</span>] = dp[<span class="string">2 - 1</span>][<span class="symbol">2 - 1</span>]  = dp[<span class="string">1</span>][<span class="symbol">1</span>] = True</span></span><br><span class="line"><span class="emphasis">    s[i - 1] = s[2 - 1] = s[1] = 'a' != p[j - 1] = p[2 - 1] = p[1] = 'b'</span></span><br><span class="line"><span class="emphasis">    False</span></span><br><span class="line"><span class="emphasis">    p[j - 1] = p[2 - 1] = p[1] = 'b' != '.'</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">    j = 3</span></span><br><span class="line"><span class="emphasis">    dp[<span class="string">i</span>][<span class="symbol">j - 2</span>] = dp[<span class="string">2</span>][<span class="symbol">3 - 2</span>] = dp[<span class="string">2</span>][<span class="symbol">1</span>] = False</span></span><br><span class="line"><span class="emphasis">    dp[<span class="string">i</span>][<span class="symbol">j - 1</span>] = dp[<span class="string">2</span>][<span class="symbol">3 - 1</span>] = dp[<span class="string">2</span>][<span class="symbol">2</span>] = False</span></span><br><span class="line"><span class="emphasis">    dp[<span class="string">i - 1</span>][<span class="symbol">j</span>] = dp[<span class="string">2 - 1</span>][<span class="symbol">3</span>] = dp[<span class="string">1</span>][<span class="symbol">3</span>] = False</span></span><br><span class="line"><span class="emphasis"></span></span><br></pre></td></tr></tbody></table></figure>

<p>利用布尔运算实现简短长度</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isMatch</span>(<span class="params">self, s: str, p: str</span>) -&gt; bool:</span></span><br><span class="line">        m, n = len(s) + <span class="number">1</span>, len(p) + <span class="number">1</span></span><br><span class="line">        dp = [[<span class="literal">False</span>] * n <span class="keyword">for</span> _ <span class="keyword">in</span> range(m)]</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">2</span>, n, <span class="number">2</span>):</span><br><span class="line">            dp[<span class="number">0</span>][j] = dp[<span class="number">0</span>][j - <span class="number">2</span>] <span class="keyword">and</span> p[j - <span class="number">1</span>] == <span class="string">'*'</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, m):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">                dp[i][j] = dp[i][j - <span class="number">2</span>] <span class="keyword">or</span> dp[i][j - <span class="number">1</span>] <span class="keyword">or</span> dp[i - <span class="number">1</span>][j] <span class="keyword">and</span> (s[i - <span class="number">1</span>] == p[j - <span class="number">2</span>] <span class="keyword">or</span> p[j - <span class="number">2</span>] == <span class="string">'.'</span>) \</span><br><span class="line">                           <span class="keyword">if</span> p[j - <span class="number">1</span>] == <span class="string">'*'</span> <span class="keyword">else</span> \</span><br><span class="line">                           dp[i - <span class="number">1</span>][j - <span class="number">1</span>] <span class="keyword">and</span> (p[j - <span class="number">1</span>] == <span class="string">'.'</span> <span class="keyword">or</span> s[i - <span class="number">1</span>] == p[j - <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">-1</span>][<span class="number">-1</span>]</span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/leetcode-sql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/leetcode-sql/" class="post-title-link" itemprop="url">leetcode sql</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-06-29 02:54:28" itemprop="dateModified" datetime="2021-06-29T02:54:28Z">2021-06-29</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Markdown/" itemprop="url" rel="index"><span itemprop="name">Markdown</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>正常情况下SELECT的书写顺序和执行顺序</p>
<h3 id="写法顺序："><a href="#写法顺序：" class="headerlink" title="写法顺序："></a>写法顺序：</h3><p>SELECT →FROM → JOIN → ON → WHERE → GROUP BY → HAVING → ORDER BY→ LIMIT</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 查询列表                ⑦                    </span><br><span class="line"><span class="keyword">FROM</span> 表 <span class="number">1</span>                    ①                                      </span><br><span class="line">【连接类型】 <span class="keyword">JOIN</span> 表 <span class="number">2</span>        ③                           </span><br><span class="line"><span class="keyword">ON</span> 连接条件                    ②</span><br><span class="line"><span class="keyword">WHERE</span> 筛选条件                ④</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> 分组列表            ⑤</span><br><span class="line"><span class="keyword">HAVING</span> 分组后的筛选条件        ⑥</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 排序的字段            ⑧</span><br><span class="line"><span class="keyword">LIMIT</span> 起始的条目索引，条目数;    ⑨</span><br></pre></td></tr></tbody></table></figure>

<h3 id="执行顺序："><a href="#执行顺序：" class="headerlink" title="执行顺序："></a>执行顺序：</h3><p>FROM → ON → JOIN → WHERE → GROUP BY → with HAVING → SELECT → ORDER BY→ LIMIT<br>TOP</p>
<p>若 每页显示条目数：<code>pageSize</code>，要显示的页数：<code>page</code><br>则有：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> 表 <span class="keyword">LIMIT</span> （page<span class="number">-1</span>）* pageSize,pageSize</span><br></pre></td></tr></tbody></table></figure>

<p>解题方法<br>根据考题要搞清楚表的结果和多表之间的关系，根据想要的结果思考使用那种关联方式，通常把要查询的列先写出来，然后分析这些列都属于哪些表，才考虑使用关联查询</p>
<p>其中每一个操作都会产生一张虚拟的表，这个虚拟的表作为一个处理的输入，只是这些虚拟的表对用户来说是透明的，但是只有最后一个虚拟的表才会被作为结果返回。如果没有在语句中指定某一个子句，那么将会跳过相应的步骤</p>
<p>因为ON是先把不符合条件的记录过滤后才进行统计，它就可以减少中间运算要处理的数据，按理说应该速度是最快的，WHERE也应该比HAVING快点的，因为它过滤数据后才进行SUM，在两个表联接时才用ON的，所以在一个表的时候，就剩下WHERE跟HAVING比较了。</p>
<p>表连接，同时查询多张表格，效率高于子查询<br>数据库在通过连接两张或多张表来返回记录时，都会生成一张中间的临时表，然后再将这张临时表返回给用户。</p>
<p>from子句中on条件主要用来连接表，其他不属于连接表的条件可以使用where子句来指定；<br>考虑联接优先顺序：<br>join连接分为三种  外连接的outer 和内连接的inner 都可以省略：</p>
<ol>
<li>内连接 inner join ，默认，所以可以省略inner关键字，又叫等值连接，只返回两个表中不一定必须有同名字段，只要连接字段相等的行、公共数据、符合连接条件。查询条件放在&nbsp;on子句和where子句的返回的结果集是相同的。<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> A,B <span class="keyword">WHERE</span> A.id=B.id</span><br></pre></td></tr></tbody></table></figure>
或者<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">from</span> a <span class="keyword">inner</span> <span class="keyword">Join</span> b <span class="keyword">on</span> A.id=B.id</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">from</span> a <span class="keyword">Join</span> b <span class="keyword">on</span> A.id=B.id <span class="keyword">JOIN</span> c <span class="keyword">on</span> B.id=c.id;</span><br></pre></td></tr></tbody></table></figure>

</li>
</ol>
<p>自连接（自身连接）的本质是把一张表复制出多张一模一样的表来使用。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 列名 </span><br><span class="line"><span class="keyword">from</span> 表名 <span class="keyword">as</span> 别名<span class="number">1</span>,表名 <span class="keyword">as</span> 别名<span class="number">2</span>;</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> A T1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> A T2 <span class="keyword">ON</span> T1.id=T2.pid</span><br></pre></td></tr></tbody></table></figure>

<ol start="2">
<li><p>外连接 outer join 是指的要保存未匹配信息 包括<br>left join,在mysql是left outer join的简写 ，左外连接，左联结</p>
<p>在使用&nbsp;left jion&nbsp;时，on&nbsp;和&nbsp;where&nbsp;条件的区别如下：<br>• on&nbsp;条件是在生成临时表时使用的补充条件，以左表为主,先查询出左表,不管&nbsp;on&nbsp;上的条件是否为真，都会返回左表的全部数据都会在结果集中，左表有而右表中不匹配的行，右表选择字段列置为null<br>• where&nbsp;条件是在临时表生成好后，再对临时表进行过滤的条件。这时已经没有&nbsp;left join&nbsp;的含义（必须返回左边表的记录）了，条件不为真的就过滤掉，条件真假直接影响结果实际的执行效果相当于inner join .</p>
</li>
</ol>
<p>right join right outer join ，右外连接，结果表中除了匹配行外，还包括右表有而左表中不匹配的行，对于这样的行，左表选择列置为null </p>
<ol start="3">
<li>full join 是full outer join的简写，全连接，<br>mysql不支持full outer join，Mysql可以用left join+union+right join来解决<br>将多个查询语句的结果进行合并</li>
</ol>
<p>联合查询</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">FROM</span> A <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="keyword">FROM</span> B <span class="keyword">UNION</span></span><br></pre></td></tr></tbody></table></figure>
<p>就是把多个结果集集中在一起, UNION前的结果为基准,需要注意的是联合查询的列数要相等,相同的记录行会合并,字段个数相同，结果集字段名称相同</p>
<p>SELECT FRoM A left Join b on A id=B id UNIOn<br>SELECT FRoM A RIGHT Join BoN A. id=Bid</p>
<p>查询语句 union （查询语句）union （查询语句）<br>如果使用 UNION ALL,不会合并重复的记录行,会显示重复的数据<br>优化UNION查询 UNION ALL的效率高于UNION</p>
<p>natural join，自然连接，分为natural left outer join和natural right outer join，语义定义与inner join相同 </p>
<p>3：cross join，交叉连接，没有任何关联条件,将两个表进行笛卡尔积运算，结果表的行数等于两表行数之积，就是第一个表的行数乘以第二个表的行数。结果集会很大,没有意义,很少使用</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> A B(,C)</span><br></pre></td></tr></tbody></table></figure>
<p>或者</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> A <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> B (<span class="keyword">CROSS</span> <span class="keyword">JOIN</span> C)</span><br></pre></td></tr></tbody></table></figure>

<p>在IN后面值的列表中，将出现最频繁的值放在最前面，出现得最少的放在最后面，减少判断的次数。</p>
<p>子查询是一种查询中嵌套在 where子句 from子句 select子句查询的语句，<br>效率不好把握<br>不能写在order子句</p>
<p>当一个SQL语句的结果是作为另外一条SQL语句的条件时则需要用到子查询。</p>
<p>from子查询不是相关子查询，把结果集作为一张表，与其他的数据表做表连接</p>
<p>嵌套子查询：执行不依赖与外部的查询。<br>优化子查询：用关联查询替代<br>执行过程：先执行子查询再执行主查询<br>（1）执行子查询总共执行一次，执行完毕后结果不被显示，而是=将值传递给外部查询，作为外部查询的条件使用。<br>（2）执行外部查询，并显示整个结果。　　<br>嵌套子查询一般可以分为：</p>
<ol>
<li>返回单值的子查询 单行子查询：返回一条记录<br>查询底薪超过公司平均底薪的员工的信息<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">WHERE 价格 &gt;</span><br><span class="line">  (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">AVG</span>(价格)</span><br><span class="line">    <span class="keyword">FROM</span> Books</span><br><span class="line">  )</span><br></pre></td></tr></tbody></table></figure></li>
<li>返回一个列表的子查询 ，多行子查询：返回多条记录，只能出现在where from子句<br>select子句中其他字段的一条记录没办法和子查询的多条记录合并</li>
</ol>
<p>相关子查询，先执行主查询再执行子查询。<br>外部查询执行一行，子查询就执行一次。执行依赖于外部查询。<br>优化关联查询<br>确定ON或者USING子句中是否有索引。<br>确保GROUP BY和ORDER BY只有一个表中的列，这样MySQL才有可能使用索引。<br>一般是子查询的WHERE子句中引用了外部查询的表。<br>可以用IN、NOT IN、EXISTS、NOT EXISTS引入<br>执行过程：<br>（1）从外层查询中取出一个元组（即一行），将元组相关列的值传给内层查询。<br>什么是元组？关系是一张表，表中的每行bai（即数据库中的每条记录）就是一个元组。<br>（2）执行内层查询，得到子查询操作的值。<br>（3）外查询根据子查询返回的结果或结果集得到满足条件的行。<br>（4）然后外层查询取出下一个元组重复做步骤1-3，直到外层的元组全部处理完毕。<br>对于外部查询返回的每一行数据，内部查询都要执行一次。另外，在关联子查询中是信息流是双向的。外部查询的每行数据传递一个值给子查询，然后子查询为每一行数据执行一次并返回它的记录。然后，外部查询根据返回的记录做出决策。</p>
<p>“选取出各商品种类中高于该商品种类的平均销售单价的商品。” 的关联子查询SELECT语句：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> product_type , product_name, sale_price</span><br><span class="line"><span class="keyword">FROM</span> Product <span class="keyword">AS</span> P1</span><br><span class="line"><span class="keyword">WHERE</span> sale_price &gt; (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">AVG</span>(sale_price)</span><br><span class="line">    <span class="keyword">FROM</span> Product <span class="keyword">AS</span> P2</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> product_type</span><br><span class="line">    );</span><br></pre></td></tr></tbody></table></figure>
<p>这个语句是错误的，原因是sale_price是一行数据，子查询的结果是3行数据，无法进行比较。更无法得到我们想要的“选取出各商品种类中高于该商品种类的平均销售单价的商品。”这个结果。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> product_type , product_name, sale_price</span><br><span class="line"><span class="keyword">FROM</span> Product <span class="keyword">AS</span> P1</span><br><span class="line"><span class="keyword">WHERE</span> sale_price &gt; (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">AVG</span>(sale_price)</span><br><span class="line">    <span class="keyword">FROM</span> Product <span class="keyword">AS</span> P2</span><br><span class="line">    <span class="keyword">WHERE</span> P1.product_type = P2.product_type</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> product_type</span><br><span class="line">    );</span><br></pre></td></tr></tbody></table></figure>
<p>实际上，‘WHERE P1.product_type = P2.product_type’这个语句是关联子查询，<br>关联子查询的执行逻辑和正常的SELECT语句执行逻辑完全不同<br>下面，我们来说明一下上面的关联子查询代码的执行过程：</p>
<p>先执行主查询， select 语句的 from，，把  Product 表里面每行数据查询出来，查询每一行数据，都要执行一次内层 select 语句，这个时候是完整的执行内层 select 语句，就是内层里面的 from … where … group by … select avg(sale_price)，作用是把和外层查询出来的一行数据里面的 type 相同的所有行取出来，算sale_price列的平均值，然后继续执行外层的 where 条件，最后选出需要的列数据</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> product_type , product_name, sale_price</span><br><span class="line"><span class="keyword">FROM</span> Product <span class="keyword">AS</span> P1</span><br></pre></td></tr></tbody></table></figure>

<p>该子查询从主查询一个“product_type”的值。而这个值是个变量，随SQLSever检索Product表中的不同行而改变<br>先将Product表中的第一条记录的“product_type”取第一个值=‘衣服’，通过WHERE P1.product_type = P2.product_type传入子查询，子查询变为：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    <span class="keyword">AVG</span>(sale_price)</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">    Product <span class="keyword">AS</span> P2</span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">    P2.product_type = ‘衣服’</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">    product_type);</span><br></pre></td></tr></tbody></table></figure>
<p>子查询得到的结果为该类product_type的平均价格，AVG(sale_price)=2500，<br>返回主查询：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> product_type , product_name, sale_price</span><br><span class="line"><span class="keyword">FROM</span> Product <span class="keyword">AS</span> P1</span><br><span class="line"><span class="keyword">WHERE</span> sale_price &gt; <span class="number">2500</span> <span class="keyword">AND</span> product_type = ‘衣服’</span><br></pre></td></tr></tbody></table></figure>
<p>如果WHERE条件为True，则第一条结果包括在结果集中，则否不包括。</p>
<p>然后，product _type取第二个值，得到整个语句的第二结果，依次类推，把product _type全取值一遍，所有行运行相同的过程，最后形成整个语句的的结果集及最后返回结果。</p>
<p>事实上，所有关联子查询的执行过程都和上面的过程一样。<br>（1）先从主查询的Product表中product _type列取出第一个值，进入子查询中，得到子查询结果，然后返回父查询，判断父查询的where子句条件，则返回整个语句的第1条结果。<br>（2）重复上述操作，直到所有主查询中的Product表中product _type列记录取完为止。得出整个语句的结果集，就是最后的答案。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create table counttest(name char(1), age char(2));</span><br><span class="line">Query OK, 0 rows affected (0.03 sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt; insert into counttest values</span><br><span class="line">    -&gt; ('a', '14'),('a', '15'), ('a', '15'), </span><br><span class="line">    -&gt; ('b', NULL), ('b', '16'), </span><br><span class="line">    -&gt; ('c', '17'),</span><br><span class="line">    -&gt; ('d', null), </span><br><span class="line">    -&gt;('e', '');</span><br><span class="line">Query OK, 8 rows affected (0.01 sec)</span><br><span class="line">Records: 8  Duplicates: 0  Warnings: 0</span><br><span class="line"> </span><br><span class="line">mysql&gt; select * from counttest;</span><br><span class="line">+<span class="comment">------+------+</span></span><br><span class="line">| name | age  |</span><br><span class="line">+<span class="comment">------+------+</span></span><br><span class="line">| a    | 14   |</span><br><span class="line">| a    | 15   |</span><br><span class="line">| a    | 15   |</span><br><span class="line">| b    | NULL |</span><br><span class="line">| b    | 16   |</span><br><span class="line">| c    | 17   |</span><br><span class="line">| d    | NULL |</span><br><span class="line">| e    |      |</span><br><span class="line">+<span class="comment">------+------+</span></span><br><span class="line">8 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt; <span class="keyword">select</span> <span class="keyword">name</span>, <span class="keyword">count</span>(<span class="keyword">name</span>), <span class="keyword">count</span>(<span class="number">1</span>), <span class="keyword">count</span>(*), <span class="keyword">count</span>(age), <span class="keyword">count</span>(<span class="keyword">distinct</span>(age))</span><br><span class="line">    -&gt; <span class="keyword">from</span> counttest</span><br><span class="line">    -&gt; <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">name</span>;</span><br><span class="line">+<span class="comment">------+-------------+----------+----------+------------+----------------------+</span></span><br><span class="line">| name | count(name) | count(1) | count(*) | count(age) | count(distinct(age)) |</span><br><span class="line">+<span class="comment">------+-------------+----------+----------+------------+----------------------+</span></span><br><span class="line">| a    |           3 |        3 |        3 |          3 |                    2 |</span><br><span class="line">| b    |           2 |        2 |        2 |          1 |                    1 |</span><br><span class="line">| c    |           1 |        1 |        1 |          1 |                    1 |</span><br><span class="line">| d    |           1 |        1 |        1 |          0 |                    0 |</span><br><span class="line">| e    |           1 |        1 |        1 |          1 |                    1 |</span><br><span class="line">+<span class="comment">------+-------------+----------+----------+------------+----------------------+</span></span><br><span class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>

<p>经典topN问题：每组最大的N条记录。<br>涉及到“既要分组，又要排序”的情况，要能想到用窗口函数来实现。</p>
<p>窗口函数，OLAP函数（Online Anallytical Processing，联机分析处理）<br>1）同时具有分组（partition by）和排序（order by）的功能<br>2）不减少原表的行数，所以经常用来在每组内排名<br>group by分组汇总后改变了表的行数，一行只有一个类别。<br>当一条sql语句没有group by的话，整张表的数据会自成一组。</p>
<p>比如下面的业务需求：<br>每组内排名问题：每个部门按业绩来排名<br>topN问题：找出每个部门排名前N的员工进行奖励：</p>
<figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;窗口函数&gt; over (partition by &lt;用于分组的列名&gt;</span><br><span class="line">                order by &lt;用于排序的列名&gt;)</span><br></pre></td></tr></tbody></table></figure>
<p>partition子句可是省略，省略就是不指定分组排名<br>&lt;窗口函数&gt;的位置，可以放以下两种函数：<br>1） 专用窗口函数，包括后面要讲到的rank, dense_rank, row_number等专用窗口函数。<br>2） 聚合函数，如sum. avg, count, max, min等</p>
<p>因为窗口函数是对where或者group by子句处理后的结果进行操作，所以窗口函数原则上只能写在select子句中。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *,</span><br><span class="line">   <span class="keyword">rank</span>() <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> 成绩 <span class="keyword">desc</span>) <span class="keyword">as</span> ranking,</span><br><span class="line">   <span class="keyword">dense_rank</span>() <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> 成绩 <span class="keyword">desc</span>) <span class="keyword">as</span> dese_rank,</span><br><span class="line">   row_number() <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> 成绩 <span class="keyword">desc</span>) <span class="keyword">as</span> row_num</span><br><span class="line"><span class="keyword">from</span> 班级</span><br></pre></td></tr></tbody></table></figure>
<p>专用窗口函数后面的括号不需要任何参数，保持()空着就可以。<br>1）rank函数：如果有并列名次的行，会占用下一名次的位置，同薪同名重复但总排名不连续。比如正常排名是1，2，3，4，但是现在前3名是并列的名次，结果是：1，1，1，4。 </p>
<p>2）dense_rank函数：如果有并列名次的行，不占用下一名次的位置，同薪同名但总排名连续。比如正常排名是1，2，3，4，但是现在前3名是并列的名次，结果是：1，1，1，2。 </p>
<p>3）row_number函数：不考虑并列名次的情况，连续排名不重复，。比如前3名是并列的名次，排名是正常的1，2，3，4。每一条数据加一个序号，用于分页查询<br> 例如薪水3000、2000、2000、1000排名结果为1-2-3-4，体现同薪不同名，排名类似于编号</p>
<p>聚和窗口函数和上面提到的专用窗口函数用法完全相同，只需要把聚合函数写在窗口函数的位置即可，但是函数后面括号里面不能为空，需要指定聚合的列名。聚合函数作为窗口函数，可以在每一行的数据里直观的看到，截止到本行数据，统计数据是多少（最大值、最小值等）。同时可以看出每一行数据，对整体统计数据的影响。想要知道所有人成绩的总和、平均等聚合结果，看最后一行即可。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *,</span><br><span class="line">   <span class="keyword">sum</span>(成绩) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> 学号) <span class="keyword">as</span> current_sum,</span><br><span class="line">   <span class="keyword">avg</span>(成绩) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> 学号) <span class="keyword">as</span> current_avg,</span><br><span class="line">   <span class="keyword">count</span>(成绩) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> 学号) <span class="keyword">as</span> current_count,</span><br><span class="line">   <span class="keyword">max</span>(成绩) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> 学号) <span class="keyword">as</span> current_max,</span><br><span class="line">   <span class="keyword">min</span>(成绩) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> 学号) <span class="keyword">as</span> current_min</span><br><span class="line"><span class="keyword">from</span> 班级表</span><br></pre></td></tr></tbody></table></figure>

<p>查询结果排序，默认升序<br>select 字段1，字段2 from 表名 order by 列名 ASC或者DESC;</p>
<p>查询结果分页<br><code>limit y offset x</code>简写成<code>limit x, y</code><br>参数x为可选参数，表示查询结果跳过前 x 条数据，x 默认为 0，从第 x+1 条数据开始取，<br>参数y为必选参数，表示取前 y 条(行)数据</p>
<p>eg1：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">table</span> <span class="keyword">LIMIT</span> <span class="number">5</span>;     //检索前 5 个记录行</span><br></pre></td></tr></tbody></table></figure>
<p>等价于</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">table</span> <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">5</span>;     //检索前 5 个记录行,0可以省略不写</span><br></pre></td></tr></tbody></table></figure>
<p>eg2：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">table</span> <span class="keyword">LIMIT</span> <span class="number">5</span>,<span class="number">10</span>;  // 检索记录行 6-15</span><br></pre></td></tr></tbody></table></figure>
<p>eg3：<br>为了检索某行开始到最后的所有数据，可以设置第二个参数为-1</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">table</span> <span class="keyword">LIMIT</span> <span class="number">95</span>,<span class="number">-1</span>; // 检索记录行 96-last</span><br></pre></td></tr></tbody></table></figure>

<h3 id="175-组合两个表"><a href="#175-组合两个表" class="headerlink" title="175. 组合两个表"></a>175. 组合两个表</h3><p><strong>编写一个 SQL 查询，获取 Employee&nbsp;表中第二高的薪水（Salary）。</strong><br>表1: Person</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+-------------+</span>---------+</span><br><span class="line">| 列名         | 类型     |</span><br><span class="line"><span class="code">+-------------+</span>---------+</span><br><span class="line">| PersonId    | int     |</span><br><span class="line">| FirstName   | varchar |</span><br><span class="line">| LastName    | varchar |</span><br><span class="line"><span class="code">+-------------+</span>---------+</span><br><span class="line">PersonId 是上表主键</span><br></pre></td></tr></tbody></table></figure>
<p>表2: Address</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+-------------+</span>---------+</span><br><span class="line">| 列名         | 类型    |</span><br><span class="line"><span class="code">+-------------+</span>---------+</span><br><span class="line">| AddressId   | int     |</span><br><span class="line">| PersonId    | int     |</span><br><span class="line">| City        | varchar |</span><br><span class="line">| State       | varchar |</span><br><span class="line"><span class="code">+-------------+</span>---------+</span><br><span class="line">AddressId 是上表主键</span><br></pre></td></tr></tbody></table></figure>
<p>编写一个 SQL 查询，满足条件：无论 person 是否有地址信息，都需要基于上述两表提供&nbsp;person 的以下信息：</p>
<figure class="highlight autohotkey"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">FirstName,</span> LastName, City, State</span><br></pre></td></tr></tbody></table></figure>

<p>使用 outer join<br>算法</p>
<p>因为表 Address 中的 personId 是表 Person 的外关键字，所以我们可以连接这两个表来获取一个人的地址信息。</p>
<p>考虑到可能不是每个人都有地址信息，我们应该使用 outer join 而不是默认的 inner join。所以是左连接保留所有的人名。right连接的话是会保留右表所有的地址信息<br>注意：如果没有某个人的地址信息，使用 where 子句过滤记录将失败，因为它不会显示姓名信息。</p>
<figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> FirstName, LastName, City, State</span><br><span class="line"><span class="keyword">from</span> Person <span class="keyword">left</span> <span class="keyword">join</span> Address</span><br><span class="line"><span class="keyword">on</span> Person.PersonId = Address.PersonId;</span><br><span class="line">```~</span><br><span class="line"></span><br><span class="line">```~sql</span><br><span class="line"><span class="keyword">select</span> P.FirstName, P.LastName, A.City, A.State</span><br><span class="line"><span class="keyword">from</span> Person <span class="keyword">as</span> P <span class="keyword">left</span> <span class="keyword">join</span> Address <span class="keyword">as</span> A </span><br><span class="line"><span class="keyword">on</span> (P.PersonId = A.PersonId);</span><br><span class="line">```~</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">---</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 176. 第二高的薪水</span></span><br><span class="line">**编写一个 SQL 查询，获取 Employee&nbsp;表中第二高的薪水（Salary）。**</span><br></pre></td></tr></tbody></table></figure>
<p>+—-+——–+<br>| Id | Salary |<br>+—-+——–+<br>| 1  | 100    |<br>| 2  | 200    |<br>| 3  | 300    |<br>+—-+——–+</p>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">例如上述</span>&nbsp;<span class="string">Employee</span>&nbsp;<span class="string">表，SQL查询应该返回</span>&nbsp;<span class="number">200</span> <span class="string">作为第二高的薪水。如果不存在第二高的薪水，那么查询应返回</span> <span class="literal">null</span><span class="string">。</span></span><br></pre></td></tr></tbody></table></figure>
<p>+———————+<br>| SecondHighestSalary |<br>+———————+<br>| 200                 |<br>+———————+</p>
<figure class="highlight pgsql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">方法一：使用子查询和 <span class="keyword">LIMIT</span> 子句  </span><br><span class="line">降序排列再返回第二条记录可以得到第二大的值。</span><br><span class="line">```<span class="keyword">distinct</span>```排除掉多行数据并列第二的情况，例如只有两行记录都是 <span class="number">100</span>，<span class="number">100</span>，此时结果应当是<span class="keyword">null</span>，如果不用<span class="keyword">distinct</span>，得到结果就是<span class="number">100</span>  </span><br><span class="line"></span><br><span class="line">关键是这个不存在返回<span class="keyword">null</span>，不存在又分为表数据不够，比如表只有一行。或者另一种情况，薪水全部一样，则也不存在第二高的薪水，因此这题除了按薪水降序排序外，还需要筛掉薪水相同的记录。可以像下面这样写使用<span class="keyword">group</span> <span class="keyword">by</span>或者用<span class="keyword">distinct</span> + <span class="keyword">order</span> <span class="keyword">by</span></span><br><span class="line"></span><br><span class="line">```<span class="keyword">SQL</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    <span class="keyword">DISTINCT</span> Salary <span class="keyword">AS</span> SecondHighestSalary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Employee</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> Salary <span class="keyword">DESC</span></span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">1</span> <span class="keyword">OFFSET</span> <span class="number">1</span>;</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    Salary <span class="keyword">AS</span> SecondHighestSalary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Employee</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Salary <span class="keyword">DESC</span></span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">1</span> <span class="keyword">OFFSET</span> <span class="number">1</span>;</span><br></pre></td></tr></tbody></table></figure>

<p>然而，如果没有这样的第二最高工资，不存在第二高记录的话会返回为空的结果集。而不是null，这个解决方案将被判断为 “错误答案”，因为本表可能只有一项记录。为了克服这个问题，我们可以将其作为临时表。 执行返回结果集不为空包含一行为NULL的记录，</p>
<figure class="highlight plain"><figcaption><span>NULL```返回null值，可以不接from单独用，子查询数据出虚表嵌套查询虚表,如果查询不到会返回null。相当于查询的列。</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">在oracle中只写查询列没有查询表需要加上 from dual（伪表）。</span><br><span class="line">而mysql不用写</span><br><span class="line">```SQL</span><br><span class="line">SELECT</span><br><span class="line">    (SELECT DISTINCT</span><br><span class="line">            Salary</span><br><span class="line">        FROM</span><br><span class="line">            Employee</span><br><span class="line">        ORDER BY Salary DESC</span><br><span class="line">        LIMIT 1 OFFSET 1) AS SecondHighestSalary</span><br><span class="line">;</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>(</span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        Salary</span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        Employee</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> Salary </span><br><span class="line">    <span class="keyword">ORDER</span> <span class="keyword">BY</span> Salary <span class="keyword">DESC</span></span><br><span class="line">    <span class="keyword">LIMIT</span> <span class="number">1</span> <span class="keyword">OFFSET</span> <span class="number">1</span></span><br><span class="line">) <span class="keyword">AS</span> SecondHighestSalary</span><br><span class="line">;</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> (</span><br><span class="line">    <span class="keyword">select</span> </span><br><span class="line">        Salary </span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        Employee</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> Salary <span class="keyword">desc</span></span><br><span class="line">    <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span></span><br><span class="line">) <span class="keyword">as</span> SecondHighestSalary</span><br></pre></td></tr></tbody></table></figure>

<p>方法二：<br>求最大值。一定要借助于MAX函数<br>先去掉最大的，然后第二大的就是最大的了,<br>考虑了扩展性，求第三，求第四呢?一直套</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">max</span>(Salary) SecondHighestSalary </span><br><span class="line"><span class="keyword">from</span> Employee</span><br><span class="line"><span class="keyword">where</span> Salary &lt; (<span class="keyword">select</span> <span class="keyword">max</span>(Salary) <span class="keyword">from</span> Employee);</span><br></pre></td></tr></tbody></table></figure>

<p>方法三：使用 IFNULL 和 LIMIT 子句</p>
<p>mysql中isnull,ifnull,nullif的用法如下：</p>
<p>isnull(expr) 的用法： 如expr 为null，那么isnull() 的返回值为 1，否则返回值为 0。<br>mysql&gt; select isnull(1+1);<br>-&gt; 0<br>mysql&gt; select isnull(1/0);<br>-&gt; 1 使用= 的null 值对比通常是错误的。</p>
<p>isnull() 函数同 is null比较操作符具有一些相同的特性。请参见有关is null 的说明。</p>
<p>IFNULL(expr1,expr2)的用法：条件函数 写在查询条件里面里面<br>判断是否为null的，不是判断是否为空。如下所示。<br>假如expr1 不为 NULL，则 IFNULL() 的返回值为 expr1;<br>假如expr1 为 NULL，其返回值为 expr2。<br>IFNULL()的返回值是数字或是字符串，具体情况取决于其所使用的语境。<br>ifnull(x, null) 如果返回null值，不就已经说明 x 的值为null</p>
<figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT IFNULL(1,0);</span><br><span class="line">-&gt; 1</span><br><span class="line">mysql&gt; SELECT IFNULL(NULL,10);</span><br><span class="line">-&gt; 10</span><br><span class="line">mysql&gt; SELECT IFNULL(1/0,10);</span><br><span class="line">-&gt; 10</span><br><span class="line">mysql&gt; SELECT</span><br><span class="line">IFNULL(1/0,'yes');</span><br><span class="line">-&gt;   'yes</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">IFNULL</span>(</span><br><span class="line">      (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> Salary</span><br><span class="line">       <span class="keyword">FROM</span> Employee</span><br><span class="line">       <span class="keyword">ORDER</span> <span class="keyword">BY</span> Salary <span class="keyword">DESC</span></span><br><span class="line">        <span class="keyword">LIMIT</span> <span class="number">1</span> <span class="keyword">OFFSET</span> <span class="number">1</span>),</span><br><span class="line">    <span class="literal">NULL</span>) <span class="keyword">AS</span> SecondHighestSalary</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h3 id="177-第N高的薪水"><a href="#177-第N高的薪水" class="headerlink" title="177. 第N高的薪水"></a>177. 第N高的薪水</h3><p><strong>编写一个 SQL 查询，获取 Employee 表中第 n 高的薪水（Salary）。</strong></p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span>--------+</span><br><span class="line">| Id | Salary |</span><br><span class="line"><span class="code">+----+</span>--------+</span><br><span class="line">| 1  | 100    |</span><br><span class="line">| 2  | 200    |</span><br><span class="line">| 3  | 300    |</span><br><span class="line"><span class="code">+----+</span>--------+</span><br></pre></td></tr></tbody></table></figure>
<p>例如上述 Employee 表，n = 2 时，应返回第二高的薪水 200。如果不存在第 n 高的薪水，那么查询应返回 null。</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+------------------------+</span></span><br><span class="line">| getNthHighestSalary(2) |</span><br><span class="line"><span class="code">+------------------------+</span></span><br><span class="line">| 200                    |</span><br><span class="line"><span class="code">+------------------------+</span></span><br></pre></td></tr></tbody></table></figure>

<p>思路1：单表查询<br>本题不存在分组排序，只需返回全局第N高的一个，所以自然想到的想法是用order by排序加limit限制得到。需要注意两个细节：</p>
<ol>
<li>同薪同名且不跳级的问题，解决办法是用group by按薪水分组后再order by</li>
<li>排名第N高意味着要跳过N-1个薪水，由于无法直接用limit N-1，所以需先在函数开头用set把N赋值为N=N-1。调整下limit的起始点即可，<br>注：这里不能直接用limit N-1,1，这样写要报语法错误，是因为limit和offset字段后面只接受正整数（意味着负数、小数都不行, limit的偏移从0开始。0是可以 但是没有啥意义）或者单一变量（意味着不能用表达式），也就是说想取一条，limit 2-1、limit 1.1这类的写法都是报错的。<br>注：这种解法形式最为简洁直观，但仅适用于查询全局排名问题，如果要求各分组的每个第N名，则该方法不适用；而且也不能处理存在重复值的情况。</li>
</ol>
<p>第N个变成参数变量时，要改为N-1。不是数字。作者认为出题的目的是不使用变量的情况下解题</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> getNthHighestSalary(N <span class="built_in">int</span>) <span class="keyword">returns</span> <span class="built_in">int</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">set</span> n=N<span class="number">-1</span>;  // sql 不区分到小写，所以只有一个N</span><br><span class="line">    return (</span><br><span class="line">        <span class="keyword">select</span>(</span><br><span class="line">            <span class="keyword">select</span> </span><br><span class="line">                <span class="keyword">distinct</span> Salary</span><br><span class="line">            <span class="keyword">from</span> </span><br><span class="line">                Employee</span><br><span class="line">            <span class="keyword">order</span> <span class="keyword">by</span> </span><br><span class="line">                Salary <span class="keyword">desc</span></span><br><span class="line">            <span class="keyword">limit</span> n,<span class="number">1</span></span><br><span class="line">        )</span><br><span class="line">    );</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> getNthHighestSalary(N <span class="built_in">INT</span>) <span class="keyword">RETURNS</span> <span class="built_in">INT</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">set</span> n = N<span class="number">-1</span>;</span><br><span class="line">  RETURN (</span><br><span class="line">      <span class="keyword">select</span> <span class="keyword">ifnull</span>(</span><br><span class="line">          (</span><br><span class="line">          <span class="keyword">select</span> </span><br><span class="line">              <span class="keyword">distinct</span> Salary </span><br><span class="line">          <span class="keyword">from</span> </span><br><span class="line">              Employee</span><br><span class="line">          <span class="keyword">order</span> <span class="keyword">by</span> </span><br><span class="line">              Salary <span class="keyword">desc</span></span><br><span class="line">          <span class="keyword">limit</span> n, <span class="number">1</span></span><br><span class="line">          )</span><br><span class="line">          , <span class="literal">null</span>)</span><br><span class="line">  );</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></tbody></table></figure>

<p>窗口函数</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> getNthHighestSalary(N <span class="built_in">INT</span>) <span class="keyword">RETURNS</span> <span class="built_in">INT</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">RETURN</span> (</span><br><span class="line">      <span class="comment"># Write your MySQL query statement below.</span></span><br><span class="line">      <span class="keyword">select</span> <span class="keyword">distinct</span> Salary </span><br><span class="line">      <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">dense_rank</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> Salary <span class="keyword">desc</span>) <span class="keyword">num</span>,Salary <span class="keyword">from</span> Employee</span><br><span class="line">      ) t </span><br><span class="line">      <span class="keyword">where</span> t.num=N</span><br><span class="line">  );</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></tbody></table></figure>

<p>法2：子查询<br>排名第N的薪水意味着该表中存在N-1个比其更高的薪水<br>注意这里的N-1个更高的薪水是指去重后的N-1个，实际对应人数可能不止N-1个<br>最后返回的薪水也应该去重，因为可能不止一个薪水排名第N<br>由于对于每个薪水的where条件都要执行一遍子查询，注定其效率低下</p>
<p>对每一个薪水A，只要大于等于A的不同薪水个数等于N即可。<br>子查询查找比当前薪资大与等于的个数，个数即排名。<br>也就是在做查找当前记录的排名，对salary进行了排名，salary相同的排同一个名次</p>
<p>假设现在给你一个分数X，如何算出它的排名Rank呢？<br>我们可以先提取出大于等于X的所有分数集合H，将H去重后的元素个数就是X的排名。<br>比如你考了99分，但最高的就只有99分，那么去重之后集合H里就只有99一个元素，个数为1，因此你的Rank为1。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> getNthHighestSalary(N <span class="built_in">INT</span>) <span class="keyword">RETURNS</span> <span class="built_in">INT</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">RETURN</span> (</span><br><span class="line">    <span class="keyword">select</span> </span><br><span class="line">        <span class="keyword">distinct</span> t1.Salary</span><br><span class="line">    <span class="keyword">from</span> </span><br><span class="line">        Employee t1</span><br><span class="line">    <span class="keyword">where</span> N = (</span><br><span class="line">        <span class="keyword">select</span> </span><br><span class="line">            <span class="keyword">count</span>(<span class="keyword">distinct</span> t2.Salary)</span><br><span class="line">        <span class="keyword">from</span> </span><br><span class="line">            Employee t2</span><br><span class="line">        <span class="keyword">where</span> </span><br><span class="line">            t2.Salary &gt;= t1.Salary</span><br><span class="line">    )</span><br><span class="line">  );</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></tbody></table></figure>
<p>只用一个sql，那么要先查出前N薪水，然后取最小就好了，注意可能总数不够前N，count一下比较即可<br>取的distinct后的前N条吧，去重以后就是N条，但是如果有重复的就会导至原本可能有N条，去重以后就小于 N条，所以最后的选择步骤会加上一个IF条件判断是否有到达第N个，达不到返回NULL。比如原本100个数，其中有60个是相同的，其余40个是不同的；要取第50大的，就会返回NULL，因为不重复的数只有41个，只对这41个数排序取值。</p>
<figure class="highlight plain"><figcaption><span>里面的 列变量。</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">```SQL</span><br><span class="line">CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT</span><br><span class="line">BEGIN</span><br><span class="line">  RETURN (     </span><br><span class="line">  SELECT  IF(count&lt;N,NULL,min) // N &gt; count 那么取 NULL 否者 取 min 的值</span><br><span class="line">  FROM</span><br><span class="line">    (SELECT MIN(Salary) AS min, COUNT(1) AS count</span><br><span class="line">    FROM</span><br><span class="line">      (SELECT DISTINCT Salary</span><br><span class="line">      FROM Employee ORDER BY Salary DESC LIMIT N) AS a</span><br><span class="line">    ) as b</span><br><span class="line">  );</span><br><span class="line">END</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">case</span> </span><br><span class="line"><span class="keyword">when</span> <span class="keyword">count</span>(*) &lt; N </span><br><span class="line"><span class="keyword">then</span> <span class="literal">NULL</span> </span><br><span class="line"><span class="keyword">else</span> <span class="keyword">min</span>(Salary) </span><br><span class="line"><span class="keyword">end</span> </span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">distinct</span> Salary </span><br><span class="line">    <span class="keyword">from</span> Employee </span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> Salary <span class="keyword">desc</span> </span><br><span class="line">    <span class="keyword">limit</span> N) </span><br><span class="line">    temp</span><br></pre></td></tr></tbody></table></figure>

<p>mysql中自定义变量需要用@作为前缀符引导符，针对于当前会话（连接）有效，同于会话变量的作用域应用在任何地方<br>定义@r表示排名信息(rank)，<br>定义@p表示前一个薪水(previous) </p>
<p>对用户变量赋值有两种方式，一种是直接用”=”号，另一种是用”:=”号。<br>其区别在于使用set命令对用户变量进行赋值时，两种方式都可以使用；<br>当使用select语句对用户变量进行赋值时，只能使用”:=”方式，因为在select语句中，”=”号被看作是比较操作符。<br>“:=”用来给变量rank赋值</p>
<hr>
<h3 id="178-分数排名"><a href="#178-分数排名" class="headerlink" title="178. 分数排名"></a>178. 分数排名</h3><p><strong>编写一个 SQL 查询来实现分数排名。</strong></p>
<p>如果两个分数相同，则两个分数排名（Rank）相同。<br>请注意，平分后的下一个名次应该是下一个连续的整数值。<br>换句话说，名次之间不应该有“间隔”。</p>
<figure class="highlight gherkin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+----+-------+</span><br><span class="line">|<span class="string"> Id </span>|<span class="string"> Score </span>|</span><br><span class="line">+----+-------+</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> 3.50  </span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string"> 3.65  </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> 4.00  </span>|</span><br><span class="line">|<span class="string"> 4  </span>|<span class="string"> 3.85  </span>|</span><br><span class="line">|<span class="string"> 5  </span>|<span class="string"> 4.00  </span>|</span><br><span class="line">|<span class="string"> 6  </span>|<span class="string"> 3.65  </span>|</span><br><span class="line">+----+-------+</span><br></pre></td></tr></tbody></table></figure>

<p>例如，根据上述给定的 Scores 表，你的查询应该返回（按分数从高到低排列）：</p>
<figure class="highlight gherkin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+-------+------+</span><br><span class="line">|<span class="string"> Score </span>|<span class="string"> Rank </span>|</span><br><span class="line">+-------+------+</span><br><span class="line">|<span class="string"> 4.00  </span>|<span class="string"> 1    </span>|</span><br><span class="line">|<span class="string"> 4.00  </span>|<span class="string"> 1    </span>|</span><br><span class="line">|<span class="string"> 3.85  </span>|<span class="string"> 2    </span>|</span><br><span class="line">|<span class="string"> 3.65  </span>|<span class="string"> 3    </span>|</span><br><span class="line">|<span class="string"> 3.65  </span>|<span class="string"> 3    </span>|</span><br><span class="line">|<span class="string"> 3.50  </span>|<span class="string"> 4    </span>|</span><br><span class="line">+-------+------+</span><br></pre></td></tr></tbody></table></figure>
<p>重要提示：对于 MySQL 解决方案，如果要转义用作列名的保留字，可以在关键字之前和之后使用撇号。例如 <code>Rank</code> rank是mysql的关键字不能使用</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> score, </span><br><span class="line">       <span class="keyword">dense_rank</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> Score <span class="keyword">desc</span>) <span class="keyword">as</span> <span class="string">`Rank`</span></span><br><span class="line"><span class="keyword">from</span> Scores;</span><br></pre></td></tr></tbody></table></figure>

<p>法二：<br>最后的结果包含两个部分，<br>第一部分是降序排列的分数</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.Score <span class="keyword">as</span> Score</span><br><span class="line"><span class="keyword">from</span> Scores a</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> a.Score <span class="keyword">DESC</span></span><br></pre></td></tr></tbody></table></figure>

<p>第二部分是每个分数对应的排名<br>假设现在给你一个分数X，如何算出它的排名Rank呢？<br>我们可以先提取出大于等于X的所有分数集合H，将H去重后的元素个数就是X的排名。<br>比如你考了99分，但最高的就只有99分，那么去重之后集合H里就只有99一个元素，个数为1，因此你的Rank为1。<br>先提取集合H：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">    b.Score </span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">    Scores b </span><br><span class="line"><span class="keyword">where</span> </span><br><span class="line">    b.Score &gt;= X;</span><br></pre></td></tr></tbody></table></figure>
<p>我们要的是集合H去重之后的元素个数就是X的排名，因此升级为：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">    <span class="keyword">count</span>(<span class="keyword">distinct</span> b.Score) </span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">    Scores b </span><br><span class="line"><span class="keyword">where</span> </span><br><span class="line">    b.Score &gt;= X <span class="keyword">as</span> <span class="keyword">Rank</span>;</span><br></pre></td></tr></tbody></table></figure>

<p>而从结果的角度来看，第二部分的Rank是对应第一部分的分数来的，<br>所以这里的X就是上面的a.Score，把两部分结合在一起为：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">    a.Score <span class="keyword">as</span> Score,</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">select</span> </span><br><span class="line">            <span class="keyword">count</span>(<span class="keyword">distinct</span> b.Score) </span><br><span class="line">        <span class="keyword">from</span> </span><br><span class="line">            Scores b </span><br><span class="line">        <span class="keyword">where</span> </span><br><span class="line">            b.Score &gt;= a.Score</span><br><span class="line">        ) <span class="keyword">as</span> <span class="string">'Rank'</span></span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">    Scores a</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> </span><br><span class="line">    a.Score <span class="keyword">DESC</span></span><br></pre></td></tr></tbody></table></figure>

<hr>
<h3 id="180-连续出现的数字"><a href="#180-连续出现的数字" class="headerlink" title="180. 连续出现的数字"></a>180. 连续出现的数字</h3><p><strong>编写一个 SQL 查询，查找所有至少连续出现三次的数字。</strong></p>
<figure class="highlight gherkin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+----+-----+</span><br><span class="line">|<span class="string"> Id </span>|<span class="string"> Num </span>|</span><br><span class="line">+----+-----+</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string">  1  </span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string">  1  </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string">  1  </span>|</span><br><span class="line">|<span class="string"> 4  </span>|<span class="string">  2  </span>|</span><br><span class="line">|<span class="string"> 5  </span>|<span class="string">  1  </span>|</span><br><span class="line">|<span class="string"> 6  </span>|<span class="string">  2  </span>|</span><br><span class="line">|<span class="string"> 7  </span>|<span class="string">  2  </span>|</span><br><span class="line">+----+-----+</span><br></pre></td></tr></tbody></table></figure>
<p>例如，给定上面的 Logs 表， 1 是唯一连续出现至少三次的数字。</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+-----------------+</span></span><br><span class="line">| ConsecutiveNums |</span><br><span class="line"><span class="code">+-----------------+</span></span><br><span class="line">| 1               |</span><br><span class="line"><span class="code">+-----------------+</span></span><br></pre></td></tr></tbody></table></figure>

<p>思路：</p>
<ol>
<li><p>由于要获取至少连续三次出现的数字，看到这个题肯定是会变的，<br>如果是至少连续出现四次呢(100次呢)，咱们连接四个表(连接一千个?)？<br>这种方法肯定是不可取的。</p>
</li>
<li><p>找规律，找出这连续起来的数字有什么规律呢，我们会发现连续的数字是相同的数字，<br>但是id有可能不是连续的，工作的生产环境某一行记录经常会被删除,<br>所以id=1之后下一个id可能是3也可以是10000，我们就需要通过对结果集进行再次编号，让其变成连续的。</p>
</li>
<li><p>首先我们获取到对每条数据编号从1开始使用row_number()函数使用id来排序，<code>row_number() over(order by id)</code><br>4、然后我们通过另一种方式排序将，这些num值一样的进行排序，然后对其编号同样使用row_bumber()使用num来分组使用id排序 over(partition by num order by id)<br>5、通过3、4步骤我们能得到什么呢，两个相减之后我们可以得到，只要是相等的，则相减的值是一样的。而且如果不连续的话相减值也不一样。</p>
</li>
</ol>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="keyword">NUM</span> <span class="keyword">As</span> ConsecutiveNums </span><br><span class="line"><span class="keyword">FROM</span> ( <span class="keyword">SELECT</span> <span class="keyword">Num</span>,<span class="keyword">count</span>(*) <span class="keyword">as</span> Num_count </span><br><span class="line">    <span class="keyword">FROM</span> ( <span class="keyword">SELECT</span> *, </span><br><span class="line">        row_number() <span class="keyword">over</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">id</span>)</span><br><span class="line">        - row_number() <span class="keyword">over</span> (</span><br><span class="line">            <span class="keyword">PARTITION</span> <span class="keyword">by</span> <span class="keyword">Num</span> </span><br><span class="line">            <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">id</span></span><br><span class="line">            )<span class="keyword">AS</span> orde </span><br><span class="line">        <span class="keyword">FROM</span> <span class="keyword">logs</span> </span><br><span class="line">    ) <span class="keyword">as</span> W <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">Num</span>,orde </span><br><span class="line">)<span class="keyword">as</span> S </span><br><span class="line"><span class="keyword">WHERE</span> Num_count&gt;=<span class="number">3</span>; </span><br></pre></td></tr></tbody></table></figure>

<p>对应id的减的是row_number（）函数的排序号<br>如果pre与t.num 相等，则cnt加1， 否则cnt重置为1</p>
<p>法二<br>定义为一张表：(select @pre:= null,@count:=1) as pc<br>Logs与pc叉积，计算出与每行数字连续相同的数字个数。</p>
<p>①首先遍历一遍整张表，找出每个数字的连续重复次数<br>定义两个用户变量并初始化<br>@pre：记录的是当前行的num值，在下一次循环里，pre和下一次循环if（）里的num值比较<br>pre初始值最好不要赋值为一个数字，因为不确定赋值的数字是否会出现在测试表中。</p>
<p>@count：记录上一个数字已经连续出现的次数。与前一行数据连续相同的个数，统计连续次数</p>
<p>然后调用if()函数，与前一行数据比较的逻辑为：<br>如果pre和当前行数字相同，count加1即为连续出现的次数；<br>如果不同，意味着重新开始一个数字，count重新从1开始。<br>最后，将当前的Num数字赋值给pre，开始下一行扫描。</p>
<p>这些结果形成一张新表：a(Num,count,USELESS)。<br>适用连续重复次数为n的情况，无论需要连续重复多少次，只需要改最后的数字就可以了，复用性很好。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">        <span class="keyword">Num</span>,    <span class="comment">#当前的Num 数字</span></span><br><span class="line">        <span class="keyword">if</span>(@pre=<span class="keyword">Num</span>,@<span class="keyword">count</span> := @<span class="keyword">count</span>+<span class="number">1</span>,@<span class="keyword">count</span> := <span class="number">1</span>) <span class="keyword">as</span> nums, <span class="comment">#判断 和 计数</span></span><br><span class="line">        @pre:=<span class="keyword">Num</span>   <span class="comment">#将当前Num赋值给pre</span></span><br><span class="line">    <span class="keyword">from</span> <span class="keyword">Logs</span> <span class="keyword">as</span> l ,</span><br><span class="line">        (<span class="keyword">select</span> @pre:= <span class="literal">null</span>,@<span class="keyword">count</span>:=<span class="number">1</span>) <span class="keyword">as</span> pc <span class="comment">#这里需要别名</span></span><br><span class="line">    <span class="comment">#上面这段代码执行结果就是一张三列为Num,count as nums,pre的表。</span></span><br></pre></td></tr></tbody></table></figure>
<p>②将上面表的结果中，重复次数大于等于3的数字选出，<br>再去重即为连续至少出现三次的数字。最终只要从a中取出count大于等于3的行。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">    <span class="keyword">distinct</span> <span class="keyword">Num</span> <span class="keyword">as</span> ConsecutiveNums </span><br><span class="line"><span class="keyword">from</span>  </span><br><span class="line">    (<span class="keyword">select</span> <span class="keyword">Num</span>,</span><br><span class="line">            <span class="keyword">if</span>(@pre=<span class="keyword">Num</span>,@<span class="keyword">count</span> := @<span class="keyword">count</span>+<span class="number">1</span>,@<span class="keyword">count</span> := <span class="number">1</span>) <span class="keyword">as</span> <span class="keyword">count</span>,</span><br><span class="line">            @pre:=<span class="keyword">Num</span></span><br><span class="line">        <span class="keyword">from</span> <span class="keyword">Logs</span> <span class="keyword">as</span> l ,</span><br><span class="line">            (<span class="keyword">select</span> @pre:= <span class="literal">null</span>,@<span class="keyword">count</span>:=<span class="number">1</span>) <span class="keyword">as</span> pc</span><br><span class="line">    ) <span class="keyword">as</span> n</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">count</span> &gt;=<span class="number">3</span>;</span><br></pre></td></tr></tbody></table></figure>

<p>Every derived table must have its own alias，<br>进行嵌套查询的时候子查询出来的的结果是作为一个派生表来进行上一级的查询的，所以子查询的结果临时表必须要有一个别名，应该是一种规范吧！</p>
<hr>
<h3 id="181-超过经理收入的员工"><a href="#181-超过经理收入的员工" class="headerlink" title="181. 超过经理收入的员工"></a>181. 超过经理收入的员工</h3><p><strong>Employee 表包含所有员工，他们的经理也属于员工。每个员工都有一个 Id，此外还有一列对应员工的经理的 Id。</strong></p>
<figure class="highlight gherkin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+----+-------+--------+-----------+</span><br><span class="line">|<span class="string"> Id </span>|<span class="string"> Name  </span>|<span class="string"> Salary </span>|<span class="string"> ManagerId </span>|</span><br><span class="line">+----+-------+--------+-----------+</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> Joe   </span>|<span class="string"> 70000  </span>|<span class="string"> 3         </span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string"> Henry </span>|<span class="string"> 80000  </span>|<span class="string"> 4         </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> Sam   </span>|<span class="string"> 60000  </span>|<span class="string"> NULL      </span>|</span><br><span class="line">|<span class="string"> 4  </span>|<span class="string"> Max   </span>|<span class="string"> 90000  </span>|<span class="string"> NULL      </span>|</span><br><span class="line">+----+-------+--------+-----------+</span><br></pre></td></tr></tbody></table></figure>
<p>给定 Employee 表，编写一个 SQL 查询，该查询可以获取收入超过他们经理的员工的姓名。在上面的表格中，Joe 是唯一一个收入超过他的经理的员工。</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----------+</span></span><br><span class="line">| Employee |</span><br><span class="line"><span class="code">+----------+</span></span><br><span class="line">| Joe      |</span><br><span class="line"><span class="code">+----------+</span></span><br></pre></td></tr></tbody></table></figure>

<p>”和自己的xxx比”这种问题基本都是自连接问题。<br>方法 1：使用 WHERE 语句<br>算法</p>
<p>如下面表格所示，表格里存有每个雇员经理的信息，我们也许需要从这个表里获取两次信息。<br>从两个表里使用 Select 语句可能会导致产生 笛卡尔乘积 。<br>不指定两个表的连接方式、 没有关联条件，这种情况下就会产生笛卡尔积，这是笛卡尔积的定义<br>在这种情况下，输出会产生 4*4=16 个记录。<br>然而我们只对雇员工资高于经理的人感兴趣。<br>所以我们应该用 WHERE 语句加 2 个判断条件。<br>a表的经理Id=b表的员工Id，即b表中的人员都是a表的经理</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    a.Name <span class="keyword">AS</span> Employee</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Employee <span class="keyword">AS</span> a,</span><br><span class="line">    Employee <span class="keyword">AS</span> b</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    a.ManagerId = b.Id</span><br><span class="line">        <span class="keyword">AND</span> a.Salary &gt; b.Salary</span><br><span class="line">;</span><br></pre></td></tr></tbody></table></figure>

<p>方法 2：使用 JOIN 语句<br>JOIN 是一个更常用也更有效的将表连起来的办法，我们使用 ON 来指明条件。<br>因为JOIN 运算优先级高于逗号<br>join相关联查语句，使用小表驱动大表，可以提高效率。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">     a.NAME <span class="keyword">AS</span> Employee</span><br><span class="line"><span class="keyword">FROM</span> Employee <span class="keyword">AS</span> a <span class="keyword">JOIN</span> Employee <span class="keyword">AS</span> b</span><br><span class="line">     <span class="keyword">ON</span> a.ManagerId = b.Id</span><br><span class="line">     <span class="keyword">AND</span> a.Salary &gt; b.Salary</span><br><span class="line">;</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">Name</span> Employee</span><br><span class="line"><span class="keyword">from</span> Employee E1</span><br><span class="line"><span class="keyword">where</span> Salary &gt; (<span class="keyword">select</span> Salary</span><br><span class="line">                <span class="keyword">from</span> Employee </span><br><span class="line">                <span class="keyword">where</span> <span class="keyword">Id</span> = E1.ManagerId);</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.Name <span class="keyword">as</span> Employee </span><br><span class="line"><span class="keyword">from</span> Employee a </span><br><span class="line"><span class="keyword">where</span> a.Salary &gt; (<span class="keyword">select</span> b.Salary </span><br><span class="line">                    <span class="keyword">from</span> Employee b </span><br><span class="line">                    <span class="keyword">where</span> b.Id = a.ManagerId)</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h3 id="182-查找重复的电子邮箱"><a href="#182-查找重复的电子邮箱" class="headerlink" title="182. 查找重复的电子邮箱"></a>182. 查找重复的电子邮箱</h3><p><strong>编写一个 SQL 查询，查找 Person 表中所有重复的电子邮箱。</strong><br>示例：</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span>---------+</span><br><span class="line">| Id | Email   |</span><br><span class="line"><span class="code">+----+</span>---------+</span><br><span class="line">| 1  | a@b.com |</span><br><span class="line">| 2  | c@d.com |</span><br><span class="line">| 3  | a@b.com |</span><br><span class="line"><span class="code">+----+</span>---------+</span><br></pre></td></tr></tbody></table></figure>
<p>根据以上输入，你的查询应返回以下结果：</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+---------+</span></span><br><span class="line">| Email   |</span><br><span class="line"><span class="code">+---------+</span></span><br><span class="line">| a@b.com |</span><br><span class="line"><span class="code">+---------+</span></span><br></pre></td></tr></tbody></table></figure>
<p>说明：所有电子邮箱都是小写字母。</p>
<p>方法一：看到“找重复”的关键字眼，首先要用分组函数（group by），<br>再用聚合函数中的计数函数count()给电子邮件列计数。</p>
<p>分组汇总后，生成了一个如下的表。使用临时表</p>
<p>从这个表里选出计数大于1的电子邮件，就是重复的电子邮件。<br>重复的电子邮箱存在多次。要计算每封电子邮件的存在次数</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> Email, <span class="keyword">count</span>(Email) <span class="keyword">as</span> <span class="keyword">num</span></span><br><span class="line"><span class="keyword">from</span> Person</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> Email;</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight gherkin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> Email   </span>|<span class="string"> num </span>|</span><br><span class="line">|<span class="string">---------</span>|<span class="string">-----</span>|</span><br><span class="line">|<span class="string"> a@b.com </span>|<span class="string"> 2   </span>|</span><br><span class="line">|<span class="string"> c@d.com </span>|<span class="string"> 1   </span>|</span><br></pre></td></tr></tbody></table></figure>
<p>以此作为临时表，我们可以得到下面的解决方案。<br>将“创建辅助表”的步骤放入子查询<br>选出辅助表中计数大于1的姓名</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> Email <span class="keyword">from</span></span><br><span class="line">(</span><br><span class="line">  <span class="keyword">select</span> Email, <span class="keyword">count</span>(Email) <span class="keyword">as</span> <span class="keyword">num</span></span><br><span class="line">  <span class="keyword">from</span> Person</span><br><span class="line">  <span class="keyword">group</span> <span class="keyword">by</span> Email</span><br><span class="line">) <span class="keyword">as</span> statistic</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">num</span> &gt; <span class="number">1</span></span><br><span class="line">;</span><br></pre></td></tr></tbody></table></figure>

<p>方法二：使用 GROUP BY 和 HAVING 条件<br>向 GROUP BY 添加条件的一种更常用的方法是使用 HAVING 子句，该子句更为简单高效。<br>在 SQL 中增加 HAVING 子句原因是，where后面不能接聚合函数，<br>因为where子句的运行顺序排在group by之前，表还没有被分组。<br>HAVING 子句对分组后的分组查询的结果进行筛选<br>having子句即可包含聚合函数作用的字段也可包括普通的标量字段<br>having子句必须于group&nbsp;by&nbsp;子句同时使用，不能单独使用<br>where在分组前过滤，having在分组后过滤，两者之间不冲突。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">    Email</span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">    Person</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">    Email</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(Email)&gt;<span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>
<p>法三自联结。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> p1.Email </span><br><span class="line"><span class="keyword">from</span> Person <span class="keyword">as</span> p1, Person <span class="keyword">as</span> p2 </span><br><span class="line"><span class="keyword">where</span> p1.Email =p2.Email <span class="keyword">and</span> p1.Id!=p2.Id;</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h3 id="183-从不订购的客户"><a href="#183-从不订购的客户" class="headerlink" title="183. 从不订购的客户"></a>183. 从不订购的客户</h3><p><strong>某网站包含两个表，Customers 表和 Orders 表。编写一个 SQL 查询，找出所有从不订购任何东西的客户。</strong><br>Customers 表：</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span>-------+</span><br><span class="line">| Id | Name  |</span><br><span class="line"><span class="code">+----+</span>-------+</span><br><span class="line">| 1  | Joe   |</span><br><span class="line">| 2  | Henry |</span><br><span class="line">| 3  | Sam   |</span><br><span class="line">| 4  | Max   |</span><br><span class="line"><span class="code">+----+</span>-------+</span><br></pre></td></tr></tbody></table></figure>
<p>Orders 表：</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span>------------+</span><br><span class="line">| Id | CustomerId |</span><br><span class="line"><span class="code">+----+</span>------------+</span><br><span class="line">| 1  | 3          |</span><br><span class="line">| 2  | 1          |</span><br><span class="line"><span class="code">+----+</span>------------+</span><br></pre></td></tr></tbody></table></figure>
<p>例如给定上述表格，你的查询应返回：</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+-----------+</span></span><br><span class="line">| Customers |</span><br><span class="line"><span class="code">+-----------+</span></span><br><span class="line">| Henry     |</span><br><span class="line">| Max       |</span><br><span class="line"><span class="code">+-----------+</span></span><br></pre></td></tr></tbody></table></figure>
<p>方法：使用子查询和 NOT IN 子句<br>如果我们有一份曾经订购过的客户名单，就很容易知道谁从未订购过。<br>我们可以使用下面的代码来获得这样的列表。<br><code>select customerid from orders;</code><br>然后，我们可以使用 NOT IN 查询不在此列表中的客户。<br>集合差定义：C=A-B。C中的元素等于在A中但是不在B中。因此，对A中的每个元素a，如果元素a不在B中，则元素a就是集合C的元素。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">    t1.name <span class="keyword">as</span> Customers</span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">    customers t1</span><br><span class="line"><span class="keyword">where</span> t1.id <span class="keyword">not</span> <span class="keyword">in</span>(</span><br><span class="line">    <span class="keyword">select</span> customerid </span><br><span class="line">    <span class="keyword">from</span> orders</span><br><span class="line">    )</span><br><span class="line">;</span><br></pre></td></tr></tbody></table></figure>

<p>法二：<br>如果订单表orders太大，那么会导致使用in的时候，信息都放入内存，效率降低；<br>使用left join只是做了个笛卡尔积运算，不占内存，求集合差的方法。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> t1.Name Customers </span><br><span class="line"><span class="keyword">FROM</span> Customers t1 <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Orders t2 </span><br><span class="line"><span class="keyword">ON</span> t1.Id = t2.CustomerId </span><br><span class="line"><span class="keyword">WHERE</span> t2.CustomerId <span class="keyword">is</span> <span class="literal">null</span></span><br></pre></td></tr></tbody></table></figure>
<p> =后面要讲一个确定的值，而null不能算一个确定的值，<br> 因为int型的可为null，varchar型的可为nul</p>
<p>方法三<br>EXISTS是布尔运算符，常用于测试子查询。<br>当subquery返回任何行时，EXISTS返回true，否则返回false。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    select_list</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    a_table</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    [<span class="keyword">NOT</span>] <span class="keyword">EXISTS</span>(subquery);</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> C.name <span class="keyword">as</span> <span class="string">`Customers`</span></span><br><span class="line"><span class="keyword">from</span> Customers <span class="keyword">as</span> C </span><br><span class="line"><span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span> (</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">distinct</span> customerid</span><br><span class="line">    <span class="keyword">from</span> Orders <span class="keyword">as</span> O</span><br><span class="line">    <span class="keyword">where</span> O.customerid = C.id</span><br><span class="line">) ;</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h3 id="184-部门工资最高的员工"><a href="#184-部门工资最高的员工" class="headerlink" title="184. 部门工资最高的员工"></a>184. 部门工资最高的员工</h3><p><strong>Employee 表包含所有员工信息，每个员工有其对应的 Id, salary 和 department Id。</strong></p>
<figure class="highlight gherkin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+----+-------+--------+--------------+</span><br><span class="line">|<span class="string"> Id </span>|<span class="string"> Name  </span>|<span class="string"> Salary </span>|<span class="string"> DepartmentId </span>|</span><br><span class="line">+----+-------+--------+--------------+</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> Joe   </span>|<span class="string"> 70000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string"> Jim   </span>|<span class="string"> 90000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> Henry </span>|<span class="string"> 80000  </span>|<span class="string"> 2            </span>|</span><br><span class="line">|<span class="string"> 4  </span>|<span class="string"> Sam   </span>|<span class="string"> 60000  </span>|<span class="string"> 2            </span>|</span><br><span class="line">|<span class="string"> 5  </span>|<span class="string"> Max   </span>|<span class="string"> 90000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">+----+-------+--------+--------------+</span><br></pre></td></tr></tbody></table></figure>
<p>Department 表包含公司所有部门的信息。</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span>----------+</span><br><span class="line">| Id | Name     |</span><br><span class="line"><span class="code">+----+</span>----------+</span><br><span class="line">| 1  | IT       |</span><br><span class="line">| 2  | Sales    |</span><br><span class="line"><span class="code">+----+</span>----------+</span><br></pre></td></tr></tbody></table></figure>
<p>编写一个 SQL 查询，找出每个部门工资最高的员工。对于上述表，您的 SQL 查询应返回以下行（行的顺序无关紧要）。</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+------------+</span>----------<span class="code">+--------+</span></span><br><span class="line">| Department | Employee | Salary |</span><br><span class="line"><span class="code">+------------+</span>----------<span class="code">+--------+</span></span><br><span class="line">| IT         | Max      | 90000  |</span><br><span class="line">| IT         | Jim      | 90000  |</span><br><span class="line">| Sales      | Henry    | 80000  |</span><br><span class="line"><span class="code">+------------+</span>----------<span class="code">+--------+</span></span><br></pre></td></tr></tbody></table></figure>
<p>解释：Max 和 Jim 在 IT 部门的工资都是最高的，Henry 在销售部的工资最高。</p>
<p>方法一：使用 JOIN 和 IN 语句</p>
<p>首先对 DepartmentId 字段分组查询每个部门内查询最高工资。<br>有可能有多个员工同时拥有最高工资，所以最好在这个查询中不包含雇员名字的信息，<br>包含 Salary 和 DepartmentId 字段，<br>例如技术部最高20k 但是客服部有个人20k 这样没有部门ID的话条件不足的</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    DepartmentId, <span class="keyword">MAX</span>(Salary)</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Employee</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> DepartmentId;</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight gherkin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> DepartmentId </span>|<span class="string"> MAX(Salary) </span>|</span><br><span class="line">|<span class="string">--------------</span>|<span class="string">-------------</span>|</span><br><span class="line">|<span class="string"> 1            </span>|<span class="string"> 90000       </span>|</span><br><span class="line">|<span class="string"> 2            </span>|<span class="string"> 80000       </span>|</span><br></pre></td></tr></tbody></table></figure>

<p>然后判断表中每条数据的分组和Salary是否和这个相等<br>把表 Employee 和 Department 连接，<br>再在这张临时表里用where或者IN语句筛选出 符合【工资=这个部门最高工资】 的员工信息。根据 Salary 和 DepartmentId 查找 Department.Name 字段</p>
<p>当两列同时作为关键字段进行条件查询时，是将两列合成二元组(部门id,部门最高薪水)作为一个值来查找。<br>，结合in判断 是否在已存在的组合中。<br>比如这个案例里是(课程号,成绩) in，<br>比如，“语文”和“90”合并为值“语文 90”。<br>如果部门A的最高薪水和部门B第二高的薪水是一样的，<br>此时不把DepartmentId对应起来的话，<br>仅仅是通过薪水查询则会把部门A薪水第二高的员工也查询出来，这是不符合要求的。</p>
<p>所以这两列的顺序要和子查询里列的顺序保持一致。<br>如果列的段顺序不一样，比如“90 语文”和“语文 90”就匹配不上，那么查询结果就是空的了。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    Department.name <span class="keyword">AS</span> <span class="string">'Department'</span>,</span><br><span class="line">    Employee.name <span class="keyword">AS</span> <span class="string">'Employee'</span>,</span><br><span class="line">    Salary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Employee</span><br><span class="line"><span class="keyword">JOIN</span></span><br><span class="line">    Department <span class="keyword">ON</span> Employee.DepartmentId = Department.Id</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    (Employee.DepartmentId , Salary) <span class="keyword">IN</span>(</span><br><span class="line">        <span class="keyword">SELECT</span></span><br><span class="line">            DepartmentId, <span class="keyword">MAX</span>(Salary)</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            Employee</span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> </span><br><span class="line">            DepartmentId</span><br><span class="line">    )</span><br><span class="line">;</span><br></pre></td></tr></tbody></table></figure>

<p>使用left join 要注意 部门名字 不能是NULL 。所以，如果使用Left join在官方解答后面加上一句判断 AND Department.name is not null… 。两张表都有可能为空，所以不能left和right，departmentid是null，leftjoin就会保留null</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    Department.name <span class="keyword">AS</span> <span class="string">'Department'</span>,</span><br><span class="line">    Employee.name <span class="keyword">AS</span> <span class="string">'Employee'</span>,</span><br><span class="line">    Salary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    Employee</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span></span><br><span class="line">    Department <span class="keyword">ON</span> Employee.DepartmentId = Department.Id </span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    (Employee.DepartmentId , Salary) <span class="keyword">IN</span></span><br><span class="line">    (   <span class="keyword">SELECT</span></span><br><span class="line">            DepartmentId, <span class="keyword">MAX</span>(Salary)</span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            Employee</span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> DepartmentId</span><br><span class="line">    )</span><br><span class="line"><span class="keyword">AND</span> Department.name <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">;</span><br></pre></td></tr></tbody></table></figure>

<p>法二<br>连接临时表<br>Employee和查询出来的每个分组的最大值连接。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> d.Name <span class="keyword">as</span> Department, e.Name <span class="keyword">as</span> Employee, e.Salary</span><br><span class="line"><span class="keyword">from</span> Employee e </span><br><span class="line"><span class="keyword">join</span> Department d <span class="keyword">on</span> e.DepartmentId = d.Id </span><br><span class="line"><span class="keyword">join</span> (</span><br><span class="line">    <span class="keyword">select</span> DepartmentId, <span class="keyword">max</span>(Salary) <span class="keyword">as</span> Salary</span><br><span class="line">    <span class="keyword">from</span> Employee</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> DepartmentId</span><br><span class="line">    ) t </span><br><span class="line">    <span class="keyword">on</span> e.DepartmentId = t.DepartmentId <span class="keyword">and</span> e.Salary = t.Salary;</span><br></pre></td></tr></tbody></table></figure>

<p>法三<br>Employee和自身连接，on的条件为部门相同且同时约束Salary的大小。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> d.Name <span class="keyword">as</span> Department, e1.Name <span class="keyword">as</span> Employee, e1.Salary</span><br><span class="line"><span class="keyword">from</span> Employee e1 </span><br><span class="line"><span class="keyword">join</span> Department d <span class="keyword">on</span> e1.DepartmentId = d.Id </span><br><span class="line"><span class="keyword">join</span> Employee e2 <span class="keyword">on</span> e1.DepartmentId = e2.DepartmentId <span class="keyword">and</span> e1.Salary &lt;= e2.Salary</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> e1.Id</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">count</span>(<span class="keyword">distinct</span> e2.Salary) = <span class="number">1</span>;</span><br></pre></td></tr></tbody></table></figure>


<hr>
<h3 id="185-部门工资前三高的所有员工"><a href="#185-部门工资前三高的所有员工" class="headerlink" title="185. 部门工资前三高的所有员工"></a>185. 部门工资前三高的所有员工</h3><p><strong>Employee 表包含所有员工信息，每个员工有其对应的工号&nbsp;Id，姓名 Name，工资 Salary 和部门编号 DepartmentId 。</strong></p>
<figure class="highlight gherkin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+----+-------+--------+--------------+</span><br><span class="line">|<span class="string"> Id </span>|<span class="string"> Name  </span>|<span class="string"> Salary </span>|<span class="string"> DepartmentId </span>|</span><br><span class="line">+----+-------+--------+--------------+</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> Joe   </span>|<span class="string"> 85000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string"> Henry </span>|<span class="string"> 80000  </span>|<span class="string"> 2            </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> Sam   </span>|<span class="string"> 60000  </span>|<span class="string"> 2            </span>|</span><br><span class="line">|<span class="string"> 4  </span>|<span class="string"> Max   </span>|<span class="string"> 90000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 5  </span>|<span class="string"> Janet </span>|<span class="string"> 69000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 6  </span>|<span class="string"> Randy </span>|<span class="string"> 85000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 7  </span>|<span class="string"> Will  </span>|<span class="string"> 70000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">+----+-------+--------+--------------+</span><br></pre></td></tr></tbody></table></figure>
<p>Department 表包含公司所有部门的信息。</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span>----------+</span><br><span class="line">| Id | Name     |</span><br><span class="line"><span class="code">+----+</span>----------+</span><br><span class="line">| 1  | IT       |</span><br><span class="line">| 2  | Sales    |</span><br><span class="line"><span class="code">+----+</span>----------+</span><br></pre></td></tr></tbody></table></figure>
<p>编写一个&nbsp;SQL 查询，找出每个部门获得前三高工资的所有员工。例如，根据上述给定的表，查询结果应返回：</p>
<figure class="highlight gherkin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+------------+----------+--------+</span><br><span class="line">|<span class="string"> Department </span>|<span class="string"> Employee </span>|<span class="string"> Salary </span>|</span><br><span class="line">+------------+----------+--------+</span><br><span class="line">|<span class="string"> IT         </span>|<span class="string"> Max      </span>|<span class="string"> 90000  </span>|</span><br><span class="line">|<span class="string"> IT         </span>|<span class="string"> Randy    </span>|<span class="string"> 85000  </span>|</span><br><span class="line">|<span class="string"> IT         </span>|<span class="string"> Joe      </span>|<span class="string"> 85000  </span>|</span><br><span class="line">|<span class="string"> IT         </span>|<span class="string"> Will     </span>|<span class="string"> 70000  </span>|</span><br><span class="line">|<span class="string"> Sales      </span>|<span class="string"> Henry    </span>|<span class="string"> 80000  </span>|</span><br><span class="line">|<span class="string"> Sales      </span>|<span class="string"> Sam      </span>|<span class="string"> 60000  </span>|</span><br><span class="line">+------------+----------+--------+</span><br></pre></td></tr></tbody></table></figure>
<p>IT 部门中，Max 获得了最高的工资，Randy 和 Joe 都拿到了第二高的工资，Will 的工资排第三。<br>销售部门（Sales）只有两名员工，Henry 的工资最高，Sam 的工资排第二。</p>
<p>感觉应该改为各部门工资级别前三的员工<br>不能理解为前三名员工，如果拿90000的有四个人的话，你只取三个人，那怎么取都是错的了</p>
<p>方法：使用 JOIN 和子查询<br>公司里前 3 高的薪水意味着有不超过 3 个工资值比这些值大。</p>
<p>统计了有多少人的工资比 e1.Salary 高</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e1.Name <span class="keyword">as</span> <span class="string">'Employee'</span>, e1.Salary</span><br><span class="line"><span class="keyword">from</span> Employee e1</span><br><span class="line"><span class="keyword">where</span> (</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">count</span>(<span class="keyword">distinct</span> e2.Salary)</span><br><span class="line">    <span class="keyword">from</span> Employee e2</span><br><span class="line">    <span class="keyword">where</span> e2.Salary &gt; e1.Salary</span><br><span class="line">    ) &lt; <span class="number">3</span> </span><br><span class="line">;</span><br></pre></td></tr></tbody></table></figure>
<p>样例的输出应该如下所示。</p>
<figure class="highlight gherkin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> Employee </span>|<span class="string"> Salary </span>|</span><br><span class="line">|<span class="string">----------</span>|<span class="string">--------</span>|</span><br><span class="line">|<span class="string"> Joe      </span>|<span class="string"> 85000  </span>|</span><br><span class="line">|<span class="string"> Henry    </span>|<span class="string"> 80000  </span>|</span><br><span class="line">|<span class="string"> Max      </span>|<span class="string"> 90000  </span>|</span><br><span class="line">|<span class="string"> Randy    </span>|<span class="string"> 85000  </span>|</span><br></pre></td></tr></tbody></table></figure>
<p>当 &lt;3 改为 =0,第一高工资 比他高的工资 个数为0 </p>
<figure class="highlight gherkin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> Employee </span>|<span class="string"> Salary </span>|</span><br><span class="line">|<span class="string">----------</span>|<span class="string">--------</span>|</span><br><span class="line">|<span class="string"> Max      </span>|<span class="string"> 90000  </span>|</span><br></pre></td></tr></tbody></table></figure>
<p>当 &lt;3 改为 =1，第二高工资 ,比他的高的 工资个数为1，</p>
<figure class="highlight gherkin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> Employee </span>|<span class="string"> Salary </span>|</span><br><span class="line">|<span class="string">----------</span>|<span class="string">--------</span>|</span><br><span class="line">|<span class="string"> Joe      </span>|<span class="string"> 85000  </span>|</span><br><span class="line">|<span class="string"> Randy    </span>|<span class="string"> 85000  </span>|</span><br></pre></td></tr></tbody></table></figure>
<p>当 &lt;3 改为 =2，有2个比某个数大，就是最3大，</p>
<figure class="highlight gherkin"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> Employee </span>|<span class="string"> Salary </span>|</span><br><span class="line">|<span class="string">----------</span>|<span class="string">--------</span>|</span><br><span class="line">|<span class="string"> Henry    </span>|<span class="string"> 80000  </span>|</span><br></pre></td></tr></tbody></table></figure>

<p>题目要查出为同一部门的前三高工资，在同一部门内 其他的工资&gt;该员工的薪资 的个数小于3  ，即为子查询里面的条件<br>把表 Employee 和表 Department 连接来获得部门信息。</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">工资是同一个部门里的，不加这个条件的话，就会所有部门比较了</span><br><span class="line">SQL查询e1表是按行查询的，每查询一行，执行一次where后面的内容，</span><br><span class="line">也就是拿这一行的salary跟e2表里同部门的所有salary作比较，</span><br><span class="line">得到不超过这一行里salary值的个数。</span><br><span class="line">```SQL</span><br><span class="line">SELECT</span><br><span class="line">    d.Name AS 'Department', e1.Name AS 'Employee', e1.Salary</span><br><span class="line">FROM</span><br><span class="line">    Employee e1</span><br><span class="line">JOIN</span><br><span class="line">    Department d ON e1.DepartmentId = d.Id</span><br><span class="line">WHERE (SELECT</span><br><span class="line">            COUNT(DISTINCT e2.Salary)</span><br><span class="line">        FROM</span><br><span class="line">            Employee e2</span><br><span class="line">        WHERE</span><br><span class="line">            e2.Salary &gt; e1.Salary</span><br><span class="line">                AND e1.DepartmentId = e2.DepartmentId</span><br><span class="line">        ) &lt; 3 </span><br><span class="line">;</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Write your MySQL query statement below</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">解题思路:先对Employee表进行部门分组工资排名，</span></span><br><span class="line"><span class="comment">再关联Department表查询部门名称，</span></span><br><span class="line"><span class="comment">再使用WHERE筛选出排名小于等于3的数据（也就是每个部门排名前3的工资）。</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">D.Name <span class="keyword">AS</span> Department,</span><br><span class="line">A.Name <span class="keyword">AS</span> Employee,</span><br><span class="line">A.Salary</span><br><span class="line"><span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">DENSE_RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">partition</span> <span class="keyword">by</span> DepartmentId <span class="keyword">order</span> <span class="keyword">by</span> Salary <span class="keyword">desc</span>) <span class="keyword">AS</span> ranking,DepartmentId,<span class="keyword">Name</span>,Salary</span><br><span class="line">      <span class="keyword">FROM</span> Employee) <span class="keyword">AS</span> A</span><br><span class="line"><span class="keyword">JOIN</span> Department <span class="keyword">AS</span> D <span class="keyword">ON</span> A.DepartmentId=D.id</span><br><span class="line"><span class="keyword">WHERE</span> A.ranking&lt;=<span class="number">3</span></span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">d.Name <span class="keyword">AS</span> <span class="string">'Department'</span>, e1.Name <span class="keyword">AS</span> <span class="string">'Employee'</span>, e1.Salary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line"> Employee e1</span><br><span class="line"><span class="keyword">JOIN</span></span><br><span class="line">Department d <span class="keyword">ON</span> e1.DepartmentId = d.Id</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line"><span class="comment">#工资级别数量小于等于3，即最多只有3个工资级别，也就是前三高</span></span><br><span class="line"> <span class="number">3</span> &gt;= (</span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line"><span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> e2.Salary)</span><br><span class="line"> <span class="keyword">FROM</span></span><br><span class="line">Employee e2</span><br><span class="line">  <span class="keyword">WHERE</span></span><br><span class="line"><span class="comment">#e2的工资级别大于等于e1的工资级别</span></span><br><span class="line"> e2.Salary &gt;= e1.Salary</span><br><span class="line"> <span class="keyword">AND</span> e1.DepartmentId = e2.DepartmentId</span><br><span class="line"> )</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> e1.DepartmentId,e1.Salary <span class="keyword">DESC</span>;</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">    t2.Name <span class="keyword">as</span> Department,</span><br><span class="line">    t1.Name <span class="keyword">as</span> Employee,</span><br><span class="line">    t1.Salary <span class="keyword">as</span> Salary</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    Employee <span class="keyword">as</span> t1,</span><br><span class="line">    Department <span class="keyword">as</span> t2</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">    t1.DepartmentId = t2.Id <span class="keyword">and</span></span><br><span class="line">    <span class="number">3</span> &gt; (</span><br><span class="line">            <span class="keyword">select</span> </span><br><span class="line">                <span class="keyword">count</span>(<span class="keyword">distinct</span> Salary)</span><br><span class="line">            <span class="keyword">from</span></span><br><span class="line">                Employee</span><br><span class="line">            <span class="keyword">where</span></span><br><span class="line">                Salary&gt;t1.Salary <span class="keyword">and</span></span><br><span class="line">                DepartmentId = t1.DepartmentId</span><br><span class="line">    )</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> t2.Name,t1.Salary <span class="keyword">desc</span></span><br></pre></td></tr></tbody></table></figure>
<p>这一题做的有点混乱了，本来按自己的想法来说，前几前几这种问题，一般都是排好序之后用limit，但是好像很多题目都是两表连接，用比较符盒count判断，这个思路要学会转换。还有就是看了一些别人题解，发现也有用自定义变量等这些方法的，姿势还是很多的，哎，太菜了。</p>
<p>为了记录足球比赛的结果，设计表如下：<br>team：参赛队伍表<br>match：赛程表<br>match赛程表中的 hostTeamID与 guestTeamID都和team表中的 teamID关联,查询2006-6-1到2006-7-1之间举行的所有比赛,并且用以下形式列出:<br>拜仁 2:0 不莱梅 2006-6-21<br>首先列出需要查询的列：<br>参赛队伍表 team<br>字段名称 字段类型 描述<br>teamID int 主键<br>teamName varchar(20) 队伍名称<br>赛程表match<br>字段名称 字段类型 描述<br>match ID int 主键<br>hostTeamID int 主队的ID<br>guestTeamID int 客队的ID<br>matchTime date   比赛开始时间<br>matchResult varchar(20) 比赛结果，如（2:0）<br>其次列出结果列：<br>主队 结果 客对 时间</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建参赛队伍表CREATE TABLE team(</span></span><br><span class="line">teamID INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY, teamName VARCHAR(30) NOT NULL</span><br><span class="line">);</span><br><span class="line"><span class="comment">#向参赛队伍表中插入记录</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> team(teamName) <span class="keyword">VALUES</span>(<span class="string">' 拜 仁 '</span>); <span class="keyword">INSERT</span> <span class="keyword">INTO</span> team(teamName) <span class="keyword">VALUES</span>(<span class="string">' 不 莱 梅 '</span>); <span class="keyword">INSERT</span> <span class="keyword">INTO</span> team(teamName) <span class="keyword">VALUES</span>(<span class="string">'皇家马德里'</span>); <span class="keyword">INSERT</span> <span class="keyword">INTO</span> team(teamName) <span class="keyword">VALUES</span>(<span class="string">'巴塞罗那'</span>); <span class="keyword">INSERT</span> <span class="keyword">INTO</span> team(teamName) <span class="keyword">VALUES</span>(<span class="string">' 切 尔 西 '</span>); <span class="keyword">INSERT</span> <span class="keyword">INTO</span> team(teamName) <span class="keyword">VALUES</span>(<span class="string">' 曼 联 '</span>); <span class="keyword">INSERT</span> <span class="keyword">INTO</span> team(teamName) <span class="keyword">VALUES</span>(<span class="string">'AC 米 兰 '</span>); <span class="keyword">INSERT</span> <span class="keyword">INTO</span> team(teamName) <span class="keyword">VALUES</span>(<span class="string">'国际米兰'</span>);</span><br><span class="line"><span class="comment">#创建 match 赛程表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> mat(</span><br><span class="line">matchID <span class="built_in">INT</span> <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT PRIMARY <span class="keyword">KEy</span>,</span><br><span class="line">hostTeamID <span class="built_in">INT</span> <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>, guestTeamID <span class="built_in">INT</span> <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">matchResult <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>, matchTime <span class="built_in">DATE</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">#向赛程表中插入几条记录</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> mat(hostTeamID,guestTeamID,matchResult,matchTime) <span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="string">'3:1'</span>,<span class="string">'2006-6-15'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> mat(hostTeamID,guestTeamID,matchResult,matchTime) <span class="keyword">VALUES</span>(<span class="number">3</span>,<span class="number">4</span>,<span class="string">'2:2'</span>,<span class="string">'2006-6-28'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> mat(hostTeamID,guestTeamID,matchResult,matchTime) <span class="keyword">VALUES</span>(<span class="number">5</span>,<span class="number">6</span>,<span class="string">'0:2'</span>,<span class="string">'2006-7-10'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> mat(hostTeamID,guestTeamID,matchResult,matchTime) <span class="keyword">VALUES</span>(<span class="number">7</span>,<span class="number">8</span>,<span class="string">'5:3'</span>,<span class="string">'2006-5-30'</span>);</span><br></pre></td></tr></tbody></table></figure>

<p>1、先进行一次左连接 得到主队的名字</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> hid,m1.tname,mres,gid,matime  <span class="keyword">from</span> m <span class="keyword">left</span> <span class="keyword">join</span> t <span class="keyword">as</span> m1 <span class="keyword">on</span> m.hid= m1.tid;</span><br><span class="line">1、先进行一次左连接 得到主队的名字</span><br></pre></td></tr></tbody></table></figure>

<p>2、再进行一次左连接 得到客队的名字</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> hid,m1.tname,mres,gid,t1.tname <span class="keyword">from</span> m <span class="keyword">left</span> <span class="keyword">join</span> t <span class="keyword">as</span> m1 <span class="keyword">on</span> m.hid= m1.tid <span class="keyword">left</span> <span class="keyword">join</span> t <span class="keyword">as</span> t1 <span class="keyword">on</span> m.gid=t1.tid;</span><br><span class="line">1、先进行一次左连接 得到主队的名字</span><br></pre></td></tr></tbody></table></figure>

<p>通过外键联表，完成最终SQL：</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> t1.teamName,m.matchResult,t2.teamName,m.matchTime </span><br><span class="line"><span class="keyword">from</span> <span class="keyword">match</span> <span class="keyword">as</span> m </span><br><span class="line">    <span class="keyword">left</span> <span class="keyword">join</span> team <span class="keyword">as</span> t1 <span class="keyword">on</span> m.hostTeamID = t1.teamID, </span><br><span class="line">    <span class="keyword">left</span> <span class="keyword">join</span> team <span class="keyword">as</span> t2 <span class="keyword">on</span> m.guestTeamID = t2.TeamID </span><br><span class="line"><span class="keyword">where</span> matchTime <span class="keyword">between</span> <span class="string">"2006-6-1"</span> <span class="keyword">and</span> <span class="string">"2006-7-1"</span></span><br></pre></td></tr></tbody></table></figure>


<p>问题22：一个6亿的表a，一个3亿的表b，通过外键tid关联，<br>你如何最快的查询出满足条件的第50000到第50200中的这200条数据记录。</p>
<p>1、如果A表TID是自增长,并且是连续的,B表的ID为索引</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * </span><br><span class="line"><span class="keyword">from</span> a,b </span><br><span class="line"><span class="keyword">where</span> a.tid = b.id <span class="keyword">and</span> a.tid&gt;<span class="number">50000</span> </span><br><span class="line"><span class="keyword">limit</span> <span class="number">200</span>;</span><br></pre></td></tr></tbody></table></figure>
<p>2、如果A表的TID不是连续的,那么就需要使用覆盖索引.TID要么是主键,要么是辅助索引,B表ID也需要有索引。</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * </span><br><span class="line"><span class="keyword">from</span> b , </span><br><span class="line">    (<span class="keyword">select</span> tid </span><br><span class="line">    <span class="keyword">from</span> a </span><br><span class="line">    <span class="keyword">limit</span> <span class="number">50000</span>,<span class="number">200</span>) a </span><br><span class="line"><span class="keyword">where</span> b.id = a .tid;</span><br></pre></td></tr></tbody></table></figure>

<p>拷贝表( 拷贝数据, 源表名：a 目标表名：b)</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> b(a, b, c) <span class="keyword">select</span> d,e,f <span class="keyword">from</span> a;</span><br></pre></td></tr></tbody></table></figure>

<p>Student(S#,Sname,Sage,Ssex) 学生表 Course(C#,Cname,T#) 课程表 SC(S#,C#,score) 成绩表 Teacher(T#,Tname) 教师表 查询没学过“叶平”老师课的同学的学号、姓名</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> Student.S<span class="comment">#,Student.Sname</span></span><br><span class="line"><span class="keyword">from</span> Student</span><br><span class="line"><span class="keyword">where</span> S<span class="comment"># not in (select distinct( SC.S#) </span></span><br><span class="line">    <span class="keyword">from</span> SC,Course,Teacher </span><br><span class="line">    <span class="keyword">where</span> SC.C<span class="comment">#=Course.C# and Teacher.T#=Course.T# and Teacher.Tname=’叶平’);</span></span><br></pre></td></tr></tbody></table></figure>

<p>随机取出10条数据</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * </span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">users</span> </span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">id</span> &gt;= (</span><br><span class="line">    (<span class="keyword">SELECT</span> <span class="keyword">MAX</span>(<span class="keyword">id</span>) <span class="keyword">FROM</span> <span class="keyword">users</span>)-(<span class="keyword">SELECT</span> <span class="keyword">MIN</span>(<span class="keyword">id</span>) <span class="keyword">FROM</span> <span class="keyword">users</span>)</span><br><span class="line">    ) * <span class="keyword">RAND</span>() + (<span class="keyword">SELECT</span> <span class="keyword">MIN</span>(<span class="keyword">id</span>) <span class="keyword">FROM</span> <span class="keyword">users</span>) </span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">10</span></span><br></pre></td></tr></tbody></table></figure>
<p>#此方法效率比直接用高很多</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">rand</span>() <span class="keyword">LIMIT</span> <span class="number">10</span></span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/jian-zhi-offer-shi-ti/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/jian-zhi-offer-shi-ti/" class="post-title-link" itemprop="url">剑指offer试题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:46" itemprop="dateModified" datetime="2021-04-02T12:24:46Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h4 id="1-二维数组中的查找-本题考点-查找"><a href="#1-二维数组中的查找-本题考点-查找" class="headerlink" title="1.二维数组中的查找  [^本题考点 查找]"></a>1.二维数组中的查找  [^本题考点 <em>查找</em>]</h4><p>​    <strong>题目：在一个二维数组中（每个一维数组的长度相同），每一行都按照从左到右递增的顺序排序，每一列都按照从上到下递增的顺序排序。请完成一个函数，输入这样的一个二维数组和一个整数，判断数组中是否含有该整数。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># array 二维列表</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 时间复杂度O(n^2) 291ms</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Find_1</span>(<span class="params">self, target, array</span>):</span></span><br><span class="line">        <span class="comment"># write code here</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(array)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(array[i])):</span><br><span class="line">                <span class="keyword">if</span> target == array[i][j]:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 时间复杂度O(n)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Find_2</span>(<span class="params">self, target, array</span>):</span></span><br><span class="line">        <span class="comment"># 行数为二维数组的长度</span></span><br><span class="line">        row_count = len(array)</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="comment"># 列数为任意一列的长度</span></span><br><span class="line">        column_count = len(array[<span class="number">0</span>])</span><br><span class="line">        j = column_count - <span class="number">1</span></span><br><span class="line">        <span class="comment"># 当i小于行数（即行数,也就是此时的i,取值0--row_count-1）且列数-1大于等于0（即列数，也将就是此时的j,取值0--column_count-1）的时候，循环</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; row_count <span class="keyword">and</span> <span class="number">0</span> &lt; j:</span><br><span class="line">            value = array[i][j]</span><br><span class="line">            <span class="keyword">if</span> value == target:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">elif</span> value &lt; target:</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                j -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="2-替换空格-本题考点-字符串"><a href="#2-替换空格-本题考点-字符串" class="headerlink" title="2.替换空格 [^本题考点 字符串]"></a>2.替换空格 [^本题考点 <em>字符串</em>]</h4><p>​    <strong>题目：请实现一个函数，将一个字符串中的每个空格替换成“%20”。例如，当字符串为We Are Happy.则经过替换之后的字符串为We%20Are%20Happy。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># s 源字符串</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">replaceSpace</span>(<span class="params">self, s</span>):</span></span><br><span class="line">        strLen = len(s)</span><br><span class="line">        <span class="comment"># 定义空字符串准备接收</span></span><br><span class="line">        rep_str = <span class="string">''</span></span><br><span class="line">        <span class="comment"># 遍历，检测到空格就加上"%20"</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(strLen):</span><br><span class="line">            <span class="keyword">if</span> s[i].isspace():</span><br><span class="line">                rep_str += <span class="string">'%'</span></span><br><span class="line">                rep_str += <span class="string">'2'</span></span><br><span class="line">                rep_str += <span class="string">'0'</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                rep_str += s[i]</span><br><span class="line">        <span class="comment"># 返回辅助字符串</span></span><br><span class="line">        <span class="keyword">return</span> rep_str</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="3-从尾到头打印链表-本题考点-链表"><a href="#3-从尾到头打印链表-本题考点-链表" class="headerlink" title="3.从尾到头打印链表 [^本题考点 链表]"></a>3.从尾到头打印链表 [^本题考点 <em>链表</em>]</h4><p>​    <strong>题目：输入一个链表，按链表值从尾到头的顺序返回一个ArrayList。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        self.val = x</span><br><span class="line">        self.next = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># 返回从尾部到头部的列表值序列，例如[1,2,3]</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">printListFromTailToHead</span>(<span class="params">self, listNode</span>):</span></span><br><span class="line">        output = []</span><br><span class="line">        pTmp = listNode</span><br><span class="line">        <span class="keyword">while</span> pTmp:</span><br><span class="line">            output.insetr(<span class="number">0</span>, pTmp.val)</span><br><span class="line">            pTmp = pTmp.next</span><br><span class="line">        <span class="keyword">return</span> output</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="4-重建二叉树-本题考点-二叉树"><a href="#4-重建二叉树-本题考点-二叉树" class="headerlink" title="4.重建二叉树 [^本题考点 二叉树]"></a>4.重建二叉树 [^本题考点 <em>二叉树</em>]</h4><p>​    <strong>题目：输入某二叉树的前序遍历和中序遍历的结果，请重建出该二叉树。假设输入的前序遍历和中序遍历的结果中都不含重复的数字。例如输入前序遍历序列{1,2,4,7,3,5,6,8}和中序遍历序列{4,7,2,1,5,3,8,6}，则重建二叉树并返回。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># 返回构造的TreeNode根节点</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reConstructBinaryTree</span>(<span class="params">self, pre, tin</span>):</span></span><br><span class="line">        <span class="comment"># write code here</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> pre <span class="keyword">or</span> <span class="keyword">not</span> tin:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> len(pre) != len(tin):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 取出pre的值</span></span><br><span class="line">        root = pre[<span class="number">0</span>]</span><br><span class="line">        <span class="comment"># 新建一个根节点</span></span><br><span class="line">        rootNode = TreeNode(root)</span><br><span class="line">        <span class="comment"># 在tin中找到pos的位置</span></span><br><span class="line">        pos = tin.index(root)</span><br><span class="line">        <span class="comment"># 将tin以pos的位置分为左右两边（除去pos）</span></span><br><span class="line">        tinLeft = tin[: pos]</span><br><span class="line">        tinRight = tin[pos+<span class="number">1</span>: ]</span><br><span class="line">        <span class="comment"># 将pre以pos的位置分为左右两边（除去pos）</span></span><br><span class="line">        preLeft = pre[<span class="number">1</span>: pos+<span class="number">1</span>]</span><br><span class="line">        preRight = pre[pos+<span class="number">1</span>: ]</span><br><span class="line">        <span class="comment"># 将preLeft和tinLeft再次走一遍这个方法，递归下去</span></span><br><span class="line">        leftNode = self.reConstructBinaryTree(preLeft, tinLeft)</span><br><span class="line">        <span class="comment"># 将preRight和tinRight再次走一遍这个方法，递归下去</span></span><br><span class="line">        rightNode = self.reConstructBinaryTree(preRight, tinRight)</span><br><span class="line">        <span class="comment"># 将leftNode赋值给rootNode的左节点</span></span><br><span class="line">        rootNode.left = leftNode</span><br><span class="line">        <span class="comment"># 将rightNode赋值给rootNode的右节点</span></span><br><span class="line">        rootNode.right = rightNode</span><br><span class="line">        <span class="comment"># 返回根节点</span></span><br><span class="line">        <span class="keyword">return</span> rootNode</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="5-用两个栈实现队列-本题考点-队列-栈"><a href="#5-用两个栈实现队列-本题考点-队列-栈" class="headerlink" title="5.用两个栈实现队列 [^本题考点 队列  栈]"></a>5.用两个栈实现队列 [^本题考点 <em>队列  栈</em>]</h4><p>​    <strong>题目：用两个栈来实现一个队列，完成队列的Push和Pop操作。 队列中的元素为int类型。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.acceptStack = []</span><br><span class="line">        self.outputStack = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span>(<span class="params">self, node</span>):</span></span><br><span class="line">        <span class="comment"># 入栈操作，实现队列的Push操作</span></span><br><span class="line">        self.acceptStack.append(node)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># 要出的列表要是没有东西，就将两个的内容弹出，加入</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.outputStack:</span><br><span class="line">            <span class="keyword">while</span> self.acceptStack:</span><br><span class="line">                self.outputStack.append(self.acceptStack.pop())</span><br><span class="line">        <span class="comment"># 给出一个出栈的返回值，实现队列的POP操作</span></span><br><span class="line">        <span class="keyword">if</span> self.outputStack:</span><br><span class="line">            <span class="keyword">return</span> self.outputStack.pop()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="6-旋转数组的最小数字-本题考点-查找"><a href="#6-旋转数组的最小数字-本题考点-查找" class="headerlink" title="6.旋转数组的最小数字 [^本题考点 查找]"></a>6.旋转数组的最小数字 [^本题考点 <em>查找</em>]</h4><p>​    <strong>题目：把一个数组最开始的若干个元素搬到数组的末尾，我们称之为数组的旋转。 输入一个非减排序的数组的一个旋转，输出旋转数组的最小元素。 例如数组{3,4,5,1,2}为{1,2,3,4,5}的一个旋转，该数组的最小值为1。 NOTE：给出的所有元素都大于0，若数组大小为0，请返回0。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minNumberInRotateArray</span>(<span class="params">self, rotateArray</span>):</span></span><br><span class="line">        <span class="comment"># 时间复杂度O(n)</span></span><br><span class="line">        <span class="comment"># minNum = 0</span></span><br><span class="line">        <span class="comment"># for i in range(0, len(rotateArray)):</span></span><br><span class="line">        <span class="comment">#     minNum = minNum if minNum  &lt; rotateArray[i] and minNum != 0 else rotateArray[i]</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># return minNum</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 时间复杂度O(logn)</span></span><br><span class="line">        <span class="comment"># 若数组大小为0</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> rotateArray:</span><br><span class="line">            <span class="comment"># 返回0</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="comment"># 左侧索引</span></span><br><span class="line">        left = <span class="number">0</span></span><br><span class="line">        <span class="comment"># 右侧索引</span></span><br><span class="line">        right = len(rotateArray) - <span class="number">1</span></span><br><span class="line">        <span class="comment"># 当左侧索引小于右侧索引时循环</span></span><br><span class="line">        <span class="keyword">while</span> left &lt;= right:  <span class="comment"># 直至left&gt;right结束。</span></span><br><span class="line">            <span class="comment"># 中间值为左侧索引和右侧索引求和再除以2，向下取整</span></span><br><span class="line">            mid = (left + right) &gt;&gt; <span class="number">1</span>  <span class="comment"># (left + right) // 2</span></span><br><span class="line">            <span class="comment"># 若中间索引对应的值小于它左侧一个的值，即为要取得值</span></span><br><span class="line">            <span class="keyword">if</span> rotateArray[mid] &lt; rotateArray[mid - <span class="number">1</span>]:</span><br><span class="line">                <span class="comment"># 返最小标值</span></span><br><span class="line">                <span class="keyword">return</span> rotateArray[mid]</span><br><span class="line">            <span class="comment"># 若中间索引对应的值小于右侧索引的值，最小值在左侧 51234</span></span><br><span class="line">            <span class="comment"># 假如最小值在右边， 53214，那么不能构成非递减</span></span><br><span class="line">            <span class="keyword">elif</span> rotateArray[mid] &lt; rotateArray[right]:</span><br><span class="line">                <span class="comment"># 将右侧索引置为中间索引-1</span></span><br><span class="line">                right = mid - <span class="number">1</span></span><br><span class="line">            <span class="comment"># 若中间索引对应的值大于右侧索引的值，最小值在右侧，</span></span><br><span class="line">            <span class="comment"># 假如最小值在左边，那么在非递减数组中间值就不会大于右边</span></span><br><span class="line">            <span class="comment"># if(rotateArray[mid] &gt; rotateArray[left])</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 将左侧索引置为中间索引+1</span></span><br><span class="line">                left = mid + <span class="number">1</span></span><br><span class="line">     </span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minNumberInRotateArray</span>(<span class="params">self, rotateArray</span>):</span></span><br><span class="line">        <span class="keyword">if</span> rotateArray <span class="keyword">is</span> <span class="literal">None</span>: <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        start = <span class="number">0</span></span><br><span class="line">        end = len(rotateArray) - <span class="number">1</span></span><br><span class="line">        mid = (start + end) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> start &lt; end:</span><br><span class="line">            <span class="keyword">if</span> rotateArray[mid] &gt; rotateArray[end]:</span><br><span class="line">                start = mid + <span class="number">1</span></span><br><span class="line">                mid = (start + end) // <span class="number">2</span></span><br><span class="line">            <span class="keyword">elif</span> rotateArray[mid] == rotateArray[end]:</span><br><span class="line">                end -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                end = mid</span><br><span class="line">                mid = (start + end) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">return</span> rotateArray[start]</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="7-斐波那契数列-本题考点-递归，复杂度"><a href="#7-斐波那契数列-本题考点-递归，复杂度" class="headerlink" title="7.斐波那契数列  [^本题考点 递归，复杂度]"></a>7.斐波那契数列  [^本题考点 <em>递归，复杂度</em>]</h4><p>​    <strong>题目：大家都知道斐波那契数列，现在要求输入一个整数n，请你输出斐波那契数列的第n项（从0开始，第0项为0）。n&lt;=39</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># 时间复杂度 O(n)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Fibonacci_1</span>(<span class="params">self, n</span>):</span></span><br><span class="line">        <span class="comment"># write code here</span></span><br><span class="line">        a, b = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            a, b = b, a+b</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 递归，时间复杂度 O(2^n)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Fibonacci_2</span>(<span class="params">n</span>):</span></span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n &gt; <span class="number">1</span>:</span><br><span class="line">            num = Fibonacci(n<span class="number">-1</span>) + Fibonacci(n<span class="number">-2</span>)</span><br><span class="line">            <span class="keyword">return</span> num</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># lambda 表达式版</span></span><br><span class="line">fibonacci = <span class="keyword">lambda</span> n: n <span class="keyword">if</span> n &lt; <span class="number">2</span> <span class="keyword">else</span> fibonacci(n<span class="number">-1</span>) + fibonacci(n<span class="number">-2</span>)</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="8-跳台阶-本题考点-逻辑分析"><a href="#8-跳台阶-本题考点-逻辑分析" class="headerlink" title="8.跳台阶 [^本题考点 逻辑分析]"></a>8.跳台阶 [^本题考点 <em>逻辑分析</em>]</h4><p>​    <strong>题目：一只青蛙一次可以跳上1级台阶，也可以跳上2级。求该青蛙跳上一个n级的台阶总共有多少种跳法（先后次序不同算不同的结果）。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># 简单版</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">jumpFloor_1</span>(<span class="params">self, number</span>):</span></span><br><span class="line">        <span class="keyword">if</span> number == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> number == <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">        reg = <span class="number">0</span></span><br><span class="line">        a = <span class="number">1</span></span><br><span class="line">        b = <span class="number">2</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, number): <span class="comment"># 从2加到number-1</span></span><br><span class="line">            reg = a + b</span><br><span class="line">            a = b</span><br><span class="line">            b = reg</span><br><span class="line">        <span class="keyword">return</span> reg</span><br><span class="line">    <span class="comment"># 简化版</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">jumpFloor_2</span>(<span class="params">self, number</span>):</span></span><br><span class="line">        a, b = <span class="number">1</span>, <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(number):</span><br><span class="line">            a, b = b, a+b</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="comment"># lambda 表达式版</span></span><br><span class="line">fibonacci = <span class="keyword">lambda</span> n: n <span class="keyword">if</span> n &lt;= <span class="number">2</span> <span class="keyword">else</span> fibonacci(n<span class="number">-1</span>) + fibonacci(n<span class="number">-2</span>)</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="9-变态跳台阶-本题考点-逻辑分析"><a href="#9-变态跳台阶-本题考点-逻辑分析" class="headerlink" title="9.变态跳台阶 [^本题考点 逻辑分析]"></a>9.变态跳台阶 [^本题考点 <em>逻辑分析</em>]</h4><p>​    <strong>题目：一只青蛙一次可以跳上1级台阶，也可以跳上2级……它也可以跳上n级。求该青蛙跳上一个n级的台阶总共有多少种跳法。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">分析：</span></span><br><span class="line"><span class="string">1 (1)</span></span><br><span class="line"><span class="string">2 (11,2)</span></span><br><span class="line"><span class="string">3 (111,21,3,12)</span></span><br><span class="line"><span class="string">4 (1111,22,13,31,211,112,121,4)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    假设有n级台阶，青蛙从最后的第n级开始往前跳，可能性为：</span></span><br><span class="line"><span class="string">    f(n) = f(n-1) + f(n-2) + ... + f(2) + f(1)        ---&gt; ①</span></span><br><span class="line"><span class="string">    青蛙从最后的第n-1级开始往前跳，可能性为：</span></span><br><span class="line"><span class="string">    f(n-1) = f(n-2) + f(n-3) + ... + f(2) + f(1)    ---&gt; ②</span></span><br><span class="line"><span class="string">    将②式代入①式得：</span></span><br><span class="line"><span class="string">    f(n) = 2f(n-1)  n &gt; 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">f(1) = 1 n = 1</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># 简单版</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">jumpFloorII_1</span>(<span class="params">self, number</span>):</span></span><br><span class="line">        <span class="keyword">if</span> number == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> number == <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">        ret = <span class="number">1</span></span><br><span class="line">        a = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, number+<span class="number">1</span>):</span><br><span class="line">            ret = <span class="number">2</span>*ret</span><br><span class="line">            a = ret</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">       <span class="comment"># 简化版</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">jumpFloorII_2</span>(<span class="params">self, number</span>):</span></span><br><span class="line">        a, b = <span class="number">1</span>, <span class="number">2</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(number<span class="number">-1</span>):</span><br><span class="line">            a, b = b, b*<span class="number">2</span></span><br><span class="line">        <span class="keyword">return</span> a</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="10-矩形覆盖-本题考点-逻辑分析"><a href="#10-矩形覆盖-本题考点-逻辑分析" class="headerlink" title="10.矩形覆盖 [^本题考点 逻辑分析]"></a>10.矩形覆盖 [^本题考点 <em>逻辑分析</em>]</h4><p>​    *<em>题目：我们可以用2</em>1的小矩形横着或者竖着去覆盖更大的矩形。请问用n个2<em>1的小矩形无重叠地覆盖一个2</em>n的大矩形，总共有多少种方法？**</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">    也是斐波那契数列的变形</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rectCover</span>(<span class="params">self, number</span>):</span></span><br><span class="line">        <span class="comment"># write code here</span></span><br><span class="line">        <span class="keyword">if</span> number == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        a, b = <span class="number">1</span>, <span class="number">2</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(number<span class="number">-1</span>):</span><br><span class="line">            a, b = b, a+b</span><br><span class="line">        <span class="keyword">return</span> a</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="11-包含min函数的栈-本题考点-栈"><a href="#11-包含min函数的栈-本题考点-栈" class="headerlink" title="11.包含min函数的栈 [^本题考点 栈]"></a>11.包含min函数的栈 [^本题考点 <em>栈</em>]</h4><p>​    <strong>题目：定义栈的数据结构，请在该类型中实现一个能够得到栈中所含最小元素的min函数（时间复杂度应为O（1））。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">如果用固定空间做不出时间上的优化，就用空间换时间</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一种是self.stack和self.minValue的长度时刻保持一致</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.stack = []</span><br><span class="line">        self.minValue = []</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span>(<span class="params">self, node</span>):</span></span><br><span class="line">        self.stack.append(node)</span><br><span class="line">        <span class="keyword">if</span> self.minValue:</span><br><span class="line">            <span class="keyword">if</span> node &lt; self.minValue[<span class="number">-1</span>]:</span><br><span class="line">                self.minValue.append(node)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.minValue.append(self.minValue[<span class="number">-1</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.minValue.append(node)</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.stack:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        self.minValue.pop()</span><br><span class="line">        <span class="keyword">return</span> self.stack.pop()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">top</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.stack:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> self.stack[<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">min</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.minValue:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> self.minValue[<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.stack = []</span><br><span class="line">        self.minValue = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span>(<span class="params">self, node</span>):</span></span><br><span class="line">        self.stack.append(node)</span><br><span class="line">        <span class="keyword">if</span> self.minValue:</span><br><span class="line">            <span class="keyword">if</span> node &lt;= self.minValue[<span class="number">-1</span>]:</span><br><span class="line">                self.minValue.append(node)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.minValue.append(node)</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.stack:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> self.stack[<span class="number">-1</span>] == self.minValue[<span class="number">-1</span>]:</span><br><span class="line">            self.minValue.pop()</span><br><span class="line">        <span class="keyword">return</span> self.stack.pop()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">top</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.stack:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> self.stack[<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">min</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.minValue:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> self.minValue[<span class="number">-1</span>]</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="12-栈的压入、弹出序列-本题考点-栈"><a href="#12-栈的压入、弹出序列-本题考点-栈" class="headerlink" title="12.栈的压入、弹出序列 [^本题考点 栈]"></a>12.栈的压入、弹出序列 [^本题考点 <em>栈</em>]</h4><p>​    <strong>题目：输入两个整数序列，第一个序列表示栈的压入顺序，请判断第二个序列是否可能为该栈的弹出顺序。假设压入栈的所有数字均不相等。例如序列1,2,3,4,5是某栈的压入顺序，序列4,5,3,2,1是该压栈序列对应的一个弹出序列，但4,3,5,1,2就不可能是该压栈序列的弹出序列。（注意：这两个序列的长度是相等的）</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">IsPopOrder</span>(<span class="params">self, pushV, popV</span>):</span></span><br><span class="line">        <span class="comment"># 语法错误，返回错误</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> pushV <span class="keyword">or</span> len(pushV) != len(popV):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        stack = []</span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        1,2,3,4,5</span></span><br><span class="line"><span class="string">        4,5,3,2,1 √</span></span><br><span class="line"><span class="string">        4,3,5,1,2 ×  因为若是4为首位出栈的话，123必定还在栈中，无论5什么时候入栈和出栈，都不可能出现1在2前面的现象，所以错误</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> pushV:</span><br><span class="line">            stack.append(i)</span><br><span class="line">            <span class="keyword">while</span> len(stack) <span class="keyword">and</span> stack[<span class="number">-1</span>] == popV[<span class="number">0</span>]:</span><br><span class="line">                stack.pop()</span><br><span class="line">                popV.pop(<span class="number">0</span>)</span><br><span class="line">        <span class="comment"># 不能合理实现辅助列表和要判断的列表之间全部清空</span></span><br><span class="line">        <span class="keyword">if</span> len(stack):</span><br><span class="line">            <span class="comment"># 返回错误</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="comment"># 都满足，返回正确</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="13-数组中只出现一次的数字-本题考点-数组"><a href="#13-数组中只出现一次的数字-本题考点-数组" class="headerlink" title="13.数组中只出现一次的数字 [^本题考点 数组]"></a>13.数组中只出现一次的数字 [^本题考点 <em>数组</em>]</h4><p>​    <strong>一个整型数组里除了两个数字之外，其他的数字都出现了偶数次。请写程序找出这两个只出现一次的数字。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># 返回[a,b] 其中ab是出现一次的两个数字</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">FindNumsAppearOnce</span>(<span class="params">self, array</span>):</span></span><br><span class="line">        <span class="keyword">if</span> len(array) &lt; <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果两个数相同，那么这两个数的异或操作就相同</span></span><br><span class="line">        <span class="comment"># 两个数异或的结果初始值</span></span><br><span class="line">        twoNumXor = <span class="literal">None</span></span><br><span class="line">        <span class="comment"># 循环array，找到两个数异或的最终结果</span></span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> array:</span><br><span class="line">            <span class="keyword">if</span> twoNumXor == <span class="literal">None</span>:</span><br><span class="line">                twoNumXor = num</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                twoNumXor = twoNumXor ^ num</span><br><span class="line">        <span class="comment"># 找到这两个数是从第几位开始不一样的（找到第一个1）</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> twoNumXor % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            twoNumXor //= <span class="number">2</span></span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">        <span class="comment"># 设置mask为第一个1往后加count个0</span></span><br><span class="line">        mask = <span class="number">1</span> &lt;&lt; count</span><br><span class="line">        <span class="comment"># 第一个出现一次的数</span></span><br><span class="line">        firstNum = <span class="literal">None</span></span><br><span class="line">        <span class="comment"># 第二次出现一次的数</span></span><br><span class="line">        secondNum = <span class="literal">None</span></span><br><span class="line">        <span class="comment"># 再次循环array</span></span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> array:</span><br><span class="line">            <span class="comment"># 第一波数，其中会有第一个出现一次的数</span></span><br><span class="line">            <span class="keyword">if</span> mask &amp; num == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> firstNum == <span class="literal">None</span>:</span><br><span class="line">                    firstNum = num</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    firstNum = firstNum ^ num</span><br><span class="line">            <span class="comment"># 第二波数，其中会有第二个出现一次的数</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> secondNum == <span class="literal">None</span>:</span><br><span class="line">                    secondNum = num</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    secondNum = secondNum ^ num</span><br><span class="line">        <span class="comment"># 返回这两个只出现一次的数</span></span><br><span class="line">        <span class="keyword">return</span> firstNum, secondNum</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="14-链表中倒数第k个结点-本题考点-链表"><a href="#14-链表中倒数第k个结点-本题考点-链表" class="headerlink" title="14.链表中倒数第k个结点 [^本题考点 链表]"></a>14.链表中倒数第k个结点 [^本题考点 <em>链表</em>]</h4><p>​    <strong>题目：输入一个链表，输出该链表中倒数第k个结点。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">FindKthToTail</span>(<span class="params">self, head, k</span>):</span></span><br><span class="line">        <span class="comment"># 定义第一个游标</span></span><br><span class="line">        firstPoint = head</span><br><span class="line">        <span class="comment"># 定义第二个游标</span></span><br><span class="line">        secondPoint = head</span><br><span class="line">        <span class="comment"># 循环，让第一个游标增加k个单位的长度</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(k):</span><br><span class="line">            <span class="comment"># 在循环中若是游标为None，则达到临界条件，</span></span><br><span class="line">            <span class="comment"># 说明k比该链表的长度还要长，即返回None</span></span><br><span class="line">            <span class="keyword">if</span> firstPoint == <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            firstPoint = firstPoint.next</span><br><span class="line">        <span class="comment"># 当第一个节点不是None，就一直循环，让两个节点同时往后移动，当第一个节点移动到最后为None的时候，第二个节点即为我们要返回的结点</span></span><br><span class="line">        <span class="keyword">while</span> firstPoint != <span class="literal">None</span>:</span><br><span class="line">            firstPoint = firstPoint.next</span><br><span class="line">            secondPoint = secondPoint.next</span><br><span class="line">        <span class="comment"># 返回最终倒数第K个节点</span></span><br><span class="line">        <span class="keyword">return</span> secondPoint</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="15-反转链表-本题考点-链表"><a href="#15-反转链表-本题考点-链表" class="headerlink" title="15.反转链表 [^本题考点 链表]"></a>15.反转链表 [^本题考点 <em>链表</em>]</h4><p>​    <strong>题目：输入一个链表，反转链表后，输出新链表的表头。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ReverseList</span>(<span class="params">self, pHead</span>):</span></span><br><span class="line">        <span class="comment"># 如果旧链表为空或者没有旧链表长度为1，就直接返回，无需反转</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> pHead <span class="keyword">or</span> <span class="keyword">not</span> pHead.next:</span><br><span class="line">            <span class="keyword">return</span> pHead</span><br><span class="line">        newHead = <span class="literal">None</span></span><br><span class="line">        <span class="comment"># 只要旧链表不为空，就一直循环</span></span><br><span class="line">        <span class="keyword">while</span> pHead:</span><br><span class="line">            <span class="comment"># 在循环过程中，让旧链表的表头的下一个结点等于新表头，</span></span><br><span class="line">            <span class="comment"># 新表头等于旧表头，旧表头等于旧表头的下一个结点，依次循环</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 容易搞清的写法</span></span><br><span class="line">            <span class="comment"># temp = pHead.next</span></span><br><span class="line">            <span class="comment"># pHead.next = newHead</span></span><br><span class="line">            <span class="comment"># newHead = pHead</span></span><br><span class="line">            <span class="comment"># pHead = temp</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 简单写法</span></span><br><span class="line">            pHead.next, newHead, pHead = newHead, pHead, pHead.next</span><br><span class="line">        <span class="comment"># 最终就达到了翻转链表的效果，返回newHead即为新链表的表头</span></span><br><span class="line">        <span class="keyword">return</span> newHead</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="16-合并两个排序的链表-本题考点-链表"><a href="#16-合并两个排序的链表-本题考点-链表" class="headerlink" title="16.合并两个排序的链表 [^本题考点 链表]"></a>16.合并两个排序的链表 [^本题考点 <em>链表</em>]</h4><p>​    <strong>题目：输入两个单调递增的链表，输出两个链表合成后的链表，当然我们需要合成后的链表满足单调不减规则。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># 返回合并后列表</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Merge</span>(<span class="params">self, pHead1, pHead2</span>):</span></span><br><span class="line">        <span class="comment"># 若pHead1为空，直接输出pHead2</span></span><br><span class="line">        <span class="keyword">if</span> pHead1 == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> pHead2</span><br><span class="line">        <span class="comment"># 若pHead2为空，直接输出pHead1</span></span><br><span class="line">        <span class="keyword">if</span> pHead2 == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> pHead1</span><br><span class="line">        <span class="comment"># 新链表头（第一个指针）选取两个值小的</span></span><br><span class="line">        newHead = pHead1 <span class="keyword">if</span> pHead1.val &lt; pHead2.val <span class="keyword">else</span> pHead2</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 再定两个指针，用于后续循环中判断大小</span></span><br><span class="line">        pTmp1 = pHead1</span><br><span class="line">        pTmp2 = pHead2</span><br><span class="line">        <span class="comment"># 如果新链表头是pHead1，就将指针pTmp1往后移动</span></span><br><span class="line">        <span class="keyword">if</span> newHead == pHead1:</span><br><span class="line">            pTmp1 = pTmp1.next</span><br><span class="line">        <span class="comment"># 如果新链表头是pHead2，就将指针pTmp2往后移动</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pTmp2 = pTmp2.next</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 第四个指针为两个指针比较完之后的值，不断往后延续</span></span><br><span class="line">        previous_Pointer = newHead</span><br><span class="line">        <span class="comment"># 当两个指针都不为空的时候循环</span></span><br><span class="line">        <span class="keyword">while</span> pTmp1 <span class="keyword">and</span> pTmp2:</span><br><span class="line">            <span class="comment"># 如果pTmp1的值小于pTmp2的值，就将第四个指针指向pTmp1，且将地址个指针的值也更新为pTmp1，方便下次接着延续</span></span><br><span class="line">            <span class="keyword">if</span> pTmp1.val &lt; pTmp2.val:</span><br><span class="line">                previous_Pointer.next = pTmp1</span><br><span class="line">                previous_Pointer = pTmp1</span><br><span class="line">                pTmp1 = pTmp1.next</span><br><span class="line">            <span class="comment"># 反之亦然</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                previous_Pointer.next = pTmp2</span><br><span class="line">                previous_Pointer = pTmp2</span><br><span class="line">                pTmp2 = pTmp2.next</span><br><span class="line">        <span class="comment"># 循环结束后，若pTmp1为空，则说明pTmp2有剩余，name就将pTmp2剩余的接到指针previous_Pointer之后即可</span></span><br><span class="line">        <span class="keyword">if</span> pTmp1 == <span class="literal">None</span>:</span><br><span class="line">            previous_Pointer.next = pTmp2</span><br><span class="line">        <span class="comment"># 反之亦然</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            previous_Pointer.next = pTmp1</span><br><span class="line">        <span class="comment"># 最终返回拼接好的第一个指针newHead</span></span><br><span class="line">        <span class="keyword">return</span> newHead</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="17-两个链表的第一个公共结点-本题考点-链表"><a href="#17-两个链表的第一个公共结点-本题考点-链表" class="headerlink" title="17.两个链表的第一个公共结点 [^本题考点 链表]"></a>17.两个链表的第一个公共结点 [^本题考点 <em>链表</em>]</h4><p>​    <strong>题目：输入两个链表，找出它们的第一个公共结点。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">FindFirstCommonNode</span>(<span class="params">self, pHead1, pHead2</span>):</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 第一个参数给比较短的那个链表</span></span><br><span class="line">        <span class="comment"># 第二个参数是比较长的那个链表</span></span><br><span class="line">        <span class="comment"># 第三个参数是比较短的那个链表头</span></span><br><span class="line">        <span class="comment"># 第四个参数是比较长的那个链表头</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">find_equal</span>(<span class="params">shortPointer, longPointer, shortHead, longHead</span>):</span></span><br><span class="line">            k = <span class="number">0</span></span><br><span class="line">            <span class="comment"># 寻找出链表长度之间的差值</span></span><br><span class="line">            <span class="keyword">while</span> longPointer:</span><br><span class="line">                longPointer = longPointer.next</span><br><span class="line">                k += <span class="number">1</span></span><br><span class="line">            <span class="comment"># 先让长的那个走K步</span></span><br><span class="line">            shortPointer = shortHead</span><br><span class="line">            longPointer = longHead</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(k):</span><br><span class="line">                longPointer = longPointer.next</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> shortPointer != longPointer:</span><br><span class="line">                shortPointer = shortPointer.next</span><br><span class="line">                longPointer = longPointer.next</span><br><span class="line">            <span class="keyword">return</span> shortPointer</span><br><span class="line"></span><br><span class="line">        pTmp1 = pHead1</span><br><span class="line">        pTmp2 = pHead2</span><br><span class="line">        <span class="keyword">while</span> pTmp1 <span class="keyword">and</span> pTmp2:</span><br><span class="line">            <span class="comment"># 当两个链表一样长的时候，直接返回</span></span><br><span class="line">            <span class="keyword">if</span> pTmp1 == pTmp2:</span><br><span class="line">                <span class="keyword">return</span> pTmp1</span><br><span class="line">            pTmp1 = pTmp1.next</span><br><span class="line">            pTmp2 = pTmp2.next</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pTmp1:</span><br><span class="line">            <span class="string">'''</span></span><br><span class="line"><span class="string">            k = 0</span></span><br><span class="line"><span class="string">            # 寻找出链表长度之间的差值</span></span><br><span class="line"><span class="string">            while pTmp1:</span></span><br><span class="line"><span class="string">                pTmp1 = pTmp1.next</span></span><br><span class="line"><span class="string">                k += 1</span></span><br><span class="line"><span class="string">            # 先让长的那个走K步</span></span><br><span class="line"><span class="string">            pTmp1 = pHead1</span></span><br><span class="line"><span class="string">            pTmp2 = pHead2</span></span><br><span class="line"><span class="string">            for i in range(k):</span></span><br><span class="line"><span class="string">                pTmp1 = pTmp1.next</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            while pTmp1 != pTmp2:</span></span><br><span class="line"><span class="string">                pTmp1 = pTmp1.next</span></span><br><span class="line"><span class="string">                pTmp2 = pTmp2.next</span></span><br><span class="line"><span class="string">            return pTmp1</span></span><br><span class="line"><span class="string">            '''</span></span><br><span class="line">            <span class="keyword">return</span> find_equal(pTmp2, pTmp1, pHead1, pHead2)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pTmp2:</span><br><span class="line">            <span class="string">'''</span></span><br><span class="line"><span class="string">            k = 0</span></span><br><span class="line"><span class="string">            # 寻找出链表长度之间的差值</span></span><br><span class="line"><span class="string">            while pTmp2:</span></span><br><span class="line"><span class="string">                pTmp2 = pTmp2.next</span></span><br><span class="line"><span class="string">                k += 1</span></span><br><span class="line"><span class="string">            # 先让长的那个走K步</span></span><br><span class="line"><span class="string">            pTmp1 = pHead1</span></span><br><span class="line"><span class="string">            pTmp2 = pHead2</span></span><br><span class="line"><span class="string">            for i in range(k):</span></span><br><span class="line"><span class="string">                pTmp2 = pTmp2.next</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            while pTmp1 != pTmp2:</span></span><br><span class="line"><span class="string">                pTmp1 = pTmp1.next</span></span><br><span class="line"><span class="string">                pTmp2 = pTmp2.next</span></span><br><span class="line"><span class="string">            return pTmp1</span></span><br><span class="line"><span class="string">            '''</span></span><br><span class="line">            <span class="keyword">return</span> find_equal(pTmp1, pTmp2, pHead1, pHead2)</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="18-孩子们的游戏-本题考点-模拟"><a href="#18-孩子们的游戏-本题考点-模拟" class="headerlink" title="18.孩子们的游戏 [^本题考点 模拟]"></a>18.孩子们的游戏 [^本题考点 <em>模拟</em>]</h4><p>​    <strong>题目：每年六一儿童节,牛客都会准备一些小礼物去看望孤儿院的小朋友,今年亦是如此。HF作为牛客的资深元老,自然也准备了一些小游戏。其中,有个游戏是这样的:首先,让小朋友们围成一个大圈。然后,他随机指定一个数m,让编号为0的小朋友开始报数。每次喊到m-1的那个小朋友要出列唱首歌,然后可以在礼品箱中任意的挑选礼物,并且不再回到圈中,从他的下一个小朋友开始,继续0…m-1报数….这样下去….直到剩下最后一个小朋友,可以不用表演,并且拿到牛客名贵的“名侦探柯南”典藏版(名额有限哦!!^_^)。请你试着想下,哪个小朋友会得到这份礼品呢？(注：小朋友的编号是从0到n-1)</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">LastRemaining_Solution</span>(<span class="params">self, n, m</span>):</span></span><br><span class="line">        <span class="comment"># 通过推倒公式可得 f(n) = (f(n-1) + m) + n</span></span><br><span class="line">        <span class="keyword">if</span> n &lt; <span class="number">1</span> <span class="keyword">or</span> m &lt; <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        value = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">2</span>, n+<span class="number">1</span>):</span><br><span class="line">            currentValue = (value + m) % index</span><br><span class="line">            value = currentValue</span><br><span class="line">        <span class="keyword">return</span> value</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="19-链表中环的入口结点-本题考点-链表"><a href="#19-链表中环的入口结点-本题考点-链表" class="headerlink" title="19.链表中环的入口结点 [^本题考点 链表]"></a>19.链表中环的入口结点 [^本题考点 <em>链表</em>]</h4><p>​    <strong>题目：给一个链表，若其中包含环，请找出该链表的环的入口结点，否则，输出null。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">EntryNodeOfLoop</span>(<span class="params">self, pHead</span>):</span></span><br><span class="line">        <span class="comment"># 需要定义两个指针，其中一个条两部，一个跳一步</span></span><br><span class="line">        <span class="comment"># 循环跳</span></span><br><span class="line">        <span class="comment"># 要么是快的指针为空（没有环），要么是快慢终又一次相等（有环）</span></span><br><span class="line">        <span class="keyword">if</span> pHead == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        fastPointer = pHead</span><br><span class="line">        slowPointer = pHead</span><br><span class="line">        <span class="keyword">while</span> fastPointer <span class="keyword">and</span> fastPointer.next:</span><br><span class="line">            fastPointer = fastPointer.next.next</span><br><span class="line">            slowPointer = slowPointer.next</span><br><span class="line">            <span class="keyword">if</span> fastPointer == slowPointer:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> fastPointer == <span class="literal">None</span> <span class="keyword">or</span> fastPointer.next == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果slow走了l的长度，那么fast就走了2l的长度</span></span><br><span class="line">        <span class="comment"># 假设从开始到入口点的长度为s，slow在环里面走的长度是d</span></span><br><span class="line">        <span class="comment"># 那么 l = s + d</span></span><br><span class="line">        <span class="comment"># 假设 slow没走的长度是m，fast走的长度是多少</span></span><br><span class="line">        <span class="comment"># fast走的长度就是 n*(m+d) + d + s = 2l</span></span><br><span class="line">        <span class="comment"># 代入 n*(m+d) + d + s = (m+d) * 2</span></span><br><span class="line">        <span class="comment"># n(m+d) = s+d</span></span><br><span class="line">        <span class="comment"># s = nm + (n-1)d</span></span><br><span class="line">        <span class="comment"># s = m + (n-1)(m+d)</span></span><br><span class="line"></span><br><span class="line">        fastPointer = pHead</span><br><span class="line">        <span class="keyword">while</span> fastPointer != slowPointer:</span><br><span class="line">            fastPointer = fastPointer.next</span><br><span class="line">            slowPointer = slowPointer.next</span><br><span class="line">        <span class="keyword">return</span> fastPointer</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="20-二进制中1的个数-本题考点-位运算"><a href="#20-二进制中1的个数-本题考点-位运算" class="headerlink" title="20.二进制中1的个数 [^本题考点 位运算]"></a>20.二进制中1的个数 [^本题考点 <em>位运算</em>]</h4><p>​    <strong>题目：输入一个整数，输出该数二进制表示中1的个数。其中负数用补码表示。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">NumberOf1</span>(<span class="params">self, n</span>):</span></span><br><span class="line">        <span class="comment"># 补码：正数不变，负数是它的整数的反码+1</span></span><br><span class="line"></span><br><span class="line">        n = <span class="number">0xFFFFFFFF</span> &amp; n</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 第一种</span></span><br><span class="line">        <span class="comment"># count = 0</span></span><br><span class="line">        <span class="comment"># for i in str(bin(n)):</span></span><br><span class="line">        <span class="comment">#     if i == '1':</span></span><br><span class="line">        <span class="comment">#         count +=1</span></span><br><span class="line">        <span class="comment"># return count</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 第二种</span></span><br><span class="line">        <span class="comment"># count = 0</span></span><br><span class="line">        <span class="comment"># for i in range(32):</span></span><br><span class="line">        <span class="comment">#     mask = 1 &lt;&lt; i</span></span><br><span class="line">        <span class="comment">#     if n &amp; mask != 0:</span></span><br><span class="line">        <span class="comment">#         count += 1</span></span><br><span class="line">        <span class="comment"># return count</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 第三种</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> n:</span><br><span class="line">            n = n &amp; (n<span class="number">-1</span>)</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            n = <span class="number">0xFFFFFFFF</span> &amp; n</span><br><span class="line">        <span class="keyword">return</span> count</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="21-不用加减乘除做加法-本题考点-发散思维能力"><a href="#21-不用加减乘除做加法-本题考点-发散思维能力" class="headerlink" title="21.不用加减乘除做加法 [^本题考点 发散思维能力]"></a>21.不用加减乘除做加法 [^本题考点 <em>发散思维能力</em>]</h4><p>​    *<em>写一个函数，求两个整数之和，要求在函数体内不得使用+、-、</em>、/四则运算符号。**</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Add</span>(<span class="params">self, num1, num2</span>):</span></span><br><span class="line">        <span class="comment"># 两数进行异或操作</span></span><br><span class="line">        xorNum = num1 ^ num2</span><br><span class="line">        <span class="comment"># 两数进行与操作</span></span><br><span class="line">        andNum = (num1 &amp; num2) &lt;&lt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># 当两数的与不为0就一直循环</span></span><br><span class="line">        <span class="keyword">while</span> andNum:</span><br><span class="line">            <span class="comment"># 继续进行 异或操作数和与操作数的异或操作</span></span><br><span class="line">            tmp1 = xorNum ^ andNum</span><br><span class="line">            <span class="comment"># 继续进行 异或操作数和与操作数的与操作</span></span><br><span class="line">            tmp2 = (xorNum &amp; andNum) &lt;&lt; <span class="number">1</span></span><br><span class="line">            <span class="comment"># 限制tmp1为32位</span></span><br><span class="line">            tmp1 = tmp1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">            <span class="comment"># 将tmp1重新赋值为xorNum</span></span><br><span class="line">            xorNum = tmp1</span><br><span class="line">            <span class="comment"># 将tmp2重新赋值为andNum</span></span><br><span class="line">            andNum = tmp2</span><br><span class="line">        <span class="comment"># 若是整数就返回xorNum，若是负数就得先限制位数再转为负数</span></span><br><span class="line">        <span class="keyword">return</span> xorNum <span class="keyword">if</span> xorNum &lt;= <span class="number">0x7FFFFFFF</span> <span class="keyword">else</span> ~(xorNum ^ <span class="number">0xFFFFFFFF</span>)</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="22-数组中出现次数超过一半的数字-本题考点-数组"><a href="#22-数组中出现次数超过一半的数字-本题考点-数组" class="headerlink" title="22.数组中出现次数超过一半的数字 [^本题考点 数组]"></a>22.数组中出现次数超过一半的数字 [^本题考点 <em>数组</em>]</h4><p>​    <strong>题目：数组中有一个数字出现的次数超过数组长度的一半，请找出这个数字。例如输入一个长度为9的数组{1,2,3,2,2,2,5,4,2}。由于数字2在数组中出现了5次，超过数组长度的一半，因此输出2。如果不存在则输出0。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">MoreThanHalfNum_Solution</span>(<span class="params">self, numbers</span>):</span></span><br><span class="line">        <span class="comment"># 时间复杂度O(n), 空间复杂度O(n)</span></span><br><span class="line">        <span class="comment"># numCount = {}</span></span><br><span class="line">        <span class="comment"># numLen = len(numbers)</span></span><br><span class="line">        <span class="comment"># for num in numbers:</span></span><br><span class="line">        <span class="comment">#     if num in numCount:</span></span><br><span class="line">        <span class="comment">#         numCount[num] += 1</span></span><br><span class="line">        <span class="comment">#     else:</span></span><br><span class="line">        <span class="comment">#         numCount[num] = 1</span></span><br><span class="line">        <span class="comment">#     if numCount[num] &gt; (numLen &gt;&gt; 1):</span></span><br><span class="line">        <span class="comment">#         return num</span></span><br><span class="line">        <span class="comment"># return 0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 想要空间复杂度为O(1)，时间复杂度O(n)</span></span><br><span class="line">        <span class="comment"># 思路：遇到不相同的数据就相互抵消掉，最终剩下的数字就可能是大于一半的数字</span></span><br><span class="line">        numLen = len(numbers)</span><br><span class="line">        last = <span class="number">0</span></span><br><span class="line">        lastCount = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> numbers:</span><br><span class="line">            <span class="keyword">if</span> lastCount == <span class="number">0</span>:</span><br><span class="line">                last = num</span><br><span class="line">                lastCount = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> num == last:</span><br><span class="line">                    lastCount += <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    lastCount -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> lastCount == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 这种情况是last可能是大于一半的数字</span></span><br><span class="line">            lastCount = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> num <span class="keyword">in</span> numbers:</span><br><span class="line">                <span class="keyword">if</span> num == last:</span><br><span class="line">                    lastCount += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> lastCount &gt; (numLen &gt;&gt; <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">return</span> last</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="23-整数中1出现的次数（从1到n整数中1出现的次数）-本题考点-时间效率"><a href="#23-整数中1出现的次数（从1到n整数中1出现的次数）-本题考点-时间效率" class="headerlink" title="23.整数中1出现的次数（从1到n整数中1出现的次数） [^本题考点 时间效率]"></a>23.整数中1出现的次数（从1到n整数中1出现的次数） [^本题考点 <em>时间效率</em>]</h4><p>​    <strong>求出1<del>13的整数中1出现的次数,并算出100</del>1300的整数中1出现的次数？为此他特别数了一下1~13中包含1的数字有1、10、11、12、13因此共出现6次,但是对于后面问题他就没辙了。ACMer希望你们帮帮他,并把问题更加普遍化,可以很快的求出任意非负整数区间中1出现的次数（从1 到 n 中1出现的次数）。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">NumberOf1Between1AndN_Solution</span>(<span class="params">self, n</span>):</span></span><br><span class="line">        <span class="comment"># 第一种，不考虑时间复杂度</span></span><br><span class="line">        <span class="comment"># count = 0</span></span><br><span class="line">        <span class="comment"># for i in range(1, n + 1):</span></span><br><span class="line">        <span class="comment">#     for j in str(i):</span></span><br><span class="line">        <span class="comment">#         if j == '1':</span></span><br><span class="line">        <span class="comment">#             count += 1</span></span><br><span class="line">        <span class="comment"># return count</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 第二种，简化事件复杂度</span></span><br><span class="line">        <span class="comment"># 起始参数的设定，从第一个开始，之后每次往右移动1个，即*10</span></span><br><span class="line">        precise = <span class="number">1</span></span><br><span class="line">        <span class="comment"># 参数位左侧的可能数量</span></span><br><span class="line">        highValue = <span class="number">1</span></span><br><span class="line">        <span class="comment"># 位数，用作乘方运算</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="comment"># 最后的要返回的总数量</span></span><br><span class="line">        sumNum = <span class="number">0</span></span><br><span class="line">        <span class="comment"># 当参数位左侧不为0时循环</span></span><br><span class="line">        <span class="keyword">while</span> highValue != <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># 取出高位</span></span><br><span class="line">            highValue = n // (precise * <span class="number">10</span>)</span><br><span class="line">            <span class="comment"># 取出参数位（每循环一次变一下）</span></span><br><span class="line">            midValue = (n // precise) % <span class="number">10</span></span><br><span class="line">            <span class="comment"># 取出低位</span></span><br><span class="line">            lowValue = n % precise</span><br><span class="line">            <span class="comment"># 每次都*10</span></span><br><span class="line">            precise = precise * <span class="number">10</span></span><br><span class="line">            <span class="comment"># 参数位分三种情况</span></span><br><span class="line">            <span class="comment"># 第一种，参数位等于0，若是该位想为1的话，只能进1，向左侧的可能性借1，右侧为10^count种可能性</span></span><br><span class="line">            <span class="keyword">if</span> midValue == <span class="number">0</span>:</span><br><span class="line">                num = (highValue <span class="number">-1</span> +<span class="number">1</span>) * pow(<span class="number">10</span>, count)</span><br><span class="line">            <span class="comment"># 第二种，参数位大于1，就不用向左侧去借位，右侧为10^count种可能性</span></span><br><span class="line">            <span class="keyword">elif</span> midValue &gt; <span class="number">1</span>:</span><br><span class="line">                num = (highValue + <span class="number">1</span>) * pow(<span class="number">10</span>, count)</span><br><span class="line">            <span class="comment"># 第三种，参数位就是1，有lowValue + 1个是需要进位的，其余不需要进位</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                num = highValue * pow(<span class="number">10</span>, count) + lowValue + <span class="number">1</span></span><br><span class="line">            <span class="comment"># 每次循环都更新总数量的值</span></span><br><span class="line">            sumNum += num</span><br><span class="line">            <span class="comment"># 更新count</span></span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">        <span class="comment"># 返回结果</span></span><br><span class="line">        <span class="keyword">return</span> sumNum</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="24-丑数（从1到n整数中1出现的次数）-本题考点-时间空间效率的平衡"><a href="#24-丑数（从1到n整数中1出现的次数）-本题考点-时间空间效率的平衡" class="headerlink" title="24.丑数（从1到n整数中1出现的次数） [^本题考点 时间空间效率的平衡]"></a>24.丑数（从1到n整数中1出现的次数） [^本题考点 <em>时间空间效率的平衡</em>]</h4><p>​    <strong>题目：把只包含质因子2、3和5的数称作丑数（Ugly Number）。例如6、8都是丑数，但14不是，因为它包含质因子7。 习惯上我们把1当做是第一个丑数。求按从小到大的顺序的第N个丑数。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GetUglyNumber_Solution</span>(<span class="params">self, index</span>):</span></span><br><span class="line">        <span class="comment"># write code here</span></span><br><span class="line">        <span class="keyword">if</span> index &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="comment"># 2的指针</span></span><br><span class="line">        twoPointer = <span class="number">0</span></span><br><span class="line">        <span class="comment"># 3的指针</span></span><br><span class="line">        threePointer = <span class="number">0</span></span><br><span class="line">        <span class="comment"># 5的指针</span></span><br><span class="line">        fivePointer = <span class="number">0</span></span><br><span class="line">        <span class="comment"># 丑数列表</span></span><br><span class="line">        uglyList = [<span class="number">1</span>]</span><br><span class="line">        <span class="comment"># uglyList的计数</span></span><br><span class="line">        count = <span class="number">1</span></span><br><span class="line">        <span class="comment"># 当计数小于index，就一直循环</span></span><br><span class="line">        <span class="keyword">while</span> count &lt; index:</span><br><span class="line">            <span class="comment"># 找到三者中的最小值</span></span><br><span class="line">            minValue = min(uglyList[twoPointer] * <span class="number">2</span>,</span><br><span class="line">                           uglyList[threePointer] * <span class="number">3</span>,</span><br><span class="line">                           uglyList[fivePointer] * <span class="number">5</span>)</span><br><span class="line">            <span class="comment"># 添加进uglyList</span></span><br><span class="line">            uglyList.append(minValue)</span><br><span class="line">            <span class="comment"># 若是当前uglyList的最后一个值等于uglyList[twoPointer]*2，就将2的指针往后移动一个</span></span><br><span class="line">            <span class="keyword">if</span> uglyList[<span class="number">-1</span>] == uglyList[twoPointer] * <span class="number">2</span>:</span><br><span class="line">                twoPointer += <span class="number">1</span></span><br><span class="line">            <span class="comment"># 若是当前uglyList的最后一个值等于uglyList[twoPointer]*3，就将3的指针往后移动一个</span></span><br><span class="line">            <span class="keyword">if</span> uglyList[<span class="number">-1</span>] == uglyList[threePointer] * <span class="number">3</span>:</span><br><span class="line">                threePointer += <span class="number">1</span></span><br><span class="line">            <span class="comment"># 若是当前uglyList的最后一个值等于uglyList[twoPointer]*5，就将5的指针往后移动一个</span></span><br><span class="line">            <span class="keyword">if</span> uglyList[<span class="number">-1</span>] == uglyList[fivePointer] * <span class="number">5</span>:</span><br><span class="line">                fivePointer += <span class="number">1</span></span><br><span class="line">            <span class="comment"># count自增1</span></span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">        <span class="comment"># 最终返回丑数列表的最后一个值即为第index个丑数</span></span><br><span class="line">        <span class="keyword">return</span> uglyList[<span class="number">-1</span>]</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="25-调整数组顺序使奇数位于偶数前面-本题考点-数组"><a href="#25-调整数组顺序使奇数位于偶数前面-本题考点-数组" class="headerlink" title="25.调整数组顺序使奇数位于偶数前面 [^本题考点 数组]"></a>25.调整数组顺序使奇数位于偶数前面 [^本题考点 <em>数组</em>]</h4><p>​    <strong>题目：输入一个整数数组，实现一个函数来调整该数组中数字的顺序，使得所有的奇数位于数组的前半部分，所有的偶数位于数组的后半部分，并保证奇数和奇数，偶数和偶数之间的相对位置不变。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reOrderArray</span>(<span class="params">self, array</span>):</span></span><br><span class="line">        n = len(array)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(n-i<span class="number">-1</span>):</span><br><span class="line">                <span class="keyword">if</span> array[j] % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">and</span> array[j+<span class="number">1</span>] % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                    array[j], array[j+<span class="number">1</span>] = array[j+<span class="number">1</span>], array[j]</span><br><span class="line">        <span class="keyword">return</span> array</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="26-树的子结构-本题考点-树"><a href="#26-树的子结构-本题考点-树" class="headerlink" title="26.树的子结构 [^本题考点 树]"></a>26.树的子结构 [^本题考点 <em>树</em>]</h4><p>​    <strong>题目：输入两棵二叉树A，B，判断B是不是A的子结构。（ps：我们约定空树不是任意一个树的子结构）</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">HasSubtree</span>(<span class="params">self, pRoot1, pRoot2</span>):</span></span><br><span class="line">        <span class="comment"># 若两个结点有一个为空，不符合要求</span></span><br><span class="line">        <span class="keyword">if</span> pRoot2 == <span class="literal">None</span> <span class="keyword">or</span> pRoot1 == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">hasEqual</span>(<span class="params">pRoot1, pRoot2</span>):</span></span><br><span class="line">            <span class="comment"># 若是右侧为空，肯定符合要求</span></span><br><span class="line">            <span class="keyword">if</span> pRoot2 == <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="comment"># 如果左侧为空，肯定不合适</span></span><br><span class="line">            <span class="keyword">if</span> pRoot1 == <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">if</span> pRoot1.val == pRoot2.val:</span><br><span class="line">                <span class="comment"># 如果一个结点的左结点为空，左侧肯定符合要求</span></span><br><span class="line">                <span class="keyword">if</span> pRoot2.left == <span class="literal">None</span>:</span><br><span class="line">                    leftEqual = <span class="literal">True</span></span><br><span class="line">                <span class="comment"># 如果不是就继续递归判断</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    leftEqual = hasEqual(pRoot1.left, pRoot2.left)</span><br><span class="line">                <span class="comment"># 如果一个结点的右结点为空，右侧肯定符合要求</span></span><br><span class="line">                <span class="keyword">if</span> pRoot2.right == <span class="literal">None</span>:</span><br><span class="line">                    rightEqual = <span class="literal">True</span></span><br><span class="line">                <span class="comment"># 如果不是就继续递归判断</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    rightEqual = hasEqual(pRoot1.right, pRoot2.right)</span><br><span class="line">                <span class="comment"># 返回左右两侧的判断情况</span></span><br><span class="line">                <span class="keyword">return</span> leftEqual <span class="keyword">and</span> rightEqual</span><br><span class="line">            <span class="comment"># 都不符合就返回False</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果两个节点相等，就进行判断左右两个分支相不相等</span></span><br><span class="line">        <span class="keyword">if</span> pRoot1.val == pRoot2.val:</span><br><span class="line">            ret = hasEqual(pRoot1, pRoot2)</span><br><span class="line">            <span class="keyword">if</span> ret:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="comment">#判断左侧结点</span></span><br><span class="line">        ret = self.HasSubtree(pRoot1.left, pRoot2)</span><br><span class="line">        <span class="keyword">if</span> ret:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="comment"># 判断右侧结点</span></span><br><span class="line">        ret = self.HasSubtree(pRoot1.right, pRoot2)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></tbody></table></figure>



<hr>
<h4 id="27-二叉树的镜像-本题考点-树"><a href="#27-二叉树的镜像-本题考点-树" class="headerlink" title="27.二叉树的镜像 [^本题考点 树]"></a>27.二叉树的镜像 [^本题考点 <em>树</em>]</h4><p>​    <strong>题目：操作给定的二叉树，将其变换为源二叉树的镜像。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># 返回镜像树的根节点</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Mirror</span>(<span class="params">self, root</span>):</span></span><br><span class="line">        <span class="keyword">if</span> root == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># 处理根节点</span></span><br><span class="line">        root.left, root.right = root.right, root.left</span><br><span class="line">        <span class="comment"># 处理左子树</span></span><br><span class="line">        self.Mirror(root.left)</span><br><span class="line">        <span class="comment"># 处理右子树</span></span><br><span class="line">        self.Mirror(root.right)</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="28-从上往下打印二叉树-本题考点-树"><a href="#28-从上往下打印二叉树-本题考点-树" class="headerlink" title="28.从上往下打印二叉树 [^本题考点 树]"></a>28.从上往下打印二叉树 [^本题考点 <em>树</em>]</h4><p>​    <strong>题目：从上往下打印出二叉树的每个节点，同层节点从左至右打印。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">PrintFromTopToBottom</span>(<span class="params">self, root</span>):</span></span><br><span class="line">        <span class="comment"># 如果根结点为空，直接返回空列表</span></span><br><span class="line">        <span class="keyword">if</span> root == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        support = [root]</span><br><span class="line">        ret = []</span><br><span class="line">        <span class="comment"># 当support不为空时一直循环</span></span><br><span class="line">        <span class="keyword">while</span> support:</span><br><span class="line">            <span class="comment"># 取出support中的第一个结点</span></span><br><span class="line">            tmpNode = support[<span class="number">0</span>]</span><br><span class="line">            <span class="comment"># 将此结点的值添加到ret</span></span><br><span class="line">            ret.append(tmpNode.val)</span><br><span class="line">            <span class="comment"># 如果取出的当前结点有左子结点就将其添加到support</span></span><br><span class="line">            <span class="keyword">if</span> tmpNode.left:</span><br><span class="line">                support.append(tmpNode.left)</span><br><span class="line">            <span class="comment"># 如果取出的当前结点有右子结点就将其添加到support</span></span><br><span class="line">            <span class="keyword">if</span> tmpNode.right:</span><br><span class="line">                support.append(tmpNode.right)</span><br><span class="line">            <span class="comment"># 删除掉support中的第一个用过的值</span></span><br><span class="line">            support.pop(<span class="number">0</span>)</span><br><span class="line">        <span class="comment"># 返回最后的结果</span></span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="29-二叉搜索树的后序遍历序列-本题考点-举例让抽象具体化"><a href="#29-二叉搜索树的后序遍历序列-本题考点-举例让抽象具体化" class="headerlink" title="29.二叉搜索树的后序遍历序列 [^本题考点 举例让抽象具体化]"></a>29.二叉搜索树的后序遍历序列 [^本题考点 <em>举例让抽象具体化</em>]</h4><p>​    <strong>题目：输入一个整数数组，判断该数组是不是某二叉搜索树的后序遍历的结果。如果是则输出Yes,否则输出No。假设输入的数组的任意两个数字都互不相同。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">VerifySquenceOfBST</span>(<span class="params">self, sequence</span>):</span></span><br><span class="line">        <span class="keyword">if</span> sequence == []:</span><br><span class="line">            <span class="comment"># 此处按照二叉搜索树的定义应为True，但是为了跑通程序写了False</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="comment"># 找到根结点</span></span><br><span class="line">        rootNum = sequence.pop()</span><br><span class="line">        <span class="comment"># 删除掉根结点</span></span><br><span class="line">        <span class="comment"># del sequence[-1]</span></span><br><span class="line">        <span class="comment"># 定义第一个大于根结点值索引位置</span></span><br><span class="line">        index = <span class="literal">None</span></span><br><span class="line">        <span class="comment"># 循环sequence</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(sequence)):</span><br><span class="line">            <span class="comment"># 找到第一个大于根结点值索引位置</span></span><br><span class="line">            <span class="keyword">if</span> index == <span class="literal">None</span> <span class="keyword">and</span> rootNum &lt; sequence[i]:</span><br><span class="line">                index = i</span><br><span class="line">            <span class="comment"># 如果找到之后还有比根结点的值小的值，就返回错误</span></span><br><span class="line">            <span class="keyword">if</span> sequence[i] &lt; rootNum <span class="keyword">and</span> index != <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> sequence[:index] == []:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> sequence[index: ] == []:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="comment"># 继续查找左子树</span></span><br><span class="line">        leftRet = self.VerifySquenceOfBST(sequence[ :index])</span><br><span class="line">        <span class="comment"># 继续查找右子树</span></span><br><span class="line">        rightRet = self.VerifySquenceOfBST(sequence[index: ])</span><br><span class="line">        <span class="comment"># 返回左与右</span></span><br><span class="line">        <span class="keyword">return</span> leftRet <span class="keyword">and</span> rightRet</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="30-二叉树中和为某一值的路径-本题考点-举例让抽象具体化"><a href="#30-二叉树中和为某一值的路径-本题考点-举例让抽象具体化" class="headerlink" title="30.二叉树中和为某一值的路径 [^本题考点 举例让抽象具体化]"></a>30.二叉树中和为某一值的路径 [^本题考点 <em>举例让抽象具体化</em>]</h4><p>​    <strong>题目：输入一颗二叉树的跟节点和一个整数，打印出二叉树中结点值的和为输入整数的所有路径。路径定义为从树的根结点开始往下一直到叶结点所经过的结点形成一条路径。(注意: 在返回值的list中，数组长度大的数组靠前)</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># 返回二维列表，内部每个列表表示找到的路径</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">FindPath</span>(<span class="params">self, root, expectNumber</span>):</span></span><br><span class="line">        <span class="comment"># 若根结点为空，就返回空列表</span></span><br><span class="line">        <span class="keyword">if</span> root == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 定义最终返回列表</span></span><br><span class="line">        ret = []</span><br><span class="line">        <span class="comment"># 定义保存路径的二维列表</span></span><br><span class="line">        supportArrayList = [[root.val]]</span><br><span class="line">        <span class="comment"># 定义广度优先遍历的列表</span></span><br><span class="line">        support = [root]</span><br><span class="line">        <span class="comment"># 当support中有值时一直循环</span></span><br><span class="line">        <span class="keyword">while</span> support:</span><br><span class="line">            <span class="comment"># 取出support中的第一个值，结点</span></span><br><span class="line">            tmpNode = support[<span class="number">0</span>]</span><br><span class="line">            <span class="comment"># 取出supportArrayList中的第一个值，列表，存放路径</span></span><br><span class="line">            tmpArrayList = supportArrayList[<span class="number">0</span>]</span><br><span class="line">            <span class="comment"># 如果取出的节点为叶子叶节点，就判断tmpArrayList的和是否和目标值相等，若相等就将其列表（路径）添加到返回列表当中</span></span><br><span class="line">            <span class="keyword">if</span> tmpNode.left == <span class="literal">None</span> <span class="keyword">and</span> tmpNode.right == <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">if</span> sum(tmpArrayList) == expectNumber:</span><br><span class="line">                    ret.insert(<span class="number">0</span>, tmpArrayList)</span><br><span class="line">            <span class="comment"># 如果有左子结点，就执行下面</span></span><br><span class="line">            <span class="keyword">if</span> tmpNode.left:</span><br><span class="line">                <span class="comment"># 将左子结点添加到广度优先列表中</span></span><br><span class="line">                support.append(tmpNode.left)</span><br><span class="line">                <span class="comment"># 将tmpArrayList进行浅拷贝得到newTmpArrayList</span></span><br><span class="line">                newTmpArrayList = copy.copy(tmpArrayList)</span><br><span class="line">                <span class="comment"># 给newTmpArrayList添加左子结点的值</span></span><br><span class="line">                newTmpArrayList.append(tmpNode.left.val)</span><br><span class="line">                <span class="comment"># 将newTmpArrayList添加到supportArrayList</span></span><br><span class="line">                supportArrayList.append(newTmpArrayList)</span><br><span class="line">            <span class="comment"># 如果有右子结点，就执行下面</span></span><br><span class="line">            <span class="keyword">if</span> tmpNode.right:</span><br><span class="line">                <span class="comment"># 将右子结点添加到广度优先列表中</span></span><br><span class="line">                support.append(tmpNode.right)</span><br><span class="line">                <span class="comment"># 将tmpArrayList进行浅拷贝得到newTmpArrayList</span></span><br><span class="line">                newTmpArrayList = copy.copy(tmpArrayList)</span><br><span class="line">                <span class="comment"># 给newTmpArrayList添加左子结点的值</span></span><br><span class="line">                newTmpArrayList.append(tmpNode.right.val)</span><br><span class="line">                <span class="comment"># 将newTmpArrayList添加到supportArrayList</span></span><br><span class="line">                supportArrayList.append(newTmpArrayList)</span><br><span class="line">            <span class="comment"># 删除广度优先的列表的第一个值</span></span><br><span class="line">            support.pop(<span class="number">0</span>)</span><br><span class="line">            <span class="comment"># 删除保存路径的二维列表的第一个值</span></span><br><span class="line">            supportArrayList.pop(<span class="number">0</span>)</span><br><span class="line">        <span class="comment"># 返回最终结果</span></span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="31-二叉树与双向链表-本题考点-分解让复杂问题简单"><a href="#31-二叉树与双向链表-本题考点-分解让复杂问题简单" class="headerlink" title="31.二叉树与双向链表 [^本题考点 分解让复杂问题简单]"></a>31.二叉树与双向链表 [^本题考点 <em>分解让复杂问题简单</em>]</h4><p>​    <strong>题目：输入一棵二叉搜索树，将该二叉搜索树转换成一个排序的双向链表。要求不能创建任何新的结点，只能调整树中结点指针的指向。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        self.val = x</span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Convert</span>(<span class="params">self, pRootOfTree</span>):</span></span><br><span class="line">        <span class="comment"># 定义寻找最右结点的函数</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">find_right</span>(<span class="params">node</span>):</span></span><br><span class="line">            <span class="comment"># 如果结点右子结点不为空就循环</span></span><br><span class="line">            <span class="keyword">while</span> node.right:</span><br><span class="line">                <span class="comment"># 一直往右找</span></span><br><span class="line">                node = node.right</span><br><span class="line">            <span class="comment"># 返回最右侧的结点</span></span><br><span class="line">            <span class="keyword">return</span> node</span><br><span class="line">        <span class="comment"># 如果pRootOfTree为空，返回空</span></span><br><span class="line">        <span class="keyword">if</span> pRootOfTree == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># 递归寻找左子结点</span></span><br><span class="line">        leftNode = self.Convert(pRootOfTree.left)</span><br><span class="line">        <span class="comment"># 递归寻找右子结点</span></span><br><span class="line">        rightNode = self.Convert(pRootOfTree.right)</span><br><span class="line">        <span class="comment"># 要返回的结点为最左子结点</span></span><br><span class="line">        retNode = leftNode</span><br><span class="line">        <span class="comment"># 如果左结点存在，就找到它最右边的结点</span></span><br><span class="line">        <span class="keyword">if</span> leftNode:</span><br><span class="line">            leftNode = find_right(leftNode)</span><br><span class="line">        <span class="comment"># 如果没有左子结点,返回的结点就是pRootOfTree</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            retNode = pRootOfTree</span><br><span class="line">        <span class="comment"># pRootOfTree的左子结点链上leftNode</span></span><br><span class="line">        pRootOfTree.left = leftNode</span><br><span class="line">        <span class="comment"># pRootOfTree的右子结点链上右子结点</span></span><br><span class="line">        pRootOfTree.right = rightNode</span><br><span class="line">        <span class="comment"># 如果左子结点不为空</span></span><br><span class="line">        <span class="keyword">if</span> leftNode:</span><br><span class="line">            <span class="comment"># 此处为左子结点的最右侧链上pRootOfTree</span></span><br><span class="line">            leftNode.right = pRootOfTree</span><br><span class="line">        <span class="comment"># 如果右子结点不为空</span></span><br><span class="line">        <span class="keyword">if</span> rightNode:</span><br><span class="line">            <span class="comment"># 此处为右子结点的最左侧链上pRootOfTree</span></span><br><span class="line">            rightNode.left = pRootOfTree</span><br><span class="line">        <span class="comment"># 返回最左侧结点</span></span><br><span class="line">        <span class="keyword">return</span> retNode</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="32-最小的K个数-本题考点-时间效率"><a href="#32-最小的K个数-本题考点-时间效率" class="headerlink" title="32.最小的K个数 [^本题考点 时间效率]"></a>32.最小的K个数 [^本题考点 <em>时间效率</em>]</h4><p>​    <strong>输入n个整数，找出其中最小的K个数。例如输入4,5,1,6,2,7,3,8这8个数字，则最小的4个数字是1,2,3,4,。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GetLeastNumbers_Solution</span>(<span class="params">self, tinput, k</span>):</span></span><br><span class="line">        <span class="comment"># 第一种</span></span><br><span class="line">        <span class="comment"># if len(tinput) &lt; k:</span></span><br><span class="line">        <span class="comment">#     return []</span></span><br><span class="line">        <span class="comment"># ret = sorted(tinput)</span></span><br><span class="line">        <span class="comment"># return ret[:k]</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 第二种,使用最大堆</span></span><br><span class="line">        <span class="comment"># 创建或者是插入最大堆</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">createMaxHeap</span>(<span class="params">num</span>):</span></span><br><span class="line">            maxHeap.append(num)</span><br><span class="line">            currentIndex = len(maxHeap) - <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> currentIndex != <span class="number">0</span>:</span><br><span class="line">                parentIndex = (currentIndex - <span class="number">1</span>) &gt;&gt; <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> maxHeap[parentIndex] &lt; maxHeap[currentIndex]:</span><br><span class="line">                    maxHeap[parentIndex], maxHeap[currentIndex] = maxHeap[currentIndex], maxHeap[parentIndex]</span><br><span class="line">                    currentIndex = parentIndex</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 调整最大堆，头节点发生改变</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">adjustMaxHeap</span>(<span class="params">num</span>):</span></span><br><span class="line">            <span class="keyword">if</span> num &lt; maxHeap[<span class="number">0</span>]:</span><br><span class="line">                maxHeap[<span class="number">0</span>] = num</span><br><span class="line"></span><br><span class="line">            maxHeapLen = len(maxHeap)</span><br><span class="line">            index = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span> index &lt; maxHeapLen:</span><br><span class="line">                leftIndex = index * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">                rightIndex = index * <span class="number">2</span> + <span class="number">2</span></span><br><span class="line">                <span class="keyword">if</span> rightIndex &lt; maxHeapLen:</span><br><span class="line">                    <span class="keyword">if</span> maxHeap[rightIndex] &lt; maxHeap[leftIndex]:</span><br><span class="line">                        largerIndex = leftIndex</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        largerIndex = rightIndex</span><br><span class="line">                <span class="keyword">elif</span> leftIndex &lt; maxHeapLen:</span><br><span class="line">                    largerIndex = leftIndex</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> maxHeap[index] &lt; maxHeap[largerIndex]:</span><br><span class="line">                    maxHeap[index], maxHeap[largerIndex] = maxHeap[largerIndex], maxHeap[index]</span><br><span class="line">                index = largerIndex</span><br><span class="line"></span><br><span class="line">        maxHeap = []</span><br><span class="line">        tinputLen = len(tinput)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> tinputLen &lt; k <span class="keyword">or</span> k &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(tinputLen):</span><br><span class="line">            <span class="keyword">if</span> i &lt; k:</span><br><span class="line">                createMaxHeap(tinput[i])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                adjustMaxHeap(tinput[i])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sorted(maxHeap)</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="33-数据流中的中位数-本题考点-树"><a href="#33-数据流中的中位数-本题考点-树" class="headerlink" title="33.数据流中的中位数 [^本题考点 树]"></a>33.数据流中的中位数 [^本题考点 <em>树</em>]</h4><p>​    <strong>题目：如何得到一个数据流中的中位数？如果从数据流中读出奇数个数值，那么中位数就是所有数值排序之后位于中间的数值。如果从数据流中读出偶数个数值，那么中位数就是所有数值排序之后中间两个数的平均值。我们使用Insert()方法读取数据流，使用GetMedian()方法获取当前读取数据的中位数。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">如何得到一个数据流中的中位数？如果从数据流中读出奇数个数值，那么中位数就是所有数值排序之后位于中间的数值。如果从数据流中读出偶数个数值，那么中位数就是所有数值排序之后中间两个数的平均值。我们使用Insert()方法读取数据流，使用GetMedian()方法获取当前读取数据的中位数。</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 未封装版本</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.littleValueMaxHeap = []</span><br><span class="line">        self.bigValueMinHeap = []</span><br><span class="line">        self.maxHeapCount = <span class="number">0</span></span><br><span class="line">        self.minHeapCount = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">createMaxHeap</span>(<span class="params">self, num</span>):</span></span><br><span class="line">        self.littleValueMaxHeap.append(num)</span><br><span class="line">        tmpIndex = len(self.littleValueMaxHeap) - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> tmpIndex != <span class="number">0</span>:</span><br><span class="line">            parentIndex = (tmpIndex - <span class="number">1</span>) &gt;&gt; <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> self.littleValueMaxHeap[parentIndex] &lt; self.littleValueMaxHeap[tmpIndex]:</span><br><span class="line">                self.littleValueMaxHeap[parentIndex], self.littleValueMaxHeap[tmpIndex] = self.littleValueMaxHeap[tmpIndex], self.littleValueMaxHeap[parentIndex]</span><br><span class="line">                tmpIndex = parentIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">adjustMaxHeap</span>(<span class="params">self, num</span>):</span></span><br><span class="line">        <span class="keyword">if</span> num &lt; self.littleValueMaxHeap[<span class="number">0</span>]:</span><br><span class="line">            self.littleValueMaxHeap[<span class="number">0</span>] = num</span><br><span class="line">        maxHeapLen = len(self.littleValueMaxHeap)</span><br><span class="line">        tmpIndex = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> tmpIndex &lt; maxHeapLen:</span><br><span class="line">            leftIndex = tmpIndex * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">            rightIndex = tmpIndex *<span class="number">2</span> + <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> rightIndex &lt; maxHeapLen:</span><br><span class="line">                largerIndex = rightIndex <span class="keyword">if</span> self.littleValueMaxHeap[leftIndex] &lt; self.littleValueMaxHeap[rightIndex] <span class="keyword">else</span> leftIndex</span><br><span class="line">            <span class="keyword">elif</span> leftIndex &lt; maxHeapLen:</span><br><span class="line">                largerIndex = leftIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> self.littleValueMaxHeap[tmpIndex] &lt; self.littleValueMaxHeap[largerIndex]:</span><br><span class="line">                self.littleValueMaxHeap[tmpIndex], self.littleValueMaxHeap[largerIndex] = self.littleValueMaxHeap[largerIndex], self.littleValueMaxHeap[tmpIndex]</span><br><span class="line">                tmpIndex = largerIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">createMinHeap</span>(<span class="params">self, num</span>):</span></span><br><span class="line">        self.bigValueMinHeap.append(num)</span><br><span class="line">        tmpIndex = len(self.bigValueMinHeap) - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> tmpIndex != <span class="number">0</span>:</span><br><span class="line">            parentIndex = (tmpIndex - <span class="number">1</span>) &gt;&gt; <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> self.bigValueMinHeap[tmpIndex] &lt; self.bigValueMinHeap[parentIndex]:</span><br><span class="line">                self.bigValueMinHeap[parentIndex], self.bigValueMinHeap[tmpIndex] = self.bigValueMinHeap[tmpIndex], self.bigValueMinHeap[parentIndex]</span><br><span class="line">                tmpIndex = parentIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">adjustMinHeap</span>(<span class="params">self, num</span>):</span></span><br><span class="line">        <span class="keyword">if</span> num &lt; self.bigValueMinHeap[<span class="number">0</span>]:</span><br><span class="line">            self.littleValueMaxHeap[<span class="number">0</span>] = num</span><br><span class="line">        minHeapLen = len(self.bigValueMinHeap)</span><br><span class="line">        tmpIndex = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> tmpIndex &lt; minHeapLen:</span><br><span class="line">            leftIndex = tmpIndex * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">            rightIndex = tmpIndex *<span class="number">2</span> + <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> rightIndex &lt; minHeapLen:</span><br><span class="line">                smallerIndex = rightIndex <span class="keyword">if</span> self.bigValueMinHeap[rightIndex] &lt; self.bigValueMinHeap[leftIndex] <span class="keyword">else</span> leftIndex</span><br><span class="line">            <span class="keyword">elif</span> leftIndex &lt; minHeapLen:</span><br><span class="line">                smallerIndex = leftIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> self.bigValueMinHeap[smallerIndex] &lt; self.bigValueMinHeap[tmpIndex]:</span><br><span class="line">                self.bigValueMinHeap[tmpIndex], self.bigValueMinHeap[smallerIndex] = self.bigValueMinHeap[smallerIndex], self.bigValueMinHeap[tmpIndex]</span><br><span class="line">                tmpIndex = smallerIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Insert</span>(<span class="params">self, num</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.minHeapCount &lt; self.maxHeapCount:</span><br><span class="line">            self.minHeapCount += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> num &lt; self.littleValueMaxHeap[<span class="number">0</span>]:</span><br><span class="line">                tmpNum = self.littleValueMaxHeap[<span class="number">0</span>]</span><br><span class="line">                self.adjustMaxHeap(num)</span><br><span class="line">                self.createMinHeap(tmpNum)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.createMinHeap(num)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.maxHeapCount += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> self.littleValueMaxHeap == []:</span><br><span class="line">                self.createMaxHeap(num)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> self.bigValueMinHeap[<span class="number">0</span>] &lt; num:</span><br><span class="line">                    tmpNum = self.bigValueMinHeap[<span class="number">0</span>]</span><br><span class="line">                    self.adjustMinHeap(num)</span><br><span class="line">                    self.createMaxHeap(tmpNum)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.createMaxHeap(num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GetMedian</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.minHeapCount &lt; self.maxHeapCount:</span><br><span class="line">            <span class="keyword">return</span> self.littleValueMaxHeap[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> (self.bigValueMinHeap[<span class="number">0</span>] + self.littleValueMaxHeap[<span class="number">0</span>]) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 封装版本</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.littleValueMaxHeap = []</span><br><span class="line">        self.bigValueMinHeap = []</span><br><span class="line">        self.maxHeapCount = <span class="number">0</span></span><br><span class="line">        self.minHeapCount = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">createHeap</span>(<span class="params">self, num, heap, cmpFunc</span>):</span></span><br><span class="line">        heap.append(num)</span><br><span class="line">        tmpIndex = len(heap) - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> tmpIndex != <span class="number">0</span>:</span><br><span class="line">            parentIndex = (tmpIndex - <span class="number">1</span>) &gt;&gt; <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> cmpFunc(heap[tmpIndex], heap[parentIndex]):</span><br><span class="line">                heap[parentIndex], heap[tmpIndex] = heap[tmpIndex], heap[parentIndex]</span><br><span class="line">                tmpIndex = parentIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">adjustHeap</span>(<span class="params">self, num, heap, cmpFunc</span>):</span></span><br><span class="line">        <span class="keyword">if</span> num &lt; heap[<span class="number">0</span>]:</span><br><span class="line">            heap[<span class="number">0</span>] = num</span><br><span class="line">        heapLen = len(heap)</span><br><span class="line">        tmpIndex = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> tmpIndex &lt; heapLen:</span><br><span class="line">            leftIndex = tmpIndex * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">            rightIndex = tmpIndex *<span class="number">2</span> + <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> rightIndex &lt; heapLen:</span><br><span class="line">                largerIndex = rightIndex <span class="keyword">if</span> cmpFunc(heap[rightIndex], heap[leftIndex]) <span class="keyword">else</span> leftIndex</span><br><span class="line">            <span class="keyword">elif</span> leftIndex &lt; heapLen:</span><br><span class="line">                largerIndex = leftIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> cmpFunc(heap[largerIndex], heap[tmpIndex]):</span><br><span class="line">                heap[tmpIndex], heap[largerIndex] = heap[largerIndex], heap[tmpIndex]</span><br><span class="line">                tmpIndex = largerIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Insert</span>(<span class="params">self, num</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">cmpMaxHeap</span>(<span class="params">a, b</span>):</span></span><br><span class="line">            <span class="keyword">return</span> b &lt; a</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">cmpMinHeap</span>(<span class="params">a, b</span>):</span></span><br><span class="line">            <span class="keyword">return</span> a &lt; b</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.minHeapCount &lt; self.maxHeapCount:</span><br><span class="line">            self.minHeapCount += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> num &lt; self.littleValueMaxHeap[<span class="number">0</span>]:</span><br><span class="line">                tmpNum = self.littleValueMaxHeap[<span class="number">0</span>]</span><br><span class="line">                self.adjustHeap(num, self.littleValueMaxHeap, cmpMaxHeap)</span><br><span class="line">                self.createHeap(tmpNum, self.bigValueMinHeap, cmpMinHeap)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.createHeap(num, self.bigValueMinHeap, cmpMinHeap)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.maxHeapCount += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> self.littleValueMaxHeap == []:</span><br><span class="line">                self.createHeap(num, self.littleValueMaxHeap, cmpMaxHeap)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> self.bigValueMinHeap[<span class="number">0</span>] &lt; num:</span><br><span class="line">                    tmpNum = self.bigValueMinHeap[<span class="number">0</span>]</span><br><span class="line">                    self.adjustHeap(num, self.bigValueMinHeap, cmpMinHeap)</span><br><span class="line">                    self.createHeap(tmpNum, self.littleValueMaxHeap, cmpMaxHeap)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.createHeap(num, self.littleValueMaxHeap, cmpMaxHeap)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GetMedian</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.minHeapCount &lt; self.maxHeapCount:</span><br><span class="line">            <span class="keyword">return</span> self.littleValueMaxHeap[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> (self.bigValueMinHeap[<span class="number">0</span>] + self.littleValueMaxHeap[<span class="number">0</span>]) / <span class="number">2</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    s = Solution()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">5</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">8</span>]:</span><br><span class="line">        s.Insert(i)</span><br><span class="line">        print(s.GetMedian())</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="34-二叉树的下一个结点-本题考点-树"><a href="#34-二叉树的下一个结点-本题考点-树" class="headerlink" title="34.二叉树的下一个结点 [^本题考点 树]"></a>34.二叉树的下一个结点 [^本题考点 <em>树</em>]</h4><p>​    <strong>题目：给定一个二叉树和其中的一个结点，请找出中序遍历顺序的下一个结点并且返回。注意，树中的结点不仅包含左右子结点，同时包含指向父结点的指针。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeLinkNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        self.val = x</span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br><span class="line">        self.next = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GetNext</span>(<span class="params">self, pNode</span>):</span></span><br><span class="line">        <span class="comment"># 1.寻找右子树，如果存在就一直找到右子树的最左边，就是下一个节点</span></span><br><span class="line">        <span class="comment"># 2.没有右子树，就寻找他的父节点，一直找到它是父节点的左子树，打印父节点</span></span><br><span class="line">        <span class="keyword">if</span> pNode.right:</span><br><span class="line">            tmpNode = pNode.right</span><br><span class="line">            <span class="keyword">while</span> tmpNode.left:</span><br><span class="line">                tmpNode = tmpNode.left</span><br><span class="line">            <span class="keyword">return</span> tmpNode</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmpNode = pNode</span><br><span class="line">            <span class="keyword">while</span> tmpNode.next:</span><br><span class="line">                <span class="keyword">if</span> tmpNode.next.left == tmpNode:</span><br><span class="line">                    <span class="keyword">return</span> tmpNode.next</span><br><span class="line">                tmpNode = tmpNode.next</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="35-对称的二叉树-本题考点-树"><a href="#35-对称的二叉树-本题考点-树" class="headerlink" title="35.对称的二叉树 [^本题考点 树]"></a>35.对称的二叉树 [^本题考点 <em>树</em>]</h4><p>​    <strong>题目：请实现一个函数，用来判断一颗二叉树是不是对称的。注意，如果一个二叉树同此二叉树的镜像是同样的，定义其为对称的。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        self.val = x</span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isSymmetrical</span>(<span class="params">self, pRoot</span>):</span></span><br><span class="line">        <span class="comment"># 定义判断是否镜像的函数</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">isMirror</span>(<span class="params">left, right</span>):</span></span><br><span class="line">            <span class="comment"># 如果两侧都为空，则是镜像的了</span></span><br><span class="line">            <span class="keyword">if</span> left == <span class="literal">None</span> <span class="keyword">and</span> right == <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="comment"># 若有一侧不为空，则不是镜像的</span></span><br><span class="line">            <span class="keyword">elif</span> left == <span class="literal">None</span> <span class="keyword">or</span> right == <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="comment"># 如果左侧的值不等于右侧额值，就不是镜像的</span></span><br><span class="line">            <span class="keyword">if</span> left.val != right.val:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="comment"># 递归判断左侧的左侧和右侧的右侧</span></span><br><span class="line">            ret1 = isMirror(left.left, right.right)</span><br><span class="line">            <span class="comment"># 递归判断左侧的右侧和右侧的左侧</span></span><br><span class="line">            ret2 = isMirror(left.right, right.left)</span><br><span class="line">            <span class="comment"># 返回这两个返回值的与</span></span><br><span class="line">            <span class="keyword">return</span> ret1 <span class="keyword">and</span> ret2</span><br><span class="line">        <span class="comment"># 如果此二叉树为空，则其也是对称的</span></span><br><span class="line">        <span class="keyword">if</span> pRoot == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="comment"># 返回判断此二叉树的左侧和右侧</span></span><br><span class="line">        <span class="keyword">return</span> isMirror(pRoot.left, pRoot.right)</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="36-按之字形顺序打印二叉树-本题考点-树"><a href="#36-按之字形顺序打印二叉树-本题考点-树" class="headerlink" title="36.按之字形顺序打印二叉树 [^本题考点 树]"></a>36.按之字形顺序打印二叉树 [^本题考点 <em>树</em>]</h4><p>​    <strong>题目：请实现一个函数按照之字形打印二叉树，即第一行按照从左到右的顺序打印，第二层按照从右至左的顺序打印，第三行按照从左到右的顺序打印，其他行以此类推。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 未封装版</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        self.val = x</span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Print</span>(<span class="params">self, pRoot</span>):</span></span><br><span class="line">        <span class="comment"># 如果二叉树为空，就返回空</span></span><br><span class="line">        <span class="keyword">if</span> pRoot == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        <span class="comment"># 定义奇数行，从左到右</span></span><br><span class="line">        stack1 = [pRoot]</span><br><span class="line">        <span class="comment"># 定义偶数行，从右到左</span></span><br><span class="line">        stack2 = []</span><br><span class="line">        <span class="comment"># 定义返回的顺序列表</span></span><br><span class="line">        ret = []</span><br><span class="line">        <span class="comment"># 当奇数行或者偶数行都不为空时循环</span></span><br><span class="line">        <span class="keyword">while</span> stack1 <span class="keyword">or</span> stack2:</span><br><span class="line">            <span class="comment"># 如果奇数行有值</span></span><br><span class="line">            <span class="keyword">if</span> stack1:</span><br><span class="line">                <span class="comment"># 临时列表</span></span><br><span class="line">                tmpRet = []</span><br><span class="line">                <span class="comment"># 如果奇数行有值，就一直循环</span></span><br><span class="line">                <span class="keyword">while</span> stack1:</span><br><span class="line">                    <span class="comment"># 临时弹出数据</span></span><br><span class="line">                    tmpNode = stack1.pop()</span><br><span class="line">                    <span class="comment"># 临时列表里面添加临时数据的值</span></span><br><span class="line">                    tmpRet.append(tmpNode.val)</span><br><span class="line">                    <span class="comment"># 如果有临时数据的左节点</span></span><br><span class="line">                    <span class="keyword">if</span> tmpNode.left:</span><br><span class="line">                        <span class="comment"># 就在偶数行添加临时数据的左节点</span></span><br><span class="line">                        stack2.append(tmpNode.left)</span><br><span class="line">                    <span class="comment"># 如果有临时数据的右节点</span></span><br><span class="line">                    <span class="keyword">if</span> tmpNode.right:</span><br><span class="line">                        <span class="comment"># 就在偶数行添加临时数据的右节点</span></span><br><span class="line">                        stack2.append(tmpNode.right)</span><br><span class="line">                <span class="comment"># 在返回的顺利列表里面添加临时列表</span></span><br><span class="line">                ret.append(tmpRet)</span><br><span class="line">            <span class="comment"># 如果偶数行有值</span></span><br><span class="line">            <span class="keyword">if</span> stack2:</span><br><span class="line">                <span class="comment"># 临时列表</span></span><br><span class="line">                tmpRet = []</span><br><span class="line">                <span class="comment"># 如果奇数行有值，就一直循环</span></span><br><span class="line">                <span class="keyword">while</span> stack2:</span><br><span class="line">                    <span class="comment"># 临时弹出数据</span></span><br><span class="line">                    tmpNode = stack2.pop()</span><br><span class="line">                    <span class="comment"># 临时列表里面添加临时数据的值</span></span><br><span class="line">                    tmpRet.append(tmpNode.val)</span><br><span class="line">                    <span class="comment"># 如果有临时数据的右节点</span></span><br><span class="line">                    <span class="keyword">if</span> tmpNode.right:</span><br><span class="line">                        <span class="comment"># 就在偶数行添加临时数据的右节点</span></span><br><span class="line">                        stack1.append(tmpNode.right)</span><br><span class="line">                    <span class="comment"># 如果有临时数据的左节点</span></span><br><span class="line">                    <span class="keyword">if</span> tmpNode.left:</span><br><span class="line">                        <span class="comment"># 就在偶数行添加临时数据的左节点</span></span><br><span class="line">                        stack1.append(tmpNode.left)</span><br><span class="line">                <span class="comment"># 在返回的顺利列表里面添加临时列表</span></span><br><span class="line">                ret.append(tmpRet)</span><br><span class="line">        <span class="comment"># 返回顺序列表</span></span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 封装版</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        self.val = x</span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Print</span>(<span class="params">self, pRoot</span>):</span></span><br><span class="line">        <span class="comment"># 定义偶数行的添加</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">oddAppend</span>(<span class="params">tmpNode, stack2</span>):</span></span><br><span class="line">            <span class="comment"># 如果有临时数据的左节点</span></span><br><span class="line">            <span class="keyword">if</span> tmpNode.left:</span><br><span class="line">                <span class="comment"># 就在偶数行添加临时数据的左节点</span></span><br><span class="line">                stack2.append(tmpNode.left)</span><br><span class="line">            <span class="comment"># 如果有临时数据的右节点</span></span><br><span class="line">            <span class="keyword">if</span> tmpNode.right:</span><br><span class="line">                <span class="comment"># 就在偶数行添加临时数据的右节点</span></span><br><span class="line">                stack2.append(tmpNode.right)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 定义奇数行的添加</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">evenAppend</span>(<span class="params">tmpNode, stack2</span>):</span></span><br><span class="line">            <span class="comment"># 如果有临时数据的右节点</span></span><br><span class="line">            <span class="keyword">if</span> tmpNode.right:</span><br><span class="line">                <span class="comment"># 就在偶数行添加临时数据的右节点</span></span><br><span class="line">                stack2.append(tmpNode.right)</span><br><span class="line">            <span class="comment"># 如果有临时数据的左节点</span></span><br><span class="line">            <span class="keyword">if</span> tmpNode.left:</span><br><span class="line">                <span class="comment"># 就在偶数行添加临时数据的左节点</span></span><br><span class="line">                stack2.append(tmpNode.left)</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">dataAppend</span>(<span class="params">stack, stack2, appendFunc</span>):</span></span><br><span class="line">            <span class="comment"># 临时列表</span></span><br><span class="line">            tmpRet = []</span><br><span class="line">            <span class="comment"># 如果奇数行有值，就一直循环</span></span><br><span class="line">            <span class="keyword">while</span> stack:</span><br><span class="line">                <span class="comment"># 临时弹出数据</span></span><br><span class="line">                tmpNode = stack.pop()</span><br><span class="line">                <span class="comment"># 临时列表里面添加临时数据的值</span></span><br><span class="line">                tmpRet.append(tmpNode.val)</span><br><span class="line">                appendFunc(tmpNode, stack2)</span><br><span class="line">            <span class="comment"># 在返回的顺利列表里面添加临时列表</span></span><br><span class="line">            ret.append(tmpRet)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果二叉树为空，就返回空</span></span><br><span class="line">        <span class="keyword">if</span> pRoot == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        <span class="comment"># 定义奇数行，从左到右</span></span><br><span class="line">        stack1 = [pRoot]</span><br><span class="line">        <span class="comment"># 定义偶数行，从右到左</span></span><br><span class="line">        stack2 = []</span><br><span class="line">        <span class="comment"># 定义返回的顺序列表</span></span><br><span class="line">        ret = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> stack1 <span class="keyword">or</span> stack2:</span><br><span class="line">            <span class="comment"># 如果奇数行有值</span></span><br><span class="line">            <span class="keyword">if</span> stack1:</span><br><span class="line">                dataAppend(stack1, stack2, oddAppend)</span><br><span class="line">            <span class="comment"># 如果偶数行有值</span></span><br><span class="line">            <span class="keyword">if</span> stack2:</span><br><span class="line">                dataAppend(stack2, stack1, evenAppend)</span><br><span class="line">        <span class="comment"># 返回顺序列表</span></span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="37-把二叉树打印成多行-本题考点-树"><a href="#37-把二叉树打印成多行-本题考点-树" class="headerlink" title="37.把二叉树打印成多行 [^本题考点 树]"></a>37.把二叉树打印成多行 [^本题考点 <em>树</em>]</h4><p>​    <strong>题目：从上到下按层打印二叉树，同一层结点从左至右输出。每一层输出一行。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        self.val = x</span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># 返回二维列表[[1,2],[4,5]]</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Print</span>(<span class="params">self, pRoot</span>):</span></span><br><span class="line">        <span class="keyword">if</span> pRoot == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        queue1 = [pRoot]</span><br><span class="line">        queue2 = []</span><br><span class="line">        ret = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> queue1 <span class="keyword">or</span> queue2:</span><br><span class="line">            <span class="keyword">if</span> queue1:</span><br><span class="line">                tmpRet = []</span><br><span class="line">                <span class="keyword">while</span> queue1:</span><br><span class="line">                    tmpNode = queue1[<span class="number">0</span>]</span><br><span class="line">                    tmpRet.append(tmpNode.val)</span><br><span class="line">                    queue1.pop(<span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">if</span> tmpNode.left:</span><br><span class="line">                        queue2.append(tmpNode.left)</span><br><span class="line">                    <span class="keyword">if</span> tmpNode.right:</span><br><span class="line">                        queue2.append(tmpNode.right)</span><br><span class="line">                ret.append(tmpRet)</span><br><span class="line">            <span class="keyword">if</span> queue2:</span><br><span class="line">                tmpRet = []</span><br><span class="line">                <span class="keyword">while</span> queue2:</span><br><span class="line">                    tmpNode = queue2[<span class="number">0</span>]</span><br><span class="line">                    tmpRet.append(tmpNode.val)</span><br><span class="line">                    queue2.pop(<span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">if</span> tmpNode.left:</span><br><span class="line">                        queue1.append(tmpNode.left)</span><br><span class="line">                    <span class="keyword">if</span> tmpNode.right:</span><br><span class="line">                        queue1.append(tmpNode.right)</span><br><span class="line">                ret.append(tmpRet)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="38-二叉搜索树的第k个结点-本题考点-树"><a href="#38-二叉搜索树的第k个结点-本题考点-树" class="headerlink" title="38.二叉搜索树的第k个结点 [^本题考点 树]"></a>38.二叉搜索树的第k个结点 [^本题考点 <em>树</em>]</h4><p>​    <strong>题目：给定一棵二叉搜索树，请找出其中的第k小的结点。<br>例如， （5，3，7，2，4，6，8） 中，按结点数值大小顺序第三小结点的值为4。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        self.val = x</span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># 返回对应节点TreeNode</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">KthNode</span>(<span class="params">self, pRoot, k</span>):</span></span><br><span class="line">        retList = []</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 先定义中序遍历的函数</span></span><br><span class="line">        <span class="comment"># 递归中序法</span></span><br><span class="line">        <span class="comment"># def midOrder(pRoot):</span></span><br><span class="line">        <span class="comment">#     if pRoot == None:</span></span><br><span class="line">        <span class="comment">#         return None</span></span><br><span class="line">        <span class="comment">#     midOrder(pRoot.left)</span></span><br><span class="line">        <span class="comment">#     retList.append(pRoot)</span></span><br><span class="line">        <span class="comment">#     midOrder(pRoot.right)</span></span><br><span class="line">        <span class="comment"># 非递归中序法</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">midOrder</span>(<span class="params">pRoot</span>):</span></span><br><span class="line">            <span class="keyword">if</span> pRoot == <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            stack = []</span><br><span class="line">            tmpNode = pRoot</span><br><span class="line">            <span class="keyword">while</span> tmpNode <span class="keyword">or</span> stack:</span><br><span class="line">                <span class="keyword">while</span> tmpNode:</span><br><span class="line">                    stack.append(tmpNode)</span><br><span class="line">                    tmpNode = tmpNode.left</span><br><span class="line">                node = stack.pop()</span><br><span class="line">                retList.append(node)</span><br><span class="line">                tmpNode = node.right</span><br><span class="line">        midOrder(pRoot)</span><br><span class="line">        <span class="keyword">if</span> len(retList) &lt; k <span class="keyword">or</span> k &lt; <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> retList[k<span class="number">-1</span>]</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="39-序列化二叉树-本题考点-树"><a href="#39-序列化二叉树-本题考点-树" class="headerlink" title="39.序列化二叉树 [^本题考点 树]"></a>39.序列化二叉树 [^本题考点 <em>树</em>]</h4><p>​    <strong>题目：请实现两个函数，分别用来序列化和反序列化二叉树</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        self.val = x</span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># 序列化</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Serialize</span>(<span class="params">self, root</span>):</span></span><br><span class="line">        retList = []</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">preOrder</span>(<span class="params">root</span>):</span></span><br><span class="line">            <span class="keyword">if</span> root == <span class="literal">None</span>:</span><br><span class="line">                retList.append(<span class="string">'#'</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            retList.append(str(root.val))</span><br><span class="line">            preOrder(root.left)</span><br><span class="line">            preOrder(root.right)</span><br><span class="line"></span><br><span class="line">        preOrder(root)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">' '</span>.join(retList)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 反序列化</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Deserialize</span>(<span class="params">self, s</span>):</span></span><br><span class="line">        retList = s.split()</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">dePreOrder</span>():</span></span><br><span class="line">            <span class="keyword">if</span> retList == []:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            rootVal = retList.pop(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">if</span> rootVal == <span class="string">'#'</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            node = TreeNode(int(rootVal))</span><br><span class="line">            leftNode = dePreOrder()</span><br><span class="line">            rightNode = dePreOrder()</span><br><span class="line">            node.left = leftNode</span><br><span class="line">            node.right = rightNode</span><br><span class="line">            <span class="keyword">return</span> node</span><br><span class="line"></span><br><span class="line">        pRoot = dePreOrder()</span><br><span class="line">        <span class="keyword">return</span> pRoot</span><br></pre></td></tr></tbody></table></figure>

<hr>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/lu-you-wang-jing-dian-xiang-xi-ye-mian/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/lu-you-wang-jing-dian-xiang-xi-ye-mian/" class="post-title-link" itemprop="url">旅游网景点详细页面</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-06-17 02:45:17" itemprop="dateModified" datetime="2021-06-17T02:45:17Z">2021-06-17</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%97%85%E6%B8%B8%E7%BD%91%E9%A1%B9%E7%9B%AE/" itemprop="url" rel="index"><span itemprop="name">旅游网项目</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="旅游网景点详细页面"><a href="#旅游网景点详细页面" class="headerlink" title="旅游网景点详细页面"></a>旅游网景点详细页面</h1><h3 id="Vue-js"><a href="#Vue-js" class="headerlink" title="Vue.js"></a>Vue.js</h3><ul>
<li>面向组件方式编程</li>
<li>单页面应用</li>
</ul>
<p>如何在Vue项目中实现“多页面”<br>VueRouter用来在单页面应用中实现“多页面”<br>通过url的规则进行匹配，<br>满足url规则1，展示组件1的内容<br>满足url规则2，展示组件2的内容<br>满足url规则3，展示组件3的内容</p>
<h3 id="Vue中的路由管理"><a href="#Vue中的路由管理" class="headerlink" title="Vue中的路由管理"></a>Vue中的路由管理</h3><ul>
<li><p>Vue Router是Vue.js官方的路由管理器</p>
</li>
<li><p>新建项目</p>
</li>
</ul>
<p>`bash</p>
<blockquote>
<blockquote>
<p>cd C:/Vue<br>npm create test<br>`</p>
</blockquote>
</blockquote>
<ul>
<li>安装<br>`bash<blockquote>
<blockquote>
<p>cnpm install vue-router -S<br>`</p>
</blockquote>
</blockquote>
</li>
</ul>
<h3 id="路由的使用"><a href="#路由的使用" class="headerlink" title="路由的使用"></a>路由的使用</h3><ul>
<li>新建<code>/src/router.js</code></li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="comment">// VueRouter是Vue.js的一个插件</span></span><br><span class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line">Vue.use(VueRouter)  <span class="comment">// 使用这个插件</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>设置路由规则<br><code>/src/router.js</code></li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  <span class="comment">// 页面1 匹配指定规则，匹配/home在对应的组件中显示首页的内容</span></span><br><span class="line">  {<span class="attr">path</span>: <span class="string">'/home'</span>, <span class="attr">component</span>: HomePage, <span class="attr">name</span>: <span class="string">'home'</span>},</span><br><span class="line">  <span class="comment">// 页面2</span></span><br><span class="line">  {<span class="attr">path</span>: <span class="string">'/about'</span>, <span class="attr">component</span>: AboutPage}</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>配置路由规则<br><code>/src/router.js</code><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter({</span><br><span class="line">  routes <span class="comment">// (缩写) 相当于 routes: routes</span></span><br><span class="line">})</span><br><span class="line"><span class="keyword">new</span> Vue({</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  router</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p><code>/src/router.js</code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> route</span><br></pre></td></tr></tbody></table></figure>

<p><code>/src/main.js</code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./router'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue({</span><br><span class="line">  <span class="comment">// router: router,</span></span><br><span class="line">  router,</span><br><span class="line">}).$mount(<span class="string">'#app'</span>)</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>设置路由切换后页面的显示位置<br>在模板中指定路由切换后组件的渲染位置<br><code>&lt;router-view&gt;&lt;/router-view&gt;</code><br><code>/src/App.vue&gt;</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id="app"&gt;</span><br><span class="line">    &lt;!-- 路由变化之后，在这里显示组件的内容 --&gt;</span><br><span class="line">    &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>在模板中实现路由跳转 转换成html的a标签<br><code>&lt;router-link to="/about"&gt;&lt;/router-link&gt;</code><br><code>to</code>的跳转地址就是<code>router.js</code>中的<code>path</code>值<br><code>/src/App.vue&gt;</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id="app"&gt;</span><br><span class="line">    &lt;router-link to="/home"&gt;首页&lt;/router-link&gt; | </span><br><span class="line">    &lt;router-link to="/about"&gt;关于&lt;/router-link&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h3 id="Vue-js中的路由中的参数传递"><a href="#Vue-js中的路由中的参数传递" class="headerlink" title="Vue.js中的路由中的参数传递"></a>Vue.js中的路由中的参数传递</h3><p>景点详情的路由如何设计？</p>
<ul>
<li><p>get参数通过问号<br><code>/detail?id=1</code><br><code>/detail?id=2</code><br><code>/detail?id=3</code></p>
</li>
<li><p>django里的url设计原则<br><code>/detail/1</code><br><code>/detail/2</code><br><code>/detail/3</code></p>
</li>
</ul>
<h3 id="动态路由匹配"><a href="#动态路由匹配" class="headerlink" title="动态路由匹配"></a>动态路由匹配</h3><ul>
<li>设置动态匹配规则<ul>
<li>动态路由参数<br><code>/src/router.js</code></li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> DetailPage <span class="keyword">from</span> <span class="string">'./views/Detail.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter({</span><br><span class="line">  routes: [</span><br><span class="line">    <span class="comment">// http://localhost:8080/#/detail/1234/type1?name=ashe&amp;sort=asc</span></span><br><span class="line">    {<span class="attr">path</span>: <span class="string">'/d/:id/:types'</span>, <span class="attr">component</span>: DetailPage}</span><br><span class="line">    ]</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>
<p>等同于</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// http://localhost:8080/#/detail/1234/type1?name=ashe&amp;sort=asc</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  {<span class="attr">path</span>: <span class="string">'/d/:id/:types'</span>, <span class="attr">component</span>: DetailPage}</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> route = <span class="keyword">new</span> VueRouter({</span><br><span class="line">  <span class="comment">// routes: routes</span></span><br><span class="line">  routes <span class="comment">// (缩写) 相当于 routes: routes</span></span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<p><code>App.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      id: '',</span><br><span class="line">      name: '',</span><br><span class="line">      type: ''</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;    </span><br></pre></td></tr></tbody></table></figure>

<p>新建<code>/test/src/views/Detail.vue</code></p>
<ul>
<li><p>在组件中获取匹配参数和查询</p>
<ul>
<li><p>在JS中获取参数<br><code>$route </code> 获取当前路由<br><code>Detial.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">export default {</span><br><span class="line">  created () {</span><br><span class="line">    let id = this.$route.params.id</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>响应参数的变化<br><code>Detial.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">export default {</span><br><span class="line">  watch: {</span><br><span class="line">    $route(to, from) {</span><br><span class="line">      // 对路由变化作出响应...</span><br><span class="line">      console.log('to:', to)</span><br><span class="line">      console.log('from:', from)</span><br><span class="line">      this.id = this.$route.params.id</span><br><span class="line">    },</span><br><span class="line">    id (to, from) {</span><br><span class="line">      console.log('to-id:', to)</span><br><span class="line">      console.log('from-id:', from)</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>
</li>
</ul>
</li>
<li><p>URL中的查询参数<br><code>/sight/list?name=ashe</code></p>
</li>
<li><p>获取方式<br><code>Detail.vue</code></p>
</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h1&gt;详情页：{{ id }} : {{ name }} : {{ type }}&lt;/h1&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default {</span><br><span class="line">  created () {</span><br><span class="line">    let name = this.$route.query.name</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<h3 id="路由的跳转"><a href="#路由的跳转" class="headerlink" title="路由的跳转"></a>路由的跳转</h3><ul>
<li><p>在模板中标签跳转 router-link<br><code>App.vue</code><br>`vue</p>
<template>
<div id="app">
  <router-link to="/d/123/type1">详情1</router-link>|
  <!-- <HelloWorld msg="Welcome to Your Vue.js App"/> -->
  <!-- 路由变化之后，在这里显示组件的内容 -->
  <router-view></router-view>
</div>
</template>
`
在浏览器点击点我回到详情1跳转
`http://localhost:8080/#/d/123/type1`
</li>
<li><p>路由命名 方便URL修改<br><code>rounter.js</code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> DetailPage <span class="keyword">from</span> <span class="string">'./views/Detail.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义路由规则</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  {<span class="attr">path</span>: <span class="string">'/home'</span>, <span class="attr">component</span>: HomePage, <span class="attr">name</span>: <span class="string">'home'</span>},</span><br><span class="line">  {<span class="attr">path</span>: <span class="string">'/about'</span>, <span class="attr">component</span>: AboutPage},</span><br><span class="line">  <span class="comment">// http://localhost:8080/#/detail/1234/type1?name=ashe&amp;sort=asc</span></span><br><span class="line">  {<span class="attr">path</span>: <span class="string">'/d/:id/:types'</span>, <span class="attr">component</span>: DetailPage, <span class="attr">name</span>: <span class="string">'detail-page'</span>}</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>按照名称跳转<br>`vue</p>
<template>
<div id="app">
  <router-link :to="&quot;/d/&quot; + id + &quot;/&quot; + types">详情2</router-link>|
  <router-link :to="{path: &quot;/d/&quot; + id + &quot;/&quot; + types, query: {name: &quot;abc&quot;, sort: &quot;desc&quot;}}">详情3</router-link>|
  <router-link :to="{name: &quot;detail-page&quot;, params: {id: &quot;abc123&quot;, types: &quot;type3&quot;}, query: {name: &quot;abc&quot;, sort: &quot;desc&quot;}}">详情4</router-link>|
  <router-view></router-view>
</div>
</template>

</li>
</ul>
<script>
// import HelloWorld from './components/HelloWorld.vue'

export default {
  name: 'App',
  data () {
    return {
      id: 456,
      types: 'type2'
    }
  }
}
</script>
<figure class="highlight autohotkey"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">在浏览器点击点我回到详情<span class="number">2</span>跳转</span><br><span class="line">`http://localhost:<span class="number">8080</span>/#/d/<span class="number">456</span>/type2`</span><br><span class="line">在浏览器点击点我回到详情<span class="number">3</span>跳转</span><br><span class="line">`http://localhost:<span class="number">8080</span>/#/d/<span class="number">456</span>/type2?name=abc&amp;sort=desc`</span><br><span class="line">在浏览器点击点我回到详情<span class="number">4</span>跳转</span><br><span class="line">`http://localhost:<span class="number">8080</span>/#/d/abc123/type3?name=abc&amp;sort=desc`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 在JS中事件跳转</span><br><span class="line">`this`vue的实例，在`main.js`通过`new vue`得到的实例</span><br><span class="line">&gt;传参是 `router`，接收参数是 `route`</span><br><span class="line">`$router`表示vue实例上所挂载的在`main.js`的`new vue`中的`router`这个对象，</span><br><span class="line">跳转到不同的url，但这个方法会向history栈添加一个记录，点击后退会返回到上一个页面。</span><br><span class="line"></span><br><span class="line">`App.vue`</span><br><span class="line">```vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=<span class="string">"app"</span>&gt;</span><br><span class="line">    &lt;-- 字符串 --&gt;</span><br><span class="line">    this.$router.push('/home')  </span><br><span class="line">    &lt;-- 对象 --&gt;</span><br><span class="line"><span class="title">    this.$router.push({path:</span>'/home'})</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>③ query 传参，相当于get请求，页面跳转时参数会在地址栏中显示，通过this.$route.query.id获取</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 变成 /user?id=2</span></span><br><span class="line"><span class="built_in">this</span>.$router.push({ </span><br><span class="line">    path:<span class="string">'/user'</span>,</span><br><span class="line">    query:{</span><br><span class="line">        id:<span class="built_in">this</span>.id</span><br><span class="line">    }</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>
<p>④ params 传参，相当于post请求，页面跳转时参数不会在地址栏中显示,通过this.$route.params.id获取</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.$router.push({ </span><br><span class="line">    path:<span class="string">'/user'</span>,</span><br><span class="line">    params:{</span><br><span class="line">        id:<span class="built_in">this</span>.id</span><br><span class="line">    }</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id="app"&gt;</span><br><span class="line">    &lt;a href="javascript:;" @click="goHome"&gt;点我跳转&lt;/a&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default {</span><br><span class="line">  name: 'App',</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      id: 456,</span><br><span class="line">      types: 'type2'</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    goHome () {</span><br><span class="line">      this.$router.push('/home')</span><br><span class="line">      // this.$router.push({name: 'home'})</span><br><span class="line">      // this.$router.push({name: "detail-page", params: {id: "abc123", types: "type3"}, query: {name: "abc", sort: "desc"}})</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>在浏览器点击点我回到首页跳转<br><code>http://localhost:8080/#/home</code></p>
<h3 id="路由的跳转方式"><a href="#路由的跳转方式" class="headerlink" title="路由的跳转方式"></a>路由的跳转方式</h3><ul>
<li>页面跳转</li>
</ul>
<p><code>this.$router.push(location, onComplete?, onAbort?)</code></p>
<ul>
<li>页面前进或后退<br><code>this.$router.go(n)</code><br>n可为正数可为负数。正数返回上一个页面。<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在浏览器记录中前进1步，相当于history.forward()</span></span><br><span class="line"><span class="built_in">this</span>.$router.go(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 后退一步记录，等同于history.back()</span></span><br><span class="line"><span class="built_in">this</span>.$router.go(<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 前进三步记录</span></span><br><span class="line"><span class="built_in">this</span>.$router.go(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果history记录不够用，就会失败</span></span><br><span class="line"><span class="built_in">this</span>.$router.go(<span class="number">100</span>)</span><br><span class="line"><span class="built_in">this</span>.$router.go(<span class="number">-100</span>)</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p>`vue<br><template><br>  <div id="app"><br>    &lt;a href=”javascript:;” @click=”goBack”&gt;点我跳转<br>  </div><br></template></p>
<script>
export default {
  name: 'App',
  data () {
    return {
      id: 456,
      types: 'type2'
    }
  },
  methods: {
    goBack () {
      this.$router.go(-1)
    }
  }
}
</script>
<figure class="highlight xquery"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 替换浏览历史记录</span><br><span class="line">同样是跳转到指定的url，但是这个方法不会向history里面添加新的记录，点击返回，会跳转到上上一个页面。上一个记录是不存在的。</span><br><span class="line">场景是用户登录了后退，支付成功后退，不能回到原来的页面</span><br><span class="line"></span><br><span class="line">`this.<span class="variable">$router</span><span class="built_in">.replace</span>(location, onComplete?, onAbort?)`</span><br><span class="line">```vue</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">export default </span><span class="xquery">{</span></span><br><span class="line"><span class="xquery"> <span class="built_in"> name</span>: <span class="string">'App'</span>,</span></span><br><span class="line"><span class="xquery">  data () {</span></span><br><span class="line"><span class="xquery">    <span class="keyword">return</span> {</span></span><br><span class="line"><span class="xquery">     <span class="built_in"> id</span>: <span class="number">456</span>,</span></span><br><span class="line"><span class="xquery">      types: <span class="string">'type2'</span></span></span><br><span class="line"><span class="xquery">    }</span></span><br><span class="line"><span class="xml">  },</span></span><br><span class="line"><span class="xml">  methods: </span><span class="xquery">{</span></span><br><span class="line"><span class="xquery">    goHome () {</span></span><br><span class="line"><span class="xquery">      this.<span class="variable">$router</span><span class="built_in">.replace</span>(<span class="built_in">{name</span>: <span class="string">'home'</span>}</span><span class="xml">)</span></span><br><span class="line"><span class="xml">    }</span></span><br><span class="line"><span class="xml">  }</span></span><br><span class="line"><span class="xml">}</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="景点搜索页面"><a href="#景点搜索页面" class="headerlink" title="景点搜索页面"></a>景点搜索页面</h3><p>实现步骤</p>
<ul>
<li>查找Vant中可以使用的组件</li>
<li>实现组件模板部分</li>
<li>模型层准备数据</li>
<li>模拟数据，实现效果</li>
</ul>
<p>使用Vant中可用的组件<br>复用景点列表组件<br>结合VueRouter实现页面跳转</p>
<p>新建<code>/src/views/Search.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 搜索页面 --&gt;</span><br><span class="line">  &lt;div class="page-search"&gt;</span><br><span class="line">    &lt;!-- 标题 --&gt;</span><br><span class="line">    &lt;van-nav-bar title="搜索景点"</span><br><span class="line">      left-text="返回"</span><br><span class="line">      left-arrow</span><br><span class="line">      @click-left="goBack"</span><br><span class="line">      v-if="isHome"/&gt;</span><br><span class="line">    &lt;!-- 搜索框 --&gt;</span><br><span class="line">    &lt;van-search</span><br><span class="line">      v-model="sightName"</span><br><span class="line">      show-action</span><br><span class="line">      label="景点"</span><br><span class="line">      placeholder="请输入搜索关键词"</span><br><span class="line">      @search="onSearch"</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;template #action&gt;</span><br><span class="line">        &lt;div @click="onSearch"&gt;搜索&lt;/div&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/van-search&gt;</span><br><span class="line">    &lt;!-- 景点列表 --&gt;</span><br><span class="line">    &lt;div class="sight-list"&gt;</span><br><span class="line">      &lt;sight-item v-for="item in dataList"</span><br><span class="line">        :key="item.id"</span><br><span class="line">        :item="item"/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 分页 --&gt;</span><br><span class="line">    &lt;van-pagination v-model="currentPage"</span><br><span class="line">    :total-items="totalItems"</span><br><span class="line">    :items-per-page="perPage" /&gt;</span><br><span class="line">    &lt;!-- 底部导航 --&gt;</span><br><span class="line">    &lt;TripFooter/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 景点列表的每一项</span><br><span class="line">import SightItem from '@/components/common/ListSight'</span><br><span class="line">// 底部导航</span><br><span class="line">import TripFooter from '@/components/common/Footer'</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      // 景点名称</span><br><span class="line">      sightName: '',</span><br><span class="line">      // 景点列表的数据</span><br><span class="line">      dataList: [],</span><br><span class="line">      // 总记录数</span><br><span class="line">      totalItems: 0,</span><br><span class="line">      // 当前的页码</span><br><span class="line">      currentPage: 1,</span><br><span class="line">      // 每页数据的大小</span><br><span class="line">      perPage: 5</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  components: {</span><br><span class="line">    SightItem,</span><br><span class="line">    TripFooter</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    onSearch () {</span><br><span class="line">      console.log('onSearch ')</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<p><code>/src/router/index.js</code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Search <span class="keyword">from</span> <span class="string">'../views/Search.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  {</span><br><span class="line">    path: <span class="string">'/search'</span>,</span><br><span class="line">    name: <span class="string">'Search'</span>,</span><br><span class="line">    component: Search</span><br><span class="line">  }</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

<p>点击底部导航跳转到搜索<br><code>/src/components/common/Footer.vue</code><br>`vue<br><template><br>  <!-- 底部导航（公共组件） --><br>  <div><br>    <!-- 开启路由模式，默认为false --><br>    <van-tabbar v-model="active" route><br>      <van-tabbar-item name="home" icon="wap-home-o" :to="{name: 'Home'}">首页</van-tabbar-item><br>      <van-tabbar-item name="search" icon="search" :to="{name: 'Search'}">搜索</van-tabbar-item><br>  </van-tabbar></div><br></template></p>
<figure class="highlight clean"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 搭建前端详情页</span><br><span class="line">#### 实现步骤</span><br><span class="line">- 设计URL路由规则</span><br><span class="line">`/src/router/index.js`</span><br><span class="line">```js</span><br><span class="line"><span class="keyword">import</span> SightList <span class="keyword">from</span> <span class="string">'../views/sight/SightList.vue'</span></span><br><span class="line"><span class="keyword">import</span> SightDetail <span class="keyword">from</span> <span class="string">'../views/sight/SightDetail.vue'</span></span><br><span class="line"><span class="keyword">import</span> SightInfo <span class="keyword">from</span> <span class="string">'../views/sight/SightInfo.vue'</span></span><br><span class="line"><span class="keyword">import</span> SightComment <span class="keyword">from</span> <span class="string">'../views/sight/SightComment.vue'</span></span><br><span class="line"><span class="keyword">import</span> SightImage <span class="keyword">from</span> <span class="string">'../views/sight/SightImage.vue'</span></span><br><span class="line"></span><br><span class="line">const routes = [</span><br><span class="line">  <span class="comment">// 景点列表</span></span><br><span class="line">  {</span><br><span class="line">    path: <span class="string">'/sight/list'</span>,</span><br><span class="line">    name: <span class="string">'SightList'</span>,</span><br><span class="line">    component: SightList</span><br><span class="line">  },</span><br><span class="line">  <span class="comment">// 景点详情</span></span><br><span class="line">  {</span><br><span class="line">    path: <span class="string">'/sight/detail/:id'</span>,</span><br><span class="line">    name: <span class="string">'SightDetail'</span>,</span><br><span class="line">    component: SightDetail</span><br><span class="line">  },</span><br><span class="line">  <span class="comment">// 景点介绍</span></span><br><span class="line">  {</span><br><span class="line">    path: <span class="string">'/sight/info/:id'</span>,</span><br><span class="line">    name: <span class="string">'SightInfo'</span>,</span><br><span class="line">    component: SightInfo</span><br><span class="line">  },</span><br><span class="line">  <span class="comment">// 评论列表</span></span><br><span class="line">  {</span><br><span class="line">    path: <span class="string">'/sight/comment/:id'</span>,</span><br><span class="line">    name: <span class="string">'SightComment'</span>,</span><br><span class="line">    component: SightComment</span><br><span class="line">  },</span><br><span class="line">  <span class="comment">// 景点下的图片</span></span><br><span class="line">  {</span><br><span class="line">    path: <span class="string">'/sight/image/:id'</span>,</span><br><span class="line">    name: <span class="string">'SightImage'</span>,</span><br><span class="line">    component: SightImage</span><br><span class="line">  }</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>新建详情页页面</p>
<ul>
<li><p>新建目录<code>/src/views/sight</code></p>
</li>
<li><p>新建<code>/src/views/sight/SightList.vue</code><br>``vue</p>
<template>
<!-- 景点列表 -->
<div class="page-sight-list"></div>
</template>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  - 新建`/src/views/sight/SightDetail.vue`</span><br><span class="line">```vue</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 景点详情 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-sight-detail"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>新建<code>/src/views/sight/SightInfo.vue</code><br>`vue</p>
<template>
<!-- 景点介绍 -->
<div class="page-sight-info"></div>
</template>
`
</li>
<li><p>新建<code>/src/views/sight/SightComment.vue</code><br>`vue</p>
<template>
<!-- 景点评论 -->
<div class="page-sight-comment"></div>
</template>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  - 新建`/src/views/sight/SightImage.vue`</span><br><span class="line">```vue</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 景点图片 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-sight-image"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
</ul>
</li>
<li><p>修改景点列表组件，支持路由跳转<br>从景点列表跳到景点详情<br><code>/src/components/common/ListSight.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;router-link class="sight-item"</span><br><span class="line">    :to="{name: 'SightDetail', params: {id: item.id}}"&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/router-link&gt;</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p>从标题热门景点和更多跳到景点列表<br>从热门景点的地点跳到对应景点详情<br><code>/src/components/home/Hot.vue</code><br>`vue<br><template><br>  <!-- 热门景点 --><br>  <div class="home-hot-box"><br>    <!-- 顶上导航 --><br>    <van-cell :to="{name: 'SightList', query: {name: '热门推荐'}}"><br>    <!-- // 顶上导航 --><br>    <!-- 景点列表 --><br>    <div class="box-main"><br>      <router-link class="hot-item" :to="{name: 'SightDetail', params: {id: item.id}}"><br>        <div class="img"><br>      <br>    </div><br>    <!-- //景点列表 --><br>  </router-link></div><br></van-cell></div></template></p>
<figure class="highlight xquery"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">从标题精选景点和更多跳到景点列表</span><br><span class="line">从精选景点的地点跳到对应景点列表</span><br><span class="line">`/src/components/home/Fine.vue`</span><br><span class="line">```vue</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="comment">&lt;!-- 精选景点 --&gt;</span></span></span><br><span class="line"><span class="xml">  </span><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"home-fine-box"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- 顶上导航 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">van-cell</span></span></span></span><br><span class="line"><span class="xml">      title="精选景点"</span></span><br><span class="line"><span class="xml">      :to="</span><span class="xquery"><span class="built_in">{name</span>: <span class="string">'SightList'</span>, query: <span class="built_in">{name</span>: <span class="string">'精选景点'</span>}</span><span class="xml">}"/&gt;</span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- // 顶上导航 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- 景点的列表 --&gt;</span></span></span><br><span class="line"><span class="xml">    </span><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box-main"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">sight-item</span> <span class="attr">v-for</span>=<span class="string">"item in dataList"</span></span></span></span><br><span class="line"><span class="xml">        :key="item.id"</span></span><br><span class="line"><span class="xml">        :item="item"/&gt;</span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!-- 不需要:to --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- //景点的列表 --&gt;</span>    </span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml">`</span></span><br><span class="line"></span><br><span class="line"><span class="xml">- 拆分详情页组件</span></span><br><span class="line"><span class="xml">`/src/views/sight/SightDetail.vue`</span></span><br><span class="line"><span class="xml">```vue</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="comment">&lt;!-- 景点详情 --&gt;</span></span></span><br><span class="line"><span class="xml">  </span><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-sight-detail"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- 页面头部 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">van-nav-bar</span></span></span></span><br><span class="line"><span class="xml">    left-text="返回"</span></span><br><span class="line"><span class="xml">    left-arrow</span></span><br><span class="line"><span class="xml">    fixed</span></span><br><span class="line"><span class="xml">    @click-left="goBack"</span></span><br><span class="line"><span class="xml">  /&gt;</span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- 大图 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- //大图 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- 评分、景点介绍 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- //评分、景点介绍 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- 地址信息 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- //地址信息 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- 门票列表 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- //门票列表 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- 用户评价 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- //用户评价 --&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml">export default </span><span class="xquery">{</span></span><br><span class="line"><span class="xquery">  methods: {</span></span><br><span class="line"><span class="xquery">    goBack () {</span></span><br><span class="line"><span class="xquery">      this.<span class="variable">$router</span>.go(-<span class="number">1</span>)</span></span><br><span class="line"><span class="xquery">    }</span></span><br><span class="line"><span class="xml">  }</span></span><br><span class="line"><span class="xml">}</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">"less"</span>&gt;</span></span></span><br><span class="line"><span class="xml">.page-sight-detail </span><span class="xquery">{</span></span><br><span class="line"><span class="xquery">  // 导航栏  </span></span><br><span class="line"><span class="xquery">  .van-nav-bar {</span></span><br><span class="line"><span class="xquery">    background-color: transparent;</span></span><br><span class="line"><span class="xquery">  }</span></span><br><span class="line"><span class="xml">}</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="景点大图部分"><a href="#景点大图部分" class="headerlink" title="景点大图部分"></a>景点大图部分</h3><h4 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li>查找Vant中可以使用的组件</li>
<li>实现组件模板部分<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 景点详情 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-sight-detail"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 大图 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sight-banner"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">van-image</span> <span class="attr">src</span>=<span class="string">"/static/home/hot/h1_max.jpg"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100%"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tips"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">class</span>=<span class="string">"pic-sts"</span> <span class="attr">:to</span>=<span class="string">"{name: 'SightImage', params: {id: 123}}"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">"video-o"</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>10 图片<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>景点标题<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- //大图 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;style lang="less"&gt;</span><br><span class="line">.page-sight-detail {</span><br><span class="line">  // 景点大图</span><br><span class="line">  .sight-banner{</span><br><span class="line">    position: relative;</span><br><span class="line">    .tips {</span><br><span class="line">      position: absolute;</span><br><span class="line">      left: 10px;</span><br><span class="line">      bottom: 10px;</span><br><span class="line">      font-size: 16px;</span><br><span class="line">      color: #fff;</span><br><span class="line"></span><br><span class="line">      .pic-sts {</span><br><span class="line">        color: #fff;</span><br><span class="line">        border-radius: 30px;</span><br><span class="line">        font-size: 14px;</span><br><span class="line">        background-color: rgba(0,0,0,0.4);</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>模型层准备数据</li>
<li>模拟数据，实现效果</li>
</ul>
<h3 id="评分、景点介绍"><a href="#评分、景点介绍" class="headerlink" title="评分、景点介绍"></a>评分、景点介绍</h3><h4 id="实现步骤-1"><a href="#实现步骤-1" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li>查找Vant中可以使用的组件</li>
<li>实现组件模板部分<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 景点详情 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-sight-detail"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 评分、景点介绍 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sight-info"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"info-title"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">strong</span>&gt;</span>5分<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">small</span>&gt;</span>很棒<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"info-tips"</span>&gt;</span>50 评论<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">"arrow"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"info-title"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>景点介绍<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"info-tips"</span>&gt;</span>开放时间、贴士<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">"arrow"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- //评分、景点介绍 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;style lang="less"&gt;</span><br><span class="line">.page-sight-detail {</span><br><span class="line">  // 评分、景点介绍</span><br><span class="line">  .sight-info {</span><br><span class="line">    display: flex;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">    border-bottom: 1px solid #f6f6f6;</span><br><span class="line"></span><br><span class="line">    &amp; &gt; div {</span><br><span class="line">      flex: 1;</span><br><span class="line">      position: relative;</span><br><span class="line">    }</span><br><span class="line">    .right {</span><br><span class="line">      border-left: 1px solid #f6f6f6;</span><br><span class="line">    }</span><br><span class="line">    .info-title {</span><br><span class="line">      text-align: left;</span><br><span class="line">      padding: 5px 10px;</span><br><span class="line">      strong {</span><br><span class="line">        color: #ff8300;</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">    .info-tips {</span><br><span class="line">      color: #999;</span><br><span class="line">      font-size: 12px;</span><br><span class="line">      text-align: left;</span><br><span class="line">      padding: 5px 10px;</span><br><span class="line">    }</span><br><span class="line">    .van-icon {</span><br><span class="line">      position: absolute;</span><br><span class="line">      right: 5px;</span><br><span class="line">      top: 5px</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>模型层准备数据</li>
<li>模拟数据，实现效果</li>
</ul>
<h3 id="地址信息"><a href="#地址信息" class="headerlink" title="地址信息"></a>地址信息</h3><h4 id="实现步骤-2"><a href="#实现步骤-2" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li>查找Vant中可以使用的组件</li>
<li>实现组件模板部分<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 景点详情 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-sight-detail"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 地址信息 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-cell</span> <span class="attr">title</span>=<span class="string">"广东省广州市番禺区番禺大道"</span> <span class="attr">icon</span>=<span class="string">"location-o"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">is-link</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:title-style</span>=<span class="string">"{'text-align': 'left'}"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">right-icon</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">van-icon</span> <span class="attr">name</span>=<span class="string">"arrow"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">van-cell</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- //地址信息 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h3 id="门票列表"><a href="#门票列表" class="headerlink" title="门票列表"></a>门票列表</h3><h4 id="实现步骤-3"><a href="#实现步骤-3" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li>查找Vant中可以使用的组件</li>
<li>实现组件模板部分<br>`html<template>
<!-- 景点详情 -->
<div class="page-sight-detail">
  <!-- 门票列表 -->
  <div class="sight-ticket">
    <van-cell title="门票" icon="bookmark-o" title-style="text-align:left">
    <div class="ticket-item" v-for="i in 5" :key="i">
      <div class="left">
        <div class="title">成人票</div>
        <div class="tips">
          <van-icon name="clock-o">
          <span>7点之前可以预定</span>
        </van-icon></div>
        <div class="tags">
          <van-tag mark type="primary">标签1</van-tag>
        </div>
      </div>
      <div class="right">
        <div class="price">
          <span>￥</span>
          <strong>65</strong>
        </div>
        <router-link to="#">
          <van-button type="warning" size="small">预定</van-button>
        </router-link>
      </div>
    </div>
  </van-cell></div>
  <!-- //门票列表 -->
</div>
</template>
<figure class="highlight stylus"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```vue</span><br><span class="line">&lt;style lang=<span class="string">"less"</span>&gt;</span><br><span class="line"><span class="selector-class">.page-sight-detail</span> {</span><br><span class="line">  <span class="comment">// 门票列表</span></span><br><span class="line">  <span class="selector-class">.sight-ticket</span> {</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.ticket-item</span> {</span><br><span class="line">      <span class="attribute">display</span>: flex;</span><br><span class="line">      <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#f6f6f6</span>;</span><br><span class="line">      <span class="attribute">padding-bottom</span>: <span class="number">10px</span>;</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.left</span> {</span><br><span class="line">        <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">        <span class="attribute">text-align</span>: left;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span>;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.title</span> {</span><br><span class="line">          <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">0</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="selector-class">.tips</span> {</span><br><span class="line">          <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">      <span class="selector-class">.right</span> {</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">        <span class="selector-class">.price</span> {</span><br><span class="line">          <span class="attribute">color</span>: <span class="number">#ff9800</span>;</span><br><span class="line">          <span class="selector-tag">strong</span> {</span><br><span class="line">            <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">          }</span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></tbody></table></figure></li>
<li>模型层准备数据</li>
<li>模拟数据，实现效果</li>
</ul>
<h3 id="用户评价列表"><a href="#用户评价列表" class="headerlink" title="用户评价列表"></a>用户评价列表</h3><h4 id="实现步骤-4"><a href="#实现步骤-4" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li>查找Vant中可以使用的组件</li>
<li>实现组件模板部分</li>
</ul>
<p>当<code>key=value</code>，<code>key:value</code>等同于<code>key</code><br><code>params: {id: id}</code>等同于<code>params: {id}</code><br><code>/src/views/sight/SightDetail.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 景点详情 --&gt;</span><br><span class="line">  &lt;div class="page-sight-detail"&gt;</span><br><span class="line">    &lt;!-- 用户评价 --&gt;</span><br><span class="line">    &lt;div class="sight-comment"&gt;</span><br><span class="line">      &lt;van-cell title="热门评论" icon="comment-o" title-style="text-align:left"/&gt;</span><br><span class="line">      &lt;comment-item/&gt;</span><br><span class="line">      &lt;router-link class="link-more" :to="{name: 'SightComment', params: {id}}"&gt;查看更多&lt;/router-link&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //用户评价 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>点击查看更多跳到景点评价</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      id: ''</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    this.id = this.$route.params.id</span><br><span class="line">  }</span><br><span class="line">  // 查看更多</span><br><span class="line">  .link-more {</span><br><span class="line">    display: block;</span><br><span class="line">    color: #666;</span><br><span class="line">    padding: 10px;</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;    </span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">```vue</span><br><span class="line">&lt;style lang="less"&gt;</span><br><span class="line">.page-sight-detail {</span><br><span class="line">  // 评论列表</span><br><span class="line">  .sight-comment {</span><br><span class="line">    margin-top: 10px;</span><br><span class="line">    background-color: #fff;</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>评价列表只在景点模块的详情页和查看更多复用<br>新建目录<code>/src/components/sight</code><br>新建<code>/src/components/sight/CommentItem.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 评论列表的每一项 --&gt;</span><br><span class="line">  &lt;div class="comment-item-box"&gt;</span><br><span class="line">    &lt;div class="cmt-header"&gt;</span><br><span class="line">      &lt;div class="rate"&gt;</span><br><span class="line">        &lt;van-rate v-model="value"</span><br><span class="line">        allow-half</span><br><span class="line">        readonly</span><br><span class="line">        void-icon="star"</span><br><span class="line">        void-color="#eee" /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class="user"&gt;张三*** 2021-3-19&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class="cmt-content"&gt;</span><br><span class="line">      &lt;p&gt;评论内容评论内容评论内容评论内容评论内容评论内容评论内容评论内容评论内容评论内容评论内容评论内容评论内容评论内容&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 图片列表 --&gt;</span><br><span class="line">    &lt;div class="cmt-imgs" @click="show=true"&gt;</span><br><span class="line">      &lt;van-image width="100" height="100" src="https://img.yzcdn.cn/vant/cat.jpeg" /&gt;</span><br><span class="line">      &lt;van-image width="100" height="100" src="https://img.yzcdn.cn/vant/cat.jpeg" /&gt;</span><br><span class="line">      &lt;van-image width="100" height="100" src="https://img.yzcdn.cn/vant/cat.jpeg" /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;van-image-preview v-model="show" :images="images" @change="onChange"&gt;</span><br><span class="line">      &lt;template v-slot:index&gt;第{{ index + 1 }}页&lt;/template&gt;</span><br><span class="line">    &lt;/van-image-preview&gt;</span><br><span class="line">    &lt;!-- //图片列表 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      show: false,</span><br><span class="line">      index: 0,</span><br><span class="line">      images: [</span><br><span class="line">        'https://img.yzcdn.cn/vant/apple-1.jpg',</span><br><span class="line">        'https://img.yzcdn.cn/vant/apple-2.jpg'</span><br><span class="line">      ],</span><br><span class="line">      value: 4.5</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    onChange (index) {</span><br><span class="line">      this.index = index</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>详情<code>/src/views/sight/SightDetail.vue</code>引入评价模块<br><code>&lt;comment-item/&gt;</code>等同于<code>&lt;CommentItem/&gt;</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 景点详情 --&gt;</span><br><span class="line">  &lt;div class="page-sight-detail"&gt;</span><br><span class="line">    &lt;!-- 用户评价 --&gt;</span><br><span class="line">    &lt;div class="sight-comment"&gt;</span><br><span class="line">      &lt;comment-item/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //用户评价 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 评论项组件</span><br><span class="line">import CommentItem from '@/components/sight/CommentItem'</span><br><span class="line">export default {</span><br><span class="line">  components: {</span><br><span class="line">    CommentItem</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>模型层准备数据</li>
<li>模拟数据，实现效果</li>
</ul>
<h3 id="ORM模型设计"><a href="#ORM模型设计" class="headerlink" title="ORM模型设计"></a>ORM模型设计</h3><p>开发步骤</p>
<ul>
<li>分析并设计模型<br>pdman工具</li>
<li>完成ORM模型编码<br>新建一个package<code>utils</code><br><code>utils\models.py</code><br>`python<br>from django.db import models</li>
</ul>
<p>class CommonModel(models.Model):<br>    “”” 模型公共类 “””<br>    is_valid = models.BooleanField(‘是否有效’, default=True)<br>    created_at = models.DateTimeField(‘创建时间’, auto_now_add=True)<br>    updated_at = models.DateTimeField(‘修改时间’, auto_now=True)</p>
<pre><code>class Meta:
    abstract = True
</code></pre>
<figure class="highlight autohotkey"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```bash</span><br><span class="line"><span class="title">C:</span>\django\trip&gt;python manage.py startapp accounts</span><br></pre></td></tr></tbody></table></figure>

<p><code>trip\setting.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="comment"># 用户账户</span></span><br><span class="line">    <span class="string">'accounts.apps.AccountsConfig'</span></span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

<p><code>accounts/models.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> utils.models <span class="keyword">import</span> CommonModel</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>(<span class="params">CommonModel</span>):</span></span><br><span class="line">    <span class="string">""" 用户模型 """</span></span><br><span class="line">    <span class="comment"># 用户用手机注册新建User的实例，只填手机号码和密码，所以姓名，手机号码、地址、邮箱可以为空</span></span><br><span class="line">    username = models.CharField(<span class="string">'用户名'</span>, max_length=<span class="number">32</span>, unique=<span class="literal">True</span>)</span><br><span class="line">    password = models.CharField(<span class="string">'密码'</span>, max_length=<span class="number">256</span>)</span><br><span class="line">    avatar = models.ImageField(<span class="string">'用户头像'</span>, upload_to=<span class="string">'avatar/%Y%m'</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    nickname = models.CharField(<span class="string">'昵称'</span>, max_length=<span class="number">32</span>, unique=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">'account_user'</span></span><br></pre></td></tr></tbody></table></figure>


<p><code>system/models.py</code>和<code>sight/models.py</code><br>删掉</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">is_valid = models.BooleanField(<span class="string">'是否有效'</span>, default=<span class="literal">True</span>)</span><br><span class="line">created_at = models.DateTimeField(<span class="string">'创建时间'</span>, auto_now_add=<span class="literal">True</span>)</span><br><span class="line">updated_at = models.DateTimeField(<span class="string">'修改时间'</span>, auto_now=<span class="literal">True</span>)</span><br></pre></td></tr></tbody></table></figure>

<p><code>system/models.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImageRelated</span>(<span class="params">CommonModel</span>):</span></span><br><span class="line">    <span class="string">""" 图片关联 """</span></span><br><span class="line">    img = models.ImageField(<span class="string">'图片'</span>, upload_to=<span class="string">'%Y%m/file/'</span>, max_length=<span class="number">256</span>)</span><br><span class="line">    summary = models.CharField(<span class="string">'图片说明'</span>, max_length=<span class="number">32</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    user = models.ForeignKey(User,</span><br><span class="line">                             on_delete=models.SET(<span class="literal">None</span>),</span><br><span class="line">                             related_name=<span class="string">'upload_images'</span>,</span><br><span class="line">                             verbose_name=<span class="string">'上传的用户'</span>,</span><br><span class="line">                             null=<span class="literal">True</span>)</span><br><span class="line">    content_type = models.ForeignKey(ContentType, on_delete=models.CASCADE)</span><br><span class="line">    object_id = models.IntegerField(<span class="string">'关联的模型'</span>)</span><br><span class="line">    <span class="comment"># 查到某一个图片要得到关联的某一个模型的对象</span></span><br><span class="line">    content_object = GenericForeignKey(<span class="string">'content_type'</span>, <span class="string">'object_id'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">'system_image_related'</span></span><br></pre></td></tr></tbody></table></figure>

<p><code>sight/models.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.contenttypes.fields <span class="keyword">import</span> GenericRelation</span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> system.models <span class="keyword">import</span> ImageRelated</span><br><span class="line"><span class="keyword">from</span> utils.models <span class="keyword">import</span> CommonModel</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sight</span>(<span class="params">CommonModel</span>):</span></span><br><span class="line">    <span class="string">""" 景点基础信息 """</span></span><br><span class="line"></span><br><span class="line">    name = models.CharField(<span class="string">'名称'</span>, max_length=<span class="number">64</span>)</span><br><span class="line">    desc = models.CharField(<span class="string">'描述'</span>, max_length=<span class="number">256</span>)</span><br><span class="line">    main_img = models.ImageField(<span class="string">'主图'</span>, upload_to=<span class="string">'%Y%m/sight/'</span>, max_length=<span class="number">256</span>)</span><br><span class="line">    banner_img = models.ImageField(<span class="string">'详情主图'</span>, upload_to=<span class="string">'%Y%m/sight/'</span>, max_length=<span class="number">256</span>)</span><br><span class="line">    content = models.TextField(<span class="string">'详细'</span>)</span><br><span class="line">    score = models.FloatField(<span class="string">'评分'</span>, default=<span class="number">5</span>)</span><br><span class="line">    min_price = models.FloatField(<span class="string">'最低价格'</span>, default=<span class="number">0</span>)</span><br><span class="line">    province = models.CharField(<span class="string">'省份'</span>, max_length=<span class="number">32</span>)</span><br><span class="line">    city = models.CharField(<span class="string">'市区'</span>, max_length=<span class="number">32</span>)</span><br><span class="line">    area = models.CharField(<span class="string">'区/县'</span>, max_length=<span class="number">32</span>, null=<span class="literal">True</span>)</span><br><span class="line">    town = models.CharField(<span class="string">'乡镇'</span>, max_length=<span class="number">32</span>, null=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    is_top = models.BooleanField(<span class="string">'是否为精选景点'</span>, default=<span class="literal">False</span>)</span><br><span class="line">    is_hot = models.BooleanField(<span class="string">'是否为热门景点'</span>, default=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 反向关联，景点和系统的图片关联上</span></span><br><span class="line">    images = GenericRelation(ImageRelated,</span><br><span class="line">                             verbose_name=<span class="string">'关联的图片'</span>,</span><br><span class="line">                             <span class="comment"># 通过一个景点的模型对象，找到对应id的记录，转换为sight的对象，</span></span><br><span class="line">                             <span class="comment"># 通过其属性找到它的图片</span></span><br><span class="line">                             related_query_name=<span class="string">'rel_sight_iamges'</span>)</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">'sight'</span></span><br><span class="line">        ordering = [<span class="string">'-updated_at'</span>]</span><br></pre></td></tr></tbody></table></figure>

<p>新建<code>sight/choices.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span>  models</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TicketTypes</span>(<span class="params">models.IntegerChoices</span>):</span></span><br><span class="line">    ADULT = <span class="number">11</span>, <span class="string">'成人票'</span></span><br><span class="line">    CHILD = <span class="number">12</span>, <span class="string">'儿童票'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TicketStatus</span>(<span class="params">models.IntegerChoices</span>):</span></span><br><span class="line">    <span class="string">""" 门票的状态 """</span></span><br><span class="line">    OPEN = <span class="number">1</span>, <span class="string">'开放购买'</span></span><br><span class="line">    CLOSED = <span class="number">0</span>, <span class="string">'暂未开放'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EntryWay</span>(<span class="params">models.IntegerChoices</span>):</span></span><br><span class="line">    <span class="string">""" 入园方式 """</span></span><br><span class="line">    BY_TICKET = <span class="number">0</span>, <span class="string">'短信换票入园'</span></span><br><span class="line">    BY_CODE = <span class="number">1</span>, <span class="string">'凭借验证码入园'</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>检测ORM模型</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py check</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>第四步，模型同步<br>`bash<br>python manage.py makemigrations<br>python manage.py migrate</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">### 重构响应对象</span></span><br><span class="line"><span class="comment">#### 开发步骤</span></span><br><span class="line">- 设计响应单个对象的基类  接口返回统一的封装</span><br><span class="line">对象转为字典，再转为json对象</span><br><span class="line">新建`utils/serializers.py`定义两种接口所响应的数据类型， 一个是详情，直接返回响应对象 ，一个是列表，有`meta`和`object`的结构</span><br><span class="line">```python</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaseSerializer</span>(<span class="params">object</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, obj</span>):</span></span><br><span class="line">        self.obj = obj</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_dict</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> {}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MetaSerializer</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="string">""" 分页元数据 """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, page, page_count, total_count, **kwargs</span>):</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :param page: 当前页</span></span><br><span class="line"><span class="string">        :param page_count: 总页数</span></span><br><span class="line"><span class="string">        :param total_count: 总记录数</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.page = page</span><br><span class="line">        self.page_count = page_count</span><br><span class="line">        self.total_count = total_count</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_dict</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="string">'total_count'</span>: self.total_count,</span><br><span class="line">            <span class="string">'page_count'</span>: self.page_count,</span><br><span class="line">            <span class="string">'current_page'</span>: self.page</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaseListPageSerializer</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="string">""" 分页类封装 """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, page_obj, paginator=None, object_list=[]</span>):</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :param page_obj: 当前页的对象</span></span><br><span class="line"><span class="string">        :param paginator: 分页器的对象</span></span><br><span class="line"><span class="string">        :param object_list: 当前页的数据列表</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.page_obj = page_obj</span><br><span class="line">        self.paginator = paginator <span class="keyword">if</span> paginator <span class="keyword">else</span> page_obj.paginator</span><br><span class="line">        self.object_list = object_list <span class="keyword">if</span> object_list <span class="keyword">else</span> page_obj.object_list</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_object</span>(<span class="params">self, obj</span>):</span></span><br><span class="line">        <span class="string">""" 对象的内容，子类重写 """</span></span><br><span class="line">        <span class="keyword">return</span> {}</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_dict</span>(<span class="params">self</span>):</span></span><br><span class="line">        page = self.page_obj.number  <span class="comment"># 当前页</span></span><br><span class="line">        page_count = self.paginator.num_pages  <span class="comment"># 总页数</span></span><br><span class="line">        total_count = self.paginator.count  <span class="comment"># 总记录数</span></span><br><span class="line">        meta = MetaSerializer(page=page, page_count=page_count, total_count=total_count).to_dict()</span><br><span class="line"></span><br><span class="line">        objects = []</span><br><span class="line">        <span class="keyword">for</span> obj <span class="keyword">in</span> self.object_list:</span><br><span class="line">            objects.append(self.get_object(obj))</span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="string">'meta'</span>: meta,</span><br><span class="line">            <span class="string">'objects'</span>: objects</span><br><span class="line">        }</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">`sight/serializers.py`</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line"><span class="keyword">from</span> utils.serializers <span class="keyword">import</span> BaseListPageSerializer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SightListSerializer</span>(<span class="params">BaseListPageSerializer</span>):</span></span><br><span class="line">    <span class="string">""" 景点列表 """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_object</span>(<span class="params">self, obj</span>):</span></span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="string">'id'</span>: obj.id,</span><br><span class="line">            <span class="string">'name'</span>: obj.name,</span><br><span class="line">            <span class="string">'main_img'</span>: obj.main_img.url,</span><br><span class="line">            <span class="string">'score'</span>: obj.score,</span><br><span class="line">            <span class="string">'province'</span>: obj.province,</span><br><span class="line">            <span class="string">'min_price'</span>: obj.min_price,</span><br><span class="line">            <span class="string">'city'</span>: obj.city,</span><br><span class="line">            <span class="comment"># TODO 评论数量暂时无法获取</span></span><br><span class="line">            <span class="string">'comment_count'</span>: <span class="number">0</span></span><br><span class="line">        }</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>设计响应列表对象的基类</p>
</li>
<li><p>设计错误基础类<br><code>utils/response.py</code></p>
</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> JsonResponse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NotFoundJsonResponse</span>(<span class="params">JsonResponse</span>):</span></span><br><span class="line">    <span class="string">""" 400 对应JSON响应 """</span></span><br><span class="line">    status_code = <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line"></span><br><span class="line">        data = {</span><br><span class="line">            <span class="string">"error_code"</span>: <span class="string">"404000"</span>,</span><br><span class="line">            <span class="string">"error_msg"</span>: <span class="string">"您访问的内容不存在或已被删除。"</span></span><br><span class="line">        }</span><br><span class="line">        super().__init__(data, *args, **kwargs)</span><br></pre></td></tr></tbody></table></figure>

<p><code>sight/views.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> http</span><br><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Q</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"><span class="keyword">from</span> django.views.generic <span class="keyword">import</span> ListView</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sight <span class="keyword">import</span> serializers</span><br><span class="line"><span class="keyword">from</span> sight.models <span class="keyword">import</span> Sight</span><br><span class="line"><span class="keyword">from</span> utils.response <span class="keyword">import</span> NotFoundJsonResponse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SightListView</span>(<span class="params">ListView</span>):</span></span><br><span class="line">    <span class="string">""" 景点列表 """</span></span><br><span class="line">    <span class="comment"># 每页放5条数据</span></span><br><span class="line">    paginate_by = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">""" 重写查询方法 """</span></span><br><span class="line">        query = Q(is_valid=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># 1. 热门景点</span></span><br><span class="line">        is_hot = self.request.GET.get(<span class="string">'is_hot'</span>, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> is_hot:</span><br><span class="line">            query = query &amp; Q(is_hot=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># 2. 精选景点</span></span><br><span class="line">        is_top = self.request.GET.get(<span class="string">'is_top'</span>, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> is_top:</span><br><span class="line">            query = query &amp; Q(is_top=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># TODO 3. 景点名称搜索</span></span><br><span class="line">        queryset = Sight.objects.filter(query)</span><br><span class="line">        <span class="keyword">return</span> queryset</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">render_to_response</span>(<span class="params">self, context, **response_kwargs</span>):</span></span><br><span class="line">        page_obj = context[<span class="string">'page_obj'</span>]  <span class="comment"># 当前页的对象</span></span><br><span class="line">        <span class="keyword">if</span> page_obj:</span><br><span class="line">            data = serializers.SightListSerializer(page_obj).to_dict()</span><br><span class="line">            <span class="keyword">return</span> http.JsonResponse(data)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> NotFoundJsonResponse()</span><br></pre></td></tr></tbody></table></figure>

<h3 id="景点详情接口开发"><a href="#景点详情接口开发" class="headerlink" title="景点详情接口开发"></a>景点详情接口开发</h3><h4 id="开发步骤"><a href="#开发步骤" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li><p>设计接口返回内容及字段</p>
</li>
<li><p>编写接口代码<br><code>sight/urls.py</code></p>
</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sight <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    <span class="comment"># 2.2 景点详细信息</span></span><br><span class="line">    path(<span class="string">'sight/detail/&lt;int:pk&gt;/'</span>, views.SightDetailView.as_view(), name=<span class="string">"sight_detail"</span>),</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

<p><code>sight/serializers.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> utils.serializers <span class="keyword">import</span> BaseSerializer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SightDetailSerializer</span>(<span class="params">BaseSerializer</span>):</span></span><br><span class="line">    <span class="string">""" 景点详情 """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_dict</span>(<span class="params">self</span>):</span></span><br><span class="line">        obj = self.obj</span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="string">'id'</span>: obj.id,</span><br><span class="line">            <span class="string">'name'</span>: obj.name,</span><br><span class="line">            <span class="string">'desc'</span>: obj.desc,</span><br><span class="line">            <span class="string">'img'</span>: obj.banner_img.url,</span><br><span class="line">            <span class="string">'content'</span>: obj.content,</span><br><span class="line">            <span class="string">'score'</span>: obj.score,</span><br><span class="line">            <span class="string">'min_price'</span>: obj.min_price,</span><br><span class="line">            <span class="string">'province'</span>: obj.province,</span><br><span class="line">            <span class="string">'city'</span>: obj.city,</span><br><span class="line">            <span class="string">'area'</span>: obj.area,</span><br><span class="line">            <span class="string">'town'</span>: obj.town,</span><br><span class="line">            <span class="comment"># TODO 评论数量暂时无法获取</span></span><br><span class="line">            <span class="string">'comment_count'</span>: <span class="number">0</span></span><br><span class="line">        }</span><br></pre></td></tr></tbody></table></figure>

<p><code>sight/views.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.views.generic <span class="keyword">import</span> DetailView</span><br><span class="line"><span class="keyword">from</span> sight.models <span class="keyword">import</span> Sight</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SightDetailView</span>(<span class="params">DetailView</span>):</span></span><br><span class="line">    <span class="string">""" 2.2 景点详细信息 """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># return Sight.objects.filter(is_valid=True)</span></span><br><span class="line">        <span class="keyword">return</span> Sight.objects.all()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">render_to_response</span>(<span class="params">self, context, **response_kwargs</span>):</span></span><br><span class="line">        page_obj = context[<span class="string">'object'</span>]</span><br><span class="line">        <span class="keyword">if</span> page_obj:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> page_obj.is_valid:</span><br><span class="line">                <span class="keyword">return</span> NotFoundJsonResponse()</span><br><span class="line">            data = serializers.SightDetailSerializer(page_obj).to_dict()</span><br><span class="line">            <span class="keyword">return</span> http.JsonResponse(data)</span><br><span class="line">        <span class="keyword">return</span> NotFoundJsonResponse()</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>模拟HTTP请求，测试验证接口</li>
</ul>
<h3 id="景点评论列表接口开发"><a href="#景点评论列表接口开发" class="headerlink" title="景点评论列表接口开发"></a>景点评论列表接口开发</h3><h4 id="开发步骤-1"><a href="#开发步骤-1" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li>设计接口返回内容及字段</li>
</ul>
<p><code>sight/urls.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sight <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    <span class="comment"># 2.3 景点下的评论列表</span></span><br><span class="line">    path(<span class="string">'comment/list/&lt;int:pk&gt;/'</span>, views.SightCommentListView.as_view(), name=<span class="string">"sight_comment_list"</span>),</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

<p>新建<code>system/serializers.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> utils.serializers <span class="keyword">import</span> BaseSerializer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BaseImageSerializer</span>(<span class="params">BaseSerializer</span>):</span></span><br><span class="line">    <span class="string">""" 序列化基础图片：其它列表需要引用到时使用 """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_dict</span>(<span class="params">self</span>):</span></span><br><span class="line">        image = self.obj</span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="string">'img'</span>: image.img.url,</span><br><span class="line">            <span class="string">'summary'</span>: image.summary</span><br><span class="line">        }</span><br></pre></td></tr></tbody></table></figure>

<p><code>sight/serializers.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> system.serializers <span class="keyword">import</span> BaseImageSerializer</span><br><span class="line"><span class="keyword">from</span> utils.serializers <span class="keyword">import</span> BaseListPageSerializer</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommentListSerializer</span>(<span class="params">BaseListPageSerializer</span>):</span></span><br><span class="line">    <span class="string">""" 评论列表 """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_object</span>(<span class="params">self, obj</span>):</span></span><br><span class="line">        user = obj.user</span><br><span class="line">        images = []</span><br><span class="line">        <span class="keyword">for</span> image <span class="keyword">in</span> obj.images.filter(is_valid=<span class="literal">True</span>):</span><br><span class="line">            images.append(BaseImageSerializer(image).to_dict())</span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="string">'user'</span>: {</span><br><span class="line">                <span class="string">'pk'</span>: user.pk,</span><br><span class="line">                <span class="string">'nickname'</span>: user.nickname</span><br><span class="line">            },</span><br><span class="line">            <span class="string">'pk'</span>: obj.pk,</span><br><span class="line">            <span class="string">'content'</span>: obj.content,</span><br><span class="line">            <span class="string">'is_top'</span>: obj.is_top,</span><br><span class="line">            <span class="string">'love_count'</span>: obj.love_count,</span><br><span class="line">            <span class="string">'score'</span>: obj.score,</span><br><span class="line">            <span class="string">'is_public'</span>: obj.is_public,</span><br><span class="line">            <span class="string">'images'</span>: images,</span><br><span class="line">            <span class="string">'created_at'</span>: obj.created_at.strftime(<span class="string">'%Y-%m-%d'</span>)</span><br><span class="line">        }</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>编写接口代码<br><code>sight/views.py</code></li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sight.models <span class="keyword">import</span> Comment</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SightCommentListView</span>(<span class="params">ListView</span>):</span></span><br><span class="line">    <span class="string">""" 2.3 景点下的评论列表 """</span></span><br><span class="line">    paginate_by = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># 根据景点ID查询景点</span></span><br><span class="line">        sight_id = self.kwargs.get(<span class="string">'pk'</span>, <span class="literal">None</span>)</span><br><span class="line">        sight = Sight.objects.filter(pk=sight_id, is_valid=<span class="literal">True</span>).first()</span><br><span class="line">        <span class="keyword">if</span> sight:</span><br><span class="line">            <span class="comment"># return Comment.objects.filter(is_valid=True, sight=sight)</span></span><br><span class="line">            <span class="keyword">return</span> sight.comments.filter(is_valid=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> Comment.objects.none()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">render_to_response</span>(<span class="params">self, context, **response_kwargs</span>):</span></span><br><span class="line">        <span class="string">""" 重写响应的返回 """</span></span><br><span class="line">        page_obj = context[<span class="string">'page_obj'</span>]  <span class="comment"># 分页的某一页对象</span></span><br><span class="line">        <span class="keyword">if</span> page_obj:</span><br><span class="line">            data = serializers.CommentListSerializer(page_obj).to_dict()</span><br><span class="line">            <span class="keyword">return</span> http.JsonResponse(data)</span><br><span class="line">        <span class="keyword">return</span> NotFoundJsonResponse()</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>模拟HTTP请求，测试验证接口</li>
</ul>
<h3 id="门票列表接口开发"><a href="#门票列表接口开发" class="headerlink" title="门票列表接口开发"></a>门票列表接口开发</h3><h4 id="开发步骤-2"><a href="#开发步骤-2" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li><p>设计接口返回内容及字段</p>
<p><code>sight/urls.py</code></p>
</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sight <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    <span class="comment"># 2.4 景点下的门票列表</span></span><br><span class="line">    path(<span class="string">'ticket/list/&lt;int:pk&gt;/'</span>, views.SightTicketListView.as_view(), name=<span class="string">"sight_ticket_list"</span>),</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

<p><code>sight/serializers.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> utils.serializers <span class="keyword">import</span> BaseListPageSerializer</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TicketListSerializer</span>(<span class="params">BaseListPageSerializer</span>):</span></span><br><span class="line">    <span class="string">""" 门票列表 """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_object</span>(<span class="params">self, obj</span>):</span></span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="string">'pk'</span>: obj.pk,</span><br><span class="line">            <span class="string">'name'</span>: obj.name,</span><br><span class="line">            <span class="string">'desc'</span>: obj.desc,</span><br><span class="line">            <span class="string">'types'</span>: obj.types,</span><br><span class="line">            <span class="string">'price'</span>: obj.price,</span><br><span class="line">            <span class="string">'discount'</span>: obj.discount,</span><br><span class="line">            <span class="string">'total_stock'</span>: obj.total_stock,</span><br><span class="line">            <span class="string">'remain_stock'</span>: obj.remain_stock</span><br><span class="line">        }</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>编写接口代码<br><code>sight/views.py</code></li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sight.models <span class="keyword">import</span> Ticket</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SightTicketListView</span>(<span class="params">ListView</span>):</span></span><br><span class="line">    <span class="string">""" 2.4 景点下的门票列表 """</span></span><br><span class="line"></span><br><span class="line">    paginate_by = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># 根据景点ID查询景点</span></span><br><span class="line">        sight_id = self.kwargs.get(<span class="string">'pk'</span>, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">return</span> Ticket.objects.filter(is_valid=<span class="literal">True</span>, sight__id=sight_id)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">render_to_response</span>(<span class="params">self, context, **response_kwargs</span>):</span></span><br><span class="line">        <span class="string">""" 重写响应的返回 """</span></span><br><span class="line">        page_obj = context[<span class="string">'page_obj'</span>]</span><br><span class="line">        <span class="keyword">if</span> page_obj <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            data = serializers.TicketListSerializer(page_obj).to_dict()</span><br><span class="line">            <span class="keyword">return</span> http.JsonResponse(data)</span><br><span class="line">        <span class="keyword">return</span> NotFoundJsonResponse()</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>模拟HTTP请求，测试验证接口</li>
</ul>
<h3 id="景点介绍接口开发"><a href="#景点介绍接口开发" class="headerlink" title="景点介绍接口开发"></a>景点介绍接口开发</h3><h4 id="开发步骤-3"><a href="#开发步骤-3" class="headerlink" title="开发步骤"></a>开发步骤</h4><ul>
<li>设计接口返回内容及字段</li>
</ul>
<p><code>sight/urls.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sight <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    <span class="comment"># 2.5 景点介绍</span></span><br><span class="line">    path(<span class="string">'sight/info/&lt;int:pk&gt;/'</span>, views.SightInfoDetailView.as_view(), name=<span class="string">"sight_info"</span>),</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>

<p><code>sight/serializers.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> utils.serializers <span class="keyword">import</span> BaseListPageSerializer</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SightInfoSerializer</span>(<span class="params">BaseSerializer</span>):</span></span><br><span class="line">    <span class="string">""" 景点介绍 """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_dict</span>(<span class="params">self</span>):</span></span><br><span class="line">        obj = self.obj</span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="string">'pk'</span>: obj.sight.pk,  <span class="comment"># 景点ID</span></span><br><span class="line">            <span class="string">'entry_explain'</span>: obj.entry_explain,</span><br><span class="line">            <span class="string">'play_way'</span>: obj.play_way,</span><br><span class="line">            <span class="string">'tips'</span>: obj.tips,</span><br><span class="line">            <span class="string">'traffic'</span>: obj.traffic,</span><br><span class="line">        }</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li><p>编写接口代码<br><code>sight/views.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sight.models <span class="keyword">import</span> Info</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SightInfoDetailView</span>(<span class="params">DetailView</span>):</span></span><br><span class="line">    <span class="string">""" 2.5 景点介绍 """</span></span><br><span class="line">    slug_field = <span class="string">'sight__pk'</span>  <span class="comment"># url传递过来的这个变化的参数指代的是哪个字段</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> Info.objects.all()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">render_to_response</span>(<span class="params">self, context, **response_kwargs</span>):</span></span><br><span class="line">        page_obj = context[<span class="string">'object'</span>]</span><br><span class="line">        <span class="keyword">if</span> page_obj:</span><br><span class="line">            data = serializers.SightInfoSerializer(page_obj).to_dict()</span><br><span class="line">            <span class="keyword">return</span> http.JsonResponse(data)</span><br><span class="line">        <span class="keyword">return</span> NotFoundJsonResponse()</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>模拟HTTP请求，测试验证接口</p>
</li>
</ul>
<h3 id="景点搜索接口联调"><a href="#景点搜索接口联调" class="headerlink" title="景点搜索接口联调"></a>景点搜索接口联调</h3><h4 id="实现步骤-5"><a href="#实现步骤-5" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li><p>修改景点列表接口，支持搜索</p>
<p><code>sight/views.py</code></p>
</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Q</span><br><span class="line"><span class="keyword">from</span> django.views.generic <span class="keyword">import</span> ListView</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SightListView</span>(<span class="params">ListView</span>):</span></span><br><span class="line">    <span class="string">""" 景点列表 """</span></span><br><span class="line">    <span class="comment"># 每页放5条数据</span></span><br><span class="line">    paginate_by = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_queryset</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">""" 重写查询方法 """</span></span><br><span class="line">        query = Q(is_valid=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># 3. 景点名称搜索</span></span><br><span class="line">        name = self.request.GET.get(<span class="string">'name'</span>, <span class="literal">None</span>)  <span class="comment"># 从前端获取搜索字段</span></span><br><span class="line">        <span class="keyword">if</span> name:</span><br><span class="line">            query = query &amp; Q(name__icontains=name)  <span class="comment"># 景点名称是否包含搜索字段</span></span><br><span class="line">        queryset = Sight.objects.filter(query)</span><br><span class="line">        <span class="keyword">return</span> queryset</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_paginate_by</span>(<span class="params">self, queryset</span>):</span></span><br><span class="line">        <span class="string">""" 从前端控制每一页的分页大小 """</span></span><br><span class="line">        page_size = self.request.GET.get(<span class="string">'limit'</span>, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">return</span> page_size <span class="keyword">or</span> self.paginate_by</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>配置接口地址<br>从首页底部点击搜索，保留底部组件，查询所有<br>从首页点击热门推荐和精选节点更多，去掉底部组件，增加左上角返回按钮，只查询热门推荐和精选景点</li>
</ul>
<p><code>src\components\home\Hot.vue</code><br>`vue<br><template><br>  <!-- 热门景点 --><br>  <div class="home-hot-box"><br>    <!-- 顶上导航 --><br>    <van-cell title="热门推荐" icon="/static/home/hot/fire.png" is-link title-style="text-align:left" value="全部榜单" :to="{name: 'Search', query: {isHot: 1}}"><br>    <!-- // 顶上导航 --><br>  </van-cell></div><br></template></p>
<figure class="highlight xquery"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">`src\components\home\Fine.vue`</span><br><span class="line">```vue</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="comment">&lt;!-- 精选景点 --&gt;</span></span></span><br><span class="line"><span class="xml">  </span><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"home-fine-box"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- 顶上导航 --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">van-cell</span></span></span></span><br><span class="line"><span class="xml">      title="精选景点"</span></span><br><span class="line"><span class="xml">      icon="location-o"</span></span><br><span class="line"><span class="xml">      is-link</span></span><br><span class="line"><span class="xml">      title-style="text-align:left"</span></span><br><span class="line"><span class="xml">      value="更多"</span></span><br><span class="line"><span class="xml">      :to="</span><span class="xquery"><span class="built_in">{name</span>: <span class="string">'Search'</span>, query: {isTop: <span class="number">1</span>}</span><span class="xml">}"/&gt;</span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- // 顶上导航 --&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></tbody></table></figure>

<p><code>src\views\Search.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 搜索页面 --&gt;</span><br><span class="line">  &lt;div class="page-search"&gt;</span><br><span class="line">    &lt;!-- 标题 --&gt;</span><br><span class="line">    &lt;van-nav-bar title="搜索景点"</span><br><span class="line">      left-text="返回"</span><br><span class="line">      left-arrow</span><br><span class="line">      @click-left="goBack"</span><br><span class="line">      v-if="isHome"/&gt;</span><br><span class="line">    &lt;van-nav-bar title="搜索景点" v-else/&gt;</span><br><span class="line">    &lt;!-- 搜索框 --&gt;</span><br><span class="line">    &lt;van-search</span><br><span class="line">      v-model="sightName"</span><br><span class="line">      show-action</span><br><span class="line">      label="景点"</span><br><span class="line">      placeholder="请输入搜索关键词"</span><br><span class="line">      @search="onSearch"</span><br><span class="line">      @clear="clear"</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;template #action&gt;</span><br><span class="line">        &lt;div @click="onSearch"&gt;搜索&lt;/div&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/van-search&gt;</span><br><span class="line"></span><br><span class="line">    &lt;h2 v-if="isHot"&gt;热门推荐&lt;/h2&gt;</span><br><span class="line">    &lt;h2 v-if="isTop"&gt;精选景点&lt;/h2&gt;</span><br><span class="line">    &lt;!-- 景点列表 --&gt;</span><br><span class="line">    &lt;div class="sight-list"&gt;</span><br><span class="line">      &lt;sight-item v-for="item in dataList"</span><br><span class="line">        :key="item.id"</span><br><span class="line">        :item="item"/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 分页 --&gt;</span><br><span class="line">    &lt;van-pagination</span><br><span class="line">    v-model="currentPage"</span><br><span class="line">    :total-items="totalItems"</span><br><span class="line">    :items-per-page="perPage"</span><br><span class="line">    @change="pageChange" /&gt;</span><br><span class="line">    &lt;!-- 底部导航 --&gt;</span><br><span class="line">    &lt;TripFooter v-if="!isHome"/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import { ajax } from '@/utils/ajax'</span><br><span class="line">import { SightApis } from '@/utils/apis'</span><br><span class="line">// 景点列表的每一项</span><br><span class="line">import SightItem from '@/components/common/ListSight'</span><br><span class="line">// 底部导航</span><br><span class="line">import TripFooter from '@/components/common/Footer'</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      // 景点名称</span><br><span class="line">      sightName: '',</span><br><span class="line">      // 景点列表的数据</span><br><span class="line">      dataList: [],</span><br><span class="line">      // 总记录数</span><br><span class="line">      totalItems: 0,</span><br><span class="line">      // 当前的页码</span><br><span class="line">      currentPage: 1,</span><br><span class="line">      // 每页数据的大小</span><br><span class="line">      perPage: 4,</span><br><span class="line">      // 热门景点和精选景点</span><br><span class="line">      isHot: '',</span><br><span class="line">      isTop: ''</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  components: {</span><br><span class="line">    SightItem,</span><br><span class="line">    TripFooter</span><br><span class="line">  },</span><br><span class="line">  computed: {</span><br><span class="line">    /**</span><br><span class="line">     * 是否从首页过来</span><br><span class="line">     */</span><br><span class="line">    isHome () {</span><br><span class="line">      return this.isHot || this.isTop</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    goBack () {</span><br><span class="line">      this.$router.go(-1)</span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * 景点列表接口</span><br><span class="line">     */</span><br><span class="line">    getDataList () {</span><br><span class="line">      ajax.get(SightApis.sightListUrl, {</span><br><span class="line">        params: {</span><br><span class="line">          page: this.currentPage,</span><br><span class="line">          name: this.sightName,</span><br><span class="line">          limit: this.perPage,</span><br><span class="line">          is_top: this.isTop,</span><br><span class="line">          is_hot: this.isHot</span><br><span class="line">        }</span><br><span class="line">      }).then(({ data: { meta, objects } }) =&gt; {</span><br><span class="line">        this.dataList = objects</span><br><span class="line">        // 总记录数</span><br><span class="line">        this.totalItems = meta.total_count</span><br><span class="line">      })</span><br><span class="line">    },</span><br><span class="line">    clear () {</span><br><span class="line">      this.dataList = []</span><br><span class="line">      this.currentPage = 1</span><br><span class="line">      this.getDataList()</span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * 页码发生变化后调用</span><br><span class="line">     */</span><br><span class="line">    pageChange () {</span><br><span class="line">      this.getDataList()</span><br><span class="line">    },</span><br><span class="line">    onSearch () {</span><br><span class="line">      console.log('onSearch ')</span><br><span class="line">      // 判断搜索内容是否为空</span><br><span class="line">      if (!this.sightName) {</span><br><span class="line">        this.$toast('请输入搜索词') // 弹框提示</span><br><span class="line">        return</span><br><span class="line">      }</span><br><span class="line">      // 重置数据</span><br><span class="line">      this.dataList = []</span><br><span class="line">      this.currentPage = 1</span><br><span class="line">      // 执行查询</span><br><span class="line">      this.getDataList()</span><br><span class="line">    }</span><br><span class="line">  },  </span><br><span class="line">  mounted () {</span><br><span class="line">    // 热门景点和精选景点</span><br><span class="line">    this.isHot = this.$route.query.isHot</span><br><span class="line">    this.isTop = this.$route.query.isTop</span><br><span class="line">    this.getDataList()</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>使用axios获取数据</li>
<li>将数据设置到模型层</li>
</ul>
<h3 id="景点详情和评论接口联调"><a href="#景点详情和评论接口联调" class="headerlink" title="景点详情和评论接口联调"></a>景点详情和评论接口联调</h3><h4 id="实现步骤-6"><a href="#实现步骤-6" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li>阅读接口文档</li>
<li>配置接口地址<br><code>src\utils\apis.js</code></li>
</ul>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 景点模块</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> SightApis = {</span><br><span class="line">  <span class="comment">// 景点列表</span></span><br><span class="line">  sightListUrl: apiHost + <span class="string">'/sight/sight/list/'</span>,</span><br><span class="line">  <span class="comment">// 景点详情</span></span><br><span class="line">  sightDetailUrl: apiHost + <span class="string">'/sight/sight/detail/#{id}/'</span>,</span><br><span class="line">  <span class="comment">// 门票列表</span></span><br><span class="line">  sightTicketUrl: apiHost + <span class="string">'/sight/ticket/list/#{id}/'</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><code>src\views\sight\SightDetail.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 景点详情 --&gt;</span><br><span class="line">  &lt;div class="page-sight-detail"&gt;</span><br><span class="line">    &lt;!-- 大图 --&gt;</span><br><span class="line">    &lt;div class="sight-banner"&gt;</span><br><span class="line">      &lt;van-image :src="sightDetail.img" width="100%" height="100%"/&gt;</span><br><span class="line">      &lt;div class="tips"&gt;</span><br><span class="line">        &lt;router-link class="pic-sts" :to="{name: 'SightImage', params: {id}}"&gt;</span><br><span class="line">          &lt;van-icon name="video-o" /&gt;</span><br><span class="line">          &lt;span&gt;{{ sightDetail.image_count }} 图片&lt;/span&gt;</span><br><span class="line">        &lt;/router-link&gt;</span><br><span class="line">        &lt;div class="title"&gt;{{ sightDetail.name }}&lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //大图 --&gt;</span><br><span class="line">    &lt;!-- 评分、景点介绍 --&gt;</span><br><span class="line">    &lt;div class="sight-info"&gt;</span><br><span class="line">      &lt;div class="left"&gt;</span><br><span class="line">        &lt;div class="info-title"&gt;</span><br><span class="line">          &lt;strong&gt;{{ sightDetail.score }}分&lt;/strong&gt;</span><br><span class="line">          &lt;small&gt;很棒&lt;/small&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class="info-tips"&gt;{{ sightDetail.comment_count }} 评论&lt;/div&gt;</span><br><span class="line">        &lt;van-icon name="arrow" /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class="right"&gt;</span><br><span class="line">        &lt;div class="info-title"&gt;</span><br><span class="line">          &lt;span&gt;景点介绍&lt;/span&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class="info-tips"&gt;开放时间、贴士&lt;/div&gt;</span><br><span class="line">        &lt;van-icon name="arrow" /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //评分、景点介绍 --&gt;</span><br><span class="line">    &lt;!-- 门票列表 --&gt;</span><br><span class="line">    &lt;div class="sight-ticket"&gt;</span><br><span class="line">      &lt;van-cell title="门票" icon="bookmark-o" title-style="text-align:left"/&gt;</span><br><span class="line">      &lt;div class="ticket-item" v-for="item in ticketList" :key="item.pk"&gt;</span><br><span class="line">        &lt;div class="left"&gt;</span><br><span class="line">          &lt;div class="title"&gt;{{ item.name }}&lt;/div&gt;</span><br><span class="line">          &lt;div class="tips"&gt;</span><br><span class="line">            &lt;van-icon name="clock-o" /&gt;</span><br><span class="line">            &lt;span&gt;{{ item.desc }}&lt;/span&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class="tags"&gt;</span><br><span class="line">            &lt;van-tag mark type="primary"&gt;标签1&lt;/van-tag&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class="right"&gt;</span><br><span class="line">          &lt;div class="price"&gt;</span><br><span class="line">            &lt;span&gt;￥&lt;/span&gt;</span><br><span class="line">            &lt;strong&gt;{{ item.sell_price }}&lt;/strong&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;router-link to="#"&gt;</span><br><span class="line">            &lt;van-button type="warning" size="small"&gt;预定&lt;/van-button&gt;</span><br><span class="line">          &lt;/router-link&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //门票列表 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import { ajax } from '@/utils/ajax'</span><br><span class="line">import { SightApis } from '@/utils/apis'</span><br><span class="line">// 评论项组件</span><br><span class="line">import CommentItem from '@/components/sight/CommentItem'</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      id: '',</span><br><span class="line">      // 景点详细信息</span><br><span class="line">      sightDetail: {},</span><br><span class="line">      // 门票列表</span><br><span class="line">      ticketList: []</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  components: {</span><br><span class="line">    CommentItem</span><br><span class="line">  },</span><br><span class="line">  computed: {</span><br><span class="line">    /**</span><br><span class="line">     * 地址的全部信息</span><br><span class="line">     */</span><br><span class="line">    fullArea () {</span><br><span class="line">      let area = this.sightDetail.province + this.sightDetail.city</span><br><span class="line">      if (this.sightDetail.area) {</span><br><span class="line">        area += this.sightDetail.area</span><br><span class="line">      }</span><br><span class="line">      if (this.sightDetail.town) {</span><br><span class="line">        area += this.sightDetail.town</span><br><span class="line">      }</span><br><span class="line">      return area</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    goBack () {</span><br><span class="line">      this.$router.go(-1)</span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * 获取景点详细信息</span><br><span class="line">     */</span><br><span class="line">    getSightDetail () {</span><br><span class="line">      const url = SightApis.sightDetailUrl.replace('#{id}', this.id)</span><br><span class="line">      ajax.get(url).then(({ data }) =&gt; {</span><br><span class="line">        this.sightDetail = data</span><br><span class="line">      })</span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">      * 门票列表</span><br><span class="line">      */</span><br><span class="line">    getTicketList () {</span><br><span class="line">      const url = SightApis.sightTicketUrl.replace('#{id}', this.id)</span><br><span class="line">      ajax.get(url).then(({ data: { objects } }) =&gt; {</span><br><span class="line">        this.ticketList = objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    this.id = this.$route.params.id</span><br><span class="line">    // 获取景点详细信息</span><br><span class="line">    this.getSightDetail()</span><br><span class="line">    // 获取门票列表</span><br><span class="line">    this.getTicketList()</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>详情页的图片数量和评论数量<br><code>sight/models.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.contenttypes.fields <span class="keyword">import</span> GenericRelation</span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> accounts.models <span class="keyword">import</span> User</span><br><span class="line"><span class="keyword">from</span> system.models <span class="keyword">import</span> ImageRelated</span><br><span class="line"><span class="keyword">from</span> sight.choices <span class="keyword">import</span> TicketTypes, EntryWay, TicketStatus</span><br><span class="line"><span class="keyword">from</span> utils.models <span class="keyword">import</span> CommonModel</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sight</span>(<span class="params">CommonModel</span>):</span></span><br><span class="line">    <span class="string">""" 景点基础信息 """</span></span><br><span class="line"></span><br><span class="line">    name = models.CharField(<span class="string">'名称'</span>, max_length=<span class="number">64</span>)</span><br><span class="line">    desc = models.CharField(<span class="string">'描述'</span>, max_length=<span class="number">256</span>)</span><br><span class="line">    main_img = models.ImageField(<span class="string">'主图'</span>, upload_to=<span class="string">'%Y%m/sight/'</span>, max_length=<span class="number">256</span>)</span><br><span class="line">    banner_img = models.ImageField(<span class="string">'详情主图'</span>, upload_to=<span class="string">'%Y%m/sight/'</span>, max_length=<span class="number">256</span>)</span><br><span class="line">    content = models.TextField(<span class="string">'详细'</span>)</span><br><span class="line">    score = models.FloatField(<span class="string">'评分'</span>, default=<span class="number">5</span>)</span><br><span class="line">    min_price = models.FloatField(<span class="string">'最低价格'</span>, default=<span class="number">0</span>)</span><br><span class="line">    province = models.CharField(<span class="string">'省份'</span>, max_length=<span class="number">32</span>)</span><br><span class="line">    city = models.CharField(<span class="string">'市区'</span>, max_length=<span class="number">32</span>)</span><br><span class="line">    area = models.CharField(<span class="string">'区/县'</span>, max_length=<span class="number">32</span>, null=<span class="literal">True</span>)</span><br><span class="line">    town = models.CharField(<span class="string">'乡镇'</span>, max_length=<span class="number">32</span>, null=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    is_top = models.BooleanField(<span class="string">'是否为精选景点'</span>, default=<span class="literal">False</span>)</span><br><span class="line">    is_hot = models.BooleanField(<span class="string">'是否为热门景点'</span>, default=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 反向关联，景点和系统的图片关联上</span></span><br><span class="line">    images = GenericRelation(ImageRelated,</span><br><span class="line">                             verbose_name=<span class="string">'关联的图片'</span>,</span><br><span class="line">                             <span class="comment"># 通过一个景点的模型对象，找到对应id的记录，转换为sight的对象，</span></span><br><span class="line">                             <span class="comment"># 通过其属性找到它的图片</span></span><br><span class="line">                             related_query_name=<span class="string">'rel_sight_iamges'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">'sight'</span></span><br><span class="line">        ordering = [<span class="string">'-updated_at'</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">comment_count</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">""" 评论总数 """</span></span><br><span class="line">        <span class="keyword">return</span> self.comments.filter(is_valid=<span class="literal">True</span>).count()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">image_count</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">""" 景点图片的数量 """</span></span><br><span class="line">        <span class="keyword">return</span> self.images.filter(is_valid=<span class="literal">True</span>).count()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Info</span>(<span class="params">models.Model</span>):</span></span><br><span class="line">    <span class="string">""" 景点详情 """</span></span><br><span class="line">    sight = models.OneToOneField(Sight, on_delete=models.CASCADE)</span><br><span class="line">    entry_explain = models.CharField(<span class="string">'入园参考'</span>, max_length=<span class="number">1024</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    play_way = models.TextField(<span class="string">'特色玩法'</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    tips = models.TextField(<span class="string">'温馨提示'</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    traffic = models.TextField(<span class="string">'交通到达'</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">'sight_info'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ticket</span>(<span class="params">CommonModel</span>):</span></span><br><span class="line">    <span class="string">""" 门票 """</span></span><br><span class="line">    sight = models.ForeignKey(Sight, related_name=<span class="string">'tickets'</span>, verbose_name=<span class="string">'景点门票'</span>,</span><br><span class="line">                              on_delete=models.PROTECT)</span><br><span class="line">    name = models.CharField(<span class="string">'名称'</span>, max_length=<span class="number">128</span>)</span><br><span class="line">    desc = models.CharField(<span class="string">'描述'</span>, max_length=<span class="number">64</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    types = models.SmallIntegerField(<span class="string">'类型'</span>,</span><br><span class="line">                                     choices=TicketTypes.choices,</span><br><span class="line">                                     default=TicketTypes.ADULT,</span><br><span class="line">                                     help_text=<span class="string">'默认为成人票'</span>)</span><br><span class="line">    price = models.FloatField(<span class="string">'价格（原价）'</span>)</span><br><span class="line">    discount = models.FloatField(<span class="string">'折扣'</span>, default=<span class="number">10</span>)</span><br><span class="line">    total_stock = models.PositiveIntegerField(<span class="string">'总库存'</span>, default=<span class="number">0</span>)</span><br><span class="line">    remain_stock = models.PositiveIntegerField(<span class="string">'剩余库存'</span>, default=<span class="number">0</span>)</span><br><span class="line">    expire_date = models.IntegerField(<span class="string">'有效期'</span>, default=<span class="number">1</span>)</span><br><span class="line">    return_policy = models.CharField(<span class="string">'退改政策'</span>, max_length=<span class="number">64</span>, default=<span class="string">'条件退'</span>)</span><br><span class="line">    has_invoice = models.BooleanField(<span class="string">'是否提供发票'</span>, default=<span class="literal">True</span>)</span><br><span class="line">    entry_way = models.SmallIntegerField(<span class="string">'入园方式'</span>,</span><br><span class="line">                                         choices=EntryWay.choices,</span><br><span class="line">                                         default=EntryWay.BY_TICKET)</span><br><span class="line">    tips = models.TextField(<span class="string">'预定须知'</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    remark = models.TextField(<span class="string">'其他说明'</span>, null=<span class="literal">True</span>, blank=<span class="literal">True</span>)</span><br><span class="line">    status = models.SmallIntegerField(<span class="string">'状态'</span>,</span><br><span class="line">                                      choices=TicketStatus.choices,</span><br><span class="line">                                      default=TicketStatus.OPEN)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">'sight_ticket'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sell_price</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">""" 销售价 = 原价 x 折扣 """</span></span><br><span class="line">        <span class="keyword">return</span> self.price * self.discount / <span class="number">10</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Comment</span>(<span class="params">CommonModel</span>):</span></span><br><span class="line">    <span class="string">""" 评论及回复 """</span></span><br><span class="line">    <span class="comment"># 评论关联到用户</span></span><br><span class="line">    user = models.ForeignKey(User, verbose_name=<span class="string">'评论人'</span>,</span><br><span class="line">                             related_name=<span class="string">'comments'</span>,</span><br><span class="line">                             on_delete=models.CASCADE)</span><br><span class="line">    <span class="comment"># 评论关联到景点</span></span><br><span class="line">    sight = models.ForeignKey(Sight, verbose_name=<span class="string">'景点'</span>,</span><br><span class="line">                              related_name=<span class="string">'comments'</span>,</span><br><span class="line">                              on_delete=models.CASCADE)</span><br><span class="line">    content = models.TextField(<span class="string">'评论内容'</span>, blank=<span class="literal">True</span>, null=<span class="literal">True</span>)</span><br><span class="line">    is_top = models.BooleanField(<span class="string">'是否置顶'</span>, default=<span class="literal">False</span>)</span><br><span class="line">    love_count = models.IntegerField(<span class="string">'点赞次数'</span>, default=<span class="number">0</span>)</span><br><span class="line">    score = models.FloatField(<span class="string">'评分'</span>, default=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    ip_address = models.CharField(<span class="string">'IP地址'</span>, blank=<span class="literal">True</span>, null=<span class="literal">True</span>, max_length=<span class="number">64</span>)</span><br><span class="line">    is_public = models.SmallIntegerField(<span class="string">'是否公开'</span>, default=<span class="number">1</span>)</span><br><span class="line">    reply = models.ForeignKey(</span><br><span class="line">        <span class="string">'self'</span>, blank=<span class="literal">True</span>, null=<span class="literal">True</span>,</span><br><span class="line">        related_name=<span class="string">'reply_comment'</span>,</span><br><span class="line">        verbose_name=<span class="string">'回复'</span>,</span><br><span class="line">        on_delete=models.CASCADE)</span><br><span class="line">    <span class="comment"># 反向关联，评论和系统的图片关联上</span></span><br><span class="line">    images = GenericRelation(ImageRelated,</span><br><span class="line">                             verbose_name=<span class="string">'关联的图片'</span>,</span><br><span class="line">                             related_query_name=<span class="string">"rel_comment_images"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></span><br><span class="line">        db_table = <span class="string">'sight_comment'</span></span><br><span class="line">        ordering = [<span class="string">'-love_count'</span>, <span class="string">'-created_at'</span>]</span><br></pre></td></tr></tbody></table></figure>

<p><code>sight/serializers.py</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SightListSerializer</span>(<span class="params">BaseListPageSerializer</span>):</span></span><br><span class="line">    <span class="string">""" 景点列表 """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_object</span>(<span class="params">self, obj</span>):</span></span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="string">'id'</span>: obj.id,</span><br><span class="line">            <span class="string">'name'</span>: obj.name,</span><br><span class="line">            <span class="string">'main_img'</span>: obj.main_img.url,</span><br><span class="line">            <span class="string">'score'</span>: obj.score,</span><br><span class="line">            <span class="string">'province'</span>: obj.province,</span><br><span class="line">            <span class="string">'min_price'</span>: obj.min_price,</span><br><span class="line">            <span class="string">'city'</span>: obj.city,</span><br><span class="line">            <span class="string">'comment_count'</span>: obj.comment_count</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SightDetailSerializer</span>(<span class="params">BaseSerializer</span>):</span></span><br><span class="line">    <span class="string">""" 景点详情 """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_dict</span>(<span class="params">self</span>):</span></span><br><span class="line">        obj = self.obj</span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="string">'id'</span>: obj.id,</span><br><span class="line">            <span class="string">'name'</span>: obj.name,</span><br><span class="line">            <span class="string">'desc'</span>: obj.desc,</span><br><span class="line">            <span class="string">'img'</span>: obj.banner_img.url,</span><br><span class="line">            <span class="string">'content'</span>: obj.content,</span><br><span class="line">            <span class="string">'score'</span>: obj.score,</span><br><span class="line">            <span class="string">'min_price'</span>: obj.min_price,</span><br><span class="line">            <span class="string">'province'</span>: obj.province,</span><br><span class="line">            <span class="string">'city'</span>: obj.city,</span><br><span class="line">            <span class="string">'area'</span>: obj.area,</span><br><span class="line">            <span class="string">'town'</span>: obj.town,</span><br><span class="line">            <span class="string">'comment_count'</span>: obj.comment_count,</span><br><span class="line">            <span class="string">'image_count'</span>: obj.image_count,</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TicketListSerializer</span>(<span class="params">BaseListPageSerializer</span>):</span></span><br><span class="line">    <span class="string">""" 门票列表 """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_object</span>(<span class="params">self, obj</span>):</span></span><br><span class="line">        <span class="keyword">return</span> {</span><br><span class="line">            <span class="string">'pk'</span>: obj.pk,</span><br><span class="line">            <span class="string">'name'</span>: obj.name,</span><br><span class="line">            <span class="string">'desc'</span>: obj.desc,</span><br><span class="line">            <span class="string">'types'</span>: obj.types,</span><br><span class="line">            <span class="string">'price'</span>: obj.price,</span><br><span class="line">            <span class="string">'sell_price'</span>: obj.sell_price,</span><br><span class="line">            <span class="string">'discount'</span>: obj.discount,</span><br><span class="line">            <span class="string">'total_stock'</span>: obj.total_stock,</span><br><span class="line">            <span class="string">'remain_stock'</span>: obj.remain_stock</span><br><span class="line">        }</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>使用axios获取数据</li>
<li>将数据设置到模型层</li>
</ul>
<h3 id="景点评论接口联调"><a href="#景点评论接口联调" class="headerlink" title="景点评论接口联调"></a>景点评论接口联调</h3><h4 id="实现步骤-7"><a href="#实现步骤-7" class="headerlink" title="实现步骤"></a>实现步骤</h4><ul>
<li>阅读接口文档</li>
<li>配置接口地址<br>评论的每一项在景点详情、单独的评论列表，封装成公共组件，<br>获取里面内容在详情页url发生变化的时候，watch监听路由变化，重新获取数据</li>
</ul>
<p><code>src\utils\filters.js</code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用户名称脱敏处理</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">{*}</span> </span>name 用户名</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unameFormat</span> (<span class="params">name</span>) </span>{</span><br><span class="line">  <span class="keyword">if</span> (!name) {</span><br><span class="line">    <span class="keyword">return</span> name</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> name.substr(<span class="number">0</span>, <span class="number">2</span>) + <span class="string">'***'</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> {</span><br><span class="line">  unameFormat</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><code>src\utils\apis.js</code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> SightApis = {</span><br><span class="line">  <span class="comment">// 评论列表</span></span><br><span class="line">  sightCommentUrl: apiHost + <span class="string">'/sight/comment/list/#{id}/'</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><code>src\views\sight\SightComment.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 景点评论 --&gt;</span><br><span class="line">  &lt;div class="page-sight-comment"&gt;</span><br><span class="line">    &lt;!-- 页面头部 --&gt;</span><br><span class="line">    &lt;van-nav-bar</span><br><span class="line">      left-text="返回"</span><br><span class="line">      title="景点评论"</span><br><span class="line">      left-arrow</span><br><span class="line">      @click-left="goBack"</span><br><span class="line">    /&gt;</span><br><span class="line">    &lt;div class="sight-comment"&gt;</span><br><span class="line">      &lt;comment-item v-for="item in commentList" :key="item.pk" :item="item" /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import { ajax } from '@/utils/ajax'</span><br><span class="line">import { SightApis } from '@/utils/apis'</span><br><span class="line">// 评论项组件</span><br><span class="line">import CommentItem from '@/components/sight/CommentItem'</span><br><span class="line">export default {</span><br><span class="line">  components: {</span><br><span class="line">    CommentItem</span><br><span class="line">  },</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      // 评论列表</span><br><span class="line">      commentList: []</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    goBack () {</span><br><span class="line">      this.$router.go(-1)</span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * 评论列表</span><br><span class="line">     */</span><br><span class="line">    getCommentList () {</span><br><span class="line">      const url = SightApis.sightCommentUrl.replace('#{id}', this.id)</span><br><span class="line">      ajax.get(url).then(({ data: { objects } }) =&gt; {</span><br><span class="line">        this.commentList = objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  mounted () {</span><br><span class="line">    this.id = this.$route.params.id</span><br><span class="line">    this.getCommentList()</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<p><code>src\views\sight\SightDetail.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 景点详情 --&gt;</span><br><span class="line">  &lt;div class="page-sight-detail"&gt;</span><br><span class="line">    &lt;!-- 门票列表 --&gt;</span><br><span class="line">    &lt;div class="sight-ticket"&gt;</span><br><span class="line">      &lt;van-cell title="门票" icon="bookmark-o" title-style="text-align:left"/&gt;</span><br><span class="line">      &lt;div class="ticket-item" v-for="item in ticketList" :key="item.pk"&gt;</span><br><span class="line">        &lt;div class="left"&gt;</span><br><span class="line">          &lt;div class="title"&gt;{{ item.name }}&lt;/div&gt;</span><br><span class="line">          &lt;div class="tips"&gt;</span><br><span class="line">            &lt;van-icon name="clock-o" /&gt;</span><br><span class="line">            &lt;span&gt;{{ item.desc }}&lt;/span&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div class="tags"&gt;</span><br><span class="line">            &lt;van-tag mark type="primary"&gt;标签1&lt;/van-tag&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class="right"&gt;</span><br><span class="line">          &lt;div class="price"&gt;</span><br><span class="line">            &lt;span&gt;￥&lt;/span&gt;</span><br><span class="line">            &lt;strong&gt;{{ item.sell_price }}&lt;/strong&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;router-link to="#"&gt;</span><br><span class="line">            &lt;van-button type="warning" size="small"&gt;预定&lt;/van-button&gt;</span><br><span class="line">          &lt;/router-link&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //门票列表 --&gt;</span><br><span class="line">    &lt;!-- 用户评价 --&gt;</span><br><span class="line">    &lt;div class="sight-comment"&gt;</span><br><span class="line">      &lt;van-cell title="热门评论" icon="comment-o" title-style="text-align:left"/&gt;</span><br><span class="line">      &lt;comment-item v-for="item in commentList" :key="item.pk" :item="item" /&gt;</span><br><span class="line">      &lt;router-link class="link-more" :to="{name: 'SightComment', params: {id}}"&gt;查看更多&lt;/router-link&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- //用户评价 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import { ajax } from '@/utils/ajax'</span><br><span class="line">import { SightApis } from '@/utils/apis'</span><br><span class="line">// 评论项组件</span><br><span class="line">import CommentItem from '@/components/sight/CommentItem'</span><br><span class="line">export default {</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      id: '',</span><br><span class="line">      // 景点详细信息</span><br><span class="line">      sightDetail: {},</span><br><span class="line">      // 门票列表</span><br><span class="line">      ticketList: [],</span><br><span class="line">      // 评论列表</span><br><span class="line">      commentList: []</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  components: {</span><br><span class="line">    CommentItem</span><br><span class="line">  },</span><br><span class="line">  computed: {</span><br><span class="line">    /**</span><br><span class="line">     * 地址的全部信息</span><br><span class="line">     */</span><br><span class="line">    fullArea () {</span><br><span class="line">      let area = this.sightDetail.province + this.sightDetail.city</span><br><span class="line">      if (this.sightDetail.area) {</span><br><span class="line">        area += this.sightDetail.area</span><br><span class="line">      }</span><br><span class="line">      if (this.sightDetail.town) {</span><br><span class="line">        area += this.sightDetail.town</span><br><span class="line">      }</span><br><span class="line">      return area</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  watch: {</span><br><span class="line">    $route () {</span><br><span class="line">      this.loadData()</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    /**</span><br><span class="line">     * 跳转到评论列表</span><br><span class="line">     */</span><br><span class="line">    goPage () {</span><br><span class="line">      this.$router.push({name: 'SightComment', params: {id: this.id}})</span><br><span class="line">    },</span><br><span class="line">    loadData () {</span><br><span class="line">      this.id = this.$route.params.id</span><br><span class="line">      // 获取景点详细信息</span><br><span class="line">      this.getSightDetail()</span><br><span class="line">      // 门票列表</span><br><span class="line">      this.getTicketList()</span><br><span class="line">      // 评论列表</span><br><span class="line">      this.getCommentList()</span><br><span class="line">    },</span><br><span class="line">    goBack () {</span><br><span class="line">      this.$router.go(-1)</span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * 获取景点详细信息</span><br><span class="line">     */</span><br><span class="line">    getSightDetail () {</span><br><span class="line">      const url = SightApis.sightDetailUrl.replace('#{id}', this.id)</span><br><span class="line">      ajax.get(url).then(({ data }) =&gt; {</span><br><span class="line">        this.sightDetail = data</span><br><span class="line">      })</span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * 门票列表</span><br><span class="line">     */</span><br><span class="line">    getTicketList () {</span><br><span class="line">      const url = SightApis.sightTicketUrl.replace('#{id}', this.id)</span><br><span class="line">      ajax.get(url).then(({ data: { objects } }) =&gt; {</span><br><span class="line">        this.ticketList = objects</span><br><span class="line">      })</span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * 评论列表</span><br><span class="line">     */</span><br><span class="line">    getCommentList () {</span><br><span class="line">      const url = SightApis.sightCommentUrl.replace('#{id}', this.id)</span><br><span class="line">      ajax.get(url).then(({ data: { objects } }) =&gt; {</span><br><span class="line">        this.commentList = objects</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  created () {</span><br><span class="line">    this.loadData()</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>使用axios获取数据</li>
<li>将数据设置到模型层</li>
</ul>
<h3 id="前端代码优化"><a href="#前端代码优化" class="headerlink" title="前端代码优化"></a>前端代码优化</h3><ul>
<li>添加loading动画和添加请求拦截</li>
</ul>
<p><code>src\main.js</code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.app = <span class="keyword">new</span> Vue({</span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">}).$mount(<span class="string">'#app'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p><code>src\utils\ajax.js</code></p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br><span class="line"></span><br><span class="line">ajax.interceptors.request.use(<span class="function"><span class="keyword">function</span> (<span class="params">config</span>) </span>{</span><br><span class="line">  <span class="comment">// 在发送请求之前做些什么</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'请求拦截到了'</span>)</span><br><span class="line">  <span class="built_in">window</span>.app.$toast.loading({</span><br><span class="line">    message: <span class="string">'加载中...'</span>,</span><br><span class="line">    forbidClick: <span class="literal">true</span>,</span><br><span class="line">    loadingType: <span class="string">'spinner'</span></span><br><span class="line">  })</span><br><span class="line">  <span class="keyword">return</span> config</span><br><span class="line">}, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>{</span><br><span class="line">  <span class="comment">// 对请求错误做些什么</span></span><br><span class="line">  <span class="built_in">window</span>.app.$toast.clear()</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">})</span><br><span class="line"></span><br><span class="line">ajax.interceptors.response.use(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>{</span><br><span class="line">  <span class="comment">// 对响应数据做点什么</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'响应拦截到了'</span>)</span><br><span class="line">  <span class="built_in">window</span>.app.$toast.clear()</span><br><span class="line">  <span class="keyword">return</span> response</span><br><span class="line">}, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>{</span><br><span class="line">  <span class="comment">// 对响应错误做点什么</span></span><br><span class="line">  <span class="keyword">if</span> (error.response) {</span><br><span class="line">    <span class="keyword">if</span> (error.response.status === <span class="number">401</span>) {</span><br><span class="line">      <span class="built_in">window</span>.alert(<span class="string">'未登录，即将跳转到登录页面'</span>)</span><br><span class="line">    } <span class="keyword">else</span> <span class="keyword">if</span> (error.response.status === <span class="number">500</span>) {</span><br><span class="line">      <span class="built_in">window</span>.app.$notify({</span><br><span class="line">        message: <span class="string">'服务器正忙，请稍后重试'</span>,</span><br><span class="line">        type: <span class="string">'danger'</span></span><br><span class="line">      })</span><br><span class="line">      <span class="comment">// window.alert('服务器正忙，请稍后重试')</span></span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  <span class="built_in">window</span>.app.$toast.clear()</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error)</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>修改页面标题<br><code>public\index.html</code></li>
</ul>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width,initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"icon"</span> <span class="attr">href</span>=<span class="string">"&lt;%= BASE_URL %&gt;favicon.ico"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>旅游网<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">`</span><br><span class="line"></span><br><span class="line">- 添加滚动加载，请求失败，点击重新加载和下拉刷新，</span><br><span class="line">在评论列表的场景添加</span><br><span class="line">`src\views\sight\SightComment.vue`</span><br><span class="line"></span><br><span class="line">```vue</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 景点评论 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-sight-comment"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">van-pull-refresh</span> <span class="attr">v-model</span>=<span class="string">"refreshing"</span> @<span class="attr">refresh</span>=<span class="string">"onRefresh"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">van-list</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"sight-comment"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">"loading"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:finished</span>=<span class="string">"finished"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">finished-text</span>=<span class="string">"没有更多了"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:error.sync</span>=<span class="string">"error"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">error-text</span>=<span class="string">"请求失败，点击重新加载"</span></span></span><br><span class="line"><span class="tag">        @<span class="attr">load</span>=<span class="string">"getCommentList"</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">comment-item</span> <span class="attr">v-for</span>=<span class="string">"item in commentList"</span> <span class="attr">:key</span>=<span class="string">"item.pk"</span> <span class="attr">:item</span>=<span class="string">"item"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">van-list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">van-pull-refresh</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> { ajax } <span class="keyword">from</span> <span class="string">'@/utils/ajax'</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> { SightApis } <span class="keyword">from</span> <span class="string">'@/utils/apis'</span></span></span><br><span class="line"><span class="javascript"><span class="comment">// 评论项组件</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> CommentItem <span class="keyword">from</span> <span class="string">'@/components/sight/CommentItem'</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> {</span></span><br><span class="line">  components: {</span><br><span class="line">    CommentItem</span><br><span class="line">  },</span><br><span class="line">  data () {</span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> {</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 评论列表</span></span></span><br><span class="line">      commentList: [],</span><br><span class="line"><span class="javascript">      <span class="comment">// 当前的页码</span></span></span><br><span class="line">      currentPage: 1,</span><br><span class="line"><span class="javascript">      <span class="comment">// 正在加载中</span></span></span><br><span class="line"><span class="javascript">      loading: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 所有的内容加载完</span></span></span><br><span class="line"><span class="javascript">      finished: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 请求失败</span></span></span><br><span class="line"><span class="javascript">      error: <span class="literal">false</span>,</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 是否正在下拉刷新中</span></span></span><br><span class="line"><span class="javascript">      refreshing: <span class="literal">false</span></span></span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    goBack () {</span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.$router.go(<span class="number">-1</span>)</span></span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * 下拉刷新执行</span><br><span class="line">     */</span><br><span class="line">    onRefresh () {</span><br><span class="line"><span class="javascript">      <span class="comment">// 清空数据</span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.commentList = []</span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.currentPage = <span class="number">1</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.finished = <span class="literal">false</span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.error = <span class="literal">false</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="comment">// 重新加载数据</span></span></span><br><span class="line"><span class="javascript">      <span class="built_in">this</span>.getCommentList()</span></span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * 评论列表</span><br><span class="line">     */</span><br><span class="line">    getCommentList () {</span><br><span class="line"><span class="javascript">      <span class="keyword">const</span> url = SightApis.sightCommentUrl.replace(<span class="string">'#{id}'</span>, <span class="built_in">this</span>.id)</span></span><br><span class="line">      ajax.get(url, {</span><br><span class="line">        params: {</span><br><span class="line"><span class="javascript">          page: <span class="built_in">this</span>.currentPage</span></span><br><span class="line">        }</span><br><span class="line"><span class="javascript">      }).then(<span class="function">(<span class="params">{ data: { meta, objects } }</span>) =&gt;</span> {</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.commentList = <span class="built_in">this</span>.commentList.concat(objects)</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 加载状态结束</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.loading = <span class="literal">false</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// 设置下一页的页码</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.currentPage = meta.current_page + <span class="number">1</span></span></span><br><span class="line"><span class="javascript">        <span class="comment">// 数据全部加载完成： 当前页面 == 总页数</span></span></span><br><span class="line">        if (meta.current_page === meta.page_count) {</span><br><span class="line"><span class="javascript">          <span class="built_in">this</span>.finished = <span class="literal">true</span></span></span><br><span class="line">        }</span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.refreshing = <span class="literal">false</span></span></span><br><span class="line"><span class="javascript">      }).catch(<span class="function">() =&gt;</span> {</span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.loading = <span class="literal">false</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.error = <span class="literal">true</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">this</span>.refreshing = <span class="literal">false</span></span></span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  mounted () {</span><br><span class="line"><span class="javascript">    <span class="built_in">this</span>.id = <span class="built_in">this</span>.$route.params.id</span></span><br><span class="line"><span class="javascript">    <span class="comment">// this.getCommentList()</span></span></span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="实现图片列表接口"><a href="#实现图片列表接口" class="headerlink" title="实现图片列表接口"></a>实现图片列表接口</h3><p><code>src\views\sight\SightImage.vue</code></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 景点图片 --&gt;</span><br><span class="line">  &lt;div class="page-sight-image"&gt;</span><br><span class="line">    &lt;!-- 顶部导航 --&gt;</span><br><span class="line">    &lt;van-nav-bar title="景点图片" left-text="返回" left-arrow @click-left="goBack" /&gt;</span><br><span class="line">    &lt;!-- 图片列表 --&gt;</span><br><span class="line">    &lt;van-pull-refresh v-model="refreshing" @refresh="onRefresh"&gt;</span><br><span class="line">      &lt;van-list</span><br><span class="line">        class="sight-image"</span><br><span class="line">        v-model="loading"</span><br><span class="line">        :finished="finished"</span><br><span class="line">        finished-text="没有更多了"</span><br><span class="line">        :error.sync="error"</span><br><span class="line">        error-text="请求失败，点击重新加载"</span><br><span class="line">        @load="getImageList"</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;van-row&gt;</span><br><span class="line">          &lt;van-col span="12" v-for="(item, index) in imageList" :key="index"&gt;</span><br><span class="line">            &lt;van-image width="100%" height="100%" :src="item.img" @click="showPreview=true"/&gt;</span><br><span class="line">          &lt;/van-col&gt;</span><br><span class="line">        &lt;/van-row&gt;</span><br><span class="line">      &lt;/van-list&gt;</span><br><span class="line">    &lt;/van-pull-refresh&gt;</span><br><span class="line">    &lt;!-- //图片列表 --&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 图片预览 --&gt;</span><br><span class="line">    &lt;van-image-preview v-model="showPreview" :images="imgUrlList" @change="onChange"&gt;</span><br><span class="line">      &lt;template v-slot:index&gt;第{{ index + 1 }}页 / 共{{ imageList.length }}张&lt;/template&gt;</span><br><span class="line">    &lt;/van-image-preview&gt;</span><br><span class="line">    &lt;!-- // 图片预览 --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import { ajax } from '@/utils/ajax'</span><br><span class="line">import { SightApis } from '@/utils/apis'</span><br><span class="line">export default {</span><br><span class="line">  components: {},</span><br><span class="line">  data () {</span><br><span class="line">    return {</span><br><span class="line">      // 图片列表</span><br><span class="line">      imageList: [],</span><br><span class="line">      // 图片预览</span><br><span class="line">      index: 0,</span><br><span class="line">      showPreview: false,</span><br><span class="line">      // 当前的页码</span><br><span class="line">      currentPage: 1,</span><br><span class="line">      // 正在加载中</span><br><span class="line">      loading: false,</span><br><span class="line">      // 所有的内容加载完</span><br><span class="line">      finished: false,</span><br><span class="line">      // 请求失败</span><br><span class="line">      error: false,</span><br><span class="line">      // 是否正在下拉刷新中</span><br><span class="line">      refreshing: false</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  methods: {</span><br><span class="line">    /**</span><br><span class="line">     * 预览切换图片</span><br><span class="line">     */</span><br><span class="line">    onChange (index) {</span><br><span class="line">      this.index = index</span><br><span class="line">    },</span><br><span class="line">    goBack () {</span><br><span class="line">      this.$router.go(-1)</span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * 下拉刷新执行</span><br><span class="line">     */</span><br><span class="line">    onRefresh () {</span><br><span class="line">      // 清空数据</span><br><span class="line">      this.imageList = []</span><br><span class="line">      this.currentPage = 1</span><br><span class="line"></span><br><span class="line">      this.finished = false</span><br><span class="line">      this.error = false</span><br><span class="line">    },</span><br><span class="line">    /**</span><br><span class="line">     * 图片列表</span><br><span class="line">     */</span><br><span class="line">    getImageList () {</span><br><span class="line">      const url = SightApis.sightImageUrl.replace('#{id}', this.id)</span><br><span class="line">      ajax.get(url, {</span><br><span class="line">        params: {</span><br><span class="line">          page: this.currentPage</span><br><span class="line">        }</span><br><span class="line">      }).then(({ data: { meta, objects } }) =&gt; {</span><br><span class="line">        this.imageList = this.imageList.concat(objects)</span><br><span class="line">        // 加载状态结束</span><br><span class="line">        this.loading = false</span><br><span class="line">        // 设置下一页的页码</span><br><span class="line">        this.currentPage = meta.current_page + 1</span><br><span class="line">        // 数据全部加载完成： 当前页面 == 总页数</span><br><span class="line">        if (meta.current_page === meta.page_count) {</span><br><span class="line">          this.finished = true</span><br><span class="line">        }</span><br><span class="line">        this.refreshing = false</span><br><span class="line">      }).catch(() =&gt; {</span><br><span class="line">        this.loading = false</span><br><span class="line">        this.error = true</span><br><span class="line">        this.refreshing = false</span><br><span class="line">      })</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  computed: {</span><br><span class="line">    /**</span><br><span class="line">     * 图片地址</span><br><span class="line">     */</span><br><span class="line">    imgUrlList () {</span><br><span class="line">      return this.imageList.map(item =&gt; item.img)</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  mounted () {</span><br><span class="line">    this.id = this.$route.params.id</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/jian-zhi-offer30-40-ti/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/jian-zhi-offer30-40-ti/" class="post-title-link" itemprop="url">剑指offer30~40题</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-04-02 12:24:46" itemprop="dateModified" datetime="2021-04-02T12:24:46Z">2021-04-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h4 id="32-最小的K个数-本题考点-时间效率"><a href="#32-最小的K个数-本题考点-时间效率" class="headerlink" title="32.最小的K个数 [^本题考点 时间效率]"></a>32.最小的K个数 [^本题考点 <em>时间效率</em>]</h4><p>​<strong>输入n个整数，找出其中最小的K个数。例如输入4,5,1,6,2,7,3,8这8个数字，则最小的4个数字是1,2,3,4,。</strong><br>示例1：</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：arr = [<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>], k = <span class="number">2</span></span><br><span class="line">输出：[<span class="number">1</span>,<span class="number">2</span>] 或者 [<span class="number">2</span>,<span class="number">1</span>]</span><br></pre></td></tr></tbody></table></figure>
<p>示例2</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：arr = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>], k = <span class="number">1</span></span><br><span class="line">输出：[<span class="number">0</span>]</span><br></pre></td></tr></tbody></table></figure>

<p>方法：快排思想<br>思路和算法<br>快排的划分函数 partition 每次执行完后都能将数组分成两个部分，<br>小于等于分界值 pivot 的元素的都会被放到数组的左边，<br>大于的都会被放到数组的右边，<br>然后返回分界值的下标。<br>与快速排序不同的是，快速排序会根据分界值的下标递归处理划分的两侧，<br>而这里我们只处理划分的一边，不需要完全排完序再处理。</p>
<p>我们定义函数 randomized_selected(arr, l, r, k)<br>表示划分数组 arr 的 [l, r] 部分，使前 k 小的数在数组的左侧，<br>在函数里我们调用快排的划分函数，<br>假设划分函数返回的下标是 pos（表示分界值 pivot 最终在数组中的位置），<br>pviot 左子序列(包括pivot)长度<br>即 pivot 是数组中第 pos - l + 1 小的数，那么一共会有三种情况：</p>
<ul>
<li><p>如果 pos - l + 1 == k，表示 pivot 就是第 k 小的数，<br>则左边的pos个值均为序列中k小的值，后面的值大于 pivot，直接返回即可； </p>
</li>
<li><p>如果 pos - l + 1 &lt; k，表示第 k 小的数在 pivot 的右侧，<br>左边的pos个值为序列中k小的值的一部分，还有 k - pos 个值在右边。<br>因此递归调用 randomized_selected(arr, pos + 1, r, k - (pos - l + 1))；</p>
</li>
<li><p>如果 pos - l + 1 &gt; k，表示第 k 小的数在 pivot 的左侧，<br>左边的k个值为序列中pos小的值的一部分。<br>递归调用 randomized_selected(arr, l, pos - 1, k)。</p>
</li>
</ul>
<p>函数递归入口为 randomized_selected(arr, 0, arr.length - 1, k)<br>在函数返回后，将前 k 个数放入答案数组返回即可。</p>
<p>时间复杂度：期望为 O(n) ，由于证明过程很繁琐，所以不再这里展开讲。<br>具体证明可以参考《算法导论》第 9 章第 2 小节。<br>最坏情况下的时间复杂度为 O(n^2)。<br>情况最差时，每次的划分点都是最大值或最小值，一共需要划分 n - 1 次，<br>而一次划分需要线性的时间复杂度，所以最坏情况下时间复杂度为 O(n^2)</p>
<p>空间复杂度：期望为 O(logn)，递归调用的期望深度为 O(logn)，<br>每层需要的空间为 O(1)，只有常数个变量。</p>
<p>最坏情况下的空间复杂度为 O(n)。最坏情况下需要划分 n 次，<br>即 randomized_selected 函数递归调用最深 n - 1 层，<br>而每层由于需要 O(1) 的空间，所以一共需要 O(n) 的空间复杂度。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partition</span>(<span class="params">self, nums, l, r</span>):</span></span><br><span class="line">        <span class="comment"># 快排切分，返回下标i + 1，使得比nums[i+1]小的数都在 i + 1 的左边，比nums[i + 1]大的数都在i + 1的右边。</span></span><br><span class="line">        pivot = nums[r]</span><br><span class="line">        i = l - <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(l, r):</span><br><span class="line">            <span class="keyword">if</span> nums[j] &lt;= pivot:</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">                nums[i], nums[j] = nums[j], nums[i]</span><br><span class="line">        nums[i + <span class="number">1</span>], nums[r] = nums[r], nums[i + <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> i + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">randomized_partition</span>(<span class="params">self, nums, l, r</span>):</span></span><br><span class="line">        p = random.randint(l, r)</span><br><span class="line">        nums[r], nums[p] = nums[p], nums[r]</span><br><span class="line">        <span class="keyword">return</span> self.partition(nums, l, r)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">randomized_selected</span>(<span class="params">self, arr, l, r, k</span>):</span></span><br><span class="line">        pos = self.randomized_partition(arr, l, r)</span><br><span class="line">        length = pos - l + <span class="number">1</span>  <span class="comment"># pviot 左子序列(包括pivot)长度</span></span><br><span class="line">        <span class="keyword">if</span> k &lt; length:</span><br><span class="line">            <span class="comment"># 则说明 k 个最小值在当前基准左侧子序，继续切分左段</span></span><br><span class="line">            self.randomized_selected(arr, l, pos - <span class="number">1</span>, k)</span><br><span class="line">        <span class="keyword">elif</span> k &gt; length:</span><br><span class="line">            <span class="comment"># 在右子序找 k - length 最小元素，继续切分右段</span></span><br><span class="line">            self.randomized_selected(arr, pos + <span class="number">1</span>, r, k - length)</span><br><span class="line">        <span class="comment"># k = length 则说明已经可以获取 k 个最小值了，找到排序后下标为pos的元素，就返回pos以及pos左边所有的数；</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getLeastNumbers</span>(<span class="params">self, arr: List[int], k: int</span>) -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>:  <span class="comment"># 特判</span></span><br><span class="line">            <span class="keyword">return</span> list()</span><br><span class="line">        self.randomized_selected(arr, <span class="number">0</span>, len(arr) - <span class="number">1</span>, k)</span><br><span class="line">        <span class="keyword">return</span> arr[:k]  <span class="comment"># 取前 k 值</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    array = [<span class="number">3</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line">    print(solution.getLeastNumbers(array, <span class="number">2</span>))</span><br><span class="line">    <span class="comment"># [2, 1]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">array</span> = [<span class="number">3</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line">self.randomized_selected(arr, <span class="number">0</span>, len(arr) - <span class="number">1</span>, k)</span><br><span class="line">self.randomized_selected(arr, <span class="number">0</span>, <span class="number">7</span> - <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">randomized_selected(self, arr, l, r, k):</span><br><span class="line">l = <span class="number">0</span></span><br><span class="line">r = <span class="number">6</span></span><br><span class="line">k = <span class="number">2</span></span><br><span class="line">pos = self.randomized_partition(arr, l, r)</span><br><span class="line">p = random.randint(l, r) = <span class="number">4</span></span><br><span class="line">nums[r] = nums[p] = nums[<span class="number">6</span>] = nums[<span class="number">4</span>] = <span class="number">6</span> </span><br><span class="line">nums[p] = nums[r] = nums[<span class="number">4</span>] = nums[p] = <span class="number">4</span></span><br><span class="line">[<span class="number">3</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">6</span>]</span><br><span class="line"><span class="keyword">return</span> self.partition(nums, l, r)</span><br><span class="line"></span><br><span class="line">pivot = nums[r] = nums[<span class="number">6</span>] = <span class="number">6</span></span><br><span class="line">i = l - <span class="number">1</span> = <span class="number">0</span> - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(l, r):</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    nums[j] = nums[<span class="number">0</span>] = <span class="number">3</span> &lt; pivot = <span class="number">6</span>:</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">    nums[i] = nums[j] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    nums[j] = nums[i] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    nums[j] = nums[<span class="number">1</span>] = <span class="number">7</span> &gt; pivot = <span class="number">6</span>:</span><br><span class="line"></span><br><span class="line">    j = <span class="number">2</span></span><br><span class="line">    nums[j] = nums[<span class="number">2</span>] = <span class="number">1</span> &lt; pivot = <span class="number">6</span>:</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">    nums[i] = nums[j] = nums[<span class="number">1</span>] = nums[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    nums[j] = nums[i] = nums[<span class="number">0</span>] = nums[<span class="number">1</span>] = <span class="number">7</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    nums[j] = nums[<span class="number">3</span>] = <span class="number">5</span> &lt; pivot = <span class="number">6</span>:</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">1</span> + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">    nums[i] = nums[j] = nums[<span class="number">2</span>] = nums[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">    nums[j] = nums[i] = nums[<span class="number">3</span>] = nums[<span class="number">2</span>] = <span class="number">7</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">    j = <span class="number">4</span></span><br><span class="line">    nums[j] = nums[<span class="number">4</span>] = <span class="number">4</span> &lt; pivot = <span class="number">6</span>:</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">    nums[i] = nums[j] = nums[<span class="number">3</span>] = nums[<span class="number">4</span>] = <span class="number">4</span></span><br><span class="line">    nums[j] = nums[i] = nums[<span class="number">4</span>] = nums[<span class="number">3</span>] = <span class="number">7</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">    j = <span class="number">5</span></span><br><span class="line">    nums[j] = nums[<span class="number">5</span>] = <span class="number">2</span> &lt; pivot = <span class="number">6</span>:</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">3</span> + <span class="number">1</span> = <span class="number">4</span></span><br><span class="line">    nums[i] = nums[j] = nums[<span class="number">4</span>] = nums[<span class="number">5</span>] = <span class="number">2</span></span><br><span class="line">    nums[j] = nums[i] = nums[<span class="number">5</span>] = nums[<span class="number">4</span>] = <span class="number">7</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">nums[i + <span class="number">1</span>] = nums[r] = nums[<span class="number">5</span>] = nums[<span class="number">6</span>] = <span class="number">6</span></span><br><span class="line">nums[r] = nums[i + <span class="number">1</span>] = nums[<span class="number">6</span>] = nums[<span class="number">5</span>] = <span class="number">7</span></span><br><span class="line">[<span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line">切分元素 pivot = nums[p] = <span class="number">6</span> 交换到它排序以后最终确定的位置上 </span><br><span class="line"><span class="keyword">return</span> i + <span class="number">1</span></span><br><span class="line">pos = i + <span class="number">1</span> = <span class="number">5</span>  返回原来下标为<span class="number">4</span>的元素<span class="number">6</span>的最终位置在下标<span class="number">5</span>，</span><br><span class="line">是第 pos + <span class="number">1</span> = <span class="number">6</span> 大元素，</span><br><span class="line">pviot 左子序列(包括pivot)长度</span><br><span class="line">length = pos - l + <span class="number">1</span> = <span class="number">5</span> - <span class="number">0</span> + <span class="number">1</span> = <span class="number">6</span></span><br><span class="line">pivot 是数组中第 pos - l + <span class="number">1</span> = <span class="number">6</span> 小的数，</span><br><span class="line"></span><br><span class="line">k = <span class="number">2</span> &lt; length = <span class="number">6</span>:</span><br><span class="line">self.randomized_selected(arr, l, pos - <span class="number">1</span>, k)</span><br><span class="line">self.randomized_selected(arr, <span class="number">0</span>, <span class="number">5</span> - <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">self.randomized_selected(arr, <span class="number">0</span>, <span class="number">4</span>, <span class="number">2</span>)</span><br><span class="line">    randomized_selected(self, arr, l, r, k)</span><br><span class="line">    l = <span class="number">0</span></span><br><span class="line">    r = <span class="number">4</span></span><br><span class="line">    k = <span class="number">2</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">    pos = self.randomized_partition(arr, l, r)</span><br><span class="line">    p = random.randint(l, r) = <span class="number">3</span></span><br><span class="line">    nums[r] = nums[p] = nums[<span class="number">4</span>] = nums[<span class="number">3</span>] = <span class="number">4</span> </span><br><span class="line">    nums[p] = nums[r] = nums[<span class="number">3</span>] = nums[<span class="number">4</span>] = <span class="number">2</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>]  [<span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line">    <span class="keyword">return</span> self.partition(nums, l, r)</span><br><span class="line"></span><br><span class="line">    pivot = nums[r] = nums[<span class="number">4</span>] = <span class="number">4</span></span><br><span class="line">    i = l - <span class="number">1</span> = <span class="number">0</span> - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(l, r):</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        nums[j] = nums[<span class="number">0</span>] = <span class="number">3</span> &lt; pivot = <span class="number">4</span>:</span><br><span class="line">        i = i + <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">        nums[i] = nums[j] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">        nums[j] = nums[i] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">        j = <span class="number">1</span></span><br><span class="line">        nums[j] = nums[<span class="number">1</span>] = <span class="number">1</span> &lt; pivot = <span class="number">4</span>:</span><br><span class="line">        i = i + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">        nums[i] = nums[j] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">        nums[j] = nums[i] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        j = <span class="number">2</span></span><br><span class="line">        nums[j] = nums[<span class="number">2</span>] = <span class="number">5</span> &gt; pivot = <span class="number">4</span>:</span><br><span class="line"></span><br><span class="line">        j = <span class="number">3</span></span><br><span class="line">        nums[j] = nums[<span class="number">3</span>] = <span class="number">2</span> &lt; pivot = <span class="number">4</span>:</span><br><span class="line">        i = i + <span class="number">1</span> = <span class="number">1</span> + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">        nums[i] = nums[j] = nums[<span class="number">2</span>] = nums[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">        nums[j] = nums[i] = nums[<span class="number">3</span>] = nums[<span class="number">2</span>] = <span class="number">5</span></span><br><span class="line">        [<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>]   [<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">    nums[i + <span class="number">1</span>] = nums[r] = nums[<span class="number">3</span>] = nums[<span class="number">4</span>] = <span class="number">4</span></span><br><span class="line">    nums[r] = nums[i + <span class="number">1</span>] = nums[<span class="number">4</span>] = nums[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]    [<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">    切分元素 nums[p] = <span class="number">4</span> 交换到它排序以后最终确定的位置上 </span><br><span class="line">    <span class="keyword">return</span> i + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    pos = i + <span class="number">1</span> = <span class="number">3</span>  返回原来下标为<span class="number">3</span>的元素<span class="number">4</span>的最终位置在下标<span class="number">3</span></span><br><span class="line">    length = pos - l + <span class="number">1</span> = <span class="number">3</span> - <span class="number">0</span> + <span class="number">1</span> = <span class="number">4</span></span><br><span class="line">    k = <span class="number">2</span> &lt; length = <span class="number">4</span>:</span><br><span class="line">    self.randomized_selected(arr, l, pos - <span class="number">1</span>, k)</span><br><span class="line">    self.randomized_selected(arr, <span class="number">0</span>, <span class="number">3</span> - <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">    self.randomized_selected(arr, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        randomized_selected(self, arr, l, r, k)</span><br><span class="line">        l = <span class="number">0</span></span><br><span class="line">        r = <span class="number">2</span></span><br><span class="line">        k = <span class="number">2</span></span><br><span class="line">        [<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">        pos = self.randomized_partition(arr, l, r)</span><br><span class="line"></span><br><span class="line">        p = random.randint(l, r) = <span class="number">0</span></span><br><span class="line">        nums[r] = nums[p] = nums[<span class="number">2</span>] = nums[<span class="number">0</span>] = <span class="number">3</span> </span><br><span class="line">        nums[p] = nums[r] = nums[<span class="number">0</span>] = nums[<span class="number">2</span>] = <span class="number">2</span></span><br><span class="line">        [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]  [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>]</span><br><span class="line">        <span class="keyword">return</span> self.partition(nums, l, r)</span><br><span class="line"></span><br><span class="line">        pivot = nums[r] = nums[<span class="number">2</span>] = <span class="number">3</span></span><br><span class="line">        i = l - <span class="number">1</span> = <span class="number">0</span> - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(l, r):</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">            nums[j] = nums[<span class="number">0</span>] = <span class="number">2</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">            i = i + <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">            nums[i] = nums[j] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">2</span></span><br><span class="line">            nums[j] = nums[i] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">            j = <span class="number">1</span></span><br><span class="line">            nums[j] = nums[<span class="number">1</span>] = <span class="number">1</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">            i = i + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">            nums[i] = nums[j] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            nums[j] = nums[i] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        nums[i + <span class="number">1</span>] = nums[r] = nums[<span class="number">2</span>] = nums[<span class="number">2</span>] = <span class="number">3</span></span><br><span class="line">        nums[r] = nums[i + <span class="number">1</span>] = nums[<span class="number">2</span>] = nums[<span class="number">2</span>] = <span class="number">3</span></span><br><span class="line">        切分元素 nums[p] = <span class="number">3</span> 交换到它排序以后最终确定的位置上</span><br><span class="line">        <span class="keyword">return</span> i + <span class="number">1</span></span><br><span class="line">        pos = i + <span class="number">1</span> = <span class="number">2</span>  返回原来下标为<span class="number">0</span>的元素<span class="number">3</span>的最终位置在下标<span class="number">2</span></span><br><span class="line">        length = pos - l + <span class="number">1</span> = <span class="number">2</span> - <span class="number">0</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">        k = <span class="number">2</span> &lt; length = <span class="number">3</span>:</span><br><span class="line">        self.randomized_selected(arr, l, pos - <span class="number">1</span>, k)</span><br><span class="line">        self.randomized_selected(arr, <span class="number">0</span>, <span class="number">2</span> - <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">        self.randomized_selected(arr, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">            randomized_selected(self, arr, l, r, k)</span><br><span class="line">            l = <span class="number">0</span></span><br><span class="line">            r = <span class="number">1</span></span><br><span class="line">            k = <span class="number">2</span></span><br><span class="line">            [<span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">            pos = self.randomized_partition(arr, l, r)</span><br><span class="line"></span><br><span class="line">            p = random.randint(l, r) = <span class="number">1</span></span><br><span class="line">            nums[r] = nums[p] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">1</span> </span><br><span class="line">            nums[p] = nums[r] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]  [<span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">            <span class="keyword">return</span> self.partition(nums, l, r)</span><br><span class="line"></span><br><span class="line">            pivot = nums[r] = nums[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            i = l - <span class="number">1</span> = <span class="number">0</span> - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(l, r):</span><br><span class="line">                j = <span class="number">0</span></span><br><span class="line">                nums[j] = nums[<span class="number">0</span>] = <span class="number">2</span> &gt; pivot = <span class="number">1</span>:</span><br><span class="line"></span><br><span class="line">            nums[i + <span class="number">1</span>] = nums[r] = nums[<span class="number">0</span>] = nums[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            nums[r] = nums[i + <span class="number">1</span>] = nums[<span class="number">1</span>] = nums[<span class="number">0</span>] = <span class="number">2</span></span><br><span class="line">            [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]  [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">            切分元素 nums[p] = <span class="number">1</span> 交换到它排序以后最终确定的位置上    </span><br><span class="line">            <span class="keyword">return</span> i + <span class="number">1</span></span><br><span class="line">            pos = i + <span class="number">1</span> = <span class="number">0</span>  返回原来下标为<span class="number">1</span>的元素<span class="number">1</span>的最终位置在下标<span class="number">0</span></span><br><span class="line">            length = pos - l + <span class="number">1</span> = <span class="number">0</span> - <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">            k = <span class="number">2</span> &gt; length = <span class="number">1</span>:</span><br><span class="line">            self.randomized_selected(arr, pos + <span class="number">1</span>, r, k - num)</span><br><span class="line">            self.randomized_selected(arr, <span class="number">0</span> + <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span> - <span class="number">1</span>)</span><br><span class="line">            self.randomized_selected(arr, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">                randomized_selected(self, arr, l, r, k)</span><br><span class="line">                l = <span class="number">1</span></span><br><span class="line">                r = <span class="number">1</span></span><br><span class="line">                k = <span class="number">1</span></span><br><span class="line">                [<span class="number">2</span>]</span><br><span class="line">                pos = self.randomized_partition(arr, l, r)</span><br><span class="line">                p = random.randint(l, r) = <span class="number">1</span></span><br><span class="line">                nums[r] = nums[p] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span> </span><br><span class="line">                nums[p] = nums[r] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">                [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]  [<span class="number">2</span>]</span><br><span class="line">                <span class="keyword">return</span> self.partition(nums, l, r)</span><br><span class="line"></span><br><span class="line">                pivot = nums[r] = nums[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">                i = l - <span class="number">1</span> = <span class="number">1</span> - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> range(l, r):</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">1</span>): j取不到值</span><br><span class="line"></span><br><span class="line">                nums[i + <span class="number">1</span>] = nums[r] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">                nums[r] = nums[i + <span class="number">1</span>] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">                [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>] [<span class="number">2</span>]</span><br><span class="line">                切分元素 nums[p] = <span class="number">2</span> 交换到它排序以后最终确定的位置上 </span><br><span class="line">                <span class="keyword">return</span> i + <span class="number">1</span></span><br><span class="line">                pos = i + <span class="number">1</span> = <span class="number">0</span>  返回原来下标为<span class="number">1</span>的元素<span class="number">1</span>的最终位置在下标<span class="number">0</span></span><br><span class="line">                length = pos - l + <span class="number">1</span> = <span class="number">0</span> - <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">                k = <span class="number">1</span> = length </span><br><span class="line">            回到上一层</span><br><span class="line">            l = <span class="number">0</span></span><br><span class="line">            r = <span class="number">1</span></span><br><span class="line">            k = <span class="number">2</span></span><br><span class="line">            length = <span class="number">1</span></span><br><span class="line">        回到上一层</span><br><span class="line">        l = <span class="number">0</span></span><br><span class="line">        r = <span class="number">2</span></span><br><span class="line">        k = <span class="number">2</span></span><br><span class="line">        length = <span class="number">3</span></span><br><span class="line">    回到上一层</span><br><span class="line">    l = <span class="number">0</span></span><br><span class="line">    r = <span class="number">4</span></span><br><span class="line">    k = <span class="number">2</span></span><br><span class="line">    length = <span class="number">4</span>        </span><br><span class="line">回到初始值</span><br><span class="line">l = <span class="number">0</span></span><br><span class="line">r = <span class="number">6</span></span><br><span class="line">k = <span class="number">2</span></span><br><span class="line">length = <span class="number">6</span>    </span><br><span class="line"><span class="keyword">return</span> arr[:k] = arr[<span class="number">1</span>]  </span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>


<p>这里的循环 partition 相当于 selection 的复杂度，平均下来是 O(n) 的复杂度。</p>
<p>T(n) = T(n/2) + O(n)</p>
<p>与带 selection 的 partition 有一些不同之处。</p>
<p>突然醒悟其实这就是基于partition 实现的 selection，不同之处只是在于:<br>返回第 k+1 个元素还是前 k 个元素。<br>因为做完 selection 后，这里的 partition 必然也实现了此效果。</p>
<p>基于 selection 的 partition, 可以用 O(n) 时间把 median 当做 pivot.</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getLeastNumbers</span>(<span class="params">self, arr: List[int], k: int</span>) -&gt; List[int]:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">partition</span>(<span class="params">nums, left, right</span>):</span>  <span class="comment"># assume  left &lt; right</span></span><br><span class="line">            pivot = nums[right]  <span class="comment"># 取最后一个</span></span><br><span class="line">            i = left</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(left, right):  <span class="comment"># 不取 right, 只能取到 right - 1 </span></span><br><span class="line">                <span class="keyword">if</span> nums[j] &lt; pivot:</span><br><span class="line">                    nums[i], nums[j] = nums[j], nums[i]</span><br><span class="line">                    i += <span class="number">1</span></span><br><span class="line">            nums[i], nums[right] = nums[right], nums[i]</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>:  <span class="comment"># 特殊情况处理</span></span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        <span class="comment"># if k == len(arr): # 可不加此，下面代码也能处理</span></span><br><span class="line">        <span class="comment">#     return arr</span></span><br><span class="line">        <span class="comment"># 当找到第 k 小的数字，即划分好了前 k 小的数字</span></span><br><span class="line">        left, right = <span class="number">0</span>, len(arr) - <span class="number">1</span></span><br><span class="line">        target = k - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> left &lt; right:</span><br><span class="line">            <span class="comment"># left == right 说明最后一次，有 target = left = right</span></span><br><span class="line">            ind = partition(arr, left, right)  <span class="comment"># 原地修改了 arr</span></span><br><span class="line">            <span class="keyword">if</span> ind == target:</span><br><span class="line">                <span class="comment"># 当前 ind 恰是 target, 恰有 arr[0,target-1] &lt; arr[target] &lt; arr[target+1, n-1]</span></span><br><span class="line">                <span class="keyword">return</span> arr[:target + <span class="number">1</span>]  <span class="comment"># 可直接返回</span></span><br><span class="line">            <span class="keyword">elif</span> ind &lt; target:</span><br><span class="line">                <span class="comment"># arr划分为 arr[0,ind-1] &lt; arr[ind] &lt; arr[ind+1, n-1], target 需在右半段中找</span></span><br><span class="line">                left = ind + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 当前 arr 划分为 arr[0,ind-1] &lt; arr[ind] &lt; arr[ind+1, n-1], 而 target 需要在左半段中找</span></span><br><span class="line">                right = ind - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> arr[:left + <span class="number">1</span>]  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    array = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">    print(solution.getLeastNumbers(array, <span class="number">2</span>))</span><br><span class="line">    <span class="comment"># [1, 2]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">arr = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">k = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">left = <span class="number">0</span></span><br><span class="line">right = <span class="number">2</span></span><br><span class="line">target = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">进入循环</span><br><span class="line">partition(arr, left, right) </span><br><span class="line">pivot = nums[right] = nums[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">nums[j] = nums[<span class="number">0</span>] = <span class="number">3</span> &gt; pivot = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">1</span> 只能取到 right - <span class="number">1</span> = <span class="number">2</span> - <span class="number">1</span> = <span class="number">1</span> </span><br><span class="line">nums[j] = nums[<span class="number">1</span>] = <span class="number">2</span> &gt; pivot = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">nums[i] = nums[right] = nums[<span class="number">0</span>] = nums[<span class="number">2</span>] = <span class="number">1</span> </span><br><span class="line">nums[right] = nums[i] = nums[<span class="number">2</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] </span><br><span class="line"><span class="keyword">return</span> i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">ind = i = <span class="number">0</span> &lt; target = <span class="number">1</span></span><br><span class="line">left = ind + <span class="number">1</span> = <span class="number">1</span> &lt; right = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">再循环</span><br><span class="line">ind = partition(arr, left, right)</span><br><span class="line">pivot = nums[right] = nums[<span class="number">2</span>] = <span class="number">3</span></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">1</span> 只能取到 right - <span class="number">1</span> = <span class="number">2</span> - <span class="number">1</span> = <span class="number">1</span> </span><br><span class="line">nums[j] = nums[<span class="number">1</span>] = <span class="number">2</span> &lt; pivot = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span> </span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span> </span><br><span class="line">nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">nums[i] = nums[right] = nums[<span class="number">1</span>] = nums[<span class="number">2</span>] = <span class="number">3</span> </span><br><span class="line">nums[right] = nums[i] = nums[<span class="number">2</span>] = nums[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">nums = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>] </span><br><span class="line"><span class="keyword">return</span> i = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">ind = i = <span class="number">2</span> &gt; target = <span class="number">1</span></span><br><span class="line">right = ind - <span class="number">1</span> = <span class="number">2</span> - <span class="number">1</span> = <span class="number">1</span> = left </span><br><span class="line">跳出循环</span><br><span class="line"><span class="keyword">return</span> arr[:left + <span class="number">1</span>] = arr[:<span class="number">1</span> + <span class="number">1</span>] = arr[<span class="number">0</span>:<span class="number">2</span>] = [<span class="number">1</span>, <span class="number">2</span>]</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># 取数组第一个值，该值进行归位，左边都比该值小，右边都比该值大。</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partition</span>(<span class="params">self, nums, left, right</span>):</span></span><br><span class="line">        pivot = nums[left]</span><br><span class="line">        <span class="comment"># 原地排序</span></span><br><span class="line">        <span class="keyword">while</span> left &lt; right:</span><br><span class="line">            <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> pivot &lt;= nums[right]:</span><br><span class="line">                right -= <span class="number">1</span></span><br><span class="line">            <span class="comment"># 从right开始，如果比tmp小，则交换。</span></span><br><span class="line">            nums[left] = nums[right]</span><br><span class="line">            <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[left] &lt;= pivot:</span><br><span class="line">                left += <span class="number">1</span></span><br><span class="line">            <span class="comment"># 从left开始，如果比tmp大，则交换。</span></span><br><span class="line">            nums[right] = nums[left]</span><br><span class="line">        nums[left] = pivot</span><br><span class="line">        <span class="keyword">return</span> left</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getLeastNumbers</span>(<span class="params">self, arr: List[int], k: int</span>) -&gt; List[int]:</span></span><br><span class="line">        size = len(arr)</span><br><span class="line">        <span class="keyword">if</span> size == <span class="number">0</span> <span class="keyword">or</span> k &gt; size: <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> size == <span class="number">1</span> <span class="keyword">or</span> size == k:</span><br><span class="line">            <span class="keyword">return</span> arr</span><br><span class="line">        left, right = <span class="number">0</span>, size - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> left &lt;= right:  <span class="comment"># 这里其实也相当于是二分法</span></span><br><span class="line">            pivot = self.partition(arr, left, right)  <span class="comment"># left, right, split_ind 都是原始 index</span></span><br><span class="line">            <span class="keyword">if</span> pivot == k:  <span class="comment"># 在 split_ind 左边有 k 个元素，全部不大于 pivot</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> pivot &gt; k:</span><br><span class="line">                right = pivot - <span class="number">1</span>  <span class="comment"># 不-1 会陷入死循环</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                left = pivot + <span class="number">1</span>  <span class="comment"># 不 +1 会陷入死循环</span></span><br><span class="line">        <span class="keyword">return</span> arr[:k]</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getLeastNumbers</span>(<span class="params">self, arr: List[int], k: int</span>) -&gt; List[int]:</span></span><br><span class="line">        l, r = <span class="number">0</span>, len(arr) - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            pivot = self.partition(arr, l, r)</span><br><span class="line">            <span class="keyword">if</span> pivot &gt; k - <span class="number">1</span>:</span><br><span class="line">                r = pivot - <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                l = pivot + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> arr[:k]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partition</span>(<span class="params">self, nums, l, r</span>):</span></span><br><span class="line">        pivot = r</span><br><span class="line">        right = l</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(l, r):</span><br><span class="line">            <span class="keyword">if</span> nums[i] &lt; nums[pivot]:</span><br><span class="line">                nums[i], nums[right] = nums[right], nums[i]</span><br><span class="line">                right += <span class="number">1</span></span><br><span class="line">        nums[pivot], nums[right] = nums[right], nums[pivot]</span><br><span class="line">        <span class="keyword">return</span> right</span><br></pre></td></tr></tbody></table></figure>



<p>法二：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getLeastNumbers</span>(<span class="params">self, arr: List[int], k: int</span>) -&gt; List[int]:</span></span><br><span class="line">        heapq.heapify(arr)</span><br><span class="line">        <span class="keyword">return</span> heapq.nsmallest(k, arr)</span><br></pre></td></tr></tbody></table></figure>

<p>法三<br>通过构造k个元素的大根堆来存储最小的k个元素，实时维护数组的前 k 小值，步骤如下：</p>
<p>将数组中的元素依次入堆，<br>如果堆中元素不足K个，那么就是直接添加；<br>当堆中元素大于等于K个时，<br>首先取数组前k个元素初始化堆，从最后一个非叶结点开始到根结点来构建最大堆<br>随后从第 k+1 个数开始遍历，依次将堆顶元素与遍历到的当前元素比较</p>
<ol>
<li>如果大于大根堆的堆顶元素，则说明这个元素不属于最小的k个数之列，<br>跳过不入堆。</li>
<li>如果当遍历到的数比大根堆的堆顶的数要小，<br>把堆顶元素弹出，再插入当前遍历到的数。<br>那么将堆顶的数换成这个更小的数，再从堆顶重新堆化（heapify）构建最大堆<br>这样下去之后，由于每次从堆顶弹出的数都是堆中最大的，最小的 k 个元素一定会留在堆里，<br>最后将大根堆里的数存入数组返回，取数组的前k个元素即为前k小的数</li>
</ol>
<p>python3标准库中提供了heapq，使用原地算法得到对小顶堆进行操作<br>实现 大顶堆 方法：要对数组中所有的数取其相反数，小顶堆的插入和弹出操作均将元素 取反</p>
<p>在写代码的时候，我们使用的也是库函数中的优先队列数据结构，<br>在面试中，我们不需要实现堆的内部结构，把数据结构使用好，会分析其复杂度即可。</p>
<p>时间复杂度：O(nlogk)，其中 n 是数组 arr 的长度。由于大根堆实时维护前 k 小值，<br>所以插入删除都是 O(logk) 的时间复杂度，<br>最坏情况下数组里 n 个数都会插入，所以一共需要 O(nlogk) 的时间复杂度。</p>
<p>空间复杂度：O(k)，因为大根堆里最多 k 个数。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getLeastNumbers</span>(<span class="params">self, arr: List[int], k: int</span>) -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>:  <span class="comment"># 排除 0 的情况</span></span><br><span class="line">            <span class="keyword">return</span> list()</span><br><span class="line">        <span class="comment"># python默认是小根堆，把所有的元素都加负号以满足最大二叉堆性质</span></span><br><span class="line">        <span class="comment"># 求最小k个数那就要转化为负值来做</span></span><br><span class="line">        hp = [-x <span class="keyword">for</span> x <span class="keyword">in</span> arr[:k]]</span><br><span class="line">        <span class="comment"># 将列表hp原地改为最大二叉堆列表，具备大顶堆特征</span></span><br><span class="line">        heapq.heapify(hp)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(k, len(arr)):</span><br><span class="line">            <span class="keyword">if</span> -hp[<span class="number">0</span>] &gt; arr[i]:</span><br><span class="line">                <span class="comment"># 堆顶元素下标为0，如果这个元素小，就入堆</span></span><br><span class="line">                <span class="comment"># 将最小二叉堆hp的堆顶元素弹出</span></span><br><span class="line">                heapq.heappop(hp)</span><br><span class="line">                <span class="comment"># 将num压入堆ls中，将 item 的值加入 hp 中，保持堆的不变性。</span></span><br><span class="line">                heapq.heappush(hp, -arr[i])</span><br><span class="line">        <span class="keyword">return</span> [-x <span class="keyword">for</span> x <span class="keyword">in</span> hp]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    array = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line">    print(solution.getLeastNumbers(array, <span class="number">2</span>))</span><br><span class="line">    <span class="comment"># [2, 1]</span></span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">array</span> = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line">k = <span class="number">2</span></span><br><span class="line">arr[:k] = arr[:<span class="number">2</span>] = [<span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">hp = [<span class="number">-3</span>, <span class="number">-2</span>]</span><br><span class="line">heapq.heapify(hp)  最小堆</span><br><span class="line">hp = [<span class="number">-3</span>, <span class="number">-2</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(k, len(arr))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, <span class="number">6</span>)</span><br><span class="line">    i = <span class="number">2</span></span><br><span class="line">    -hp[<span class="number">0</span>] = <span class="number">3</span> &gt; arr[i] = arr[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    heapq.heappop(hp)</span><br><span class="line">    hp = [<span class="number">-2</span>]</span><br><span class="line">    heapq.heappush(hp, -arr[i])</span><br><span class="line">    heapq.heappush(hp, <span class="number">-1</span>)</span><br><span class="line">    hp = [<span class="number">-2</span>, <span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">    i = <span class="number">3</span></span><br><span class="line">    -hp[<span class="number">0</span>] = <span class="number">2</span> &lt; arr[i] = arr[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">4</span></span><br><span class="line">    -hp[<span class="number">0</span>] = <span class="number">2</span> &lt; arr[i] = arr[<span class="number">4</span>] = <span class="number">6</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">5</span></span><br><span class="line">    -hp[<span class="number">0</span>] = <span class="number">2</span> &lt; arr[i] = arr[<span class="number">3</span>] = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [-x <span class="keyword">for</span> x <span class="keyword">in</span> hp]</span><br><span class="line">    <span class="keyword">return</span> [-x <span class="keyword">for</span> x <span class="keyword">in</span> [<span class="number">-2</span>, <span class="number">-1</span>]]</span><br><span class="line">    <span class="keyword">return</span> [<span class="number">2</span>, <span class="number">1</span>]]</span><br></pre></td></tr></tbody></table></figure>

<p>-3 &lt; -2</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">   <span class="number">-3</span></span><br><span class="line">   /</span><br><span class="line">  <span class="number">-2</span></span><br><span class="line"></span><br><span class="line">   /</span><br><span class="line">  <span class="number">-2</span></span><br><span class="line">不符合最小堆，调整</span><br><span class="line">   <span class="number">-2</span></span><br><span class="line">   /</span><br><span class="line"></span><br><span class="line">   <span class="number">-2</span></span><br><span class="line">   /</span><br><span class="line">  <span class="number">-1</span></span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getLeastNumbers</span>(<span class="params">self, arr: List[int], k: int</span>) -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> list()</span><br><span class="line">        <span class="comment"># python默认是小根堆，求最小k个数那就要转化为负值来做，变成大根堆</span></span><br><span class="line">        hp = [-x <span class="keyword">for</span> x <span class="keyword">in</span> arr[:k]]</span><br><span class="line">        <span class="comment"># 将列表hp原地改为最大二叉堆列表，具备大顶堆特征</span></span><br><span class="line">        heapq.heapify(hp)  </span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> arr[k:]:</span><br><span class="line">            <span class="keyword">if</span> -hp[<span class="number">0</span>] &gt; item:</span><br><span class="line">                <span class="comment"># 堆顶元素下标为0，如果这个元素小，就入堆</span></span><br><span class="line">                <span class="comment"># 将最小二叉堆hp的堆顶元素弹出</span></span><br><span class="line">                heapq.heappop(hp)  </span><br><span class="line">                <span class="comment"># 将num压入堆ls中</span></span><br><span class="line">                heapq.heappush(hp, -item)</span><br><span class="line">        <span class="keyword">return</span> [-x <span class="keyword">for</span> x <span class="keyword">in</span> hp]</span><br></pre></td></tr></tbody></table></figure>


<p>击败97%</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getLeastNumbers</span>(<span class="params">self, arr: List[int], k: int</span>) -&gt; List[int]:</span></span><br><span class="line">        heap = [-a <span class="keyword">for</span> a <span class="keyword">in</span> arr[:k]]</span><br><span class="line">        heapq.heapify(heap)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(k, len(arr)):</span><br><span class="line">            heapq.heappushpop(heap, -arr[i])</span><br><span class="line">        <span class="keyword">return</span> [-a <span class="keyword">for</span> a <span class="keyword">in</span> heap]</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span>   </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getLeastNumbers</span>(<span class="params">self, arr: List[int], k: int</span>) -&gt; List[int]:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> arr <span class="keyword">or</span> k == <span class="number">0</span>: <span class="keyword">return</span> []</span><br><span class="line">    <span class="keyword">if</span> len(arr) &lt;= k: <span class="keyword">return</span> arr</span><br><span class="line">    heap = arr[:k]  <span class="comment"># 初始化</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">buildMaxHeap</span>(<span class="params">pos</span>):</span></span><br><span class="line">        <span class="keyword">while</span> pos*<span class="number">2</span>+<span class="number">1</span> &lt; k:</span><br><span class="line">            max_pos = pos*<span class="number">2</span>+<span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> pos*<span class="number">2</span>+<span class="number">2</span> &lt; k <span class="keyword">and</span> heap[pos*<span class="number">2</span>+<span class="number">2</span>] &gt; heap[pos*<span class="number">2</span>+<span class="number">1</span>]:  <span class="comment"># 存在右节点，且右节点大于左节点</span></span><br><span class="line">                max_pos += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> heap[pos] &lt; heap[max_pos]:  <span class="comment"># 最大节点大于根节点，上浮/下沉</span></span><br><span class="line">                heap[pos],heap[max_pos] = heap[max_pos],heap[pos]</span><br><span class="line">                pos = max_pos</span><br><span class="line">            <span class="keyword">else</span>: <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(k//<span class="number">2</span>, <span class="number">-1</span>, <span class="number">-1</span>):  <span class="comment"># k//2 ~ 0: 2i+1为左节点于数组中index</span></span><br><span class="line">        buildMaxHeap(i)  <span class="comment"># 由叶子节点开始上浮</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(k, len(arr)):</span><br><span class="line">        <span class="keyword">if</span> arr[i] &lt; heap[<span class="number">0</span>]:</span><br><span class="line">            heap[<span class="number">0</span>] = arr[i]</span><br><span class="line">            buildMaxHeap(<span class="number">0</span>)  <span class="comment"># 由根节点开始下沉</span></span><br><span class="line">        <span class="keyword">else</span>: <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">return</span> heap</span><br></pre></td></tr></tbody></table></figure>


<p>大根堆 – 最小k个元素<br>求前k个最小用最大堆，求前k个最大用最小堆。<br>步骤如下：<br>1: 取数组前k个元素初始化堆，从最后一个非叶子节点开始到根节点来构建大根堆<br>2: 当某个元素大于堆顶元素时，直接抛弃<br>3: 当某个元素小于堆顶元素时，替换栈顶元素，再从堆顶重新构建大根堆</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">swap</span>(<span class="params">heap, i, j</span>):</span></span><br><span class="line">        heap[i], heap[j] = heap[j], heap[i]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">heapify</span>(<span class="params">self, heap, i</span>):</span></span><br><span class="line">        left, right = <span class="number">2</span> * i + <span class="number">1</span>, <span class="number">2</span> * i + <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        largest = i</span><br><span class="line">        <span class="keyword">if</span> left &lt; len(heap) <span class="keyword">and</span> heap[left] &gt; heap[largest]:</span><br><span class="line">            largest = left</span><br><span class="line">        <span class="keyword">if</span> right &lt; len(heap) <span class="keyword">and</span> heap[right] &gt; heap[largest]:</span><br><span class="line">            largest = right</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> largest != i:  <span class="comment"># 调整当前子树为大顶堆</span></span><br><span class="line">            self.swap(heap, i, largest)</span><br><span class="line">            self.heapify(heap, largest)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">build_heap</span>(<span class="params">self, heap: list</span>):</span></span><br><span class="line">        <span class="comment"># 从最后一个非叶子节点开始构建大根堆, len(heap)//2 - 1就是最后一个非叶子节点</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(heap) // <span class="number">2</span> - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            self.heapify(heap, i)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getLeastNumbers</span>(<span class="params">self, arr: list, k: int</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> arr <span class="keyword">or</span> k &lt;= <span class="number">0</span>: <span class="keyword">return</span> []</span><br><span class="line">        <span class="keyword">if</span> len(arr) &lt;= k: <span class="keyword">return</span> arr</span><br><span class="line"></span><br><span class="line">        heap = arr[:k]</span><br><span class="line">        self.build_heap(heap)  <span class="comment"># 构建大根堆</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(k, len(arr)):</span><br><span class="line">            <span class="keyword">if</span> arr[i] &lt; heap[<span class="number">0</span>]:  <span class="comment"># 当前元素比堆根小，则弹出堆根并插入当前元素</span></span><br><span class="line">                heap[<span class="number">0</span>] = arr[i]</span><br><span class="line">                self.heapify(heap, <span class="number">0</span>)  <span class="comment"># 重新调整堆根</span></span><br><span class="line">        <span class="keyword">return</span> heap</span><br></pre></td></tr></tbody></table></figure>



<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GetLeastNumbers_Solution</span>(<span class="params">self, tinput, k</span>):</span></span><br><span class="line">        <span class="comment"># 第一种</span></span><br><span class="line">        <span class="comment"># if len(tinput) &lt; k:</span></span><br><span class="line">        <span class="comment">#     return []</span></span><br><span class="line">        <span class="comment"># ret = sorted(tinput)</span></span><br><span class="line">        <span class="comment"># return ret[:k]</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 第二种,使用最大堆</span></span><br><span class="line">        <span class="comment"># 创建或者是插入最大堆</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">createMaxHeap</span>(<span class="params">num</span>):</span></span><br><span class="line">            maxHeap.append(num)</span><br><span class="line">            currentIndex = len(maxHeap) - <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> currentIndex != <span class="number">0</span>:</span><br><span class="line">                parentIndex = (currentIndex - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>  <span class="comment"># 任意节点的父节点</span></span><br><span class="line">                <span class="keyword">if</span> maxHeap[parentIndex] &lt; maxHeap[currentIndex]:</span><br><span class="line">                    maxHeap[parentIndex], maxHeap[currentIndex] = maxHeap[currentIndex], maxHeap[parentIndex]</span><br><span class="line">                    currentIndex = parentIndex</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 调整最大堆，头节点发生改变</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">adjustMaxHeap</span>(<span class="params">num</span>):</span></span><br><span class="line">            <span class="keyword">if</span> num &lt; maxHeap[<span class="number">0</span>]:</span><br><span class="line">                maxHeap[<span class="number">0</span>] = num</span><br><span class="line"></span><br><span class="line">            maxHeapLen = len(maxHeap)</span><br><span class="line">            index = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span> index &lt; maxHeapLen:</span><br><span class="line">                leftIndex = index * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">                rightIndex = index * <span class="number">2</span> + <span class="number">2</span></span><br><span class="line">                <span class="keyword">if</span> rightIndex &lt; maxHeapLen:</span><br><span class="line">                    <span class="keyword">if</span> maxHeap[rightIndex] &lt; maxHeap[leftIndex]:</span><br><span class="line">                        largerIndex = leftIndex</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        largerIndex = rightIndex</span><br><span class="line">                <span class="keyword">elif</span> leftIndex &lt; maxHeapLen:</span><br><span class="line">                    largerIndex = leftIndex</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> maxHeap[index] &lt; maxHeap[largerIndex]:</span><br><span class="line">                    maxHeap[index], maxHeap[largerIndex] = maxHeap[largerIndex], maxHeap[index]</span><br><span class="line">                index = largerIndex</span><br><span class="line"></span><br><span class="line">        maxHeap = []</span><br><span class="line">        tinputLen = len(tinput)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> tinputLen &lt; k <span class="keyword">or</span> k &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(tinputLen):</span><br><span class="line">            <span class="keyword">if</span> i &lt; k:</span><br><span class="line">                createMaxHeap(tinput[i])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                adjustMaxHeap(tinput[i])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sorted(maxHeap)</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h4 id="215-数组中的第K个最大元素"><a href="#215-数组中的第K个最大元素" class="headerlink" title="215. 数组中的第K个最大元素"></a>215. 数组中的第K个最大元素</h4><p>​    <strong>在未排序的数组中找到第 k 个最大的元素。请注意，你需要找的是数组排序后的第 k 个最大的元素，而不是第 k 个不同的元素。</strong></p>
<p>示例 1:</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: [<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">4</span>] 和 k = <span class="number">2</span></span><br><span class="line">输出: <span class="number">5</span></span><br></pre></td></tr></tbody></table></figure>

<p>示例 2:</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: [<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">6</span>] 和 k = <span class="number">4</span></span><br><span class="line">输出: <span class="number">4</span></span><br></pre></td></tr></tbody></table></figure>
<p>说明：你可以假设 k 总是有效的，且 1 ≤ k ≤ 数组的长度。</p>
<p>题目要求我们找到“数组排序后的第 k 个最大的元素，而不是第 k 个不同的元素” ，<br>语义是从右边往左边数第 k 个元素（从 1 开始），那么从左向右数是第几个呢，<br>我们列出几个找找规律就好了。<br>一共 6 个元素，找第 2 大，索引是 4；<br>一共 6 个元素，找第 4 大，索引是 2。<br>因此，升序排序以后，目标元素的索引是 len - k。<br>找第 k 大，即找第 len - k 小</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span>(<span class="params">self, nums: List[int], k: int</span>) -&gt; int:</span></span><br><span class="line">        <span class="keyword">return</span> heapq.nlargest(k, nums)[<span class="number">-1</span>]</span><br></pre></td></tr></tbody></table></figure>

<p>法二：<br>借助 partition 操作定位到最终排定以后索引为 len - k 的那个元素（特别注意：随机化切分元素）</p>
<p>时间复杂度：O(N)，这里 N 是数组的长度，理由可以参考主定理进行分析。<br>空间复杂度：O(1)，原地排序，没有借助额外的辅助空间。<br>注意：本题必须随机初始化 pivot 元素，否则通过时间会很慢，因为测试用例中有极端测试用例。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span>(<span class="params">self, nums: List[int], k: int</span>) -&gt; int:</span></span><br><span class="line">        size = len(nums)</span><br><span class="line">        target = size - k</span><br><span class="line">        left = <span class="number">0</span></span><br><span class="line">        right = size - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:  <span class="comment"># 死循环</span></span><br><span class="line">            index = self.__partition(nums, left, right)</span><br><span class="line">            <span class="keyword">if</span> index == target:</span><br><span class="line">                <span class="keyword">return</span> nums[index]  <span class="comment"># 结束循环</span></span><br><span class="line">            <span class="keyword">elif</span> index &lt; target:</span><br><span class="line">                <span class="comment"># 下一轮在 [index + 1, right] 里找</span></span><br><span class="line">                left = index + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                right = index - <span class="number">1</span></span><br><span class="line">    <span class="string">'''parition 的操作</span></span><br><span class="line"><span class="string">         在循环中，保持的循环不变量是：</span></span><br><span class="line"><span class="string">         [left + 1, j] &lt; pivot 与 (j, i) &gt;= pivot</span></span><br><span class="line"><span class="string">         因此，在 partition 的最后，需要将 left 位置与 j 位置交换，交换以后就能得到：</span></span><br><span class="line"><span class="string">         [left, j - 1] &lt; pivot，nums[j] = pivot ，[j + 1, right] &gt;= pivot ，j 位置就是 pivot 在排序以后应该呆的位置。</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__partition</span>(<span class="params">self, nums, left, right</span>):</span></span><br><span class="line"></span><br><span class="line">        pivot = nums[left]</span><br><span class="line">        j = left</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(left + <span class="number">1</span>, right + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> nums[i] &lt; pivot:</span><br><span class="line">                j += <span class="number">1</span>   <span class="comment"># 小于 pivot 的元素都被交换到前面</span></span><br><span class="line">                nums[i], nums[j] = nums[j], nums[i]</span><br><span class="line"></span><br><span class="line">        <span class="comment">#  partition 的作用：把一个数组的子区间按照 pivot 进行分区，分区完成以后，交换 left 和 分区的分界线，把切分元素 pivot 交换到它排序以后最终确定的位置上。</span></span><br><span class="line">        nums[left], nums[j] = nums[j], nums[left]</span><br><span class="line">        <span class="keyword">return</span> j</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">array</span> = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">k = <span class="number">2</span></span><br><span class="line">size = <span class="number">3</span></span><br><span class="line">target = size - k = <span class="number">3</span> - <span class="number">2</span> = <span class="number">1</span> </span><br><span class="line">left = <span class="number">0</span></span><br><span class="line">right = size - <span class="number">1</span> = <span class="number">3</span> - <span class="number">1</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">index = self.__partition(nums, left, right)</span><br><span class="line">    pivot = nums[left] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    j = left = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    nums[i] = nums[<span class="number">1</span>] = <span class="number">2</span> &lt; pivot = <span class="number">3</span></span><br><span class="line">    j = j + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">    nums[i] = nums[j] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span>  </span><br><span class="line">    nums[j] = nums[i] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span>  </span><br><span class="line"></span><br><span class="line">    i = <span class="number">2</span> </span><br><span class="line">    nums[i] = nums[<span class="number">2</span>] = <span class="number">1</span> &lt; pivot = <span class="number">3</span></span><br><span class="line">    j = j + <span class="number">1</span> = <span class="number">1</span> + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">    nums[i] = nums[j] = nums[<span class="number">2</span>] = nums[<span class="number">2</span>] = <span class="number">1</span>  </span><br><span class="line">    nums[j] = nums[i] = nums[<span class="number">2</span>] = nums[<span class="number">2</span>] = <span class="number">1</span>  </span><br><span class="line"></span><br><span class="line">    i 只取到 right + <span class="number">1</span> - <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">    跳出循环</span><br><span class="line"></span><br><span class="line">    nums[left] = nums[j] = nums[<span class="number">0</span>] = nums[<span class="number">2</span>] = <span class="number">1</span> </span><br><span class="line">    nums[j] = nums[left] = nums[<span class="number">2</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] 切分元素 pivot = <span class="number">3</span> 交换到它排序以后最终确定的位置上。</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> j</span><br><span class="line">index = j = <span class="number">2</span> &gt; target = <span class="number">1</span></span><br><span class="line">right = index - <span class="number">1</span> = <span class="number">2</span> - <span class="number">1</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">self.__partition(nums, left, right)</span><br><span class="line">    pivot = nums[left] = <span class="number">1</span></span><br><span class="line">    j = left = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    nums[<span class="number">1</span>] = <span class="number">2</span> &gt; pivot = <span class="number">1</span></span><br><span class="line">    i = <span class="number">2</span></span><br><span class="line">    nums[<span class="number">2</span>] = <span class="number">3</span> &gt; pivot = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    nums[left] = nums[j] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">1</span> </span><br><span class="line">    nums[j] = nums[left] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] 切分元素 pivot = <span class="number">1</span> 交换到它排序以后最终确定的位置上。     </span><br><span class="line">    <span class="keyword">return</span> j</span><br><span class="line">index = j = <span class="number">0</span> &lt; target = <span class="number">1</span></span><br><span class="line">left = index + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">self.__partition(nums, left, right)</span><br><span class="line">    pivot = nums[left] = nums[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    j = left = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">2</span></span><br><span class="line">    nums[<span class="number">2</span>] = <span class="number">3</span> &gt; pivot = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    nums[left] = nums[j] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span> </span><br><span class="line">    nums[j] = nums[left] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] 切分元素 pivot = <span class="number">2</span> 交换到它排序以后最终确定的位置上。</span><br><span class="line">    <span class="keyword">return</span> j</span><br><span class="line">index = j = <span class="number">1</span> = target = <span class="number">1</span></span><br><span class="line"><span class="keyword">return</span> nums[index] = nums[<span class="number">1</span>] = <span class="number">2</span></span><br></pre></td></tr></tbody></table></figure>


<p>法三：<br>随机</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span>(<span class="params">self, nums: List[int], k: int</span>) -&gt; int:</span></span><br><span class="line">        size = len(nums)</span><br><span class="line"></span><br><span class="line">        target = size - k</span><br><span class="line">        left = <span class="number">0</span></span><br><span class="line">        right = size - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            index = self.__partition(nums, left, right)</span><br><span class="line">            <span class="keyword">if</span> index == target:</span><br><span class="line">                <span class="keyword">return</span> nums[index]</span><br><span class="line">            <span class="keyword">elif</span> index &lt; target:</span><br><span class="line">                <span class="comment"># 下一轮在 [index + 1, right] 里找</span></span><br><span class="line">                left = index + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                right = index - <span class="number">1</span></span><br><span class="line">    <span class="string">''' parition 的操作</span></span><br><span class="line"><span class="string">        在循环中，保持的循环不变量是：</span></span><br><span class="line"><span class="string">        [left + 1, j] &lt; pivot 与 (j, i) &gt;= pivot</span></span><br><span class="line"><span class="string">        因此，在 partition 的最后，需要将 left 位置与 j 位置交换，交换以后就能得到：</span></span><br><span class="line"><span class="string">        [left, j - 1] &lt; pivot，nums[j] = pivot ，[j + 1, right] &gt;= pivot ，j 位置就是 pivot 在排序以后应该呆的位置。</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__partition</span>(<span class="params">self, nums, left, right</span>):</span></span><br><span class="line">        <span class="comment"># 随机化切分元素</span></span><br><span class="line">        <span class="comment"># randint 是包括左右区间的</span></span><br><span class="line">        random_index = random.randint(left, right)</span><br><span class="line">        nums[random_index], nums[left] = nums[left], nums[random_index]</span><br><span class="line"></span><br><span class="line">        pivot = nums[left]</span><br><span class="line">        j = left</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(left + <span class="number">1</span>, right + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> nums[i] &lt; pivot:</span><br><span class="line">                j += <span class="number">1</span></span><br><span class="line">                nums[i], nums[j] = nums[j], nums[i]</span><br><span class="line">        <span class="comment">#  partition 的作用：把一个数组的子区间按照 pivot 进行分区，分区完成以后，交换 left 和 分区的分界线，把切分元素 pivot 交换到它排序以后最终确定的位置上。</span></span><br><span class="line">        nums[left], nums[j] = nums[j], nums[left]</span><br><span class="line">        <span class="keyword">return</span> j</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">array</span> = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line">k = <span class="number">2</span></span><br><span class="line">size = <span class="number">6</span></span><br><span class="line">target = size - k = <span class="number">6</span> - <span class="number">2</span> = <span class="number">4</span></span><br><span class="line">left = <span class="number">0</span></span><br><span class="line">right = size - <span class="number">1</span> = <span class="number">6</span> - <span class="number">1</span> = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">index = self.__partition(nums, left, right)</span><br><span class="line">    random_index = left</span><br><span class="line">    pivot = nums[left] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    j = left = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    nums[i] = nums[<span class="number">1</span>] = <span class="number">2</span> &lt; pivot = <span class="number">3</span></span><br><span class="line">    j = j + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">    nums[i] = nums[j] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span>  </span><br><span class="line">    nums[j] = nums[i] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span>  </span><br><span class="line"></span><br><span class="line">    i = <span class="number">2</span> </span><br><span class="line">    nums[i] = nums[<span class="number">2</span>] = <span class="number">1</span> &lt; pivot = <span class="number">3</span></span><br><span class="line">    j = j + <span class="number">1</span> = <span class="number">1</span> + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">    nums[i] = nums[j] = nums[<span class="number">2</span>] = nums[<span class="number">2</span>] = <span class="number">1</span>  </span><br><span class="line">    nums[j] = nums[i] = nums[<span class="number">2</span>] = nums[<span class="number">2</span>] = <span class="number">1</span>  </span><br><span class="line"></span><br><span class="line">    i = <span class="number">3</span> </span><br><span class="line">    nums[i] = nums[<span class="number">3</span>] = <span class="number">5</span> &gt; pivot = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">4</span> </span><br><span class="line">    nums[i] = nums[<span class="number">4</span>] = <span class="number">6</span> &gt; pivot = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">5</span> </span><br><span class="line">    nums[i] = nums[<span class="number">5</span>] = <span class="number">4</span> &gt; pivot = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    i 只取到 right + <span class="number">1</span> - <span class="number">1</span> = <span class="number">5</span></span><br><span class="line">    跳出循环</span><br><span class="line"></span><br><span class="line">    nums[left] = nums[j] = nums[<span class="number">0</span>] = nums[<span class="number">2</span>] = <span class="number">1</span> </span><br><span class="line">    nums[j] = nums[left] = nums[<span class="number">2</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>] 切分元素 pivot = <span class="number">3</span> 交换到它排序以后最终确定的位置上。</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> j</span><br><span class="line">index = j = <span class="number">2</span> &lt; target = <span class="number">4</span></span><br><span class="line">left = index + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">self.__partition(nums, left, right)</span><br><span class="line">self.__partition(nums, <span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line">    random_index = left</span><br><span class="line">    pivot = nums[left] = nums[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">    j = left = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">4</span></span><br><span class="line">    nums[<span class="number">4</span>] = <span class="number">6</span> &gt; pivot = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">5</span></span><br><span class="line">    nums[<span class="number">5</span>] = <span class="number">4</span> &lt; pivot = <span class="number">5</span></span><br><span class="line">    j = j + <span class="number">1</span> = <span class="number">4</span></span><br><span class="line">    nums[i] = nums[j] = nums[<span class="number">5</span>] = nums[<span class="number">4</span>] = <span class="number">6</span> </span><br><span class="line">    nums[j] = nums[i] = nums[<span class="number">4</span>] = nums[<span class="number">5</span>] = <span class="number">4</span> </span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">    nums[left] = nums[j] = nums[<span class="number">3</span>] = nums[<span class="number">4</span>] = <span class="number">6</span> </span><br><span class="line">    nums[j] = nums[left] = nums[<span class="number">4</span>] = nums[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">    nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>] 切分元素 pivot = <span class="number">5</span> 交换到它排序以后最终确定的位置上。</span><br><span class="line">    <span class="keyword">return</span> j</span><br><span class="line">index = j = <span class="number">4</span> = target = <span class="number">4</span></span><br><span class="line"><span class="keyword">return</span> nums[index] = nums[<span class="number">4</span>] = <span class="number">5</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">array</span> = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line">k = <span class="number">2</span></span><br><span class="line">size = <span class="number">6</span></span><br><span class="line">target = size - k = <span class="number">6</span> - <span class="number">2</span> = <span class="number">4</span></span><br><span class="line">left = <span class="number">0</span></span><br><span class="line">right = size - <span class="number">1</span> = <span class="number">6</span> - <span class="number">1</span> = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">index = self.__partition(nums, left, right)</span><br><span class="line">    random_index = right</span><br><span class="line">    pivot = nums[left] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    j = left = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    nums[i] = nums[<span class="number">1</span>] = <span class="number">2</span> &lt; pivot = <span class="number">3</span></span><br><span class="line">    j = j + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">    nums[i] = nums[j] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span>  </span><br><span class="line">    nums[j] = nums[i] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span>  </span><br><span class="line"></span><br><span class="line">    i = <span class="number">2</span> </span><br><span class="line">    nums[i] = nums[<span class="number">2</span>] = <span class="number">1</span> &lt; pivot = <span class="number">3</span></span><br><span class="line">    j = j + <span class="number">1</span> = <span class="number">1</span> + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">    nums[i] = nums[j] = nums[<span class="number">2</span>] = nums[<span class="number">2</span>] = <span class="number">1</span>  </span><br><span class="line">    nums[j] = nums[i] = nums[<span class="number">2</span>] = nums[<span class="number">2</span>] = <span class="number">1</span>  </span><br><span class="line"></span><br><span class="line">    i = <span class="number">3</span> </span><br><span class="line">    nums[i] = nums[<span class="number">3</span>] = <span class="number">5</span> &gt; pivot = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">4</span> </span><br><span class="line">    nums[i] = nums[<span class="number">4</span>] = <span class="number">6</span> &gt; pivot = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">5</span> </span><br><span class="line">    nums[i] = nums[<span class="number">5</span>] = <span class="number">4</span> &gt; pivot = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    i 只取到 right + <span class="number">1</span> - <span class="number">1</span> = <span class="number">5</span></span><br><span class="line">    跳出循环</span><br><span class="line"></span><br><span class="line">    nums[left] = nums[j] = nums[<span class="number">0</span>] = nums[<span class="number">2</span>] = <span class="number">1</span> </span><br><span class="line">    nums[j] = nums[left] = nums[<span class="number">2</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>] 切分元素 pivot = <span class="number">3</span> 交换到它排序以后最终确定的位置上。</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> j</span><br><span class="line">index = j = <span class="number">2</span> &lt; target = <span class="number">4</span></span><br><span class="line">left = index + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">self.__partition(nums, left, right)</span><br><span class="line">self.__partition(nums, <span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line">    random_index = left</span><br><span class="line">    pivot = nums[left] = nums[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">    j = left = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">4</span></span><br><span class="line">    nums[<span class="number">4</span>] = <span class="number">6</span> &gt; pivot = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">5</span></span><br><span class="line">    nums[<span class="number">5</span>] = <span class="number">4</span> &lt; pivot = <span class="number">5</span></span><br><span class="line">    j = j + <span class="number">1</span> = <span class="number">4</span></span><br><span class="line">    nums[i] = nums[j] = nums[<span class="number">5</span>] = nums[<span class="number">4</span>] = <span class="number">6</span> </span><br><span class="line">    nums[j] = nums[i] = nums[<span class="number">4</span>] = nums[<span class="number">5</span>] = <span class="number">4</span> </span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">    nums[left] = nums[j] = nums[<span class="number">3</span>] = nums[<span class="number">4</span>] = <span class="number">6</span> </span><br><span class="line">    nums[j] = nums[left] = nums[<span class="number">4</span>] = nums[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">    nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>] 切分元素 pivot = <span class="number">5</span> 交换到它排序以后最终确定的位置上。</span><br><span class="line">    <span class="keyword">return</span> j</span><br><span class="line">index = j = <span class="number">4</span> = target = <span class="number">4</span></span><br><span class="line"><span class="keyword">return</span> nums[index] = nums[<span class="number">4</span>] = <span class="number">5</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>使用双指针，将与 pivot 相等的元素等概论地分到 pivot 最终排定位置的两边。<br>使用双指针的办法找到切分元素的位置。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span>(<span class="params">self, nums: List[int], k: int</span>) -&gt; int:</span></span><br><span class="line">        size = len(nums)</span><br><span class="line"></span><br><span class="line">        target = size - k</span><br><span class="line">        left = <span class="number">0</span></span><br><span class="line">        right = size - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            index = self.__partition(nums, left, right)</span><br><span class="line">            <span class="keyword">if</span> index == target:</span><br><span class="line">                <span class="keyword">return</span> nums[index]</span><br><span class="line">            <span class="keyword">elif</span> index &lt; target:</span><br><span class="line">                <span class="comment"># 下一轮在 [index + 1, right] 里找</span></span><br><span class="line">                left = index + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                right = index - <span class="number">1</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">parition 的操作 在之前遍历的过程中 将等于 pivot 的元素分散到两边</span></span><br><span class="line"><span class="string">在循环中，保持的循环不变量是：</span></span><br><span class="line"><span class="string">    # [left + 1, lt） &lt;= pivot</span></span><br><span class="line"><span class="string">    # (rt, right] &gt;= pivot</span></span><br><span class="line"><span class="string">因此，在 partition 的最后，需要将 left 位置与 rt 位置交换，交换以后就能得到：</span></span><br><span class="line"><span class="string">[left, rt - 1] &lt; pivot，nums[rt] = pivot ，[rt + 1, right] &gt;= pivot ，rt 位置就是 pivot 在排序以后应该呆的位置。</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__partition</span>(<span class="params">self, nums, left, right</span>):</span></span><br><span class="line">        <span class="comment"># randint 是包括左右区间的</span></span><br><span class="line">        random_index = random.randint(left, right)</span><br><span class="line">        nums[random_index], nums[left] = nums[left], nums[random_index]</span><br><span class="line"></span><br><span class="line">        pivot = nums[left]</span><br><span class="line">        lt = left + <span class="number">1</span></span><br><span class="line">        rt = right</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">while</span> lt &lt;= rt <span class="keyword">and</span> nums[lt] &lt; pivot:</span><br><span class="line">                lt += <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> lt &lt;= rt <span class="keyword">and</span> nums[rt] &gt; pivot:</span><br><span class="line">                rt -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> lt &gt; rt:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            nums[lt], nums[rt] = nums[rt], nums[lt]</span><br><span class="line">            lt += <span class="number">1</span></span><br><span class="line">            rt -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        nums[left], nums[rt] = nums[rt], nums[left]</span><br><span class="line">        <span class="keyword">return</span> rt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    array = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">    print(solution.findKthLargest(array, <span class="number">2</span>))</span><br><span class="line">    <span class="comment"># [2]</span></span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">array</span> = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">k = <span class="number">2</span></span><br><span class="line">size = <span class="number">3</span></span><br><span class="line">target = size - k = <span class="number">3</span> - <span class="number">2</span> = <span class="number">1</span> </span><br><span class="line">left = <span class="number">0</span></span><br><span class="line">right = size - <span class="number">1</span> = <span class="number">3</span> - <span class="number">1</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    self.__partition(nums, left, right)</span><br><span class="line">    random_index = random.randint(left, right) = <span class="number">0</span></span><br><span class="line">    nums[random_index] = nums[left] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    nums[left] = nums[random_index] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    pivot = nums[left] = <span class="number">3</span></span><br><span class="line">    lt = left + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">    rt = right = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> lt = <span class="number">1</span> &lt; rt = <span class="number">2</span> <span class="keyword">and</span> nums[lt] = <span class="number">2</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">    lt = lt + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> lt = <span class="number">2</span> = rt = <span class="number">2</span> <span class="keyword">and</span> nums[lt] = <span class="number">1</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">    lt = lt + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">    <span class="keyword">while</span> lt = <span class="number">3</span> &gt; rt = <span class="number">2</span> <span class="keyword">and</span> </span><br><span class="line">    退出循环</span><br><span class="line">    <span class="keyword">while</span> lt = <span class="number">3</span> &gt; rt = <span class="number">2</span> <span class="keyword">and</span> </span><br><span class="line">    不进入循环</span><br><span class="line">    <span class="keyword">if</span> lt &gt; rt:</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">    nums[left] = nums[rt] = nums[<span class="number">0</span>] = nums[<span class="number">2</span>] = <span class="number">3</span></span><br><span class="line">    nums[rt] = nums[left] = nums[<span class="number">2</span>] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">    <span class="keyword">return</span> rt</span><br><span class="line">    index = rt = <span class="number">2</span> &gt; target</span><br><span class="line">    right = index - <span class="number">1</span> = <span class="number">2</span> - <span class="number">1</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    self.__partition(nums, left, right)</span><br><span class="line">    random_index = random.randint(left, right) = <span class="number">0</span></span><br><span class="line">    nums[random_index] = nums[left] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    nums[left] = nums[random_index] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    pivot = nums[left] = <span class="number">1</span></span><br><span class="line">    lt = left + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">    rt = right = <span class="number">1</span></span><br><span class="line">    lt = rt <span class="keyword">and</span> nums[rt] = nums[<span class="number">1</span>] = <span class="number">2</span> &gt; pivot = <span class="number">1</span>:</span><br><span class="line">    rt = rt - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">    lt = <span class="number">1</span> &gt; rt  = <span class="number">0</span> <span class="keyword">and</span> </span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">    nums[left] = nums[rt] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    nums[rt] = nums[left] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">    <span class="keyword">return</span> rt</span><br><span class="line">    index = rt = <span class="number">0</span> &lt; target = <span class="number">1</span></span><br><span class="line">    left = index + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    self.__partition(nums, left, right)</span><br><span class="line">    random_index = random.randint(left, right) = <span class="number">1</span></span><br><span class="line">    nums[random_index] = nums[left] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    nums[left] = nums[random_index] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    pivot = nums[left] = <span class="number">2</span></span><br><span class="line">    lt = left + <span class="number">1</span> = <span class="number">1</span> + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">    rt = right = <span class="number">1</span></span><br><span class="line">    lt &gt; rt <span class="keyword">and</span> </span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">    nums[left] = nums[rt] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    nums[left] = nums[rt] = nums[<span class="number">1</span>] = nums[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">    切分元素 pivot = <span class="number">3</span> 交换到它排序以后最终确定的位置上</span><br><span class="line">    <span class="keyword">return</span> rt</span><br><span class="line">    index = rt = <span class="number">1</span> = target = <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> nums[index] = nums[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>双指针是同向出发的吧，参考代码 2 和参考代码 3 是一样的，这种写法使得 </p>
<figure class="highlight plain"><figcaption><span>+ 1, j] &lt; nums[left] ```，```[j + 1, right] &gt;</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">前后两个指针一边往中间走一边交换的双指针，把等于 nums[left] 的元素平均分到了区间的两边，递归树相对是平衡的。</span><br><span class="line">它们就这点区别。</span><br><span class="line"></span><br><span class="line">我觉得您这种写法会有冗余操作。就拿这 个测试案例[3,2,1,5,6,4] 2来说，您的参考代码2第一次分区需要4次交换操作，而双指针向中间的写法，应该只需要最后一次交换就可以了。</span><br><span class="line">参考代码 2 和参考代码 3 是认识 partition 的第 1 步，并且是不怎么好的写法。至于它多做了一些交换，这个正如您所说，跟输入数据具体的样子有关。对于一类数据是不好的，对于另一类数据又是好的，如果后面遍历到的元素都是 pivot 大，那么一次都不需要交换，具体的评估可能还有点复杂</span><br><span class="line"></span><br><span class="line">然后才是双指针的写法，</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">法三</span><br><span class="line">确定数据量的情况下寻找第K大的数，用快速选择的算法，快排中的轴值计算</span><br><span class="line">在分解的过程当中，我们会对子数组进行划分，</span><br><span class="line">  1. 如果某次划分得到的 index 正好就是倒数第 k 个下标的时候，就直接返回 a[index]；</span><br><span class="line">  2. 否则，如果 index 比目标下标小，就递归右子区间，</span><br><span class="line">  3. 否则递归左子区间。</span><br><span class="line">  这样就可以把原来递归两个区间变成只递归一个区间，提高了时间效率。这就是「快速选择」算法。</span><br><span class="line">至于 a[left⋯j−1] 和 a[j+1⋯right] 是否是有序的，我们不关心。</span><br><span class="line"></span><br><span class="line">一开始是n个比对，然后你选的数是第 a 个，然后就缩小了范围(left, index), (index, right)，</span><br><span class="line">接下来如果k 在(index, right)之间就只要再比对(index, right)次，然后递归下去，</span><br><span class="line">可以发现如果是平均分的话差不多就是比对n个然后是n/2 ，n/4，...,n/2^m </span><br><span class="line">加起来不会超过2n，当然了这是要分配比较均匀的情况。</span><br><span class="line">上面用了随机分片就一般不会出现全都是n-1这种情况了</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line">from typing import List</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Solution:</span><br><span class="line">    def quickSelect(self, a, l, r, target):</span><br><span class="line">        index = self.randomPartition(a, l, r)</span><br><span class="line">        if index == target:</span><br><span class="line">            return a[index]</span><br><span class="line">        elif index &lt; target:</span><br><span class="line">            return self.quickSelect(a, index + 1, r, target)</span><br><span class="line">        else:</span><br><span class="line">            return self.quickSelect(a, l, index - 1, target)</span><br><span class="line"></span><br><span class="line">    def randomPartition(self, a, l, r):</span><br><span class="line">        i = random.randint(l, r)</span><br><span class="line">        # 将随机数先放在[l,r]最右边a[r]上</span><br><span class="line">        a[i], a[r] = a[r], a[i]</span><br><span class="line">        return self.partition(a, l, r)</span><br><span class="line"></span><br><span class="line">    def partition(self, a, l, r):</span><br><span class="line">        # 在调用当前方法的randomPartition方法中，已经确定了了随机数是nums[r]</span><br><span class="line">        pivot = a[r]</span><br><span class="line">        i = l - 1</span><br><span class="line">        # nums[j] 小于 随机数 pivot 的数都跟[l,r]左边区间交换</span><br><span class="line">        for j in range(l, r):</span><br><span class="line">            if a[j] &lt; pivot:</span><br><span class="line">                i += 1</span><br><span class="line">                a[i], a[j] = a[j], a[i]</span><br><span class="line">        # 这个for循环操作就是将小于 pivot 的数都往[i, j]的左边区间设置，</span><br><span class="line">        # 从而实现存在[l, i]区间,使得对应数值都 小于 pivot</span><br><span class="line">        # 现在将pivot也就是nums[r] 跟nums[i+1]交换，从而分成两个区间[l，i+1]左, [i+2, r]右，左边区间的值都小于pivot</span><br><span class="line">        i += 1</span><br><span class="line">        a[i], a[r] = a[r], a[i]</span><br><span class="line">        return i</span><br><span class="line"></span><br><span class="line">    def findKthLargest(self, nums, k):</span><br><span class="line">        return self.quickSelect(nums, 0, len(nums) - 1, len(nums) - k)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">array</span> = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line">k = <span class="number">2</span></span><br><span class="line">self.quickSelect(nums, <span class="number">0</span>, len(nums) - <span class="number">1</span>, len(nums) - k)</span><br><span class="line">quickSelect(self, a, l, r, target)</span><br><span class="line">a = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line">l = <span class="number">0</span></span><br><span class="line">r = len(nums) - <span class="number">1</span> = <span class="number">6</span> - <span class="number">1</span> = <span class="number">5</span> </span><br><span class="line">target = len(nums) - k = <span class="number">6</span> - <span class="number">2</span> = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">self.randomPartition(a, l, r)</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">a[i] = a[r] = a[<span class="number">0</span>] = a[<span class="number">5</span>] = <span class="number">4</span></span><br><span class="line">a[r] = a[i] = a[<span class="number">5</span>] = a[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">[<span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">return</span> self.partition(a, l, r)</span><br><span class="line">pivot = a[r] = <span class="number">3</span></span><br><span class="line">i = l - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(l, r):</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    a[j] = a[<span class="number">0</span>] = <span class="number">4</span> &gt; pivot = <span class="number">3</span>:</span><br><span class="line"></span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    a[j] = a[<span class="number">1</span>] = <span class="number">2</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">-1</span> + <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">    a[i] = a[j] = a[<span class="number">0</span>] = a[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    a[j] = a[i] = a[<span class="number">1</span>] = a[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    j = <span class="number">2</span></span><br><span class="line">    a[j] = a[<span class="number">2</span>] = <span class="number">1</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">    a[i] = a[j] = a[<span class="number">1</span>] = a[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    a[j] = a[i] = a[<span class="number">2</span>] = a[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    a[j] = a[<span class="number">3</span>] = <span class="number">5</span> &gt; pivot = <span class="number">3</span>:</span><br><span class="line"></span><br><span class="line">    j = <span class="number">4</span></span><br><span class="line">    a[j] = a[<span class="number">4</span>] = <span class="number">6</span> &gt; pivot = <span class="number">3</span>:</span><br><span class="line"></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">a[i] = a[r] = a[<span class="number">2</span>] = a[<span class="number">5</span>] = <span class="number">3</span></span><br><span class="line">a[r] = a[i] = a[<span class="number">5</span>] = a[<span class="number">2</span>] = <span class="number">4</span></span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line">切分元素 pivot = <span class="number">3</span> 交换到它排序以后最终确定的位置上</span><br><span class="line"><span class="keyword">return</span> i </span><br><span class="line"></span><br><span class="line">index = i = <span class="number">2</span> &lt; target = <span class="number">4</span></span><br><span class="line"><span class="keyword">return</span> self.quickSelect(a, index + <span class="number">1</span>, r, target)</span><br><span class="line">quickSelect(self, a, l, r, target)</span><br><span class="line">a = [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line">l = <span class="number">3</span></span><br><span class="line">r = <span class="number">5</span></span><br><span class="line">target = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">self.randomPartition(a, l, r)</span><br><span class="line">i = <span class="number">3</span></span><br><span class="line">a[i] = a[r] = a[<span class="number">3</span>] = a[<span class="number">5</span>] = <span class="number">4</span></span><br><span class="line">a[r] = a[i] = a[<span class="number">5</span>] = a[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>]</span><br><span class="line"><span class="keyword">return</span> self.partition(a, l, r)</span><br><span class="line">pivot = a[<span class="number">5</span>] = <span class="number">6</span></span><br><span class="line">i = l - <span class="number">1</span> = <span class="number">2</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(l, r):</span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    a[j] = a[<span class="number">3</span>] = <span class="number">4</span> &lt; pivot = <span class="number">5</span>:</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">    a[i] = a[j] = a[<span class="number">3</span>] = a[<span class="number">3</span>] = <span class="number">4</span></span><br><span class="line">    a[j] = a[i] = a[<span class="number">3</span>] = a[<span class="number">3</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">    j = <span class="number">4</span></span><br><span class="line">    a[j] = a[<span class="number">4</span>] = <span class="number">6</span> &gt; pivot = <span class="number">5</span>:</span><br><span class="line"></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">3</span> + <span class="number">1</span> = <span class="number">4</span></span><br><span class="line">a[i] = a[r] = a[<span class="number">4</span>] = a[<span class="number">5</span>] = <span class="number">5</span></span><br><span class="line">a[r] = a[i] = a[<span class="number">5</span>] = a[<span class="number">4</span>] = <span class="number">6</span></span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">切分元素 pivot = <span class="number">3</span> 交换到它排序以后最终确定的位置上</span><br><span class="line"><span class="keyword">return</span> i </span><br><span class="line"></span><br><span class="line">index = i = <span class="number">4</span> = target</span><br><span class="line"><span class="keyword">return</span> a[index] = <span class="number">5</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span>(<span class="params">self, nums: List[int], k: int</span>) -&gt; int:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">partition</span>(<span class="params">nums, left, right</span>):</span></span><br><span class="line">            pivot = nums[right]</span><br><span class="line">            i = left</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(left, right + <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> nums[j] &lt; pivot:</span><br><span class="line">                    nums[i], nums[j] = nums[j], nums[i]</span><br><span class="line">                    i += <span class="number">1</span></span><br><span class="line">            nums[i], nums[right] = nums[right], nums[i]</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line">        n = len(nums)</span><br><span class="line">        t = n - k</span><br><span class="line">        <span class="comment">#        if not (0&lt;= t &lt;= n-1):</span></span><br><span class="line">        <span class="comment">#            return</span></span><br><span class="line">        left, right = <span class="number">0</span>, n - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> left &lt; right:  <span class="comment"># 若设置成 left &lt; right 如果下面没有语句的话，可能会漏解， 例如 [3]</span></span><br><span class="line">            ind = partition(nums, left, right)</span><br><span class="line">            <span class="keyword">if</span> ind == t:</span><br><span class="line">                <span class="keyword">return</span> nums[ind]</span><br><span class="line">            <span class="keyword">elif</span> ind &lt; t:</span><br><span class="line">                left = ind + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                right = ind - <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> nums[left]  <span class="comment"># 对应前面 left&lt;right, 若前面设置为 left &lt;= right, 则不用此语句</span></span><br></pre></td></tr></tbody></table></figure>


<p>方法二：基于堆排序的选择方法<br>思路和算法<br>我们也可以使用堆排序来解决这个问题——建立一个大根堆，<br>做 k - 1 次删除操作后堆顶元素就是我们要找的答案。<br>在很多语言中，都有优先队列或者堆的的容器可以直接使用，<br>但是在面试中，面试官更倾向于让面试者自己实现一个堆。<br>所以建议读者掌握这里大根堆的实现方法，<br>在这道题中尤其要搞懂「建堆」、「调整」和「删除」的过程。</p>
<p>时间复杂度：O(nlogn)，建堆的时间代价是 O(n)，删除的总代价是 O(klogn)，因为 k &lt; n，故渐进时间复杂为 O(n+klogn)=O(nlogn)。<br>空间复杂度：O(logn)，即递归使用栈空间的空间代价。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxHeapify</span>(<span class="params">self, a, i, heapSize</span>):</span></span><br><span class="line">        l = i * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">        r = i * <span class="number">2</span> + <span class="number">2</span></span><br><span class="line">        largest = i</span><br><span class="line">        <span class="keyword">if</span> l &lt; heapSize <span class="keyword">and</span> a[l] &gt; a[largest]:</span><br><span class="line">            largest = l</span><br><span class="line">        <span class="keyword">if</span> r &lt; heapSize <span class="keyword">and</span> a[r] &gt; a[largest]:</span><br><span class="line">            largest = r</span><br><span class="line">        <span class="keyword">if</span> largest != i:</span><br><span class="line">            a[i], a[largest] = a[largest], a[i]</span><br><span class="line">            self.maxHeapify(a, largest, heapSize)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">buildMaxHeap</span>(<span class="params">self, a, heapSize</span>):</span>  <span class="comment"># 由列表建立大根堆</span></span><br><span class="line">            <span class="string">""""从后往前遍历所有内部节点，其中最后一个内部节点的公式为len(nums_list)//2 - 1"""</span></span><br><span class="line">        <span class="comment"># 从最后一个非叶子节点开始堆化</span></span><br><span class="line">        <span class="comment"># 从最后一个非叶子节点开始构建大根堆, len(heap)//2 - 1就是最后一个非叶子节点</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(heapSize // <span class="number">2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            self.maxHeapify(a, i, heapSize)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span>(<span class="params">self, nums, k</span>):</span></span><br><span class="line">        heapSize = len(nums)</span><br><span class="line">        self.buildMaxHeap(nums, heapSize)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums) - <span class="number">1</span>, len(nums) - k, <span class="number">-1</span>):</span><br><span class="line">            nums[<span class="number">0</span>], nums[i] = nums[i], nums[<span class="number">0</span>]</span><br><span class="line">            heapSize -= <span class="number">1</span></span><br><span class="line">            self.maxHeapify(nums, <span class="number">0</span>, heapSize)</span><br><span class="line">        <span class="keyword">return</span> nums[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    array = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">    print(solution.findKthLargest(array, <span class="number">4</span>))</span><br><span class="line">    <span class="comment"># 5</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">array</span> = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">findKthLargest(self, nums, k)</span><br><span class="line">findKthLargest(<span class="built_in">array</span>, <span class="number">2</span>)</span><br><span class="line">nums = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">k = <span class="number">4</span></span><br><span class="line">heapSize = <span class="number">9</span></span><br><span class="line">self.buildMaxHeap(nums, heapSize)</span><br><span class="line">buildMaxHeap(self, a, heapSize):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(heapSize <span class="comment">// 2, -1, -1):</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">    i = <span class="number">4</span></span><br><span class="line">    self.maxHeapify(a, i, heapSize)</span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">9</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">10</span></span><br><span class="line">    largest = i = <span class="number">4</span></span><br><span class="line">    l = <span class="number">9</span> = heapSize </span><br><span class="line"></span><br><span class="line">    i = <span class="number">3</span></span><br><span class="line">    self.maxHeapify(a, i, heapSize)</span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">7</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">8</span></span><br><span class="line">    largest = i = <span class="number">3</span></span><br><span class="line">    l = <span class="number">7</span> &lt; heapSize = <span class="number">9</span></span><br><span class="line">    a[l] = a[<span class="number">7</span>] = <span class="number">5</span> &gt; a[largest] = a[<span class="number">3</span>] = <span class="number">1</span> </span><br><span class="line">    largest = l = <span class="number">7</span></span><br><span class="line">    a[r] = a[<span class="number">8</span>] = <span class="number">6</span> &gt; a[largest] = a[<span class="number">7</span>] = <span class="number">5</span> </span><br><span class="line">    largest = r = <span class="number">8</span> != i = <span class="number">3</span></span><br><span class="line">    a[i] = a[largest] = a[<span class="number">3</span>] = a[<span class="number">8</span>] = <span class="number">6</span></span><br><span class="line">    a[largest] = a[i] = a[<span class="number">7</span>] = a[<span class="number">3</span>] = <span class="number">1</span></span><br><span class="line">    a = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">1</span>]</span><br><span class="line">    self.maxHeapify(a, largest, heapSize)</span><br><span class="line">    maxHeapify(self, a, i, heapSize)</span><br><span class="line">    i = largest = <span class="number">8</span></span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">17</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">18</span></span><br><span class="line">    largest = i = <span class="number">8</span></span><br><span class="line">    l = <span class="number">17</span> &gt; heapSize = <span class="number">9</span></span><br><span class="line">    largest = <span class="number">8</span> = i</span><br><span class="line"></span><br><span class="line">    i = <span class="number">2</span></span><br><span class="line">    self.maxHeapify(a, i, heapSize)</span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">5</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">6</span></span><br><span class="line">    largest = i = <span class="number">2</span></span><br><span class="line">    l = <span class="number">5</span> &lt; heapSize = <span class="number">9</span></span><br><span class="line">    a[l] = a[<span class="number">5</span>] = <span class="number">4</span> &gt; a[largest] = a[<span class="number">2</span>] = <span class="number">3</span> </span><br><span class="line">    largest = l = <span class="number">5</span></span><br><span class="line">    a[r] = a[<span class="number">6</span>] = <span class="number">5</span> &gt; a[largest] = a[<span class="number">5</span>] = <span class="number">4</span> </span><br><span class="line">    largest = r = <span class="number">6</span> != i = <span class="number">2</span></span><br><span class="line">    a[i] = a[largest] = a[<span class="number">2</span>] = a[<span class="number">6</span>] = <span class="number">5</span></span><br><span class="line">    a[largest] = a[i] = a[<span class="number">6</span>] = a[<span class="number">2</span>] = <span class="number">3</span></span><br><span class="line">    a = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>]</span><br><span class="line">    self.maxHeapify(a, largest, heapSize)</span><br><span class="line">    maxHeapify(self, a, i, heapSize):</span><br><span class="line">    i = largest = <span class="number">6</span></span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">13</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">14</span></span><br><span class="line">    largest = i = <span class="number">6</span></span><br><span class="line">    l = <span class="number">13</span> &gt; heapSize = <span class="number">9</span></span><br><span class="line">    largest = <span class="number">6</span> = i</span><br><span class="line"></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    self.maxHeapify(a, i, heapSize)</span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">4</span></span><br><span class="line">    largest = i = <span class="number">1</span></span><br><span class="line">    l = <span class="number">3</span> &lt; heapSize = <span class="number">9</span></span><br><span class="line">    a[l] = a[<span class="number">3</span>] = <span class="number">6</span> &gt; a[largest] = a[<span class="number">1</span>] = <span class="number">2</span> </span><br><span class="line">    largest = l = <span class="number">3</span></span><br><span class="line">    a[r] = a[<span class="number">4</span>] = <span class="number">2</span> &lt; a[largest] = a[<span class="number">3</span>] = <span class="number">6</span> </span><br><span class="line">    largest = <span class="number">3</span> != i = <span class="number">1</span></span><br><span class="line">    a[i] = a[largest] = a[<span class="number">1</span>] = a[<span class="number">3</span>] = <span class="number">6</span></span><br><span class="line">    a[largest] = a[i] = a[<span class="number">3</span>] = a[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    a = [<span class="number">3</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>]</span><br><span class="line">    self.maxHeapify(a, largest, heapSize)</span><br><span class="line">    maxHeapify(self, a, i, heapSize):</span><br><span class="line">    i = largest = <span class="number">3</span></span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">7</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">8</span></span><br><span class="line">    largest = i = <span class="number">3</span></span><br><span class="line">    l = <span class="number">7</span> &lt; heapSize = <span class="number">9</span></span><br><span class="line">    a[l] = a[<span class="number">7</span>] = <span class="number">5</span> &gt; a[largest] = a[<span class="number">3</span>] = <span class="number">2</span> </span><br><span class="line">    largest = l = <span class="number">7</span></span><br><span class="line">    a[r] = a[<span class="number">8</span>] = <span class="number">1</span> &lt; a[largest] = a[<span class="number">7</span>] = <span class="number">5</span> </span><br><span class="line">    largest = l = <span class="number">7</span> != i = <span class="number">3</span></span><br><span class="line">    a[i] = a[largest] = a[<span class="number">3</span>] = a[<span class="number">7</span>] = <span class="number">5</span></span><br><span class="line">    a[largest] = a[i] = a[<span class="number">7</span>] = a[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">    self.maxHeapify(a, largest, heapSize)</span><br><span class="line">    maxHeapify(self, a, i, heapSize):</span><br><span class="line">    i = largest = <span class="number">7</span></span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">15</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">16</span></span><br><span class="line">    largest = i = <span class="number">6</span></span><br><span class="line">    l = <span class="number">15</span> &gt; heapSize = <span class="number">9</span></span><br><span class="line">    largest = <span class="number">7</span> = i</span><br><span class="line"></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    self.maxHeapify(a, i, heapSize)</span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">2</span></span><br><span class="line">    largest = i = <span class="number">0</span></span><br><span class="line">    l = <span class="number">1</span> &lt; heapSize = <span class="number">9</span></span><br><span class="line">    a[l] = a[<span class="number">1</span>] = <span class="number">6</span> &gt; a[largest] = a[<span class="number">0</span>] = <span class="number">3</span> </span><br><span class="line">    largest = l = <span class="number">1</span></span><br><span class="line">    a[r] = a[<span class="number">2</span>] = <span class="number">5</span> &lt; a[largest] = a[<span class="number">1</span>] = <span class="number">6</span></span><br><span class="line">    largest = l = <span class="number">1</span> != i = <span class="number">0</span> </span><br><span class="line">    a[i] = a[largest] = a[<span class="number">0</span>] = a[<span class="number">1</span>] = <span class="number">6</span></span><br><span class="line">    a[largest] = a[i] = a[<span class="number">1</span>] = a[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    a = [<span class="number">6</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">    self.maxHeapify(a, largest, heapSize)</span><br><span class="line">    maxHeapify(self, a, i, heapSize):</span><br><span class="line">    i = largest = <span class="number">1</span></span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">4</span></span><br><span class="line">    largest = i = <span class="number">1</span></span><br><span class="line">    l = <span class="number">3</span> &lt; heapSize = <span class="number">9</span></span><br><span class="line">    a[l] = a[<span class="number">3</span>] = <span class="number">5</span> &gt; a[largest] = a[<span class="number">1</span>] = <span class="number">3</span> </span><br><span class="line">    largest = l = <span class="number">3</span></span><br><span class="line">    a[r] = a[<span class="number">4</span>] = <span class="number">2</span> &lt; a[largest] = a[<span class="number">3</span>] = <span class="number">5</span> </span><br><span class="line">    largest = <span class="number">3</span> != i = <span class="number">1</span></span><br><span class="line">    a[i] = a[largest] = a[<span class="number">1</span>] = a[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">    a[largest] = a[i] = a[<span class="number">3</span>] = a[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    a = [<span class="number">6</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">    self.maxHeapify(a, largest, heapSize)</span><br><span class="line">    maxHeapify(self, a, i, heapSize):</span><br><span class="line">    i = largest = <span class="number">3</span></span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">7</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">8</span></span><br><span class="line">    largest = i = <span class="number">3</span></span><br><span class="line">    l = <span class="number">7</span> &lt; heapSize = <span class="number">9</span></span><br><span class="line">    a[l] = a[<span class="number">7</span>] = <span class="number">2</span> &lt; a[largest] = a[<span class="number">3</span>] = <span class="number">3</span></span><br><span class="line">    a[r] = a[<span class="number">8</span>] = <span class="number">1</span> &lt; a[largest] = a[<span class="number">3</span>] = <span class="number">3</span> </span><br><span class="line">    largest = <span class="number">3</span> = i </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums) - <span class="number">1</span>, len(nums) - k, <span class="number">-1</span>):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span> - <span class="number">1</span>, <span class="number">9</span> - <span class="number">4</span>, <span class="number">-1</span>):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>, <span class="number">5</span>, <span class="number">-1</span>):</span><br><span class="line">    i = <span class="number">8</span> </span><br><span class="line">    nums[<span class="number">0</span>] = nums[i] = a[<span class="number">8</span>] = <span class="number">1</span> </span><br><span class="line">    nums[i] = nums[<span class="number">8</span>] = a[<span class="number">0</span>] = <span class="number">6</span> </span><br><span class="line">    [<span class="number">1</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">6</span>]</span><br><span class="line">    heapSize = heapSize - <span class="number">1</span> = <span class="number">8</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>] 去掉a[<span class="number">8</span>]</span><br><span class="line">    self.maxHeapify(nums, <span class="number">0</span>, heapSize)</span><br><span class="line">    maxHeapify(self, a, i, heapSize):</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">2</span></span><br><span class="line">    largest = i = <span class="number">0</span></span><br><span class="line">    l = <span class="number">1</span> &lt; heapSize = <span class="number">8</span></span><br><span class="line">    a[l] = a[<span class="number">1</span>] = <span class="number">5</span> &gt; a[largest] = a[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    largest = l = <span class="number">1</span></span><br><span class="line">    a[r] = a[<span class="number">2</span>] = <span class="number">5</span> = a[largest] = a[<span class="number">1</span>] = <span class="number">5</span> </span><br><span class="line">    largest = <span class="number">1</span> != i = <span class="number">0</span></span><br><span class="line">    a[i] = a[largest] = a[<span class="number">0</span>] = a[<span class="number">1</span>] = <span class="number">5</span></span><br><span class="line">    a[largest] = a[i] = a[<span class="number">1</span>] = a[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    a = [<span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">    self.maxHeapify(a, largest, heapSize)</span><br><span class="line">    maxHeapify(self, a, i, heapSize):</span><br><span class="line">    i = largest = <span class="number">1</span></span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">4</span></span><br><span class="line">    largest = i = <span class="number">1</span></span><br><span class="line">    l = <span class="number">3</span> &lt; heapSize = <span class="number">8</span></span><br><span class="line">    a[l] = a[<span class="number">3</span>] = <span class="number">3</span> &gt; a[largest] = a[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">    largest = l = <span class="number">3</span></span><br><span class="line">    a[r] = a[<span class="number">4</span>] = <span class="number">2</span> &lt; a[largest] = a[<span class="number">3</span>] = <span class="number">3</span> </span><br><span class="line">    largest = <span class="number">3</span> != i = <span class="number">1</span> </span><br><span class="line">    a[i] = a[largest] = a[<span class="number">1</span>] = a[<span class="number">3</span>] = <span class="number">3</span></span><br><span class="line">    a[largest] = a[i] = a[<span class="number">3</span>] = a[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">    a = [<span class="number">5</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">    self.maxHeapify(a, largest, heapSize)</span><br><span class="line">    maxHeapify(self, a, i, heapSize):</span><br><span class="line">    i = largest = <span class="number">3</span></span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">7</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">8</span></span><br><span class="line">    largest = i = <span class="number">3</span></span><br><span class="line">    l = <span class="number">7</span> &lt; heapSize = <span class="number">8</span></span><br><span class="line">    a[l] = a[<span class="number">7</span>] = <span class="number">2</span> &gt; a[largest] = a[<span class="number">3</span>] = <span class="number">1</span></span><br><span class="line">    largest = l = <span class="number">7</span></span><br><span class="line">    a[r] = a[<span class="number">8</span>]不存在</span><br><span class="line">    largest = <span class="number">7</span> != i = <span class="number">3</span> </span><br><span class="line">    a[i] = a[largest] = a[<span class="number">3</span>] = a[<span class="number">7</span>] = <span class="number">2</span></span><br><span class="line">    a[largest] = a[i] = a[<span class="number">7</span>] = a[<span class="number">3</span>] = <span class="number">1</span></span><br><span class="line">    a = [<span class="number">5</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>]</span><br><span class="line">    self.maxHeapify(a, largest, heapSize)</span><br><span class="line">    maxHeapify(self, a, i, heapSize):</span><br><span class="line">    i = largest = <span class="number">7</span></span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">15</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">16</span></span><br><span class="line">    largest = i = <span class="number">7</span></span><br><span class="line">    l = <span class="number">15</span> &gt; heapSize = <span class="number">8</span> </span><br><span class="line">    largest = <span class="number">7</span> = i </span><br><span class="line"></span><br><span class="line">    i = <span class="number">7</span> </span><br><span class="line">    nums[<span class="number">0</span>] = nums[i] = a[<span class="number">7</span>] = <span class="number">1</span> </span><br><span class="line">    nums[i] = nums[<span class="number">7</span>] = a[<span class="number">0</span>] = <span class="number">5</span> </span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>]</span><br><span class="line">    heapSize = heapSize - <span class="number">1</span> = <span class="number">7</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>] 去掉a[<span class="number">7</span>]</span><br><span class="line">    self.maxHeapify(nums, <span class="number">0</span>, heapSize)</span><br><span class="line">    maxHeapify(self, a, i, heapSize):</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">2</span></span><br><span class="line">    largest = i = <span class="number">0</span></span><br><span class="line">    l = <span class="number">1</span> &lt; heapSize = <span class="number">7</span></span><br><span class="line">    a[l] = a[<span class="number">1</span>] = <span class="number">3</span> &gt; a[largest] = a[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    largest = l = <span class="number">0</span></span><br><span class="line">    a[r] = a[<span class="number">2</span>] = <span class="number">5</span> &gt; a[largest] = a[<span class="number">1</span>] = <span class="number">3</span> </span><br><span class="line">    largest = r = <span class="number">2</span> != i = <span class="number">0</span></span><br><span class="line">    a[i] = a[largest] = a[<span class="number">0</span>] = a[<span class="number">2</span>] = <span class="number">5</span></span><br><span class="line">    a[largest] = a[i] = a[<span class="number">2</span>] = a[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    a = [<span class="number">5</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>]</span><br><span class="line">    self.maxHeapify(a, largest, heapSize)</span><br><span class="line">    maxHeapify(self, a, i, heapSize):</span><br><span class="line">    i = largest = <span class="number">2</span></span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">5</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">6</span></span><br><span class="line">    largest = i = <span class="number">2</span></span><br><span class="line">    l = <span class="number">5</span> &lt; heapSize = <span class="number">7</span></span><br><span class="line">    a[l] = a[<span class="number">5</span>] = <span class="number">4</span> &gt; a[largest] = a[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    largest = l = <span class="number">5</span></span><br><span class="line">    a[r] = a[<span class="number">6</span>] = <span class="number">3</span> &lt; a[largest] = a[<span class="number">5</span>] = <span class="number">4</span> </span><br><span class="line">    largest = <span class="number">5</span> != i = <span class="number">2</span> </span><br><span class="line">    a[i] = a[largest] = a[<span class="number">2</span>] = a[<span class="number">5</span>] = <span class="number">4</span></span><br><span class="line">    a[largest] = a[i] = a[<span class="number">5</span>] = a[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    a = [<span class="number">5</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>]</span><br><span class="line">    self.maxHeapify(a, largest, heapSize)</span><br><span class="line">    maxHeapify(self, a, i, heapSize):</span><br><span class="line">    i = largest = <span class="number">5</span></span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">11</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">12</span></span><br><span class="line">    largest = i = <span class="number">5</span></span><br><span class="line">    l = <span class="number">11</span> &gt; heapSize = <span class="number">7</span></span><br><span class="line">    largest = <span class="number">5</span> = i</span><br><span class="line"></span><br><span class="line">    i = <span class="number">6</span> </span><br><span class="line">    nums[<span class="number">0</span>] = nums[i] = a[<span class="number">6</span>] = <span class="number">3</span> </span><br><span class="line">    nums[i] = nums[<span class="number">6</span>] = a[<span class="number">0</span>] = <span class="number">5</span> </span><br><span class="line">    [<span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>]</span><br><span class="line">    heapSize = heapSize - <span class="number">1</span> = <span class="number">6</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>] 去掉a[<span class="number">6</span>]</span><br><span class="line">    self.maxHeapify(nums, <span class="number">0</span>, heapSize)</span><br><span class="line">    maxHeapify(self, a, i, heapSize):</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">2</span></span><br><span class="line">    largest = i = <span class="number">0</span></span><br><span class="line">    l = <span class="number">1</span> &lt; heapSize = <span class="number">6</span></span><br><span class="line">    a[l] = a[<span class="number">1</span>] = <span class="number">3</span> = a[largest] = a[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    a[r] = a[<span class="number">2</span>] = <span class="number">4</span> &gt; a[largest] = a[<span class="number">0</span>] = <span class="number">3</span> </span><br><span class="line">    largest = r = <span class="number">2</span> != i = <span class="number">0</span></span><br><span class="line">    a[i] = a[largest] = a[<span class="number">0</span>] = a[<span class="number">2</span>] = <span class="number">4</span></span><br><span class="line">    a[largest] = a[i] = a[<span class="number">2</span>] = a[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    a = [<span class="number">4</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">    self.maxHeapify(a, largest, heapSize)</span><br><span class="line">    maxHeapify(self, a, i, heapSize):</span><br><span class="line">    i = largest = <span class="number">2</span></span><br><span class="line">    l = i * <span class="number">2</span> + <span class="number">1</span> = <span class="number">5</span></span><br><span class="line">    r = i * <span class="number">2</span> + <span class="number">2</span> = <span class="number">6</span></span><br><span class="line">    largest = i = <span class="number">2</span></span><br><span class="line">    l = <span class="number">5</span> &lt; heapSize = <span class="number">7</span></span><br><span class="line">    a[l] = a[<span class="number">5</span>] = <span class="number">1</span> &lt; a[largest] = a[<span class="number">2</span>] = <span class="number">3</span></span><br><span class="line">    a[r] = a[<span class="number">6</span>]不存在</span><br><span class="line">    largest = i</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> nums[<span class="number">0</span>] = <span class="number">4</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">array</span> = [<span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">构建大根堆：存入完全二叉树</span><br><span class="line"></span><br><span class="line">先按照顺序将该数组元素</span><br><span class="line">构建成一棵完全二叉树</span><br><span class="line"></span><br><span class="line">            <span class="number">3</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">2</span>    <span class="number">3</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">1</span>  <span class="number">2</span> <span class="number">4</span>   <span class="number">5</span></span><br><span class="line">       / \</span><br><span class="line">      <span class="number">5</span>   <span class="number">6</span></span><br><span class="line">从第一个非叶子节点为根节点的子树开始，将其调整为大根堆</span><br><span class="line">            <span class="number">3</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">2</span>    <span class="number">3</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">6</span>  <span class="number">2</span> <span class="number">4</span>   <span class="number">5</span></span><br><span class="line">       / \</span><br><span class="line">      <span class="number">5</span>   <span class="number">1</span></span><br><span class="line">调整倒数第二个非叶子节点作为根节点的子树</span><br><span class="line">            <span class="number">3</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">2</span>    <span class="number">5</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">6</span>  <span class="number">2</span> <span class="number">4</span>   <span class="number">3</span></span><br><span class="line">       / \</span><br><span class="line">      <span class="number">5</span>   <span class="number">1</span></span><br><span class="line">调整倒数第三个非叶子节点作为根节点的子树</span><br><span class="line">            <span class="number">3</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">6</span>    <span class="number">5</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">2</span>  <span class="number">2</span> <span class="number">4</span>   <span class="number">3</span></span><br><span class="line">       / \</span><br><span class="line">      <span class="number">5</span>   <span class="number">1</span></span><br><span class="line">      </span><br><span class="line">            <span class="number">3</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">6</span>    <span class="number">5</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">5</span>  <span class="number">2</span> <span class="number">4</span>   <span class="number">3</span></span><br><span class="line">       / \</span><br><span class="line">      <span class="number">2</span>   <span class="number">1</span></span><br><span class="line">调整倒数第四个非叶子节点作为根节点的子树</span><br><span class="line">            <span class="number">6</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">3</span>    <span class="number">5</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">5</span>  <span class="number">2</span> <span class="number">4</span>   <span class="number">3</span></span><br><span class="line">       / \</span><br><span class="line">      <span class="number">2</span>   <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="number">6</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">5</span>    <span class="number">5</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">3</span>  <span class="number">2</span> <span class="number">4</span>   <span class="number">3</span></span><br><span class="line">       / \</span><br><span class="line">      <span class="number">2</span>   <span class="number">1</span></span><br><span class="line"></span><br><span class="line">第一次删除</span><br><span class="line">k = <span class="number">4</span>，删除<span class="number">3</span>次堆顶元素</span><br><span class="line">            </span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">5</span>    <span class="number">5</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">3</span>  <span class="number">2</span> <span class="number">4</span>   <span class="number">3</span></span><br><span class="line">       / \</span><br><span class="line">      <span class="number">2</span>   <span class="number">1</span></span><br><span class="line"></span><br><span class="line">先将末尾节点<span class="number">1</span>补充到堆顶位置,再进行调整</span><br><span class="line">            <span class="number">1</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">5</span>    <span class="number">5</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">3</span>  <span class="number">2</span> <span class="number">4</span>   <span class="number">3</span></span><br><span class="line">       / \</span><br><span class="line">      <span class="number">2</span>   </span><br><span class="line"></span><br><span class="line">            <span class="number">5</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">1</span>    <span class="number">5</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">3</span>  <span class="number">2</span> <span class="number">4</span>   <span class="number">3</span></span><br><span class="line">       / \</span><br><span class="line">      <span class="number">2</span>  </span><br><span class="line">开始调整，已删除<span class="number">1</span>次</span><br><span class="line"></span><br><span class="line">            <span class="number">5</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">3</span>    <span class="number">5</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">1</span>  <span class="number">2</span> <span class="number">4</span>   <span class="number">3</span></span><br><span class="line">       / \</span><br><span class="line">      <span class="number">2</span>  </span><br><span class="line"></span><br><span class="line">            <span class="number">5</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">3</span>    <span class="number">5</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">2</span>  <span class="number">2</span> <span class="number">4</span>   <span class="number">3</span></span><br><span class="line">       / \</span><br><span class="line">      <span class="number">1</span>  </span><br><span class="line"></span><br><span class="line">调整完成，已删除<span class="number">1</span>次 第<span class="number">2</span>次删除</span><br><span class="line"></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">3</span>    <span class="number">5</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">2</span>  <span class="number">2</span> <span class="number">4</span>   <span class="number">3</span></span><br><span class="line">       / \</span><br><span class="line">      <span class="number">1</span></span><br><span class="line"></span><br><span class="line">将末尾节点<span class="number">1</span>补充到堆顶位置</span><br><span class="line">            <span class="number">1</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">3</span>    <span class="number">5</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">2</span>  <span class="number">2</span> <span class="number">4</span>   <span class="number">3</span></span><br><span class="line">       / \</span><br><span class="line">再进行调整     </span><br><span class="line">            <span class="number">5</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">3</span>    <span class="number">1</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">2</span>  <span class="number">2</span> <span class="number">4</span>   <span class="number">3</span></span><br><span class="line">       / \</span><br><span class="line"></span><br><span class="line">            <span class="number">5</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">2</span>  <span class="number">2</span> <span class="number">1</span>   <span class="number">3</span></span><br><span class="line">       / \</span><br><span class="line">第<span class="number">3</span>次删除</span><br><span class="line">            </span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">2</span>  <span class="number">2</span> <span class="number">1</span>   <span class="number">3</span></span><br><span class="line">将末尾节点<span class="number">3</span>补充到堆顶位置,</span><br><span class="line">            <span class="number">3</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">2</span>  <span class="number">2</span> <span class="number">1</span>   </span><br><span class="line">再进行调整</span><br><span class="line"></span><br><span class="line">            <span class="number">4</span></span><br><span class="line">           /  \</span><br><span class="line">          <span class="number">3</span>    <span class="number">3</span></span><br><span class="line">         / \  / \</span><br><span class="line">        <span class="number">2</span>  <span class="number">2</span> <span class="number">1</span>   </span><br><span class="line"></span><br><span class="line">调整完成,已删除<span class="number">3</span>次</span><br><span class="line">返回堆顶元素 <span class="number">4</span></span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span>(<span class="params">self, nums: List[int], k: int</span>) -&gt; int:</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">adju_max_heap</span>(<span class="params">nums_list, in_node</span>):</span>  <span class="comment"># 从当前内部节点处修正大根堆</span></span><br><span class="line">            <span class="string">""""in_node是内部节点的索引"""</span></span><br><span class="line">            l, r, large_idx= <span class="number">2</span>*in_node+<span class="number">1</span>, <span class="number">2</span>*in_node+<span class="number">2</span>, in_node  <span class="comment"># 最大值的索引默认为该内部节点</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> l &lt; len(nums_list) <span class="keyword">and</span> nums_list[large_idx] &lt; nums[l]:  </span><br><span class="line">                <span class="comment"># 如果左孩子值大于该内部节点的值，则最大值索引指向左孩子</span></span><br><span class="line">                large_idx = l</span><br><span class="line">            <span class="keyword">if</span> r &lt; len(nums_list) <span class="keyword">and</span> nums_list[large_idx] &lt; nums[r]:</span><br><span class="line">                <span class="comment"># 如果执行了上一个if语句，此时最大值索引指向左孩子，否则还是指向该内部节点</span></span><br><span class="line">                <span class="comment"># 然后最大值索引指向的值和右孩子的值比较</span></span><br><span class="line">                large_idx = r</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 上述两个if就是得到(内部节点，左孩子，右孩子)中最大值的索引</span></span><br><span class="line">            <span class="keyword">if</span> large_idx != in_node: <span class="comment"># 如果最大值在左孩子和右孩子中，则和内部节点交换</span></span><br><span class="line">                nums_list[large_idx], nums_list[in_node] = nums_list[in_node], nums_list[large_idx]</span><br><span class="line">                <span class="comment"># 如何内部节点是和左孩子交换，那就递归修正它的左子树，否则递归修正它的右子树</span></span><br><span class="line">                adju_max_heap(nums_list, large_idx)</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">build_max_heap</span>(<span class="params">nums_list</span>):</span>  <span class="comment"># 由列表建立大根堆</span></span><br><span class="line">            <span class="string">""""从后往前遍历所有内部节点，其中最后一个内部节点的公式为len(nums_list)//2 - 1"""</span></span><br><span class="line">            <span class="comment"># 从最后一个非叶子节点开始堆化</span></span><br><span class="line">            <span class="keyword">for</span> in_node <span class="keyword">in</span> range(len(nums_list)//<span class="number">2</span> - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">                adju_max_heap(nums_list, in_node)</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">find_kth_max</span>(<span class="params">nums_list, k</span>):</span>  <span class="comment"># 从列表中找到第k个最大的</span></span><br><span class="line">            build_max_heap(nums_list)  <span class="comment"># 先建立大根堆</span></span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> range(k<span class="number">-1</span>):</span><br><span class="line">                nums_list[<span class="number">0</span>], nums_list[<span class="number">-1</span>] = nums_list[<span class="number">-1</span>], nums_list[<span class="number">0</span>]  <span class="comment"># 堆头和堆尾交换</span></span><br><span class="line">                nums_list.pop()  <span class="comment"># 删除堆尾</span></span><br><span class="line">                adju_max_heap(nums_list, <span class="number">0</span>)  <span class="comment"># 从堆头处开始修正大根堆</span></span><br><span class="line">            <span class="keyword">return</span> nums_list[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> find_kth_max(nums, k) </span><br></pre></td></tr></tbody></table></figure>

<p>小根堆最多只需要k个元素在堆里，<br>时间复杂度 O(nlogk)，在k小于n时不是更优，q 里最多就 k 个元素<br>空间复杂度：O(k)</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span>(<span class="params">self, nums: List[int], k: int</span>) -&gt; int:</span></span><br><span class="line">        <span class="string">"""使用小顶堆"""</span></span><br><span class="line">        q = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> nums:</span><br><span class="line">            heapq.heappush(q, c)</span><br><span class="line">            <span class="keyword">while</span> len(q) &gt; k:</span><br><span class="line">                heapq.heappop(q)</span><br><span class="line">        <span class="keyword">return</span> heapq.heappop(q)</span><br></pre></td></tr></tbody></table></figure>


<hr>
<h4 id="33-数据流中的中位数-本题考点-树"><a href="#33-数据流中的中位数-本题考点-树" class="headerlink" title="33.数据流中的中位数 [^本题考点 树]"></a>33.数据流中的中位数 [^本题考点 <em>树</em>]</h4><p>​    <strong>题目：如何得到一个数据流中的中位数？如果从数据流中读出奇数个数值，那么中位数就是所有数值排序之后位于中间的数值。如果从数据流中读出偶数个数值，那么中位数就是所有数值排序之后中间两个数的平均值。</strong></p>
<p>例如，</p>
<p>[2,3,4]&nbsp;的中位数是 3</p>
<p>[2,3] 的中位数是 (2 + 3) / 2 = 2.5</p>
<p>设计一个支持以下两种操作的数据结构：</p>
<ul>
<li>void addNum(int num) - 从数据流中添加一个整数到数据结构中。</li>
<li>double findMedian() - 返回目前所有元素的中位数。<br>示例 1：<figure class="highlight prolog"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">输入：</span><br><span class="line">[<span class="string">"MedianFinder"</span>,<span class="string">"addNum"</span>,<span class="string">"addNum"</span>,<span class="string">"findMedian"</span>,<span class="string">"addNum"</span>,<span class="string">"findMedian"</span>]</span><br><span class="line">[[],[<span class="number">1</span>],[<span class="number">2</span>],[],[<span class="number">3</span>],[]]</span><br><span class="line">输出：[null,null,null,<span class="number">1.50000</span>,null,<span class="number">2.00000</span>]</span><br></pre></td></tr></tbody></table></figure>

</li>
</ul>
<p>示例 2：</p>
<figure class="highlight prolog"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">输入：</span><br><span class="line">[<span class="string">"MedianFinder"</span>,<span class="string">"addNum"</span>,<span class="string">"findMedian"</span>,<span class="string">"addNum"</span>,<span class="string">"findMedian"</span>]</span><br><span class="line">[[],[<span class="number">2</span>],[],[<span class="number">3</span>],[]]</span><br><span class="line">输出：[null,null,<span class="number">2.00000</span>,null,<span class="number">2.50000</span>]</span><br></pre></td></tr></tbody></table></figure>

<p>法一：暴力</p>
<p>解题思路：<br>给定一长度为 N 的无序数组，其中位数的计算方法：<br>数据流新进来一个数，都把它与已经读出来的数进行一次排序，（使用 O(NlogN) 时间），<br>然后返回中间元素即可（使用 O(1) 时间）。</p>
<p>法二<br>当从数据流中读出的数的个数为奇数的时候，中位数是“前有序数组”中的最小值<br>当从数据流中读出的数的个数为偶数的时候，左中位数是“前有序数组”中的最小值，右中位数是“后有序数组”中的最大值<br>前后后序大小堆谁在前面都是可以的</p>
<p>我们只关心在中间的那两个数（或者一个数）这两个“有序数组”中的最值，<br>对除了中位数以外的其它位置的元素没有必要进行 “比较” 和 “交换” 的操作。</p>
<p>“中位数”把它们分为<br>两个部分,一部分是“前有序数组”,另一部分是“后有序数组”</p>
<p>借助 堆就的性质，通过树的形式减少了元素比较的次数。<br>每次都从堆里得到一个 “最值” 而其它元素无需排序，<br>可以将数据流保存在一个列表中，并在添加元素时 保持数组有序 。</p>
<p>建立一个 小顶堆 min_heap (am ..a3 a2 a1)和 大顶堆 B(b1 b2 b3.. bn) ，<br>am &gt; ..a3 &gt; a2 &gt; a1,a1是堆顶<br>b1 &gt; b2 &gt; b3.. &gt; bn,b1是堆顶<br>各保存列表的一半元素，且规定：</p>
<ul>
<li>小顶堆 min_heap 保存 较大 的一半，长度为 N/2（ N 为偶数）或 (N+1)/2（ N 为奇数）；</li>
<li>大顶堆 max_heap 保存 较小 的一半，长度为 N/2（ N 为偶数）或 (N-1)/2（ N 为奇数）；</li>
</ul>
<p>算法流程：<br>设元素总数为 N = m + n ，其中 m 和 n 分别为 min_heap 和 max_heap 中的元素个数。<br>规定添加元素时保证：</p>
<ol>
<li>m = n + 1 = (N + 1) / 2，N 为 奇数</li>
<li>m = n = N / 2，N 为 偶数<br>中位数可仅根据 min_heap, max_heap 的堆顶元素计算得到。<br>中位数 = a1 , m != n<br>中位数 = (a1 + b1)/2 , m = n </li>
</ol>
<p>因为它是一实时插入，也会实时计算所有数的中位数。<br>那么一个大根堆，一个小根堆肯定是一个放一次数字，交替插入。<br>至于先插入哪个队列都是可以的</p>
<p>为什么比较长度就可以判断怎么插入两个堆咧，平衡这两个堆<br>始终保持</p>
<ul>
<li>小根堆的长度-大根堆的长度 = 0 或者 1 </li>
<li>小顶堆 min_heap 保存较大一半、 大顶堆 max_heap 保存较小一半。</li>
</ul>
<p>也可以用以优化成boolean的True False或者count变量统计当前一共有几个数字，<br>若为奇数则先插入min_heap队列（max_heap队列），为偶数则先插入max_heap队列（min_heap队列）。 </p>
<p>addNum(num) 函数： 从数据流中添加一个整数到数据结构中。</p>
<ol>
<li>当 m = n（即总数量 N 为 偶数）：需向 小顶堆 min_heap 添加一个元素。<br>实现方法：将新元素 num 插入至大根堆 max_heap ，再弹出大根堆 max_heap 堆顶元素插入至 min_heap ；<br>因为 num 可能属于 “较小的一半” （即属于 max_heap ），所以不能将 nums 直接插入至 min_heap 。</li>
</ol>
<ol start="2">
<li>当 m !=n（即 N 为 奇数）说明小根堆长度-大根堆长度=1：需向大根堆 max_heap 添加一个元素。<br>实现方法：将新元素 num 插入至小根堆 min_heap ，再弹出 min_heap 堆顶元素插入至 max_heap ；</li>
</ol>
<p>findMedian() 函数：返回目前所有元素的中位数。</p>
<ol>
<li>当 m = n（ N 为 偶数）：则中位数为 ( min_heap 的堆顶元素 + max_heap 的堆顶元素)/2。</li>
<li>当 m !=n（ N 为 奇数）：则中位数为 min_heap 的堆顶元素。</li>
</ol>
<p>时间复杂度：O(5⋅logn)+O(1)≈O(logn).</p>
<ul>
<li>查找中位数 O(1)： 获取堆顶元素使用 O(1) 时间；</li>
<li>添加数字 O(logN)： 每个数据的从堆中取出最值插入和弹出操作，优先队列会自行调整，把“最优值”放入堆顶，这是使用优先队列解决这个问题的原因<br>查找元素插入位置 O(logN) （二分查找）、向数组某位置插入元素 O(N) （插入位置之后的元素都需要向后移动一位）。<br>最坏情况下，从顶部有三个堆插入和两个堆删除。每一个都需要花费 O(logn) 时间。<br>找到平均值需要持续的 O(1) 时间，因为可以直接访问堆的顶部。<br>单独的分析每个操作，addNum 和 findMedian 是只和 N 相关的，题目只是要求我们单独分析每个操作的时间复杂度。addNum 是对数复杂度， findMedian 是 O(1) 。</li>
</ul>
<p>空间复杂度 O(N)：其中 N 为数据流中的元素数量，在容器中保存输入的线性空间<br>小顶堆 min_heap 和大顶堆 max_heap 最多同时保存 N 个元素。两个堆的空间复杂度是 O(N/2)</p>
<p>Python 中 heapq 模块是小顶堆。<br>实现 大顶堆 方法：小顶堆的插入和弹出操作均将元素 取反 即可</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MedianFinder</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        initialize your data structure here.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="comment"># 初始化大顶堆和小顶堆</span></span><br><span class="line">        self.min_heap = [] <span class="comment"># 小顶堆，保存较大的一半</span></span><br><span class="line">        self.max_heap = [] <span class="comment"># 大顶堆，保存较小的一半</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addNum</span>(<span class="params">self, num: int</span>) -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="keyword">if</span> len(self.min_heap) != len(self.max_heap):</span><br><span class="line">            <span class="comment"># 总数为奇数时，先加到小顶堆，再把小堆顶元素加到大顶堆</span></span><br><span class="line">            heapq.heappush(self.min_heap, num)</span><br><span class="line">            heapq.heappush(self.max_heap, -heapq.heappop(self.min_heap))</span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># 总数为偶数时，先加到大顶堆，再把大堆顶元素加到小顶堆 </span></span><br><span class="line">            heapq.heappush(self.max_heap, -num)</span><br><span class="line">            heapq.heappush(self.min_heap, -heapq.heappop(self.max_heap))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findMedian</span>(<span class="params">self</span>) -&gt; float:</span></span><br><span class="line">        <span class="keyword">if</span> len(self.min_heap) != len(self.max_heap): </span><br><span class="line">            <span class="keyword">return</span> self.min_heap[<span class="number">0</span>] </span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># 你存进B的时候，为了实现大顶堆，加了负号</span></span><br><span class="line">            <span class="keyword">return</span> (self.min_heap[<span class="number">0</span>] -self.max_heap[<span class="number">0</span>]) / <span class="number">2.0</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># Your MedianFinder object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"># obj = MedianFinder()</span></span><br><span class="line"><span class="comment"># obj.addNum(num)</span></span><br><span class="line"><span class="comment"># param_2 = obj.findMedian()</span></span><br></pre></td></tr></tbody></table></figure>

<p>Push item on the heap, then pop and return the smallest item from the heap. The combined action runs more efficiently than heappush() followed by a separate call to heappop().</p>
<p>根据以上文档说明，可将 Python 代码优化为：</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MedianFinder</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        initialize your data structure here.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="comment"># 初始化大顶堆和小顶堆</span></span><br><span class="line">        self.min_heap = []  <span class="comment"># 小顶堆，保存较大的一半</span></span><br><span class="line">        self.max_heap = []  <span class="comment"># 大顶堆，保存较小的一半</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addNum</span>(<span class="params">self, num: int</span>) -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="keyword">if</span> len(self.min_heap) != len(self.max_heap):</span><br><span class="line">            <span class="comment"># 先加到小顶堆，再把小堆顶元素加到大顶堆</span></span><br><span class="line">            heapq.heappush(self.max_heap, -heapq.heappushpop(self.min_heap, num))</span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># 先加到大顶堆，再把大堆顶元素加到小顶堆</span></span><br><span class="line">            heapq.heappush(self.min_heap, -heapq.heappushpop(self.max_heap, -num))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findMedian</span>(<span class="params">self</span>) -&gt; float:</span></span><br><span class="line">        <span class="keyword">if</span> len(self.min_heap) != len(self.max_heap):</span><br><span class="line">            <span class="keyword">return</span> self.min_heap[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">else</span>:  <span class="comment"># 你存进B的时候，为了实现大顶堆，加了负号</span></span><br><span class="line">            <span class="keyword">return</span> (self.min_heap[<span class="number">0</span>] - self.max_heap[<span class="number">0</span>]) / <span class="number">2.0</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>]</span><br><span class="line">length = <span class="number">6</span> = N 为偶数</span><br><span class="line"></span><br><span class="line">len(self.A) = <span class="number">0</span> = len(self.B)</span><br><span class="line">插入 <span class="number">5</span>，</span><br><span class="line">    A 小顶          B 大顶(负数的小顶堆)         </span><br><span class="line">                    <span class="number">-5</span>  </span><br><span class="line">    A 小顶          B 大顶(负数的小顶堆)           </span><br><span class="line">     <span class="number">5</span> </span><br><span class="line">findMedian() = A[<span class="number">0</span>] = <span class="number">5</span>    </span><br><span class="line"></span><br><span class="line">len(self.A) = <span class="number">1</span> != len(self.B) = <span class="number">0</span></span><br><span class="line">插入 <span class="number">2</span>，从存储较小 大顶 B</span><br><span class="line">    A 小顶          B 大顶(负数的小顶堆)  </span><br><span class="line">     <span class="number">2</span>               </span><br><span class="line">    /  \            </span><br><span class="line">    <span class="number">5</span>  </span><br><span class="line">    A 小顶          B 大顶(负数的小顶堆)  </span><br><span class="line">     <span class="number">5</span>               <span class="number">-2</span></span><br><span class="line">findMedian() = (<span class="number">5</span> - (<span class="number">-2</span>)) / <span class="number">2</span> = <span class="number">3.5</span></span><br><span class="line"></span><br><span class="line">len(self.A) = <span class="number">1</span> = len(self.B)</span><br><span class="line">插入 <span class="number">4</span>，从存储较大 小顶 A</span><br><span class="line">    A 小顶          B 大顶(负数的小顶堆) </span><br><span class="line">     <span class="number">5</span>               <span class="number">-4</span></span><br><span class="line">                    /  \</span><br><span class="line">                   <span class="number">-2</span></span><br><span class="line">    A 小顶          B 大顶(负数的小顶堆)                 </span><br><span class="line">     <span class="number">4</span>               <span class="number">-2</span></span><br><span class="line">    /  \            </span><br><span class="line">    <span class="number">5</span>              </span><br><span class="line">findMedian() = A[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">len(self.A) = <span class="number">2</span> != len(self.B) = <span class="number">1</span></span><br><span class="line">插入 <span class="number">3</span>，从存储较小 大顶 B</span><br><span class="line">     <span class="number">3</span>               <span class="number">-2</span></span><br><span class="line">    /  \            /  \</span><br><span class="line">    <span class="number">5</span>   <span class="number">4</span>          </span><br><span class="line">     <span class="number">4</span>               <span class="number">-3</span></span><br><span class="line">    /  \            /  \</span><br><span class="line">    <span class="number">5</span>              <span class="number">-2</span></span><br><span class="line">findMedian() (<span class="number">4</span> - (<span class="number">-3</span>)) / <span class="number">2</span> = <span class="number">3.5</span></span><br><span class="line"></span><br><span class="line">len(self.A) = <span class="number">2</span> = len(self.B)</span><br><span class="line">插入 <span class="number">1</span> &gt; <span class="number">3.5</span>，从存储较大 小顶 A</span><br><span class="line">      <span class="number">4</span>              <span class="number">-3</span></span><br><span class="line">    /  \            /  \</span><br><span class="line">    <span class="number">5</span>              <span class="number">-2</span>   <span class="number">-1</span> </span><br><span class="line">     <span class="number">3</span>               <span class="number">-2</span></span><br><span class="line">    /  \            /  \</span><br><span class="line">    <span class="number">5</span>   <span class="number">4</span>          <span class="number">-1</span></span><br><span class="line">findMedian() = A[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">len(self.A) = <span class="number">3</span> != len(self.B) = <span class="number">2</span></span><br><span class="line">插入 <span class="number">6</span> &gt; <span class="number">2.5</span>，从存储较小 大顶 B</span><br><span class="line">     <span class="number">3</span>               <span class="number">-2</span></span><br><span class="line">    /  \            /  \</span><br><span class="line">    <span class="number">5</span>   <span class="number">4</span>          <span class="number">-1</span>                     </span><br><span class="line">   /  \            /  \</span><br><span class="line">  <span class="number">6</span>              </span><br><span class="line">     <span class="number">4</span>               <span class="number">-3</span></span><br><span class="line">    /  \            /  \</span><br><span class="line">    <span class="number">5</span>   <span class="number">6</span>          <span class="number">-1</span>   <span class="number">-2</span>   </span><br><span class="line">findMedian() (<span class="number">4</span> - (<span class="number">-3</span>)) / <span class="number">2</span> = <span class="number">3.5</span> </span><br></pre></td></tr></tbody></table></figure>



<p>使用Insert()方法读取数据流，使用GetMedian()方法获取当前读取数据的中位数。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 未封装版本</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.littleValueMaxHeap = []</span><br><span class="line">        self.bigValueMinHeap = []</span><br><span class="line">        self.maxHeapCount = <span class="number">0</span></span><br><span class="line">        self.minHeapCount = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">createMaxHeap</span>(<span class="params">self, num</span>):</span></span><br><span class="line">        self.littleValueMaxHeap.append(num)</span><br><span class="line">        tmpIndex = len(self.littleValueMaxHeap) - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> tmpIndex != <span class="number">0</span>:</span><br><span class="line">            parentIndex = (tmpIndex - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>  <span class="comment"># 任意节点的父节点</span></span><br><span class="line">            <span class="keyword">if</span> self.littleValueMaxHeap[parentIndex] &lt; self.littleValueMaxHeap[tmpIndex]:</span><br><span class="line">                self.littleValueMaxHeap[parentIndex], self.littleValueMaxHeap[tmpIndex] = self.littleValueMaxHeap[tmpIndex], self.littleValueMaxHeap[parentIndex]</span><br><span class="line">                tmpIndex = parentIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">adjustMaxHeap</span>(<span class="params">self, num</span>):</span></span><br><span class="line">        <span class="keyword">if</span> num &lt; self.littleValueMaxHeap[<span class="number">0</span>]:</span><br><span class="line">            self.littleValueMaxHeap[<span class="number">0</span>] = num</span><br><span class="line">        maxHeapLen = len(self.littleValueMaxHeap)</span><br><span class="line">        tmpIndex = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> tmpIndex &lt; maxHeapLen:</span><br><span class="line">            leftIndex = tmpIndex * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">            rightIndex = tmpIndex *<span class="number">2</span> + <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> rightIndex &lt; maxHeapLen:</span><br><span class="line">                largerIndex = rightIndex <span class="keyword">if</span> self.littleValueMaxHeap[leftIndex] &lt; self.littleValueMaxHeap[rightIndex] <span class="keyword">else</span> leftIndex</span><br><span class="line">            <span class="keyword">elif</span> leftIndex &lt; maxHeapLen:</span><br><span class="line">                largerIndex = leftIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> self.littleValueMaxHeap[tmpIndex] &lt; self.littleValueMaxHeap[largerIndex]:</span><br><span class="line">                self.littleValueMaxHeap[tmpIndex], self.littleValueMaxHeap[largerIndex] = self.littleValueMaxHeap[largerIndex], self.littleValueMaxHeap[tmpIndex]</span><br><span class="line">                tmpIndex = largerIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">createMinHeap</span>(<span class="params">self, num</span>):</span></span><br><span class="line">        self.bigValueMinHeap.append(num)</span><br><span class="line">        tmpIndex = len(self.bigValueMinHeap) - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> tmpIndex != <span class="number">0</span>:</span><br><span class="line">            parentIndex = (tmpIndex - <span class="number">1</span>) &gt;&gt; <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> self.bigValueMinHeap[tmpIndex] &lt; self.bigValueMinHeap[parentIndex]:</span><br><span class="line">                self.bigValueMinHeap[parentIndex], self.bigValueMinHeap[tmpIndex] = self.bigValueMinHeap[tmpIndex], self.bigValueMinHeap[parentIndex]</span><br><span class="line">                tmpIndex = parentIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">adjustMinHeap</span>(<span class="params">self, num</span>):</span></span><br><span class="line">        <span class="keyword">if</span> num &lt; self.bigValueMinHeap[<span class="number">0</span>]:</span><br><span class="line">            self.littleValueMaxHeap[<span class="number">0</span>] = num</span><br><span class="line">        minHeapLen = len(self.bigValueMinHeap)</span><br><span class="line">        tmpIndex = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> tmpIndex &lt; minHeapLen:</span><br><span class="line">            leftIndex = tmpIndex * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">            rightIndex = tmpIndex *<span class="number">2</span> + <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> rightIndex &lt; minHeapLen:</span><br><span class="line">                smallerIndex = rightIndex <span class="keyword">if</span> self.bigValueMinHeap[rightIndex] &lt; self.bigValueMinHeap[leftIndex] <span class="keyword">else</span> leftIndex</span><br><span class="line">            <span class="keyword">elif</span> leftIndex &lt; minHeapLen:</span><br><span class="line">                smallerIndex = leftIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> self.bigValueMinHeap[smallerIndex] &lt; self.bigValueMinHeap[tmpIndex]:</span><br><span class="line">                self.bigValueMinHeap[tmpIndex], self.bigValueMinHeap[smallerIndex] = self.bigValueMinHeap[smallerIndex], self.bigValueMinHeap[tmpIndex]</span><br><span class="line">                tmpIndex = smallerIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Insert</span>(<span class="params">self, num</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.minHeapCount &lt; self.maxHeapCount:</span><br><span class="line">            self.minHeapCount += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> num &lt; self.littleValueMaxHeap[<span class="number">0</span>]:</span><br><span class="line">                tmpNum = self.littleValueMaxHeap[<span class="number">0</span>]</span><br><span class="line">                self.adjustMaxHeap(num)</span><br><span class="line">                self.createMinHeap(tmpNum)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.createMinHeap(num)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.maxHeapCount += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> self.littleValueMaxHeap == []:</span><br><span class="line">                self.createMaxHeap(num)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> self.bigValueMinHeap[<span class="number">0</span>] &lt; num:</span><br><span class="line">                    tmpNum = self.bigValueMinHeap[<span class="number">0</span>]</span><br><span class="line">                    self.adjustMinHeap(num)</span><br><span class="line">                    self.createMaxHeap(tmpNum)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.createMaxHeap(num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GetMedian</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.minHeapCount &lt; self.maxHeapCount:</span><br><span class="line">            <span class="keyword">return</span> self.littleValueMaxHeap[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> (self.bigValueMinHeap[<span class="number">0</span>] + self.littleValueMaxHeap[<span class="number">0</span>]) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 封装版本</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.littleValueMaxHeap = []</span><br><span class="line">        self.bigValueMinHeap = []</span><br><span class="line">        self.maxHeapCount = <span class="number">0</span></span><br><span class="line">        self.minHeapCount = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">createHeap</span>(<span class="params">self, num, heap, cmpFunc</span>):</span></span><br><span class="line">        heap.append(num)</span><br><span class="line">        tmpIndex = len(heap) - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> tmpIndex != <span class="number">0</span>:</span><br><span class="line">            parentIndex = (tmpIndex - <span class="number">1</span>) &gt;&gt; <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> cmpFunc(heap[tmpIndex], heap[parentIndex]):</span><br><span class="line">                heap[parentIndex], heap[tmpIndex] = heap[tmpIndex], heap[parentIndex]</span><br><span class="line">                tmpIndex = parentIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">adjustHeap</span>(<span class="params">self, num, heap, cmpFunc</span>):</span></span><br><span class="line">        <span class="keyword">if</span> num &lt; heap[<span class="number">0</span>]:</span><br><span class="line">            heap[<span class="number">0</span>] = num</span><br><span class="line">        heapLen = len(heap)</span><br><span class="line">        tmpIndex = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> tmpIndex &lt; heapLen:</span><br><span class="line">            leftIndex = tmpIndex * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">            rightIndex = tmpIndex *<span class="number">2</span> + <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> rightIndex &lt; heapLen:</span><br><span class="line">                largerIndex = rightIndex <span class="keyword">if</span> cmpFunc(heap[rightIndex], heap[leftIndex]) <span class="keyword">else</span> leftIndex</span><br><span class="line">            <span class="keyword">elif</span> leftIndex &lt; heapLen:</span><br><span class="line">                largerIndex = leftIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> cmpFunc(heap[largerIndex], heap[tmpIndex]):</span><br><span class="line">                heap[tmpIndex], heap[largerIndex] = heap[largerIndex], heap[tmpIndex]</span><br><span class="line">                tmpIndex = largerIndex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Insert</span>(<span class="params">self, num</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">cmpMaxHeap</span>(<span class="params">a, b</span>):</span></span><br><span class="line">            <span class="keyword">return</span> b &lt; a</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">cmpMinHeap</span>(<span class="params">a, b</span>):</span></span><br><span class="line">            <span class="keyword">return</span> a &lt; b</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.minHeapCount &lt; self.maxHeapCount:</span><br><span class="line">            self.minHeapCount += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> num &lt; self.littleValueMaxHeap[<span class="number">0</span>]:</span><br><span class="line">                tmpNum = self.littleValueMaxHeap[<span class="number">0</span>]</span><br><span class="line">                self.adjustHeap(num, self.littleValueMaxHeap, cmpMaxHeap)</span><br><span class="line">                self.createHeap(tmpNum, self.bigValueMinHeap, cmpMinHeap)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.createHeap(num, self.bigValueMinHeap, cmpMinHeap)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.maxHeapCount += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> self.littleValueMaxHeap == []:</span><br><span class="line">                self.createHeap(num, self.littleValueMaxHeap, cmpMaxHeap)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> self.bigValueMinHeap[<span class="number">0</span>] &lt; num:</span><br><span class="line">                    tmpNum = self.bigValueMinHeap[<span class="number">0</span>]</span><br><span class="line">                    self.adjustHeap(num, self.bigValueMinHeap, cmpMinHeap)</span><br><span class="line">                    self.createHeap(tmpNum, self.littleValueMaxHeap, cmpMaxHeap)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.createHeap(num, self.littleValueMaxHeap, cmpMaxHeap)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GetMedian</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.minHeapCount &lt; self.maxHeapCount:</span><br><span class="line">            <span class="keyword">return</span> self.littleValueMaxHeap[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> (self.bigValueMinHeap[<span class="number">0</span>] + self.littleValueMaxHeap[<span class="number">0</span>]) / <span class="number">2</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    s = Solution()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">5</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">8</span>]:</span><br><span class="line">        s.Insert(i)</span><br><span class="line">        print(s.GetMedian())</span><br></pre></td></tr></tbody></table></figure>



<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">heap_sort</span>(<span class="params">nums</span>):</span></span><br><span class="line">    <span class="comment"># 调整堆</span></span><br><span class="line">    <span class="comment"># 迭代写法</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">adjust_heap</span>(<span class="params">nums, startpos, endpos</span>):</span></span><br><span class="line">        newitem = nums[startpos]</span><br><span class="line">        pos = startpos</span><br><span class="line">        childpos = pos * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> childpos &lt; endpos:</span><br><span class="line">            rightpos = childpos + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> rightpos &lt; endpos <span class="keyword">and</span> nums[rightpos] &gt;= nums[childpos]:</span><br><span class="line">                childpos = rightpos</span><br><span class="line">            <span class="keyword">if</span> newitem &lt; nums[childpos]:</span><br><span class="line">                nums[pos] = nums[childpos]</span><br><span class="line">                pos = childpos</span><br><span class="line">                childpos = pos * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        nums[pos] = newitem</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 递归写法</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">adjust_heap</span>(<span class="params">nums, startpos, endpos</span>):</span></span><br><span class="line">        pos = startpos</span><br><span class="line">        chilidpos = pos * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> chilidpos &lt; endpos:</span><br><span class="line">            rightpos = chilidpos + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> rightpos &lt; endpos <span class="keyword">and</span> nums[rightpos] &gt; nums[chilidpos]:</span><br><span class="line">                chilidpos = rightpos</span><br><span class="line">            <span class="keyword">if</span> nums[chilidpos] &gt; nums[pos]:</span><br><span class="line">                nums[pos], nums[chilidpos] = nums[chilidpos], nums[pos]</span><br><span class="line">                adjust_heap(nums, pos, endpos)</span><br><span class="line"></span><br><span class="line">    n = len(nums)</span><br><span class="line">    <span class="comment"># 建堆</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> reversed(range(n // <span class="number">2</span>)):</span><br><span class="line">        adjust_heap(nums, i, n)</span><br><span class="line">    <span class="comment"># 调整堆</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">        nums[<span class="number">0</span>], nums[i] = nums[i], nums[<span class="number">0</span>]</span><br><span class="line">        adjust_heap(nums, <span class="number">0</span>, i)</span><br><span class="line">    <span class="keyword">return</span> nums</span><br></pre></td></tr></tbody></table></figure>

<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://bubbleboy11.github.io/2020/08/21/liu-da-ji-ben-pai-xu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="外心人D">
      <meta itemprop="description" content="本博客大多内容为慕课和网上博客，并非原创">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="外心人D的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/08/21/liu-da-ji-ben-pai-xu/" class="post-title-link" itemprop="url">六大基本排序</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-08-20 16:21:41" itemprop="dateCreated datePublished" datetime="2020-08-20T16:21:41Z">2020-08-20</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-05-10 01:55:30" itemprop="dateModified" datetime="2021-05-10T01:55:30Z">2021-05-10</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="排序算法-Sorting-algorithm"><a href="#排序算法-Sorting-algorithm" class="headerlink" title="排序算法 Sorting algorithm"></a>排序算法 Sorting algorithm</h1><p>是一种能将一串数据依照特定顺序进行排列的一种算法。<br>进行从小到大进行排序，内置排序函数<code>sort()</code></p>
<p>在平均情况下，快速排序最快；<br>在最好情况下，插入排序和起泡排序最快；<br>在最坏情况下，堆排序和归并排序最快。</p>
<p>排序算法的分析</p>
<ol>
<li>排序算法的稳定性：如果在对象序列中有两个对象 r[i]和r[j] ,它们的排序码 k[i]==k[j] 。如果排序前后,对象 r[i]和 r[j] 的相对位置不变，则称排序算法是稳定的；否则排序算法是不稳定的。</li>
<li>时间开销：排序的时间开销可用算法执行中的数据比较次数与数据移动次数来衡量。算法运行时间代价的大略估算一般都按平均情况进行估算。对于那些受对象排序码序列初始排列及对象个数影响较大的，需要按最好情况和最坏情况进行估算3. 空间开销：算法执行时所需的附加存储。</li>
</ol>
<h2 id="1-冒泡排序-Bubble-Sort-（了解）"><a href="#1-冒泡排序-Bubble-Sort-（了解）" class="headerlink" title="1.冒泡排序 Bubble Sort （了解）"></a>1.冒泡排序 Bubble Sort （了解）</h2><p>首先是每次比较两个相邻的元素，当左面的大于右面的时候，进行互换位置，当小于的时候，都不动。<br>它重复地遍历要排序的数列直到没有再需要交换，该数列已经排序完成。<br>这个算法的名字由来是因为越小的元素会经由交换慢慢”浮”到数列的顶端，大的向下沉。</p>
<p>外层循环每一次经过两两比较，把每一轮未排定部分最大的元素放到了数组的末尾；<br>「冒泡排序」有个特点：在遍历的过程中，提前检测到数组是有序的，从而结束排序，而不像「选择排序」那样，即使输入数据是有序的，「选择排序」依然需要「傻乎乎」地走完所有的流程。<br>一趟排序完成后，则无序区减少一个数，有序区增加一个数</p>
<p>冒泡排序算法的运作如下：</p>
<ul>
<li>比较相邻的元素。如果第一个比第二个大（升序），就交换这两个。</li>
<li>对每一对相邻元素作同样的工作，从开始第一对到结尾的最后一对。这步做完后，最后的元素会是最大的数。</li>
<li>针对所有的元素重复以上的步骤，除了最后一个。</li>
<li>持续每次对越来越少的元素重复上面的步骤，直到没有任何一对数字需要比较。<br>时间复杂度 O(n^2)<br>空间复杂度：O(1) 用到常数个临时变量。<br>稳定性：稳定</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bubbleSort</span>(<span class="params">array</span>):</span></span><br><span class="line">    <span class="comment"># 遍历所有数组元素，每一个都要找到没排好序的最大值</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(array)):  <span class="comment"># 第i趟  </span></span><br><span class="line">    <span class="comment"># for i in range(len(array) - 1):  # 第i趟，减去1也不影响</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(array) - i - <span class="number">1</span>):</span><br><span class="line">            <span class="comment"># j 表示每次遍历需要比较的次数，是逐渐减小的</span></span><br><span class="line">            <span class="comment"># 将 没有排好序的数组 找最大值， 并一直将最大值换到最顶端</span></span><br><span class="line">            <span class="comment"># 判断如果说一个数大于它下面的一个数，那么就两个数的位置互换。</span></span><br><span class="line">            <span class="keyword">if</span> array[j] &gt; array[j + <span class="number">1</span>]:</span><br><span class="line">                array[j], array[j + <span class="number">1</span>] = array[j + <span class="number">1</span>], array[j]</span><br><span class="line">    <span class="keyword">return</span> array</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    array = [<span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">    print(bubbleSort(array))</span><br><span class="line">    <span class="comment"># [1, 2, 3, 4]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">len(<span class="built_in">array</span>) = <span class="number">4</span></span><br><span class="line">i = <span class="number">0</span> </span><br><span class="line">len(<span class="built_in">array</span>) - i - <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span> &gt; <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">4</span> &gt; <span class="built_in">array</span>[<span class="number">1</span> + <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">1</span> + <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span> + <span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">    j = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">4</span> &gt; <span class="built_in">array</span>[<span class="number">2</span> + <span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line">i = <span class="number">1</span>     </span><br><span class="line">len(<span class="built_in">array</span>) - i - <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">3</span> &gt; <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span> &gt; <span class="built_in">array</span>[<span class="number">1</span> + <span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">1</span> + <span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span> + <span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">i = <span class="number">2</span>     </span><br><span class="line">len(<span class="built_in">array</span>) - i - <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">1</span> &lt; <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bubble_sort</span>(<span class="params">array</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(array)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i + <span class="number">1</span>, len(array)):</span><br><span class="line">            <span class="keyword">if</span> array[i] &gt; array[j]:</span><br><span class="line">                array[i], array[j] = array[j], array[i]</span><br><span class="line">    <span class="keyword">return</span> array</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">len(<span class="built_in">array</span>) = <span class="number">4</span></span><br><span class="line">i = <span class="number">0</span> </span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span> &gt; <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span> + <span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">    j = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">3</span> &gt; <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">1</span> &lt; <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">i = <span class="number">1</span>     </span><br><span class="line">    j = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">4</span> &gt; <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span> &gt; <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>]</span><br><span class="line">i = <span class="number">2</span>     </span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">4</span> &gt; <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br></pre></td></tr></tbody></table></figure>

<p>优化的冒泡<br>如果在某一趟过程中没有发生交换，说明已经结束排序。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bubble_sort</span>(<span class="params">array</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(array) - <span class="number">1</span>):  </span><br><span class="line">            flag = <span class="literal">False</span>  <span class="comment"># 优化后的冒泡，设置一个交换标志位</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(array) - i - <span class="number">1</span>):  </span><br><span class="line">                <span class="keyword">if</span> array[j] &gt; array[j + <span class="number">1</span>]:</span><br><span class="line">                    array[j], array[j + <span class="number">1</span>] = array[j + <span class="number">1</span>], array[j]</span><br><span class="line">                    flag = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> flag:</span><br><span class="line">                <span class="keyword">return</span> array  <span class="comment"># 代表计算机偷懒成功</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bubble_sort</span>(<span class="params">nums</span>):</span></span><br><span class="line">    <span class="comment"># 升序排序，从列表最前面开始进行判断，如果后面一个小于前面一个，则交换位置,依次比较</span></span><br><span class="line">    <span class="comment"># 第一次循环就会把最大的值放到列表的最后面</span></span><br><span class="line">    <span class="comment"># 第二次循环就会把第二大的值放到最大值的前面，以此类推</span></span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(len(nums) - <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>):</span><br><span class="line">        <span class="keyword">for</span> num_index <span class="keyword">in</span> range(index):</span><br><span class="line">            <span class="keyword">if</span> nums[num_index] &gt; nums[num_index + <span class="number">1</span>]:</span><br><span class="line">                nums[num_index], nums[num_index + <span class="number">1</span>] = nums[num_index +</span><br><span class="line">                                                            <span class="number">1</span>], nums[num_index]</span><br><span class="line">    <span class="keyword">return</span> nums</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h2 id="2-插入排序-Insertion-Sort-（熟悉）"><a href="#2-插入排序-Insertion-Sort-（熟悉）" class="headerlink" title="2.插入排序 Insertion Sort （熟悉）"></a>2.插入排序 Insertion Sort （熟悉）</h2><p>每次将一个数据插入到已经排好序的有序数据中，从而得到一个新的、个数加1 的有序数据，<br>用于少量数据的排序，首先将第一个作为已经排好序的，然后每次从后的取出插入到前面并排序。</p>
<p>通过构建有序序列，对于未排序数据，在已排序序列中从后向前扫描，找到相应位置并插入。<br>插入排序在实现上，在从后向前扫描过程中，需要反复把已排序元素逐步向后挪位，为最新元素提供插入空间。<br>优化：「将一个数字插入一个有序的数组」这一步，可以不使用逐步交换，使用先赋值给「临时变量」，然后「适当的元素」后移，空出一个位置，最后把「临时变量」赋值给这个空位的策略（就是上面那张图的意思）。编码的时候如果不小心，可能会把数组的值修改，建议多调试；</p>
<p>特点：「插入排序」可以提前终止内层循环（体现在 nums[j - 1] &gt; temp 不满足时），在数组「几乎有序」的前提下，「插入排序」的时间复杂度可以达到 O(N)；</p>
<p>由于「插入排序」在「几乎有序」的数组上表现良好，特别地，在「短数组」上的表现也很好。因为「短数组」的特点是：每个元素离它最终排定的位置都不会太远。为此，在小区间内执行排序任务的时候，可以转向使用「插入排序」。</p>
<p>时间复杂度 O(n^2)<br>空间复杂度：O(1) 使用到常数个临时变量。<br>稳定性：稳定</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insert_sort</span>(<span class="params">ilist</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(ilist)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i):</span><br><span class="line">            <span class="keyword">if</span> ilist[i] &lt; ilist[j]:</span><br><span class="line">                ilist.insert(j, ilist.pop(i))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> ilist</span><br><span class="line"></span><br><span class="line">print(insert_sort([<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">0</span>]))</span><br><span class="line"><span class="comment"># [0, 1, 2, 3, 4, 6, 7, 8]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">len(<span class="built_in">array</span>) = <span class="number">4</span></span><br><span class="line">i = <span class="number">0</span> </span><br><span class="line">    j 为空</span><br><span class="line">i = <span class="number">1</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span> &lt; <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">    [<span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">i = <span class="number">2</span>    </span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">1</span> &lt; <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">i = <span class="number">3</span>     </span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span> &gt; <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span> &lt; <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insert_sort</span>(<span class="params">alist</span>):</span></span><br><span class="line">    <span class="comment"># 从第二个位置，即下标为1的元素开始向前插入</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(alist)):</span><br><span class="line">        <span class="comment"># 从第i个元素开始向前比较，如果小于前一个元素，交换位置</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i, <span class="number">0</span>, <span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">if</span> alist[j] &lt; alist[j<span class="number">-1</span>]:</span><br><span class="line">                alist[j], alist[j<span class="number">-1</span>] = alist[j<span class="number">-1</span>], alist[j]</span><br><span class="line"></span><br><span class="line">alist = [<span class="number">54</span>,<span class="number">26</span>,<span class="number">93</span>,<span class="number">17</span>,<span class="number">77</span>,<span class="number">31</span>,<span class="number">44</span>,<span class="number">55</span>,<span class="number">20</span>]</span><br><span class="line">print(insert_sort(alist))</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insert_sort</span>(<span class="params">li</span>):</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">        插入排序，将无序区的数据依次取出，与有序区数据比较，然后放在合理的位置</span></span><br><span class="line"><span class="string">        li: 无序列表</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(li)):  <span class="comment"># 无序列表第一个数</span></span><br><span class="line">        temp = li[i]</span><br><span class="line">        j = i - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> j &gt;= <span class="number">0</span> <span class="keyword">and</span> li[j] &gt; temp: <span class="comment">#如果有序区的数依次与无序列表第一个数比较，直到找到对应位置</span></span><br><span class="line">            li[j+<span class="number">1</span>] = li[j]</span><br><span class="line">            j -= <span class="number">1</span></span><br><span class="line">        li[j+<span class="number">1</span>] = temp</span><br><span class="line">    <span class="keyword">return</span> li</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">插入排序 Insertion Sort</span><br><span class="line">从左到右遍历每一个元素，每次将这个元素和前面的元素一一比较，如果比某个元素小，则跟其交换</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insert_sort</span>(<span class="params">arr, n</span>):</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    选择排序，每次选择未排序部分的最小值和未排序部分的第一位交换位置</span></span><br><span class="line"><span class="string">    :param arr:</span></span><br><span class="line"><span class="string">    :param n:</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n):</span><br><span class="line">        <span class="comment"># 寻找元素arr[i]合适的插入位置</span></span><br><span class="line"></span><br><span class="line">        e = arr[i]</span><br><span class="line">        j = i  <span class="comment"># j保存元素e应该插入的位置</span></span><br><span class="line">        <span class="keyword">while</span> arr[j<span class="number">-1</span>] &gt; e <span class="keyword">and</span> j &gt; <span class="number">0</span>:</span><br><span class="line">            arr[j] = arr[j<span class="number">-1</span>]</span><br><span class="line">            j -= <span class="number">1</span></span><br><span class="line">        arr[j] = e</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>选择排序一个特别重要的性质：当找到合适的位置以后（<code>arr[j-1] &gt; e</code>），可以提前终止内层循环<br>这使得在一个近乎有序的数组在进行插入排序的时候，效率要高的多，设置比o(logn)的算法效率还要高<br>当排序一个完全排序的数组时，插入排序的算法复杂度为o(n)级别</li>
</ul>
<p>（直白描述）<br>1.当只考虑第一个元素的时候，它已经排好序了，第一个元素不动。<br>2.寻找第二个元素合适的位置，把它和第一个元素比较，如果小于第一个元素，交换，否则，它的位置是合适的，继续下一次循环。<br>3.寻找第三个元素合适的位置，先和第二个元素比较，如果小于第二个元素，和第二个元素交换位置，然后和第一个元素比较，如果小于第一个元素，和第一个元素交换位置，继续下一次循环。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insertionSort</span>(<span class="params">arrList</span>):</span></span><br><span class="line">    <span class="comment"># 从1开始，第0个元素已经有序</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(arrList)):</span><br><span class="line">        <span class="comment"># 寻找arrList[i]合适的插入位置</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i, <span class="number">0</span>, <span class="number">-1</span>):</span><br><span class="line">            <span class="comment"># 如果当前位置元素比前一个位置元素小，交换</span></span><br><span class="line">            <span class="keyword">if</span> arrList[j] &lt; arrList[j<span class="number">-1</span>]:</span><br><span class="line">                arrList[j<span class="number">-1</span>], arrList[j] = arrList[j], arrList[j<span class="number">-1</span>]</span><br><span class="line">            <span class="comment"># 否则，当前元素位置合适，寻找下一个元素的合适位置</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">a = [<span class="number">10</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>]</span><br><span class="line">insertionSort(a)</span><br><span class="line"></span><br><span class="line">print(a)</span><br><span class="line"><span class="comment"># [6, 7, 8, 9, 10]</span></span><br></pre></td></tr></tbody></table></figure>

<p>插入排序算法的改进<br>（形式化描述）<br>将第一个元素标记为已排序<br>遍历每个没有排序过的元素<br>    “提取” 元素 X<br>    i = 最后排序过元素的指数 到 0 的遍历<br>        如果现在排序过的元素 &gt; 提取的元素<br>            将排序过的元素向右移一格<br>        否则：插入提取的元素</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">insertionSort</span>(<span class="params">arrList</span>):</span></span><br><span class="line">    <span class="comment"># 从1开始，第0个元素已经有序</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(arrList)):</span><br><span class="line">        <span class="comment"># 寻找arrList[i]合适的插入位置</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将当前元素提取出来</span></span><br><span class="line">        x = arrList[i]</span><br><span class="line">        <span class="comment"># j保存元素应该插入的位置，初始为i</span></span><br><span class="line">        j = i</span><br><span class="line">        <span class="comment"># -1取不到，可以取到0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">if</span> arrList[j<span class="number">-1</span>] &gt; x:</span><br><span class="line">                <span class="comment"># 赋值而不做交换</span></span><br><span class="line">                arrList[j] = arrList[j<span class="number">-1</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 位置合适</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        arrList[j] = x</span><br><span class="line"></span><br><span class="line">a = [<span class="number">10</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>]</span><br><span class="line">insertionSort(a)</span><br><span class="line"></span><br><span class="line">print(a)</span><br><span class="line"><span class="comment"># [6, 7, 8, 9, 10]</span></span><br></pre></td></tr></tbody></table></figure>
<hr>
<h2 id="3-选择排序-Selection-sort-（了解）"><a href="#3-选择排序-Selection-sort-（了解）" class="headerlink" title="3.选择排序 Selection sort （了解）"></a>3.选择排序 Selection sort （了解）</h2><p>首先在未排序序列中找到最小（大）元素，存放到排序序列的起始位置，然后，再从剩余未排序元素中继续寻找最小（大）元素，然后放到已排序序列的末尾。以此类推，直到所有元素均排序完毕。</p>
<p>选择排序的主要优点与数据移动有关。如果某个元素位于正确的最终位置上，则它不会被移动。选择排序每次交换一对元素，它们当中至少有一个将被移到其最终位置上，因此对n个元素的表进行排序总共进行至多n-1次交换。在所有的完全依靠交换去移动元素的排序方法中，选择排序属于非常好的一种。<br>第一趟，在待排序记录r1 …r(n)中选出最小的记录，将它与r1 交换，<br>第二趟，在待排序记录r2 ~ r(n) 中选出最小的记录，将它与 r2 交换，<br>以此类推，第i趟在待排序记录 r[i]~r[n]中选出最小的记录，将它与r[i]交换，使有序序列不断增长直到全部排序完毕。</p>
<p>算法思想 1：贪心算法：每一次决策只看当前，当前最优，则全局最优。<br>注意：这种思想不是任何时候都适用。</p>
<p>算法思想 2：减治思想：外层循环每一次都能排定一个元素，问题的规模逐渐减少，直到全部解决，即「大而化小，小而化了」。运用「减治思想」很典型的算法就是大名鼎鼎的「二分查找」。</p>
<p>优点：交换次数最少。</p>
<p>时间复杂度 O(n^2)<br>空间复杂度：O(1)<br>稳定性：不稳定</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">select_sort</span>(<span class="params">array</span>):</span></span><br><span class="line">    <span class="comment"># 外层循环控制循环次数</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(array)):  <span class="comment"># 第i趟</span></span><br><span class="line">    <span class="comment"># for i in range(len(array) - 1):  # 第i趟</span></span><br><span class="line">        min_index = i  <span class="comment"># 假设找到的最小元素下标，无序区第一个数开始查找</span></span><br><span class="line">        <span class="comment"># 寻找最小元素的过程</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i, len(array)):</span><br><span class="line">        <span class="comment"># for j in range(i + 1, len(array)):  </span></span><br><span class="line">        <span class="comment"># 加1也不影响 从i+1位置到末尾选择出最小数据</span></span><br><span class="line">            <span class="comment"># 假设最小下标的值，大于循环中一个元素，那么就改变最小值的下标</span></span><br><span class="line">            <span class="keyword">if</span> array[j] &lt; array[min_index]:</span><br><span class="line">                min_index = j</span><br><span class="line">        <span class="comment"># 循环一开始就假设把最小值的下标赋值给变量 min_index</span></span><br><span class="line">        <span class="comment"># 在不停的循环中，不停的交换两个不一样大小的值</span></span><br><span class="line">        array[i], array[min_index] = array[min_index], array[i]</span><br><span class="line">    <span class="keyword">return</span> array</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">len(<span class="built_in">array</span>) = <span class="number">4</span></span><br><span class="line">i = <span class="number">0</span> </span><br><span class="line">min_index = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span> = <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span> &lt; <span class="built_in">array</span>[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    min_index = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    j = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">1</span> &lt; <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    min_index = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span> &gt; <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    min_index = <span class="number">2</span></span><br><span class="line">    slist[<span class="number">0</span>] = slist[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    slist[<span class="number">2</span>]  = slist[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    slist = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line">min_index = <span class="number">1</span></span><br><span class="line">    j = <span class="number">1</span>,  j 从i开始，不是从<span class="number">0</span>开始</span><br><span class="line">    <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span> = <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    j = <span class="number">2</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">4</span> &gt; <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">2</span> &lt; <span class="built_in">array</span>[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    min_index = <span class="number">3</span></span><br><span class="line">    slist[<span class="number">1</span>] = slist[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">    slist[<span class="number">3</span>]  = slist[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">    slist = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>]</span><br><span class="line">    </span><br><span class="line">i = <span class="number">2</span>  </span><br><span class="line">min_index = <span class="number">2</span>  </span><br><span class="line">    j = <span class="number">2</span>,  j 从i开始，不是从<span class="number">0</span>开始</span><br><span class="line">    <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">4</span> = <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">4</span></span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">3</span> &lt; <span class="built_in">array</span>[<span class="number">2</span>] = <span class="number">4</span></span><br><span class="line">    min_index = <span class="number">3</span></span><br><span class="line">    slist[<span class="number">2</span>] = slist[<span class="number">3</span>] = <span class="number">3</span></span><br><span class="line">    slist[<span class="number">3</span>]  = slist[<span class="number">2</span>] = <span class="number">4</span></span><br><span class="line">    slist = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">i = <span class="number">3</span>     </span><br><span class="line">min_index = <span class="number">3</span> </span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">3</span> = <span class="built_in">array</span>[<span class="number">3</span>] = <span class="number">3</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></tbody></table></figure>
<p>每次选择没有排序部分的最小值和第一位交换</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">selection_sort</span>(<span class="params">org_arr, length</span>):</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    选择排序，每次选择未排序部分的最小值和未排序部分的第一位交换位置</span></span><br><span class="line"><span class="string">    :param org_arr: 待排序数组</span></span><br><span class="line"><span class="string">    :param length: 待数组长度</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, length):</span><br><span class="line">        <span class="comment"># 寻找[i,n)区间里的最小值</span></span><br><span class="line">        main_index = i</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>, length):</span><br><span class="line">            <span class="keyword">if</span> org_arr[j] &lt; org_arr[main_index]:</span><br><span class="line">                main_index = j</span><br><span class="line">        org_arr[i], org_arr[main_index] = org_arr[main_index], org_arr[i]</span><br></pre></td></tr></tbody></table></figure>
<p>（直白描述）</p>
<ol>
<li>找出所有元素中的最小值，与第一个位置的元素互换。</li>
<li>找出剩下的元素中的最小值，与第二个位置的元素互换。</li>
<li>以此类推。</li>
</ol>
<p>（形式化描述）<br>重复（元素个数-1）次<br>    # 从0开始<br>    把第一个没有排序过的元素设置为最小值<br>    遍历每个没有排序过的元素<br>        如果元素 &lt; 现在的最小值<br>        将此元素设置成为新的最小值<br>    将最小值和第一个没有排序过的位置交换</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">selectionSort</span>(<span class="params">arrList</span>):</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    选择排序</span></span><br><span class="line"><span class="string">    :param arrList:可迭代对象</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(arrList)):</span><br><span class="line">        <span class="comment"># 寻找[i, len(arrlist))区间的最小值</span></span><br><span class="line">        minIndex = i</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>, len(arrList)):</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> arrList[j] &lt; arrList[i]:</span><br><span class="line">                minIndex = j</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 交换i位置和最小值</span></span><br><span class="line">        <span class="comment"># 注意双向交换</span></span><br><span class="line">        arrList[i], arrList[minIndex] = arrList[minIndex], arrList[i]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试</span></span><br><span class="line">a = [<span class="number">10</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">selectionSort(a)</span><br><span class="line"></span><br><span class="line">print(a)    </span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br></pre></td></tr></tbody></table></figure>
<hr>
<h2 id="4-希尔排序-Shell-Sort（不建议多花时间了解）"><a href="#4-希尔排序-Shell-Sort（不建议多花时间了解）" class="headerlink" title="4.希尔排序 Shell Sort（不建议多花时间了解）"></a>4.希尔排序 Shell Sort（不建议多花时间了解）</h2><p>是插入排序的一种。也称缩小增量排序，是直接插入排序算法的一种更高效的改进版本。</p>
<p>是把记录按下标的一定增量分组，对每组使用直接插入排序算法排序；随着增量逐渐减少，每组包含的关键词越来越多，当增量减至1时，整个文件恰好被分成一组，算法终止</p>
<p>将数组列在一个表中并对列分别进行插入排序，重复这过程，不过每次用更长的列（步长更长了，列数更少了）来进行。最后整个表就只有一列了。将数组转换至表是为了更好地理解这算法，算法本身还是使用数组进行排序。</p>
<p>时间复杂度 O(n^2)<br>空间复杂度：O(nlogn)<br>稳定性：不稳定</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shell_sort</span>(<span class="params">slist</span>):</span></span><br><span class="line">    count = len(slist)</span><br><span class="line">    step = <span class="number">2</span></span><br><span class="line">    group = count // step</span><br><span class="line">    <span class="keyword">while</span> group &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(group):</span><br><span class="line">            j = i + group</span><br><span class="line">            <span class="keyword">while</span> j &lt; count:</span><br><span class="line">                key = slist[j]</span><br><span class="line">                k = j - group</span><br><span class="line">                <span class="keyword">while</span> k &gt;= <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">if</span> slist[k] &gt; key:</span><br><span class="line">                        slist[k+group] = slist[k]</span><br><span class="line">                        slist[k] = key</span><br><span class="line">                    k = k - group</span><br><span class="line">                j = j + group</span><br><span class="line">        group = group // step</span><br><span class="line">    <span class="keyword">return</span> slist</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(shell_sort([4,5,7,3,2,6,9,8,0]))</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ShellSort</span>(<span class="params">arrList</span>):</span></span><br><span class="line">    arrayLen = len(arrList)</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> h &lt; arrayLen//<span class="number">3</span>:</span><br><span class="line">        h = h * <span class="number">3</span> + <span class="number">1</span></span><br><span class="line">        <span class="comment">#插入排序的方法，判断是不是后一个比前一个要小</span></span><br><span class="line">        <span class="comment">#如果是则交换</span></span><br><span class="line">    <span class="keyword">while</span> h &gt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(h,arrayLen):</span><br><span class="line">            j = i</span><br><span class="line">            <span class="keyword">while</span> j &gt;= h <span class="keyword">and</span> arrList[j] &lt; arrList[j-h]:</span><br><span class="line">                arrList[j] ,arrList[j-h] = arrList[j-h],arrList[j]</span><br><span class="line">                j -= h</span><br><span class="line">        h  //= <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    arrList = [<span class="number">14</span>,<span class="number">33</span>,<span class="number">27</span>,<span class="number">10</span>,<span class="number">35</span>,<span class="number">19</span>,<span class="number">42</span>,<span class="number">44</span>]</span><br><span class="line">    ShellSort(arrList)</span><br><span class="line">    print(arrList)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shell_sort</span>(<span class="params">alist</span>):</span></span><br><span class="line">    n = len(alist)</span><br><span class="line">    <span class="comment"># 初始步长</span></span><br><span class="line">    gap = n / <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> gap &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># 按步长进行插入排序</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(gap, n):</span><br><span class="line">            j = i</span><br><span class="line">            <span class="comment"># 插入排序</span></span><br><span class="line">            <span class="keyword">while</span> j&gt;=gap <span class="keyword">and</span> alist[j-gap] &gt; alist[j]:</span><br><span class="line">                alist[j-gap], alist[j] = alist[j], alist[j-gap]</span><br><span class="line">                j -= gap</span><br><span class="line">        <span class="comment"># 得到新的步长</span></span><br><span class="line">        gap = gap / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">alist = [<span class="number">54</span>,<span class="number">26</span>,<span class="number">93</span>,<span class="number">17</span>,<span class="number">77</span>,<span class="number">31</span>,<span class="number">44</span>,<span class="number">55</span>,<span class="number">20</span>]</span><br><span class="line">shell_sort(alist)</span><br><span class="line">print(alist)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="排序数组"><a href="#排序数组" class="headerlink" title="排序数组"></a>排序数组</h2><p><strong>给你一个整数数组 nums，请你将该数组升序排列。</strong></p>
<p>示例 1：</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [<span class="number">5</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>]</span><br><span class="line">输出：[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>]</span><br></pre></td></tr></tbody></table></figure>
<p>示例 2：</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入：nums = [<span class="number">5</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">输出：[<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>]</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h2 id="5-归并排序-Merge-Sort-（重点）"><a href="#5-归并排序-Merge-Sort-（重点）" class="headerlink" title="5.归并排序  Merge_Sort （重点）"></a>5.归并排序  Merge_Sort （重点）</h2><p>算法思想：分而治之（分治思想）（Divide and Conquer）。<br>形象理解是「曹冲称象」、MapReduce，在一定情况下可以并行化。</p>
<p>算法描述：<br>把长度为n的输入序列中待排序数字分分成长度 n/2的子序列；<br>一直重复<br>直到每个子序列只包含一个数字，长度为一的数组是有序的<br>对两个子序列采用归并排序，合并为一个有序序列<br>反复归并，将若干个组两两合并，所有子序列。</p>
<p>直到只剩下一组，最后把另一个数组的剩余部分复制过来即可</p>
<p>让子序列有序，再将子序列间有序，</p>
<p>基本思路：是比较两个数组的最前面的数，<br>谁小就先取谁，取了后相应的指针就往后移一位。<br>然后再比较，直至一个数组为空，</p>
<p>例如：「力扣」第 88 题：合并两个有序数组。</p>
<p>「归并排序」是理解「递归思想」的非常好的学习材料，大家可以通过理解：<br>递归完成以后，合并两个有序数组的这一步骤，想清楚程序的执行流程。<br>即「递归函数执行完成以后，我们还可以做点事情」。</p>
<p>时间复杂度：O(nlogn)<br>空间复杂度：O(1)<br>稳定性：稳定</p>
<p>当n较大，则应采用时间复杂度为O(nlog2n)的排序方法：快速排序、堆排序或归并排序序。</p>
<p>思路<br>归并排序利用了分治的思想来对序列进行排序。对一个长为 n 的待排序的序列，我们将其分解成两个长度为 n/2 的子序列。每次先递归调用函数使两个子序列有序，然后我们再线性合并两个有序的子序列使整个序列有序。</p>
<p>算法</p>
<p>定义 mergeSort(nums, l, r) 函数表示对 nums 数组里 [l,r] 的部分进行排序，整个函数流程如下：</p>
<ol>
<li><p>递归调用函数 mergeSort(nums, l, mid) 对 nums 数组里 [l,mid] 部分进行排序。</p>
</li>
<li><p>递归调用函数 mergeSort(nums, mid + 1, r) 对 nums 数组里 [mid+1,r] 部分进行排序。</p>
</li>
<li><p>此时 nums 数组里 [l,mid] 和 [mid+1,r] 两个区间已经有序，我们对两个有序区间线性归并即可使 nums 数组里 [l,r] 的部分有序。</p>
</li>
</ol>
<p>线性归并的过程，由于两个区间均有序，<br>所以我们维护两个指针 i 和 j 表示当前考虑到 [l,mid] 里的第 i 个位置和 [mid+1,r] 的第 j 个位置。</p>
<p>如果 nums[i] &lt; nums[j] ，那么我们就将 nums[i] 放入临时数组 tmp 中并让 i += 1 ，即指针往后移。否则我们就将 nums[j] 放入临时数组 tmp 中并让 j += 1 。<br>如果有一个指针已经移到了区间的末尾，那么就把另一个区间里的数按顺序加入 tmp 数组中即可。</p>
<p>这样能保证我们每次都是让两个区间中较小的数加入临时数组里，那么整个归并过程结束后 [l,r] 即为有序的。</p>
<p>函数递归调用的入口为 mergeSort(nums, 0, nums.length - 1)，递归结束当且仅当 l &gt;= r。</p>
<p>时间复杂度：O(nlogn)。由于归并排序每次都将当前待排序的序列折半成两个子序列递归调用，然后再合并两个有序的子序列，而每次合并两个有序的子序列需要 O(n) 的时间复杂度，所以我们可以列出归并排序运行时间 T(n) 的递归表达式：<br>T(n)=2T(n/2}) + O(n)<br>根据主定理我们可以得出归并排序的时间复杂度为 O(nlogn)。</p>
<p>空间复杂度：O(n)。我们需要额外 O(n) 空间的 tmp 数组，且归并排序递归调用的层数最深为 \log_2 ，所以我们还需要额外的 O(logn) 的栈空间，所需的空间复杂度即为 O(n+logn)=O(n)</p>
<p><img src="/2020/08/21/liu-da-ji-ben-pai-xu/..%5C%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%5C%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84.gif"></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">merge_sort</span>(<span class="params">self, nums, l, r</span>):</span></span><br><span class="line">        <span class="keyword">if</span> l == r:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        mid = (l + r) // <span class="number">2</span></span><br><span class="line">        self.merge_sort(nums, l, mid)</span><br><span class="line">        self.merge_sort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">        tmp = []</span><br><span class="line">        i, j = l, mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> i &lt;= mid <span class="keyword">or</span> j &lt;= r:</span><br><span class="line">            <span class="keyword">if</span> i &gt; mid <span class="keyword">or</span> (j &lt;= r <span class="keyword">and</span> nums[j] &lt; nums[i]):</span><br><span class="line">                tmp.append(nums[j])</span><br><span class="line">                j += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tmp.append(nums[i])</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">        nums[l:r + <span class="number">1</span>] = tmp</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortArray</span>(<span class="params">self, nums: List[int]</span>) -&gt; List[int]:</span></span><br><span class="line">        self.merge_sort(nums, <span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> nums</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">    print(solution.sortArray(array))</span><br><span class="line">    <span class="comment"># [1, 2, 2, 3, 5, 6]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br></pre></td><td class="code"><pre><span class="line">nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">len(nums) - <span class="number">1</span> = <span class="number">6</span> - <span class="number">1</span> = <span class="number">5</span></span><br><span class="line">l = <span class="number">0</span></span><br><span class="line">r = <span class="number">5</span></span><br><span class="line">mid = (<span class="number">0</span> + <span class="number">5</span>) <span class="comment">// 2 = 2</span></span><br><span class="line"></span><br><span class="line">    merge_sort(nums, l, mid)</span><br><span class="line">    l = <span class="number">0</span></span><br><span class="line">    r = <span class="number">2</span></span><br><span class="line">    mid = (<span class="number">0</span> + <span class="number">2</span>) <span class="comment">// 2 = 1</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">        merge_sort(nums, l, mid)</span><br><span class="line">        l = <span class="number">0</span></span><br><span class="line">        r = <span class="number">1</span></span><br><span class="line">        mid = (<span class="number">0</span> + <span class="number">1</span>) <span class="comment">// 2 = 0</span></span><br><span class="line">        [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">            merge_sort(nums, l, mid)</span><br><span class="line">            l = r = <span class="number">0</span></span><br><span class="line">            [<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">            递归到最深层</span><br><span class="line"></span><br><span class="line">        回到上一层的结果</span><br><span class="line">        l = <span class="number">0</span></span><br><span class="line">        r = <span class="number">1</span></span><br><span class="line">        mid = (<span class="number">0</span> + <span class="number">1</span>) <span class="comment">// 2 = 0</span></span><br><span class="line">        [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">            merge_sort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">            l = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span> = r</span><br><span class="line">            [<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">            递归到最深层</span><br><span class="line"></span><br><span class="line">        回到上一层的结果</span><br><span class="line">        l = <span class="number">0</span></span><br><span class="line">        r = <span class="number">1</span></span><br><span class="line">        mid = (<span class="number">0</span> + <span class="number">1</span>) <span class="comment">// 2 = 0</span></span><br><span class="line">        [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">        tmp = []</span><br><span class="line">        i = l = <span class="number">0</span> = mid </span><br><span class="line">        j = mid + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span> = r </span><br><span class="line">        num[j] = nums[<span class="number">1</span>] = <span class="number">2</span> &gt; nums[i] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">        tmp.append(nums[i])</span><br><span class="line">        tmp = [<span class="number">1</span>]</span><br><span class="line">        i = i + <span class="number">1</span> = <span class="number">1</span> &gt; mid = <span class="number">0</span></span><br><span class="line">        j = r</span><br><span class="line">        tmp.append(nums[j])</span><br><span class="line">        tmp = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">        j = j + <span class="number">1</span> = <span class="number">2</span> &gt; r = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        nums[l:r + <span class="number">1</span>] = tmp = [<span class="number">1</span>, <span class="number">2</span>]  # 切片左闭右开 </span><br><span class="line">        l = <span class="number">0</span></span><br><span class="line">        r + <span class="number">1</span> = <span class="number">1</span> + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">        nums[<span class="number">0</span>:<span class="number">2</span>] = [<span class="number">1</span>, <span class="number">2</span>]  # 切片左闭右开 </span><br><span class="line">        递归到最深层</span><br><span class="line"></span><br><span class="line">    回到上一层的结果</span><br><span class="line">    merge_sort(nums, l, mid)</span><br><span class="line">    l = <span class="number">0</span></span><br><span class="line">    r = <span class="number">2</span></span><br><span class="line">    mid = (<span class="number">0</span> + <span class="number">2</span>) <span class="comment">// 2 = 1</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">        self.merge_sort(nums, l, mid)</span><br><span class="line">        已经执行过，不再执行</span><br><span class="line"></span><br><span class="line">        self.merge_sort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">        l = mid + <span class="number">1</span> = <span class="number">1</span> + <span class="number">1</span> = <span class="number">2</span> = r</span><br><span class="line">        [<span class="number">3</span>]</span><br><span class="line">        <span class="keyword">return</span>  </span><br><span class="line">        递归到最深层</span><br><span class="line"></span><br><span class="line">    回到上一层的结果</span><br><span class="line">    l = <span class="number">0</span></span><br><span class="line">    r = <span class="number">2</span></span><br><span class="line">    mid = (<span class="number">0</span> + <span class="number">2</span>) <span class="comment">// 2 = 1</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    tmp = []</span><br><span class="line">    i = l = <span class="number">0</span> &lt; mid = <span class="number">1</span></span><br><span class="line">    j = mid + <span class="number">1</span> = <span class="number">2</span> = r</span><br><span class="line"></span><br><span class="line">    num[j] = nums[<span class="number">2</span>] = <span class="number">3</span> &gt; nums[i] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    tmp.append(nums[i])</span><br><span class="line">    tmp = [<span class="number">1</span>]</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">1</span> = mid</span><br><span class="line">    tmp.append(nums[i])</span><br><span class="line">    tmp = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">2</span> &gt; mid</span><br><span class="line">    tmp.append(nums[j])</span><br><span class="line">    tmp = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">    j = j + <span class="number">1</span> = <span class="number">3</span> &gt; r 退出循环</span><br><span class="line"></span><br><span class="line">    nums[l:r + <span class="number">1</span>] = tmp </span><br><span class="line">    l = <span class="number">0</span></span><br><span class="line">    r + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">    nums[<span class="number">0</span>:<span class="number">3</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">    递归到最深层</span><br><span class="line"></span><br><span class="line">回到上一层的结果</span><br><span class="line">nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">l = <span class="number">0</span></span><br><span class="line">r = <span class="number">5</span></span><br><span class="line">mid = (<span class="number">0</span> + <span class="number">5</span>) <span class="comment">// 2 = 2</span></span><br><span class="line"></span><br><span class="line">    self.merge_sort(nums, l, mid)</span><br><span class="line">    不执行</span><br><span class="line"></span><br><span class="line">    self.merge_sort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">    l = mid + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> </span><br><span class="line">    r = <span class="number">5</span></span><br><span class="line">    mid = (<span class="number">3</span> + <span class="number">5</span>) <span class="comment">// 2 = 4</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">        self.merge_sort(nums, l, mid)</span><br><span class="line">        l = <span class="number">3</span> </span><br><span class="line">        r = <span class="number">4</span></span><br><span class="line">        mid = (<span class="number">3</span> + <span class="number">4</span>) <span class="comment">// 2 = 3</span></span><br><span class="line">        [<span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">            self.merge_sort(nums, l, mid)</span><br><span class="line">            l = <span class="number">3</span> = r </span><br><span class="line">            [<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">return</span>  </span><br><span class="line">            递归到最深层</span><br><span class="line"></span><br><span class="line">        回到上一层的结果</span><br><span class="line">        l = <span class="number">3</span> </span><br><span class="line">        r = <span class="number">4</span></span><br><span class="line">        mid = (<span class="number">3</span> + <span class="number">4</span>) <span class="comment">// 2 = 3</span></span><br><span class="line">        [<span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">            self.merge_sort(nums, l, mid)</span><br><span class="line">            不执行</span><br><span class="line">            self.merge_sort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">            l = mid + <span class="number">1</span> = <span class="number">3</span> + <span class="number">1</span> = <span class="number">4</span> = r </span><br><span class="line">            [<span class="number">5</span>]</span><br><span class="line">            <span class="keyword">return</span>  </span><br><span class="line">            递归到最深层</span><br><span class="line"></span><br><span class="line">        回到上一层的结果</span><br><span class="line">        l = <span class="number">3</span> </span><br><span class="line">        r = <span class="number">4</span></span><br><span class="line">        mid = (<span class="number">3</span> + <span class="number">4</span>) <span class="comment">// 2 = 3</span></span><br><span class="line">        [<span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">        tmp = []</span><br><span class="line">        i = l = <span class="number">3</span> = mid </span><br><span class="line">        j = mid + <span class="number">1</span> = <span class="number">3</span> + <span class="number">1</span> = <span class="number">4</span> = r </span><br><span class="line">        num[j] = nums[<span class="number">4</span>] = <span class="number">5</span> &gt; nums[i] = nums[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">        tmp.append(nums[i])</span><br><span class="line">        tmp = [<span class="number">2</span>]</span><br><span class="line">        i = i + <span class="number">1</span> = <span class="number">3</span> + <span class="number">1</span> = <span class="number">4</span> &gt; mid = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">        tmp.append(nums[j])</span><br><span class="line">        tmp = [<span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">        j = j + <span class="number">1</span> = <span class="number">4</span> + <span class="number">1</span> = <span class="number">5</span> &gt; r = <span class="number">4</span></span><br><span class="line">        跳出循环</span><br><span class="line"></span><br><span class="line">        nums[l:r + <span class="number">1</span>] = tmp  # 切片左闭右开 </span><br><span class="line">        l = <span class="number">3</span></span><br><span class="line">        r + <span class="number">1</span> = <span class="number">4</span> + <span class="number">1</span> = <span class="number">5</span></span><br><span class="line">        nums[<span class="number">3</span>:<span class="number">5</span>] = [<span class="number">2</span>, <span class="number">5</span>]  # 切片左闭右开</span><br><span class="line">        递归到最深层</span><br><span class="line"></span><br><span class="line">    回到上一层</span><br><span class="line">    l = mid + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> </span><br><span class="line">    r = <span class="number">5</span></span><br><span class="line">    mid = (<span class="number">3</span> + <span class="number">5</span>) <span class="comment">// 2 = 4</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">        self.merge_sort(nums, l, mid)</span><br><span class="line">        不再执行</span><br><span class="line"></span><br><span class="line">        self.merge_sort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">        l = mid + <span class="number">1</span> = <span class="number">4</span> + <span class="number">1</span> = <span class="number">5</span> = r </span><br><span class="line">        [<span class="number">6</span>]</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">        递归到最深层</span><br><span class="line"></span><br><span class="line">    回到上一层</span><br><span class="line">    l = mid + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> </span><br><span class="line">    r = <span class="number">5</span></span><br><span class="line">    mid = (<span class="number">3</span> + <span class="number">5</span>) <span class="comment">// 2 = 4</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">    tmp = []</span><br><span class="line">    i = l = <span class="number">3</span> &lt; mid = <span class="number">4</span></span><br><span class="line">    j = mid + <span class="number">1</span> = <span class="number">4</span> + <span class="number">1</span> = <span class="number">5</span> = r </span><br><span class="line">    num[j] = nums[<span class="number">5</span>] = <span class="number">6</span> &gt; nums[i] = nums[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line">    tmp.append(nums[i])</span><br><span class="line">    tmp = [<span class="number">2</span>]</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">3</span> + <span class="number">1</span> = <span class="number">4</span> = mid = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    tmp.append(nums[i])</span><br><span class="line">    tmp = [<span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">4</span> + <span class="number">1</span> = <span class="number">5</span> &gt; mid = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    tmp.append(nums[i])</span><br><span class="line">    tmp = [<span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]    </span><br><span class="line">    j = j + <span class="number">1</span> = <span class="number">6</span> &gt; r</span><br><span class="line"></span><br><span class="line">    nums[l:r + <span class="number">1</span>] = tmp  # 切片左闭右开  </span><br><span class="line">    l = <span class="number">3</span></span><br><span class="line">    r + <span class="number">1</span> = <span class="number">5</span> + <span class="number">1</span> = <span class="number">6</span></span><br><span class="line">    nums[<span class="number">3</span>:<span class="number">6</span>] = [<span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]  # 切片左闭右开</span><br><span class="line">    递归到最深层</span><br><span class="line"></span><br><span class="line">回到上一层的结果</span><br><span class="line">nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">l = <span class="number">0</span></span><br><span class="line">r = <span class="number">5</span></span><br><span class="line">mid = (<span class="number">0</span> + <span class="number">5</span>) <span class="comment">// 2 = 2</span></span><br><span class="line"></span><br><span class="line">tmp = []</span><br><span class="line">i = l = <span class="number">0</span> &lt; mid = <span class="number">2</span></span><br><span class="line">j = mid + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> &lt; r = <span class="number">5</span></span><br><span class="line">num[j] = nums[<span class="number">3</span>] = <span class="number">2</span> &gt; nums[i] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">tmp.append(nums[i])</span><br><span class="line">tmp = [<span class="number">1</span>]</span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span> &lt; mid = <span class="number">2</span></span><br><span class="line">tmp.append(nums[i])</span><br><span class="line">tmp = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">1</span> + <span class="number">1</span> = <span class="number">2</span> = mid = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">tmp.append(nums[j])</span><br><span class="line">tmp = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>]</span><br><span class="line">j = j + <span class="number">1</span> = <span class="number">3</span> + <span class="number">1</span> = <span class="number">4</span> &lt; r = <span class="number">5</span></span><br><span class="line">num[j] = nums[<span class="number">4</span>] = <span class="number">5</span> &gt; nums[i] = nums[<span class="number">4</span>] = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">tmp.append(nums[i])</span><br><span class="line">tmp = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> &gt; mid = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">tmp.append(nums[j])</span><br><span class="line">tmp = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>]</span><br><span class="line">j = j + <span class="number">1</span> = <span class="number">4</span> + <span class="number">1</span> = <span class="number">5</span> = r = <span class="number">5</span></span><br><span class="line">num[j] = nums[<span class="number">5</span>] = <span class="number">6</span> &gt; nums[i] = nums[<span class="number">3</span>] = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">tmp.append(nums[j])</span><br><span class="line">tmp = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">j = j + <span class="number">1</span> = <span class="number">5</span> + <span class="number">1</span> = <span class="number">6</span> &gt; r = <span class="number">5</span></span><br><span class="line">跳出循环</span><br><span class="line"></span><br><span class="line">nums[l:r + <span class="number">1</span>] = tmp  # 切片左闭右开 </span><br><span class="line">l = <span class="number">0</span></span><br><span class="line">r + <span class="number">1</span> = <span class="number">5</span> + <span class="number">1</span> = <span class="number">6</span></span><br><span class="line">nums[<span class="number">0</span>:<span class="number">6</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>]  # 切片左闭右开</span><br></pre></td></tr></tbody></table></figure>



<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MergeSort</span>(<span class="params">arrayList</span>):</span></span><br><span class="line">    arrayLen = len(arrayList)</span><br><span class="line">    <span class="comment">#判断输入参数的正确性,如果长度小于1，就说明为1</span></span><br><span class="line">    <span class="keyword">if</span> arrayLen &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> arrayList</span><br><span class="line">    <span class="comment"># 二分分解</span></span><br><span class="line">    midIndex = arrayLen // <span class="number">2</span></span><br><span class="line">    <span class="comment">#左边的部分去做 MergeSort</span></span><br><span class="line">    leftArray = MergeSort(arrayList[:midIndex])</span><br><span class="line">    <span class="comment">#右边的去做 MergeSort</span></span><br><span class="line">    rightArray = MergeSort(arrayList[midIndex:])</span><br><span class="line">    <span class="comment">#将左右两边合并，称为一个新的数组，并已经排序成功</span></span><br><span class="line">    retArray = MergeCore(leftArray, rightArray)</span><br><span class="line">    <span class="keyword">return</span> retArray</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MergeCore</span>(<span class="params">leftArray, rightArray</span>):</span></span><br><span class="line">    <span class="string">'''合并操作，将两个有序数组left[]和right[]合并成一个大的有序数组'''</span></span><br><span class="line">    <span class="comment">#首先需要定义两个指针,这两个指针，分别指向这两个数组的第一个元素</span></span><br><span class="line">    leftIndex = <span class="number">0</span></span><br><span class="line">    rightIndex = <span class="number">0</span></span><br><span class="line">    <span class="comment">#获取两个数组的长度，用于指出上面两个指针的边界是什么</span></span><br><span class="line">    leftLen = len(leftArray)</span><br><span class="line">    rightLen = len(rightArray)</span><br><span class="line">    <span class="comment">#定义一个返回的列表,这一步就代表空间复杂度至少是 O(n)</span></span><br><span class="line">    retList = []</span><br><span class="line">    <span class="comment">#循环两个数组寻找最小值加入到返回值的数组中</span></span><br><span class="line">    <span class="keyword">while</span> leftIndex &lt; leftLen <span class="keyword">and</span> rightIndex &lt; rightLen:</span><br><span class="line">        <span class="keyword">if</span> leftArray[leftIndex] &lt; rightArray[rightIndex]:</span><br><span class="line">            retList.append(leftArray[leftIndex])</span><br><span class="line">            leftIndex += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            retList.append(rightArray[rightIndex])</span><br><span class="line">            rightIndex += <span class="number">1</span></span><br><span class="line">    <span class="comment">#下面的代码是将剩余的数组中内容放置在返回的数组中</span></span><br><span class="line">    retList.extend(leftArray[leftIndex:])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># while leftIndex &lt; leftLen:</span></span><br><span class="line">    <span class="comment">#     retList.append(leftArray[leftIndex])</span></span><br><span class="line">    <span class="comment">#     leftIndex += 1</span></span><br><span class="line"></span><br><span class="line">    retList.extend(rightArray[rightIndex:])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># while rightIndex &lt; rightLen:</span></span><br><span class="line">    <span class="comment">#     retList.append(rightArray[rightIndex])</span></span><br><span class="line">    <span class="comment">#     rightIndex += 1</span></span><br><span class="line">    <span class="keyword">return</span> retList</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    retList = MergeSort([<span class="number">14</span>, <span class="number">33</span>, <span class="number">27</span>, <span class="number">10</span>, <span class="number">35</span>, <span class="number">19</span>, <span class="number">42</span>, <span class="number">44</span>])</span><br><span class="line">    print(retList)  <span class="comment"># [10, 14, 19, 27, 33, 35, 42, 44]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__merge</span>(<span class="params">arrList, l, mid, r</span>):</span></span><br><span class="line">    <span class="comment"># 将arr[l...mid]和arr[mid + 1...r]两部分进行归并</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 一段辅助的临时空间，大小为r-l+1</span></span><br><span class="line">    aux = [<span class="literal">None</span>]*(r-l+<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 将当前要处理的arrList中的元素复制到aux中</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(l, r+<span class="number">1</span>):</span><br><span class="line">        <span class="comment"># aux从0开始，要处理的元素从l开始，中间有个l的偏移量。</span></span><br><span class="line">        aux[i-l] = arrList[i]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 两个指针</span></span><br><span class="line">    i = l</span><br><span class="line">    j = mid + <span class="number">1</span></span><br><span class="line">    <span class="comment"># 寻找arrList[k]处的元素</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(l, r+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> i &gt; mid:</span><br><span class="line">            arrList[k] = aux[j-l]</span><br><span class="line">            j = j + <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> j &gt; r:</span><br><span class="line">            arrList[k] = aux[i-l]</span><br><span class="line">            i = i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> aux[i-l] &lt;= aux[j-l]:</span><br><span class="line">            arrList[k] = aux[i-l]</span><br><span class="line">            i = i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            arrList[k] = aux[j-l]</span><br><span class="line">            j = j + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__mergeSort</span>(<span class="params">arrList, l, r</span>):</span></span><br><span class="line">    <span class="comment"># 递归使用归并排序, 对arr[l...r]的范围进行排序</span></span><br><span class="line">    <span class="comment"># 处理递归到底的情况</span></span><br><span class="line">    <span class="comment"># 当l &lt; r时，至少有两个元素需要处理</span></span><br><span class="line">    <span class="keyword">if</span> l &gt;= r:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    当粒度小到一定程度时，使用插入排序</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    if r-l &lt; 15:</span></span><br><span class="line"><span class="string">        insertinSort(arrList, l, r)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        return</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 最小粒度拆分</span></span><br><span class="line">    <span class="comment"># 对分开的左右两部分进行归并排序</span></span><br><span class="line">    mid = int((l+r)/<span class="number">2</span>)</span><br><span class="line">    __mergeSort(arrList, l, mid)</span><br><span class="line">    __mergeSort(arrList, mid+<span class="number">1</span>, r)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 进行归并排序之后，已经保证每个部分都是有序的</span></span><br><span class="line">    <span class="comment"># 仅当arrList[mid] &gt; arrList[mid+1]的时候，才需要进行merge操作</span></span><br><span class="line">    <span class="comment"># 对l-&gt;mid和mid+1-&gt;r进行merge操作</span></span><br><span class="line">    <span class="keyword">if</span> arrList[mid] &gt; arrList[mid+<span class="number">1</span>]:</span><br><span class="line">        __merge(arrList, l, mid, r)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mergeSort</span>(<span class="params">arrList</span>):</span></span><br><span class="line">    __mergeSort(arrList, <span class="number">0</span>, len(arrList)<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line">a = [<span class="number">4</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">7</span>]</span><br><span class="line">mergeSort(a)</span><br><span class="line"></span><br><span class="line">print(a)</span><br><span class="line"><span class="comment"># [1, 1, 2, 3, 3, 4, 4, 5, 7, 8]</span></span><br></pre></td></tr></tbody></table></figure>

<hr>
<h2 id="6-快速排序-Quick-sort"><a href="#6-快速排序-Quick-sort" class="headerlink" title="6.快速排序 Quick sort"></a>6.快速排序 Quick sort</h2><p>通过一趟排序划分将待排序的序列分成前后两部分，<br>其中前一部分的数据都比后一部分的数据要小，<br>然后再递归调用此方法对这两部分序列分别进行快速排序，以此使整个序列达到有序。</p>
<p>快速排序没有指定应如何具体实现第一步，不论是选择主元 pivot 的过程还是划分的过程，都有不止一种实现方法。</p>
<p>步骤为：</p>
<ol>
<li>在每一次 partition 之前，选一个元素作为切分元素 pivot，称为“基准”“主元”“分界点”，可以选择nums[left] 或随机<br>交换它与第 1 个或最后 1 个元素的位置，随机元素作为左端“标定点”元素的原因是为了避免极端测试用例，避免递归树加深、达不到减治的效果：</li>
</ol>
<ul>
<li><p>性能和「划分」出的子数组的长度密切相关。</p>
</li>
<li><p>最差的情况就是 pivot 被选在了数组的两侧。顺序数组与倒序数组就是这种最差的情况，<br>此时递归树画出来是链表，排序的“递归结构”就变成了“线性结构”，这个时候就很像选择排序，或者是冒泡排序了， 《算法4》这本书上有说，也可以取三个元素的中位数。<br>例如：例如“顺序数组” [1, 2, 3, 4, 5] 的 partition 过程，就是线性搜索，<br>如果找第 1 大元素，就得一个一个地看，看到末尾。<br>直观地理解如果每次规模为 n 的问题我们都划分成 1 和 n - 1，<br>每次递归的时候又向 n−1 的集合中递归，<br>而导致时间复杂度退化为 O(N)，快速排序的最坏运行情况是 O(n ^ 2)<br>出现最坏情况的概率是： 1/1 * 1/2 * 1/3 * … 1/n，这个值非常小了。<br>讨论最坏情况意义不大，所以引入随机化来加速这个过程，它的时间代价的期望是 O(n)，<br>证明过程可以参考「《算法导论》9.2：期望为线性的选择算法」。<br>快速排序的 平摊期望时间复杂度是 O(nlogn)，且 O(nlogn) 记号中隐含的常数因子很小，比复杂度稳定等于 O(nlogn) 的归并排序要小很多。<br>对绝大多数顺序性较弱的随机数列而言，是目前基于比较的内部排序中被认为是最好的方法，</p>
</li>
<li><p>最理想的情况是 快速排序每一次选择的 pivot 它最后会被交换到数组中间的部分，这样后面递归的部分，每一个小组的数据不用跟另外小组的数据比较，需要比较的元素就会减少，因此速度较快</p>
</li>
</ul>
<ol start="2">
<li>算法思想：分而治之（分治思想），不像「归并排序」无脑地一分为二，<br>把问题规模转化到一个更小的范围里，这样的思想叫做 “减而治之”（是 “分而治之” 思想的特例）。</li>
</ol>
<ul>
<li><p>partition 切分、分区：将数组 nums[left⋯right] 分成两个子数组 nums[left⋯j−1]、nums[j+1⋯right]，使得 </p>
<ul>
<li><p>nums[left⋯j−1] 中的每个元素小于等于 nums[j]，分割点左侧的数全部不大于基准值，所有元素比基准值小的摆放在基准前面，</p>
</li>
<li><p>nums[j] 小于等于 nums[j+1⋯right] 中的每个元素。右侧的数全部不小于分割点的数。所有元素比基准值大的摆在基准的后面（相同的数可以到任一边）。</p>
</li>
<li><p>计算下标 j 也是「划分」过程的一部分。</p>
</li>
<li><p>解决：通过递归调用快速排序，对子数组 nums[left⋯j−1] 和 nums[j+1⋯right] 进行排序。</p>
</li>
<li><p>因为子数组都是原址排序的，所以没有「合」的合并操作，nums[left⋯right] 已经完全有序。已经分别有序且第一个序列中的数都小于第二个数，所以直接拼接起来就好了。</p>
</li>
</ul>
</li>
</ul>
<p>即基准元素 pivot = nums[j] 每次经过 partition 切分操作以后会放置在它 “最终应该放置的地方”索引为 j，</p>
<blockquote>
<p>至于 a[left⋯j−1] 和 a[j+1⋯right] 是否是有序的，我们不关心。</p>
</blockquote>
<p>切分过程可以不借助额外的数组空间，仅通过交换数组元素实现。</p>
<ol start="3">
<li>递归（recursive）地处理左右两段，把小于基准值元素的子数列和大于基准值元素的子数列排序。<br>递归的最底部情形，是数列的大小是零或一，即直至排序区间为 0 时完成排序，也就是永远都已经被排序好了。<br>虽然一直递归下去，但是这个算法总会结束，因为在每次的迭代（iteration）中，它至少会把一个元素摆到它最后的位置去，使数组中的每个数成为基准。</li>
</ol>
<p>快排一轮递归，再对分割点左右两侧的子数组成为独立两组数据，分别再像之前一样定一个pivot，比较，分组，如此类推。</p>
<p>保持「循环不变量」，<br>即定义的变量在循环开始前、循环过程中、循环结束以后，都保持不变的性质，<br>这个性质是人为根据问题特点定义的。<br>「循环不变量」是证明算法有效性的基础，更是写对代码的保证，<br>是不是该写等于号，先交换还是先 ++ ，就会特别清楚，绝对不会写错，<br>快速排序丢失了稳定性，如果需要稳定的快速排序，需要具体定义比较函数，这个过程叫「稳定化」</p>
<h4 id="法一"><a href="#法一" class="headerlink" title="法一"></a>法一</h4><ol>
<li><p>选中列表第一个元素nums[start] 为基准值 pivot，定义两个左右指针 left 指向左边表头和 right 指向右边表尾，</p>
</li>
<li><p>因为分界点选的第一个是最左边，所以不从左边开始而是从右向左找比这个值要大的数，找到就停止，否则指针继续向左移动一个位置，直到找到或者已经比左指针位置小。首先从 right 所指位置起向前 (表头方向)直到搜索出第一个小于关键字元素和pivot基准值相互交换；</p>
</li>
<li><p>从左向右找比这个值要小的数，找到就停止，否则指针继续向右移动一个位置，直到找到或者已经比右指针位置大。然后从 left 所指位置起向后 (表尾方向)直到搜索出第一个大于基准值元素和pivot基准值相互交换。重复这两步知道 left=right为止。</p>
</li>
<li><p>然后交换这两个数字的位置。<br>重复2 3 4 步骤，直到左指针位置已经不再小于右指针位置</p>
</li>
<li><p>然后将中值和现在的左指针或者右指针位置的数 交换位置<br>此时这个数组，就已经以中值为界限，中值左边的均小于中值，中值右边的均大于中值</p>
</li>
<li><p>最后递归重复以上的所有步骤 即可将一个无序数组完整的排序。<br>分别递归左侧列表，右侧列表<br>while里面套两个while循环，从左往右一个while，从右往左一个while<br>将所有大于 nums[start] 的数放到 nums[start] 右边，所有小于 nums[start] 的数放到 nums[start] 左边</p>
</li>
</ol>
<p>跟 start 还是 end 比取决于我们把哪个元素看作”哨兵“，跟 end 比也可以，<br>如果要用 end ，哨兵 i, j 的移动先后顺序也要对换<br>因为最后要把 nums[i], nums[start] 交换，因此要保证 ``nums[i] &gt; nums[start]` （和 end 的情况正好相反），这样交换后才符合快排定义。</p>
<p>维护一前一后两个指针 p 和 q ，依次考虑当前的数是否放在了应该放的位置（前还是后）。如果当前的数没放对，比如说如果后面的指针  遇到了一个比  小的数，那么可以交换  和  位置上的数，再把  向后移一位。当前的数的位置全放对后，再移动指针继续处理，直到两个指针相遇。</p>
<p><img src="/2020/08/21/liu-da-ji-ben-pai-xu/..%5C%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%5C%E5%BF%AB%E6%8E%92%E6%95%B0%E7%BB%84%E5%89%8D%E5%90%8E%E5%8F%8C%E6%8C%87%E9%92%88.jpg"></p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortArray</span>(<span class="params">self, nums: List[int]</span>) -&gt; List[int]:</span></span><br><span class="line">        <span class="comment"># nums待排序列表，第一个元素start下标值为0，最后一个元素end下标值len(nums)-1</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">partition</span>(<span class="params">start, end</span>):</span></span><br><span class="line">            <span class="comment"># 递归过程中发现start和end一致时，停止递归，直接返回列表</span></span><br><span class="line">            <span class="keyword">if</span> start &gt;= end:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="comment"># 设定待排数组第一个元素为要寻找位置的基准元素</span></span><br><span class="line">            pivot = nums[start]</span><br><span class="line">            <span class="comment"># left为序列左边的由左向右移动的指针</span></span><br><span class="line">            left = start</span><br><span class="line">            <span class="comment"># right为序列右边的由右向左移动的指针</span></span><br><span class="line">            right = end</span><br><span class="line">            <span class="keyword">while</span> left &lt; right:  <span class="comment"># 当left = right，退出循环</span></span><br><span class="line">                <span class="comment"># 如果left与right未重合，right指向的元素不比基准元素小</span></span><br><span class="line">                <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[right] &gt;= pivot:</span><br><span class="line">                    <span class="comment"># right先往左移，直到找到一个比基准值小的元素</span></span><br><span class="line">                    right -= <span class="number">1</span></span><br><span class="line">                <span class="comment"># 当 nums[left] &lt; pivot 将right指向的元素放到left的位置上</span></span><br><span class="line">                nums[left] = nums[right]</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 如果left与right未重合，left指向的元素比基准元素小，</span></span><br><span class="line">                <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[left] &lt; pivot:</span><br><span class="line">                    <span class="comment"># 则left向右移动，直到找到一个比基准值大的元素</span></span><br><span class="line">                    left += <span class="number">1</span></span><br><span class="line">                <span class="comment"># 当 nums[left] &gt; pivot, 将left指向的元素放到right的位置上</span></span><br><span class="line">                nums[right] = nums[left]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 退出循环后，left与right重合，用哪个都一样，</span></span><br><span class="line">            nums[left] = pivot  <span class="comment"># 此时所指位置为基准元素的正确位置</span></span><br><span class="line">            <span class="keyword">return</span> left</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">left, right</span>):</span></span><br><span class="line">            <span class="keyword">if</span> left &lt; right:</span><br><span class="line">                pivot = partition(left, right)</span><br><span class="line">                <span class="comment"># 对基准元素左边的子序列进行快速排序</span></span><br><span class="line">                quick_sort(left, pivot - <span class="number">1</span>)</span><br><span class="line">                <span class="comment"># 对基准元素右边的子序列进行快速排序</span></span><br><span class="line">                quick_sort(pivot + <span class="number">1</span>, right)</span><br><span class="line"></span><br><span class="line">        quick_sort(<span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> nums</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    array = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">    print(solution.sortArray(array))</span><br><span class="line">    <span class="comment"># [1, 2, 3, 4, 5, 6]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nums待排序列表，start第一个元素下标值为0，end最后一个元素下标值len(nums)-1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">nums, start, end</span>):</span></span><br><span class="line">    <span class="comment"># 递归过程中发现start和end一致时，停止递归，直接返回列表</span></span><br><span class="line">    <span class="keyword">if</span> start &gt;= end:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="comment"># 设定待排数组第一个元素为要寻找位置的基准元素</span></span><br><span class="line">    pivot = nums[start]</span><br><span class="line">    <span class="comment"># left为序列左边的由左向右移动的指针</span></span><br><span class="line">    left = start</span><br><span class="line">    <span class="comment"># right为序列右边的由右向左移动的指针</span></span><br><span class="line">    right = end</span><br><span class="line">    <span class="keyword">while</span> left &lt; right:  <span class="comment"># 当left = right，退出循环</span></span><br><span class="line">        <span class="comment"># 如果left与right未重合，right指向的元素不比基准元素小</span></span><br><span class="line">        <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[right] &gt;= pivot:</span><br><span class="line">            <span class="comment"># right往左移,直到找到一个比基准值小的元素</span></span><br><span class="line">            right -= <span class="number">1</span>   <span class="comment"># 先移动 right</span></span><br><span class="line">        <span class="comment"># 当 nums[left] &lt; pivot 将right指向的元素放到left的位置上</span></span><br><span class="line">        nums[left] = nums[right]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果left与right未重合，left指向的元素比基准元素小，</span></span><br><span class="line">        <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[left] &lt; pivot:</span><br><span class="line">            <span class="comment"># 则left向右移动，直到找到一个比基准值大的元素</span></span><br><span class="line">            left += <span class="number">1</span></span><br><span class="line">        <span class="comment"># 当 nums[left] &gt; pivot, 将left指向的元素放到right的位置上</span></span><br><span class="line">        nums[right] = nums[left]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 退出循环后，left与right重合用哪个都一样，</span></span><br><span class="line">    nums[left] = pivot  <span class="comment"># 此时所指位置为基准元素的正确位置</span></span><br><span class="line">    <span class="comment"># 对基准元素左边的子序列进行快速排序</span></span><br><span class="line">    quick_sort(nums, start, left - <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 对基准元素右边的子序列进行快速排序</span></span><br><span class="line">    quick_sort(nums, left + <span class="number">1</span>, end)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nums = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">quick_sort(nums, <span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">print(nums)</span><br><span class="line"><span class="comment"># [1, 2, 3, 4, 5, 6]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">pivot = nums[start] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">left = start = <span class="number">0</span></span><br><span class="line">right = end = <span class="number">5</span> </span><br><span class="line"></span><br><span class="line">进入外循环</span><br><span class="line">    nums[right] = nums[<span class="number">5</span>] = <span class="number">5</span> &gt; pivot = <span class="number">3</span>:</span><br><span class="line">        right = right - <span class="number">1</span> = <span class="number">1</span> = <span class="number">4</span></span><br><span class="line">        nums[right] = nums[<span class="number">4</span>] = <span class="number">2</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">        不进入子循环</span><br><span class="line">    nums[left] = nums[right] = nums[<span class="number">0</span>] = nums[<span class="number">4</span>] = <span class="number">2</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">    nums[left] = nums[<span class="number">0</span>] = <span class="number">2</span> &lt; pivot = <span class="number">3</span></span><br><span class="line">        left = left + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">        nums[left] = nums[<span class="number">1</span>] = <span class="number">4</span> &gt; pivot = <span class="number">3</span></span><br><span class="line">        不进入子循环</span><br><span class="line">    nums[right] = nums[left] = nums[<span class="number">4</span>] = nums[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">    nums[right] = nums[<span class="number">4</span>] = <span class="number">4</span> &gt; pivot = <span class="number">3</span>:</span><br><span class="line">        right = right - <span class="number">1</span> = <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">        nums[right] = nums[<span class="number">3</span>] = <span class="number">1</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">        不进入子循环</span><br><span class="line">    nums[left] = nums[right] = nums[<span class="number">1</span>] = nums[<span class="number">3</span>] = <span class="number">1</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">    nums[left] = nums[<span class="number">1</span>] = <span class="number">1</span> &lt; pivot = <span class="number">3</span></span><br><span class="line">        left = left + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">        nums[left] = nums[<span class="number">2</span>] = <span class="number">6</span> &gt; pivot = <span class="number">3</span></span><br><span class="line">        不进入子循环</span><br><span class="line">    nums[right] = nums[left] = nums[<span class="number">3</span>] = nums[<span class="number">2</span>] = <span class="number">6</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">    nums[right] = nums[<span class="number">3</span>] = <span class="number">6</span> &gt; pivot = <span class="number">3</span>:</span><br><span class="line">        right = right - <span class="number">1</span> = <span class="number">1</span> = <span class="number">2</span> = left</span><br><span class="line">退出外循环</span><br><span class="line">nums[left] = pivot = nums[<span class="number">2</span>] = <span class="number">3</span>  </span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">切分元素 pivot = <span class="number">3</span> 交换到它排序以后最终确定的位置上</span><br></pre></td></tr></tbody></table></figure>

<p>跟 l 还是 r 比取决于我们把哪个元素看作”哨兵“，<br>如果要用 r ，哨兵 i, j 的移动先后顺序也要对换<br>因为最后要把 strs[i], strs[r] 交换，因此要保证 ``strs[i] &gt; strs[r]` （和 l 的情况正好相反），这样交换后才符合快排定义。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortArray</span>(<span class="params">self, nums: List[int]</span>) -&gt; List[int]:</span></span><br><span class="line">        <span class="comment"># nums待排序列表，第一个元素start下标值为0，最后一个元素end下标值len(nums)-1</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">partition</span>(<span class="params">start, end</span>):</span></span><br><span class="line">            <span class="comment"># 递归过程中发现start和end一致时，停止递归，直接返回列表</span></span><br><span class="line">            <span class="keyword">if</span> start &gt;= end:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="comment"># 设定待排数组第一个元素为要寻找位置的基准元素</span></span><br><span class="line">            pivot = nums[end]</span><br><span class="line">            <span class="comment"># left为序列左边的由左向右移动的指针</span></span><br><span class="line">            left = start</span><br><span class="line">            <span class="comment"># right为序列右边的由右向左移动的指针</span></span><br><span class="line">            right = end</span><br><span class="line">            <span class="keyword">while</span> left &lt; right:  <span class="comment"># 当left = right，退出循环</span></span><br><span class="line">                <span class="comment"># 如果left与right未重合，left指向的元素比基准元素小，</span></span><br><span class="line">                <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[left] &lt; pivot:</span><br><span class="line">                    <span class="comment"># 则left向右移动，直到找到一个比基准值大的元素</span></span><br><span class="line">                    left += <span class="number">1</span></span><br><span class="line">                <span class="comment"># 当 nums[left] &gt; pivot, 将left指向的元素放到right的位置上</span></span><br><span class="line">                nums[right] = nums[left]</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># 如果left与right未重合，right指向的元素不比基准元素小</span></span><br><span class="line">                <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[right] &gt;= pivot:</span><br><span class="line">                    <span class="comment"># right先往左移，直到找到一个比基准值小的元素</span></span><br><span class="line">                    right -= <span class="number">1</span></span><br><span class="line">                <span class="comment"># 当 nums[left] &lt; pivot 将right指向的元素放到left的位置上</span></span><br><span class="line">                nums[left] = nums[right]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 退出循环后，left与right重合，用哪个都一样，</span></span><br><span class="line">            nums[left] = pivot  <span class="comment"># 此时所指位置为基准元素的正确位置</span></span><br><span class="line">            <span class="keyword">return</span> left</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">left, right</span>):</span></span><br><span class="line">            <span class="keyword">if</span> left &lt; right:</span><br><span class="line">                pivot = partition(left, right)</span><br><span class="line">                <span class="comment"># 对基准元素左边的子序列进行快速排序</span></span><br><span class="line">                quick_sort(left, pivot - <span class="number">1</span>)</span><br><span class="line">                <span class="comment"># 对基准元素右边的子序列进行快速排序</span></span><br><span class="line">                quick_sort(pivot + <span class="number">1</span>, right)</span><br><span class="line"></span><br><span class="line">        quick_sort(<span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> nums</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    array = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">    print(solution.sortArray(array))</span><br><span class="line">    <span class="comment"># [1, 2, 3, 4, 5, 6]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">nums, start, end</span>):</span></span><br><span class="line">    <span class="comment"># 递归过程中发现start和end一致时，停止递归，直接返回列表</span></span><br><span class="line">    <span class="keyword">if</span> start &gt;= end:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="comment"># 设定待排数组倒数第一个元素为要寻找位置的基准元素</span></span><br><span class="line">    pivot = nums[end]</span><br><span class="line">    <span class="comment"># left为序列左边的由左向右移动的指针</span></span><br><span class="line">    left = start</span><br><span class="line">    <span class="comment"># right为序列右边的由右向左移动的指针</span></span><br><span class="line">    right = end</span><br><span class="line">    <span class="keyword">while</span> left &lt; right:  <span class="comment"># 当left = right，退出循环</span></span><br><span class="line">        <span class="comment"># 如果left与right未重合，left指向的元素比基准元素小，</span></span><br><span class="line">        <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[left] &lt; pivot:</span><br><span class="line">            <span class="comment"># 则left向右移动，直到找到一个比基准值大的元素</span></span><br><span class="line">            left += <span class="number">1</span>   <span class="comment"># 先移动 left</span></span><br><span class="line">        <span class="comment"># 当 nums[left] &gt; pivot, 将left指向的元素放到right的位置上</span></span><br><span class="line">        nums[right] = nums[left]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果left与right未重合，right指向的元素不比基准元素小</span></span><br><span class="line">        <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> nums[right] &gt;= pivot:</span><br><span class="line">            <span class="comment"># right往左移,直到找到一个比基准值小的元素</span></span><br><span class="line">            right -= <span class="number">1</span></span><br><span class="line">        <span class="comment"># 当 nums[left] &lt; pivot 将right指向的元素放到left的位置上</span></span><br><span class="line">        nums[left] = nums[right]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 退出循环后，left与right重合用哪个都一样，</span></span><br><span class="line">    nums[left] = pivot  <span class="comment"># 此时所指位置为基准元素的正确位置</span></span><br><span class="line">    <span class="comment"># 对基准元素左边的子序列进行快速排序</span></span><br><span class="line">    quick_sort(nums, start, left - <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 对基准元素右边的子序列进行快速排序</span></span><br><span class="line">    quick_sort(nums, left + <span class="number">1</span>, end)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nums = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">quick_sort(nums, <span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">print(nums)</span><br><span class="line"><span class="comment"># [1, 2, 3, 4, 5, 6]</span></span><br></pre></td></tr></tbody></table></figure>

<p>法二</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortArray</span>(<span class="params">self, nums: List[int]</span>) -&gt; List[int]:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">partition</span>(<span class="params">left, right</span>):</span></span><br><span class="line">            randidx = random.randint(left, right)</span><br><span class="line">            nums[left], nums[randidx] = nums[randidx], nums[left]</span><br><span class="line"></span><br><span class="line">            pivot = nums[left]</span><br><span class="line">            l = left + <span class="number">1</span></span><br><span class="line">            r = right</span><br><span class="line">            <span class="keyword">while</span> l &lt;= r:</span><br><span class="line">                <span class="keyword">while</span> l &lt;= r <span class="keyword">and</span> nums[l] &lt;= pivot:</span><br><span class="line">                    <span class="comment"># l 指向数字肯定比 pivot 大</span></span><br><span class="line">                    l += <span class="number">1</span></span><br><span class="line">                <span class="keyword">while</span> l &lt;= r <span class="keyword">and</span> nums[r] &gt;= pivot:</span><br><span class="line">                    <span class="comment"># r 指向数字肯定比 pivot 小</span></span><br><span class="line">                    r -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> l &gt; r:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                nums[l], nums[r] = nums[r], nums[l]</span><br><span class="line">            <span class="comment"># r 和 left 互换, r为 pivot</span></span><br><span class="line">            nums[r], nums[left] = nums[left], nums[r]</span><br><span class="line">            <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">quicksort</span>(<span class="params">left, right</span>):</span></span><br><span class="line">            <span class="keyword">if</span> left &lt; right:</span><br><span class="line">                pivot = partition(left, right)</span><br><span class="line">                quicksort(left, pivot - <span class="number">1</span>)</span><br><span class="line">                quicksort(pivot + <span class="number">1</span>, right)</span><br><span class="line"></span><br><span class="line">        quicksort(<span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> nums</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    array = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">    print(solution.sortArray(array))</span><br><span class="line">    <span class="comment"># [1, 2, 3, 4, 5, 6]</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">quicksort(<span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">quicksort(<span class="number">0</span>, <span class="number">6</span> - <span class="number">1</span>)</span><br><span class="line">quicksort(<span class="number">0</span>, <span class="number">5</span>)</span><br><span class="line">left = <span class="number">0</span> &lt; right = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">partition(left, right)</span><br><span class="line">randidx = <span class="number">0</span>  随机取到最左边</span><br><span class="line">nums[left] = nums[randidx] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">nums[randidx] = nums[left] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">pivot = nums[left] = <span class="number">3</span></span><br><span class="line">l = left + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">r = right = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">l = <span class="number">1</span> &lt; r = <span class="number">5</span>:</span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">1</span> &lt; r = <span class="number">5</span> <span class="keyword">and</span> nums[l] = nums[<span class="number">1</span>] = <span class="number">4</span> &gt; pivot = <span class="number">3</span></span><br><span class="line">        不进入循环</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">1</span> &lt; r = <span class="number">5</span> <span class="keyword">and</span> nums[r] = nums[<span class="number">5</span>] = <span class="number">5</span> &gt; pivot = <span class="number">3</span>:</span><br><span class="line">        r = r - <span class="number">1</span> = <span class="number">4</span></span><br><span class="line">        <span class="keyword">while</span> l = <span class="number">1</span> &lt; r = <span class="number">4</span> <span class="keyword">and</span> nums[r] = nums[<span class="number">4</span>] = <span class="number">2</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">        退出子循环</span><br><span class="line"></span><br><span class="line">    nums[l] = nums[r] = nums[<span class="number">1</span>] = nums[<span class="number">4</span>] = <span class="number">2</span></span><br><span class="line">    nums[r] = nums[l] = nums[<span class="number">4</span>] = nums[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">1</span> &lt; r = <span class="number">4</span> <span class="keyword">and</span> nums[l] = nums[<span class="number">1</span>] = <span class="number">2</span> &lt; pivot = <span class="number">3</span></span><br><span class="line">    l = l + <span class="number">1</span> = <span class="number">1</span> + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">2</span> &lt; r = <span class="number">4</span> <span class="keyword">and</span> nums[l] = nums[<span class="number">2</span>] = <span class="number">6</span> &gt; pivot = <span class="number">3</span></span><br><span class="line">        不进入循环</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">2</span> &lt; r = <span class="number">4</span> <span class="keyword">and</span> nums[r] = nums[<span class="number">4</span>] = <span class="number">4</span> &gt; pivot = <span class="number">3</span>:</span><br><span class="line">        r = r - <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">        <span class="keyword">while</span> l = <span class="number">2</span> &lt; r = <span class="number">3</span> <span class="keyword">and</span> nums[r] = nums[<span class="number">3</span>] = <span class="number">1</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">        退出子循环</span><br><span class="line"></span><br><span class="line">    nums[l] = nums[r] = nums[<span class="number">2</span>] = nums[<span class="number">3</span>] = <span class="number">1</span></span><br><span class="line">    nums[r] = nums[l] = nums[<span class="number">3</span>] = nums[<span class="number">2</span>] = <span class="number">6</span></span><br><span class="line">    [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">2</span> &lt; r = <span class="number">3</span> <span class="keyword">and</span> nums[l] = nums[<span class="number">2</span>] = <span class="number">1</span> &lt; pivot = <span class="number">3</span></span><br><span class="line">    l = l + <span class="number">1</span> = <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">3</span> = r <span class="keyword">and</span> nums[l] = nums[<span class="number">3</span>] = <span class="number">6</span> &gt; pivot = <span class="number">3</span></span><br><span class="line">        不进入循环</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">3</span> = r <span class="keyword">and</span> nums[r] = nums[<span class="number">3</span>] = <span class="number">6</span> &gt; pivot = <span class="number">3</span>:</span><br><span class="line">        r = r - <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> l = <span class="number">3</span> &gt; r = <span class="number">2</span> <span class="keyword">and</span> nums[r] = nums[<span class="number">2</span>] = <span class="number">1</span> &lt; pivot = <span class="number">3</span>:</span><br><span class="line">        退出子循环</span><br><span class="line"></span><br><span class="line">l = <span class="number">3</span> &gt; r = <span class="number">2</span></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">nums[r] = nums[left] = nums[<span class="number">2</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">nums[left] = nums[r] = nums[<span class="number">0</span>] = nums[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">切分元素 pivot = <span class="number">3</span> 交换到它排序以后最终确定的位置上</span><br><span class="line"><span class="keyword">return</span> r = <span class="number">2</span></span><br><span class="line">pivot = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">quicksort(left, pivot - <span class="number">1</span>)</span><br><span class="line">    quicksort(<span class="number">0</span>, <span class="number">2</span> - <span class="number">1</span>)</span><br><span class="line">    quicksort(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    partition(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    left = <span class="number">0</span> </span><br><span class="line">    right = <span class="number">1</span></span><br><span class="line">    randidx = random.randint(left, right)</span><br><span class="line">    randidx = random.randint(<span class="number">0</span>, <span class="number">1</span>) 取不到后面的<span class="number">2</span>~<span class="number">5</span></span><br><span class="line">    randidx = <span class="number">0</span>  随机取到最左边</span><br><span class="line">    nums[left] = nums[randidx] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    nums[randidx] = nums[left] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    pivot = nums[left] = <span class="number">1</span></span><br><span class="line">    l = left + <span class="number">1</span> = <span class="number">0</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">    r = right = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    l = <span class="number">1</span> = r:</span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">1</span> = r <span class="keyword">and</span> nums[l] = nums[<span class="number">1</span>] = <span class="number">2</span> &gt; pivot = <span class="number">1</span></span><br><span class="line">        不进入循环</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> l = <span class="number">1</span> = r <span class="keyword">and</span> nums[r] = nums[<span class="number">1</span>] = <span class="number">2</span> &gt; pivot = <span class="number">1</span>:</span><br><span class="line">        r = r - <span class="number">1</span> = <span class="number">0</span> &lt; l = <span class="number">1</span></span><br><span class="line">    l = <span class="number">1</span> &gt; r = <span class="number">0</span></span><br><span class="line">    <span class="keyword">break</span>    </span><br><span class="line">    nums[r] = nums[left] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    nums[left] = nums[r] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">    切分元素 pivot = <span class="number">1</span> 交换到它排序以后最终确定的位置上</span><br><span class="line">    <span class="keyword">return</span> r = <span class="number">0</span></span><br><span class="line">    pivot = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    quicksort(left, pivot - <span class="number">1</span>)</span><br><span class="line">        quicksort(<span class="number">0</span>, <span class="number">0</span> - <span class="number">1</span>)</span><br><span class="line">        quicksort(<span class="number">0</span>, <span class="number">-1</span>)</span><br><span class="line">        left = <span class="number">0</span> &gt; right = <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">    quicksort(pivot + <span class="number">1</span>, right)</span><br><span class="line">        quicksort(<span class="number">0</span> + <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">        left = <span class="number">1</span> = right</span><br><span class="line"></span><br><span class="line">quicksort(pivot + <span class="number">1</span>, right)</span><br><span class="line">    quicksort(<span class="number">2</span> + <span class="number">1</span>, <span class="number">5</span>)</span><br><span class="line">    quicksort(<span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line">    partition(<span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line">    randidx = random.randint(left, right)</span><br><span class="line">    randidx = random.randint(<span class="number">3</span>, <span class="number">5</span>)区间，取不到前面的<span class="number">0</span>~<span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>

<p>方法三<br>我们定义函数 randomized_quicksort(nums, l, r) 为对 nums 数组里 [l,r] 的部分进行排序，每次先调用 randomized_partition 函数对 nums 数组里 [l,r] 的部分进行划分，并返回分界值的下标 pos，然后按上述将的递归调用 randomized_quicksort(nums, l, pos - 1) 和 randomized_quicksort(nums, pos + 1, r) 即可。</p>
<p>这里我们采用随机的方式，对当前划分区间 [l,r] 里的数等概率随机一个作为我们的主元，<br>再将主元放到区间末尾，进行划分。</p>
<p>整个划分函数 partition 主要涉及两个指针 i 和 j，<br>一开始 i = l - 1，j = l。<br>实时维护两个指针使得任意时候对于任意数组下标 k，我们有如下条件成立：</p>
<ol>
<li>l ≤ k ≤ i 时，nums[k] ≤ pivot。</li>
<li>i+1 ≤ k ≤ j−1 时，nums[k] &gt; pivot。</li>
<li>k == r 时，nums[k] = pivot。</li>
</ol>
<p>我们每次移动指针 j ，如果 nums[j] &gt; pivot，我们只需要继续移动指针 j ，即能使上述三个条件成立，否则我们需要将指针 i 加一，然后交换 nums[i] 和 nums[j]，再移动指针 j 才能使得三个条件成立。</p>
<p>当 j 移动到 r−1 时结束循环，此时我们可以由上述三个条件知道 [l,i] 的数都小于等于主元 pivot，[i+1,r−1] 的数都大于主元 pivot，那么我们只要交换 nums[i+1] 和 nums[r] ，即能使得 [l,i+1] 区间的数都小于 [i+2,r] 区间的数，完成一次划分，且分界值下标为 i+1，返回即可。</p>
<p>如下的动图展示了一次划分的过程，刚开始随机选了 4 作为主元，与末尾元素交换后开始划分：</p>
<p>时间复杂度：基于随机选取主元的快速排序时间复杂度为期望 O(nlogn)，其中 n 为数组的长度。详细证明过程可以见《算法导论》第七章</p>
<p>空间复杂度：O(h)，其中 h 为快速排序递归调用的层数。我们需要额外的 O(h) 的递归调用的栈空间，由于划分的结果不同导致了快速排序递归调用的层数也会不同，最坏情况下需 O(n) 的空间，最优情况下每次都平衡，此时整个递归树高度为 nlogn，空间复杂度为 O(logn)。</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">randomized_partition</span>(<span class="params">self, nums, l, r</span>):</span></span><br><span class="line">        pivot = random.randint(l, r)</span><br><span class="line">        nums[pivot], nums[r] = nums[r], nums[pivot]</span><br><span class="line">        <span class="comment"># 设置一个 左边的指针位置 为 左侧的 前一个</span></span><br><span class="line">        i = l - <span class="number">1</span></span><br><span class="line">        <span class="comment"># 双指针同时往后，一趟for循环，遍历 除 基准数之外的 数</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(l, r):  <span class="comment"># range左闭右开</span></span><br><span class="line">            <span class="comment"># 比较 遍历的当前数 和 基准数 ，若是小于基准数 则 换到数组前面去</span></span><br><span class="line">            <span class="comment"># 交换位置，将遍历的比 基准数小的数 放到 我们指针 的 后一个上，然后 这个时候指针向后移一位。当遍历的数大于我们的基准数的时候，不移动，而且 指针也不发生变化，那么 当我们遍历完一圈以后，把 我们的基准数 放到 索引i 的后一个 位置，那么就形成了 一个 基准数 左边都是比它小的数，基准数右边 都是比它大的数 这样的模式。然后要把 索引 i 的后一个位置 作为基准数 与 原基准数 交换位置，进而可以第二次来 遍历比较。</span></span><br><span class="line">            <span class="keyword">if</span> nums[j] &lt; nums[r]:</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">                nums[j], nums[i] = nums[i], nums[j]</span><br><span class="line">        <span class="comment"># 遍历完后，将 ？数 和 right 上的数互换位置，就 重置 基准数了。</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        nums[i], nums[r] = nums[r], nums[i]</span><br><span class="line">        <span class="comment"># 返回基准的下标</span></span><br><span class="line">        <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">randomized_quicksort</span>(<span class="params">self, nums, l, r</span>):</span></span><br><span class="line">        <span class="keyword">if</span> l &gt;= r:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        mid = self.randomized_partition(nums, l, r)</span><br><span class="line">        self.randomized_quicksort(nums, l, mid - <span class="number">1</span>)</span><br><span class="line">        self.randomized_quicksort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 函数入口</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortArray</span>(<span class="params">self, nums: List[int]</span>) -&gt; List[int]:</span></span><br><span class="line">        self.randomized_quicksort(nums, <span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> nums</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    solution = Solution()</span><br><span class="line">    array = [<span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line">    print(solution.sortArray(array))</span><br><span class="line">    <span class="comment"># [1, 2, 3, 4, 5, 6, 7, 8]</span></span><br></pre></td></tr></tbody></table></figure>

<p>调试1</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]</span><br><span class="line">randomized_quicksort(nums, <span class="number">0</span>, len(nums) - <span class="number">1</span>)</span><br><span class="line">randomized_quicksort(nums, <span class="number">0</span>, <span class="number">6</span> - <span class="number">1</span>)</span><br><span class="line">randomized_quicksort(nums, <span class="number">0</span>, <span class="number">5</span>)</span><br><span class="line">l = <span class="number">0</span> &lt; r = <span class="number">5</span></span><br><span class="line">randomized_partition(nums, l, r)</span><br><span class="line">pivot = random.randint(l, r) = <span class="number">0</span></span><br><span class="line">nums[pivot] = nums[r] = nums[<span class="number">0</span>] = nums[<span class="number">5</span>] = <span class="number">5</span></span><br><span class="line">nums[r] = nums[pivot] = nums[<span class="number">5</span>] = nums[<span class="number">0</span>] = <span class="number">3</span></span><br><span class="line">[<span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] </span><br><span class="line">i = l - <span class="number">1</span> = <span class="number">0</span> - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">num[<span class="number">0</span>] = <span class="number">5</span> &gt; num[<span class="number">5</span>] = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">1</span></span><br><span class="line">nums[<span class="number">1</span>] = <span class="number">4</span> &gt; num[<span class="number">5</span>] = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">2</span></span><br><span class="line">nums[<span class="number">2</span>] = <span class="number">6</span> &gt; num[<span class="number">5</span>] = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">3</span></span><br><span class="line">nums[<span class="number">3</span>] = <span class="number">1</span> &lt; num[<span class="number">5</span>] = <span class="number">3</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">3</span>] = nums[<span class="number">0</span>] = <span class="number">5</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">0</span>] = nums[<span class="number">3</span>] = <span class="number">1</span> </span><br><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">3</span>] </span><br><span class="line"></span><br><span class="line">j = <span class="number">4</span></span><br><span class="line">nums[<span class="number">4</span>] = <span class="number">2</span> &lt; num[<span class="number">5</span>] = <span class="number">3</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">4</span>] = nums[<span class="number">1</span>] = <span class="number">4</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">1</span>] = nums[<span class="number">4</span>] = <span class="number">2</span> </span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>] </span><br><span class="line"></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">nums[i] = nums[r] = nums[<span class="number">2</span>] = nums[<span class="number">5</span>] = <span class="number">4</span> </span><br><span class="line">nums[r] = nums[i] = nums[<span class="number">5</span>] = nums[<span class="number">2</span>] = <span class="number">6</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>] </span><br><span class="line">切分元素 nums[pivot] = <span class="number">3</span> 交换到它排序以后最终确定的位置上</span><br><span class="line">mid = i = <span class="number">2</span> 返回原来下标为<span class="number">2</span>的元素<span class="number">3</span>的最终位置在下标<span class="number">2</span> </span><br><span class="line"></span><br><span class="line">self.randomized_quicksort(nums, l, mid - <span class="number">1</span>)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">2</span> - <span class="number">1</span>)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    l = <span class="number">0</span> &lt; r = <span class="number">1</span></span><br><span class="line">    randomized_partition(nums, l, r)</span><br><span class="line">    pivot = random.randint(l, r) = <span class="number">0</span></span><br><span class="line">    nums[pivot] = nums[r] = nums[<span class="number">0</span>] = nums[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">    nums[r] = nums[pivot] = nums[<span class="number">1</span>] = nums[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>] </span><br><span class="line">    i = l - <span class="number">1</span> = <span class="number">0</span> - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    num[<span class="number">0</span>] = <span class="number">2</span> &gt; num[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">    nums[i] = nums[r] = nums[<span class="number">0</span>] = nums[<span class="number">1</span>] = <span class="number">1</span> </span><br><span class="line">    nums[r] = nums[i] = nums[<span class="number">1</span>] = nums[<span class="number">0</span>] = <span class="number">2</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>] </span><br><span class="line">    切分元素 nums[pivot] = <span class="number">1</span> 交换到它排序以后最终确定的位置上</span><br><span class="line">    mid = i = <span class="number">0</span> 返回原来下标为<span class="number">0</span>的元素<span class="number">1</span>的最终位置在下标<span class="number">0</span> </span><br><span class="line"></span><br><span class="line">    self.randomized_quicksort(nums, l, mid - <span class="number">1</span>)</span><br><span class="line">    self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">0</span> - <span class="number">1</span>)</span><br><span class="line">    self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">-1</span>)</span><br><span class="line">        l = <span class="number">0</span> &gt; r = <span class="number">-1</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    self.randomized_quicksort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">    self.randomized_quicksort(nums, <span class="number">0</span> + <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">        l = <span class="number">1</span> = r</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">self.randomized_quicksort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">2</span> + <span class="number">1</span>, <span class="number">5</span>)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line">    l = <span class="number">3</span> &lt; r = <span class="number">5</span></span><br><span class="line">    randomized_partition(nums, l, r)</span><br><span class="line">    pivot = random.randint(l, r) = <span class="number">3</span></span><br><span class="line">    nums[pivot] = nums[r] = nums[<span class="number">3</span>] = nums[<span class="number">5</span>] = <span class="number">6</span></span><br><span class="line">    nums[r] = nums[pivot] = nums[<span class="number">5</span>] = nums[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>] </span><br><span class="line">    i = l - <span class="number">1</span> = <span class="number">3</span> - <span class="number">1</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    j = <span class="number">3</span></span><br><span class="line">    num[<span class="number">3</span>] = <span class="number">6</span> &gt; num[<span class="number">5</span>] = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    j = <span class="number">4</span></span><br><span class="line">    num[<span class="number">4</span>] = <span class="number">4</span> &lt; num[<span class="number">5</span>] = <span class="number">5</span></span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">    nums[j] = nums[i] = nums[<span class="number">4</span>] = nums[<span class="number">3</span>] = <span class="number">6</span> </span><br><span class="line">    nums[i] = nums[j] = nums[<span class="number">3</span>] = nums[<span class="number">4</span>] = <span class="number">4</span> </span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">5</span>] </span><br><span class="line"></span><br><span class="line">    i = i + <span class="number">1</span> = <span class="number">4</span></span><br><span class="line">    nums[i] = nums[r] = nums[<span class="number">4</span>] = nums[<span class="number">5</span>] = <span class="number">6</span> </span><br><span class="line">    nums[r] = nums[i] = nums[<span class="number">5</span>] = nums[<span class="number">4</span>] = <span class="number">5</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">    切分元素 nums[pivot] = <span class="number">5</span> 交换到它排序以后最终确定的位置上</span><br><span class="line">    mid = i = <span class="number">4</span> 返回原来下标为<span class="number">3</span>的元素<span class="number">5</span>的最终位置在下标<span class="number">4</span> </span><br><span class="line"></span><br><span class="line">    self.randomized_quicksort(nums, l, mid - <span class="number">1</span>)</span><br><span class="line">    self.randomized_quicksort(nums, <span class="number">3</span>, <span class="number">4</span> - <span class="number">1</span>)</span><br><span class="line">    self.randomized_quicksort(nums, <span class="number">3</span>, <span class="number">3</span>)</span><br><span class="line">        l = <span class="number">3</span> = r</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    self.randomized_quicksort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">    self.randomized_quicksort(nums, <span class="number">4</span> + <span class="number">1</span>, <span class="number">5</span>)</span><br><span class="line">        l = <span class="number">5</span> = r</span><br><span class="line">        <span class="keyword">return</span></span><br></pre></td></tr></tbody></table></figure>

<p>调试2</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>] len(nums) - <span class="number">1</span> = <span class="number">7</span></span><br><span class="line">pivot = random.randint(l, r) = <span class="number">2</span></span><br><span class="line">nums[pivot] = <span class="number">4</span> </span><br><span class="line">nums[pivot] = nums[r] = nums[<span class="number">2</span>] = nums[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">nums[r] = nums[pivot] = nums[<span class="number">3</span>] = nums[<span class="number">2</span>] = <span class="number">4</span></span><br><span class="line">[<span class="number">2</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line">i = l - <span class="number">1</span> = <span class="number">0</span> - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">num[<span class="number">0</span>] = <span class="number">2</span> &lt; num[<span class="number">7</span>] = <span class="number">4</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">2</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">2</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">1</span></span><br><span class="line">nums[<span class="number">1</span>] = <span class="number">8</span> &gt; num[<span class="number">7</span>] = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">2</span></span><br><span class="line">nums[<span class="number">2</span>] = <span class="number">7</span> &gt; num[<span class="number">7</span>] = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">3</span></span><br><span class="line">nums[<span class="number">3</span>] = <span class="number">1</span> &lt; num[<span class="number">7</span>] = <span class="number">4</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">3</span>] = nums[<span class="number">1</span>] = <span class="number">8</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">1</span>] = nums[<span class="number">3</span>] = <span class="number">1</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">4</span></span><br><span class="line">nums[<span class="number">4</span>] = <span class="number">3</span> &lt; num[<span class="number">7</span>] = <span class="number">4</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">4</span>] = nums[<span class="number">2</span>] = <span class="number">3</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">2</span>] = nums[<span class="number">4</span>] = <span class="number">7</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">5</span></span><br><span class="line">nums[<span class="number">5</span>] = <span class="number">5</span> &gt; num[<span class="number">7</span>] = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">6</span></span><br><span class="line">nums[<span class="number">6</span>] = <span class="number">6</span> &gt; num[<span class="number">7</span>] = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">nums[i] = nums[r] = nums[<span class="number">3</span>] = nums[<span class="number">7</span>] = <span class="number">4</span> </span><br><span class="line">nums[r] = nums[i] = nums[<span class="number">7</span>] = nums[<span class="number">1</span>] = <span class="number">8</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>]</span><br><span class="line">切分元素 pivot = <span class="number">4</span> 交换到它排序以后最终确定的位置上</span><br><span class="line">mid = i = <span class="number">3</span> 返回原来下标为<span class="number">2</span>的元素<span class="number">3</span>的最终位置在下标<span class="number">3</span> </span><br><span class="line"></span><br><span class="line">self.randomized_quicksort(nums, l, mid - <span class="number">1</span>)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">1</span> - <span class="number">1</span>)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">self.randomized_quicksort(nums, mid + <span class="number">1</span>, r)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">3</span> + <span class="number">1</span>, <span class="number">7</span>)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>] </span><br><span class="line">r = len(nums) - <span class="number">1</span> = <span class="number">7</span></span><br><span class="line"></span><br><span class="line">pivot = random.randint(l, r) = <span class="number">7</span> 随机取到最右边</span><br><span class="line">nums[pivot] = <span class="number">7</span> </span><br><span class="line">nums[pivot] = nums[r] = nums[<span class="number">7</span>] = nums[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">nums[r] = nums[pivot] = nums[<span class="number">7</span>] = nums[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">[<span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line">i = l - <span class="number">1</span> = <span class="number">0</span> - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">num[<span class="number">0</span>] = <span class="number">2</span> &lt; num[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">2</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">2</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">1</span></span><br><span class="line">nums[<span class="number">1</span>] = <span class="number">8</span> &gt; num[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line"></span><br><span class="line">j = <span class="number">2</span></span><br><span class="line">nums[<span class="number">2</span>] = <span class="number">4</span> &lt; num[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">2</span>] = nums[<span class="number">1</span>] = <span class="number">8</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">1</span>] = nums[<span class="number">2</span>] = <span class="number">4</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">3</span></span><br><span class="line">nums[<span class="number">3</span>] = <span class="number">1</span> &lt; num[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">2</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">3</span>] = nums[<span class="number">2</span>] = <span class="number">8</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">2</span>] = nums[<span class="number">3</span>] = <span class="number">1</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">4</span></span><br><span class="line">nums[<span class="number">4</span>] = <span class="number">3</span> &lt; num[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">4</span>] = nums[<span class="number">3</span>] = <span class="number">8</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">3</span>] = nums[<span class="number">4</span>] = <span class="number">3</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">5</span></span><br><span class="line">nums[<span class="number">5</span>] = <span class="number">5</span> &lt; num[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">4</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">5</span>] = nums[<span class="number">4</span>] = <span class="number">8</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">4</span>] = nums[<span class="number">5</span>] = <span class="number">5</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">j = <span class="number">6</span></span><br><span class="line">nums[<span class="number">6</span>] = <span class="number">6</span> &lt; num[<span class="number">7</span>] = <span class="number">7</span></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">5</span></span><br><span class="line">nums[j] = nums[i] = nums[<span class="number">6</span>] = nums[<span class="number">5</span>] = <span class="number">8</span> </span><br><span class="line">nums[i] = nums[j] = nums[<span class="number">5</span>] = nums[<span class="number">6</span>] = <span class="number">6</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">i = i + <span class="number">1</span> = <span class="number">6</span></span><br><span class="line">nums[i] = nums[r] = nums[<span class="number">6</span>] = nums[<span class="number">7</span>] = <span class="number">8</span> </span><br><span class="line">nums[r] = nums[i] = nums[<span class="number">7</span>] = nums[<span class="number">1</span>] = <span class="number">7</span> </span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br><span class="line">切分元素 nums[pivot] = <span class="number">7</span> 交换到它排序以后最终确定的位置上</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> i = <span class="number">6</span></span><br><span class="line">mid = i = <span class="number">6</span> ，则原来下标为<span class="number">7</span>的元素<span class="number">7</span>的位置确定在下标<span class="number">6</span></span><br><span class="line"></span><br><span class="line">self.randomized_quicksort(nums, l, mid - <span class="number">1</span>)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">6</span> - <span class="number">1</span>)</span><br><span class="line">self.randomized_quicksort(nums, <span class="number">0</span>, <span class="number">5</span>)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_pos</span>(<span class="params">lists, low, high</span>):</span></span><br><span class="line">    key = lists[low]</span><br><span class="line">    <span class="keyword">while</span> low &lt; high:</span><br><span class="line">        <span class="keyword">while</span> low &lt; high <span class="keyword">and</span> lists[high] &gt;= key:</span><br><span class="line">            high -= <span class="number">1</span></span><br><span class="line">        lists[low] = lists[high]</span><br><span class="line">        <span class="keyword">while</span> low &lt; high <span class="keyword">and</span> lists[low] &lt;= key:</span><br><span class="line">            low += <span class="number">1</span></span><br><span class="line">        lists[high] = lists[low]</span><br><span class="line">    lists[low] = key</span><br><span class="line">    <span class="keyword">return</span> low</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">alist, first, last</span>):</span></span><br><span class="line">    <span class="keyword">if</span> first &lt; last:</span><br><span class="line">        split_point = find_pos(alist, first, last)</span><br><span class="line">        quick_sort(alist, first, split_point<span class="number">-1</span>)</span><br><span class="line">        quick_sort(alist, split_point+<span class="number">1</span>, last)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">alist = [<span class="number">99</span>,<span class="number">88</span>,<span class="number">66</span>,<span class="number">23</span>,<span class="number">54</span>,<span class="number">23</span>,<span class="number">89</span>,<span class="number">0</span>,<span class="number">2</span>]</span><br><span class="line">quick_sort(alist,<span class="number">0</span>,len(alist)<span class="number">-1</span>)</span><br><span class="line">print(alist)</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">array: list</span>) -&gt; list:</span></span><br><span class="line">    lower = []  <span class="comment"># 存放小于基准值的数据</span></span><br><span class="line">    higher = []  <span class="comment"># 存放大于基准值的数据</span></span><br><span class="line">    <span class="keyword">if</span> len(array) &lt;= <span class="number">1</span>:  <span class="comment"># 递归结束条件</span></span><br><span class="line">        <span class="keyword">return</span> array</span><br><span class="line"></span><br><span class="line">    pivot = array.pop()  <span class="comment"># 取列表最后一个数据为基准值</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> array:</span><br><span class="line">        <span class="keyword">if</span> i &gt;= pivot:</span><br><span class="line">            higher.append(i)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            lower.append(i)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> quick_sort(lower) + [pivot] + quick_sort(higher)</span><br></pre></td></tr></tbody></table></figure>

<h5 id="使用递归-推导式写快速排序"><a href="#使用递归-推导式写快速排序" class="headerlink" title="使用递归+推导式写快速排序"></a>使用递归+推导式写快速排序</h5><figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">array</span>):</span></span><br><span class="line">    <span class="keyword">if</span> len(array) &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> array</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        pivot = array[<span class="number">0</span>]  <span class="comment"># 找到一个基准值</span></span><br><span class="line">        <span class="comment"># 遍历整个列表，将小于这个基准值的元素放到一个子列表中</span></span><br><span class="line">        less = [i <span class="keyword">for</span> i <span class="keyword">in</span> array[<span class="number">1</span>:] <span class="keyword">if</span> i &lt; pivot]</span><br><span class="line">        <span class="comment">#遍历整个列表，将大于这个基准值的元素放到一个子列表中</span></span><br><span class="line">        greater = [i <span class="keyword">for</span> i <span class="keyword">in</span> array[<span class="number">1</span>:] <span class="keyword">if</span> i &gt; pivot]</span><br><span class="line">        <span class="comment">#首先，明确我们对元素为0个/1个的列表无需要排序</span></span><br><span class="line">        <span class="comment">#使用函数递归</span></span><br><span class="line">        <span class="comment">#目标：让我们在一个基准值的一侧变为有序，然后依次返回，让我们的每个基准值的两侧都变得有序</span></span><br><span class="line">        <span class="keyword">return</span> quick_sort(less) + [pivot] + quick_sort(greater)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(quick_sort([<span class="number">2</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">11</span>]))</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span>(<span class="params">quick_list</span>):</span></span><br><span class="line">    <span class="keyword">if</span> quick_list == []:</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        first = quick_list[<span class="number">0</span>]</span><br><span class="line">        less = quick_sort([l <span class="keyword">for</span> l <span class="keyword">in</span> quick_list[<span class="number">1</span>:] <span class="keyword">if</span> l &lt; first])</span><br><span class="line">        more = quick_sort([m <span class="keyword">for</span> m <span class="keyword">in</span> quick_list[<span class="number">1</span>:] <span class="keyword">if</span> m &gt;= first])</span><br><span class="line">        <span class="keyword">return</span> less + [first] + more</span><br></pre></td></tr></tbody></table></figure>

<hr>
<h2 id="各种排序的复杂度对比："><a href="#各种排序的复杂度对比：" class="headerlink" title="各种排序的复杂度对比："></a>各种排序的复杂度对比：</h2><p><img src="/2020/08/21/liu-da-ji-ben-pai-xu/%E6%8E%92%E5%BA%8F%E5%A4%8D%E6%9D%82%E5%BA%A6%E6%AF%94%E8%BE%83.jpg"></p>
<hr>
<h2 id="算法执行的时间："><a href="#算法执行的时间：" class="headerlink" title="算法执行的时间："></a>算法执行的时间：</h2><p><img src="/2020/08/21/liu-da-ji-ben-pai-xu/%E6%8E%92%E5%BA%8F.png"></p>
<hr>
<h2 id="排序的内存使用："><a href="#排序的内存使用：" class="headerlink" title="排序的内存使用："></a>排序的内存使用：</h2><p><img src="/2020/08/21/liu-da-ji-ben-pai-xu/%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8.jpg"></p>
<h2 id="148-排序链表"><a href="#148-排序链表" class="headerlink" title="148. 排序链表"></a>148. 排序链表</h2><p><strong>在 O(n log n) 时间复杂度和常数级空间复杂度下，对链表进行排序。</strong></p>
<p>示例 1:</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: <span class="number">4</span>-&gt;<span class="number">2</span>-&gt;<span class="number">1</span>-&gt;<span class="number">3</span></span><br><span class="line">输出: <span class="number">1</span>-&gt;<span class="number">2</span>-&gt;<span class="number">3</span>-&gt;<span class="number">4</span></span><br></pre></td></tr></tbody></table></figure>
<p>示例 2:</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: <span class="number">-1</span>-&gt;<span class="number">5</span>-&gt;<span class="number">3</span>-&gt;<span class="number">4</span>-&gt;<span class="number">0</span></span><br><span class="line">输出: <span class="number">-1</span>-&gt;<span class="number">0</span>-&gt;<span class="number">3</span>-&gt;<span class="number">4</span>-&gt;<span class="number">5</span></span><br></pre></td></tr></tbody></table></figure>

<p>解答一：归并排序 递归的向下递推过程实际上是在切分链表。<br><img src="/2020/08/21/liu-da-ji-ben-pai-xu/..%5C%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%5C%E6%8E%92%E5%BA%8F%E9%93%BE%E8%A1%A8%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%EF%BC%88%E9%80%92%E5%BD%92%E6%B3%95%EF%BC%89.png"></p>
<ul>
<li><p>题目要求时间空间复杂度分别为O(nlogn)和O(1)，根据时间复杂度我们自然想到二分法，从而联想到归并排序；</p>
</li>
<li><p>对数组做归并排序的空间复杂度为 O(n)，分别由新开辟数组O(n)和递归函数调用O(logn)组成，而根据链表特性：</p>
<ul>
<li>数组额外空间：链表可以通过修改引用来更改节点顺序，无需像数组一样开辟额外空间；</li>
<li>递归额外空间：递归调用函数将带来O(logn)的空间复杂度，因此若希望达到O(1)空间复杂度，则不能使用递归。<br>二分是二叉树状结构，深度为 log N ~<br>切分链表时向下“二分”，因此递归树的高度是 O(log n) ，<br>每层都需遍历整个链表，占用 O(n) ，因此总体为 O(n log n) ~</li>
</ul>
</li>
</ul>
<p>每次找到中间节点的时间复杂度度是n,排序也是n,但是他们是在一个函数前后执行的还是n,<br>复杂度线性累加 还是原复杂度，只有内外嵌套才会升级为 N^2 ~</p>
<ul>
<li>通过递归实现链表归并排序，有以下两个环节：<ul>
<li>分割 cut 环节： 找到当前链表中点，并从中点将链表断开（以便在下次递归 cut 时，链表片段拥有正确边界）；<ul>
<li>我们使用 fast,slow 快慢双指针法，奇数个节点找到中点，偶数个节点找到中心左边的节点。</li>
<li>找到中点 slow 后，执行 slow.next = None 将链表切断。</li>
<li>递归分割时，输入当前链表左端点 head 和中心节点 slow 的下一个节点 mid(因为链表是从 slow 切断的)。</li>
<li>cut 递归终止条件： 当head.next == None时，说明只有一个节点了，直接返回此节点。</li>
</ul>
</li>
<li>合并 merge 环节： 将两个排序链表合并，转化为一个排序链表。<ul>
<li>双指针法合并，建立辅助ListNode h 作为头部。</li>
<li>设置两指针 left, right 分别指向两链表头部，比较两指针处节点值大小，由小到大加入合并链表头部，指针交替前进，直至添加完两个链表。</li>
<li>返回辅助ListNode h 作为头部的下个节点 h.next。</li>
<li>时间复杂度 O(l + r)，l, r 分别代表两个链表长度。</li>
</ul>
</li>
<li>当题目输入的 head == None 时，直接返回None。</li>
</ul>
</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortList</span>(<span class="params">self, head: ListNode</span>) -&gt; ListNode:</span></span><br><span class="line">        <span class="comment"># 递归结束条件</span></span><br><span class="line">        <span class="comment"># 当题目输入的 head == None 时，直接返回None。</span></span><br><span class="line">        <span class="comment"># 当head.next == None时，说明只有一个节点了，直接返回此节点。</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head <span class="keyword">or</span> <span class="keyword">not</span> head.next: </span><br><span class="line">            <span class="keyword">return</span> head <span class="comment"># termination.</span></span><br><span class="line">        <span class="comment"># cut the LinkedList at the mid index.</span></span><br><span class="line">        <span class="comment"># 每次慢指针+1，快指针都相当于+2，</span></span><br><span class="line">        <span class="comment"># 所以当快指针到终点，慢指针到达中点</span></span><br><span class="line">        slow, fast = head, head.next</span><br><span class="line">        <span class="keyword">while</span> fast <span class="keyword">and</span> fast.next:  <span class="comment"># 快</span></span><br><span class="line">            fast, slow = fast.next.next, slow.next</span><br><span class="line">        mid, slow.next = slow.next, <span class="literal">None</span> <span class="comment"># save and cut.</span></span><br><span class="line">        <span class="comment"># recursive for cutting.</span></span><br><span class="line">        <span class="comment"># left, right 分别指向两链表头部，比较两指针处节点值大小，</span></span><br><span class="line">        left, right = self.sortList(head), self.sortList(mid)</span><br><span class="line">        <span class="comment"># merge `left` and `right` linked list and return it.</span></span><br><span class="line">        <span class="comment"># res 是新建listNode，可以理解为新建一个头结点保留头指针，未创建新的链表，只是修改了原链表的节点指向，res指向的是h指针，这个h就是dummy亚指针，并不是合并后的头结点，而是它的前一个节点</span></span><br><span class="line">        <span class="comment"># 因为原头指针 h 在合并排序链表的时候会变化</span></span><br><span class="line">        h = res = ListNode(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">while</span> left <span class="keyword">and</span> right:</span><br><span class="line">            <span class="keyword">if</span> left.val &lt; right.val:</span><br><span class="line">                h.next, left = left, left.next</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                h.next, right = right, right.next</span><br><span class="line">            h = h.next</span><br><span class="line">        <span class="comment">#  前面while排序后, 如果左右子链表长度相同 ，</span></span><br><span class="line">        <span class="comment"># left和right都应该指向了左右子链表的最后一个node.next都是None</span></span><br><span class="line">        <span class="comment"># 但实际上长度可能不同，比如总长为 7 的链表，</span></span><br><span class="line">        <span class="comment"># 只能被分为7 = 3+4, 3 = 1+2……</span></span><br><span class="line">        <span class="comment"># 此时就需要把没走完的链表再加到尾部了。</span></span><br><span class="line">        h.next = left <span class="keyword">if</span> left <span class="keyword">else</span> right</span><br><span class="line">        <span class="comment"># h.next = left or right 更加 pythonic</span></span><br><span class="line">        <span class="keyword">return</span> res.next  <span class="comment"># 保存归并的结果的</span></span><br></pre></td></tr></tbody></table></figure>

<p>在 cut 到链表长度为 2 时，如果 fast, slow 都指向头部 head ，那么fast会走两步，slow走一步，cut点是不对的。 如果fast先走一步到 head.next ，就会避免长度为 2 时出现的特殊错误情况。<br>[3, 2]<br>slow = = head = 3<br>fast = = head.next = 2<br>fast.next = None不进入循环<br>mid = slow.next = 3<br>slow.next = None [3 | 2]</p>
<p>如果初始化时令fast=head，slow=head<br>slow = head = 3<br>fast.next != None进入循环</p>
<p>slow = slow.next = 2<br>fast = fast.next.next =None<br>mid = slow.next = None<br>slow.next = None </p>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span> <span class="number">2</span> <span class="number">4</span> <span class="number">6</span></span><br><span class="line"><span class="string">slow</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"><span class="string">fast</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">slow</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">fast</span> <span class="string">=</span> <span class="number">6</span></span><br><span class="line">  </span><br><span class="line"><span class="string">mid</span> <span class="string">=</span> <span class="number">4</span> </span><br><span class="line"><span class="string">slow.next</span> <span class="string">=</span> <span class="string">None</span> <span class="string">切断</span>  [<span class="number">3</span>, <span class="number">2</span> <span class="string">|</span> <span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="string">self.sortList(head)</span>  [<span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line"><span class="string">slow</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"><span class="string">fast</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">fast.next</span> <span class="string">=</span> <span class="string">None</span> <span class="string">不进入循环</span></span><br><span class="line"><span class="string">mid</span> <span class="string">=</span> <span class="string">slow.next</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">slow.next</span> <span class="string">=</span> <span class="string">None</span>    [<span class="number">3</span> <span class="string">|</span> <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="string">self.sortList(head)</span></span><br><span class="line"><span class="string">head</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"><span class="string">head.next</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"><span class="string">return</span> <span class="string">head</span> </span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="string">right</span> <span class="string">=</span> <span class="string">self.sortList(mid)</span></span><br><span class="line"><span class="string">head</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">head.next</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"><span class="string">return</span> <span class="string">head</span> </span><br><span class="line"><span class="string">right</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="string">独立的</span> <span class="number">3</span> <span class="string">和</span> <span class="number">2</span> <span class="string">合并</span></span><br><span class="line"><span class="number">3</span> <span class="string">&gt;</span> <span class="number">2</span></span><br><span class="line"><span class="string">h.next</span> <span class="string">=</span> <span class="string">right</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">right</span> <span class="string">=</span> <span class="string">right.next</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"><span class="string">h</span> <span class="string">=</span> <span class="string">h.next</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">跳出循环</span></span><br><span class="line"><span class="string">h.next</span> <span class="string">=</span> <span class="string">left</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"></span><br><span class="line"><span class="string">right</span> <span class="string">=</span> <span class="string">self.sortList(mid)</span>  [<span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line"><span class="string">slow</span> <span class="string">=</span> <span class="number">4</span></span><br><span class="line"><span class="string">fast</span> <span class="string">=</span> <span class="number">6</span></span><br><span class="line"><span class="string">fast.next</span> <span class="string">=</span> <span class="string">None</span> <span class="string">不进入循环</span></span><br><span class="line"><span class="string">mid</span> <span class="string">=</span> <span class="string">slow.next</span> <span class="string">=</span> <span class="number">6</span></span><br><span class="line"><span class="string">slow.next</span> <span class="string">=</span> <span class="string">None</span>    [<span class="number">4</span> <span class="string">|</span> <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="string">self.sortList(head)</span> </span><br><span class="line"><span class="string">head</span> <span class="string">=</span> <span class="number">4</span></span><br><span class="line"><span class="string">head.next</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"><span class="string">return</span> <span class="string">head</span> </span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="string">right</span> <span class="string">=</span> <span class="string">self.sortList(mid)</span></span><br><span class="line"><span class="string">head</span> <span class="string">=</span> <span class="number">6</span></span><br><span class="line"><span class="string">head.next</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"><span class="string">return</span> <span class="string">head</span> </span><br><span class="line"><span class="string">right</span> <span class="string">=</span> <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="string">独立的</span> <span class="number">4</span> <span class="string">和</span> <span class="number">6</span> <span class="string">合并</span></span><br><span class="line"><span class="number">4</span> <span class="string">&lt;</span> <span class="number">6</span>          </span><br><span class="line"><span class="string">h.next</span> <span class="string">=</span> <span class="string">left</span> <span class="string">=</span> <span class="number">4</span></span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="string">left.next</span> <span class="string">=</span> <span class="string">None</span> </span><br><span class="line"><span class="string">h</span> <span class="string">=</span> <span class="string">h.next</span> <span class="string">=</span> <span class="number">4</span></span><br><span class="line"><span class="string">跳出循环</span></span><br><span class="line"><span class="string">h.next</span> <span class="string">=</span> <span class="string">left</span> <span class="string">=</span> <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"></span><br><span class="line"><span class="string">独立的</span> [<span class="number">2</span>, <span class="number">3</span>] <span class="string">和</span> [<span class="number">4</span>, <span class="number">6</span>] <span class="string">合并</span></span><br><span class="line"><span class="number">2</span> <span class="string">&lt;</span> <span class="number">4</span>         </span><br><span class="line"><span class="string">h.next</span> <span class="string">=</span> <span class="string">left</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="string">left.next</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"><span class="string">h</span> <span class="string">=</span> <span class="string">h.next</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">再循环</span></span><br><span class="line"><span class="number">3</span> <span class="string">&lt;</span> <span class="number">4</span></span><br><span class="line"><span class="string">h.next</span> <span class="string">=</span> <span class="string">left</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"><span class="string">left</span> <span class="string">=</span> <span class="string">left.next</span> <span class="string">=</span> <span class="string">None</span></span><br><span class="line"><span class="string">h</span> <span class="string">=</span> <span class="string">h.next</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"><span class="string">h.next</span> <span class="string">=</span> <span class="string">right</span> <span class="string">=</span> <span class="number">4</span> <span class="string">right只是链表的头节点，会指向后面排序好的节点6</span></span><br><span class="line"><span class="string">h指向2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">6</span><span class="string">，ok</span></span><br></pre></td></tr></tbody></table></figure>

<p>一次方法的调用和返回代表着一个栈帧的入栈和出栈，栈帧出栈后，该栈帧中的临时变量所占用的空间都会得到释放。 对于数组的归并排序之所以空间复杂度是O(n)，是因为数组归并排序使用了一个创建了一个辅助数组。这里每个栈帧创建的只是辅助节点，出栈后就释放了。空间复杂度应该是O(1)<br>若算法执行所需要的辅助空间相对于输入数据n而言是一个常数，则称这个算法空间复杂度辅助空间为o（1）；<br>递归算法空间复杂度：递归深度n*每次递归所要的辅助空间，如果每次递归所需要的辅助空间为常数，则递归空间复杂度o（n）。</p>
<p>递归栈的空间复杂度和递归函数调用的 深度 有关<br>（即在某时刻有多少个递归函数 “尚未返回”）。<br>在返回后，系统会释放栈空间的。<br>递归调用次数多，空间复杂度不一定更高~</p>
<p>偶數個數的時候 mid 有偏左和偏右兩個。<br>如果直接從 fast 開始，slow 永遠會走到偏右的那個，會進入無窮迴圈。<br>所以我們要的是偏左那個 mid，一開始要先多走一步<br>如果不令fast初始化为head.next，则在链表长度n为偶数的情况下返回第n/2 + 1个数，题意需要的是第n/2个数<br>因为起点一样的话,拆分到只剩两个节点的时候,这两个节点永远拆分不开</p>
<hr>
<p>法二：归并排序（从底至顶直接合并）</p>
<p><img src="/2020/08/21/liu-da-ji-ben-pai-xu/..%5C%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%5C%E6%8E%92%E5%BA%8F%E9%93%BE%E8%A1%A8%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%EF%BC%88%E4%BB%8E%E5%BA%95%E8%87%B3%E9%A1%B6%E7%9B%B4%E6%8E%A5%E5%90%88%E5%B9%B6%EF%BC%89.png"></p>
<ul>
<li><p>对于非递归的归并排序，需要使用迭代的方式替换cut环节：</p>
<ul>
<li>我们知道，cut环节本质上是通过二分法得到链表最小节点单元，再通过多轮合并得到排序结果。</li>
<li>每一轮合并merge操作针对的单元都有固定长度intv，例如：<ul>
<li>第一轮合并时intv = 1，即将整个链表切分为多个长度为1的单元，并按顺序两两排序合并，合并完成的已排序单元长度为2。</li>
<li>第二轮合并时intv = 2，即将整个链表切分为多个长度为2的单元，并按顺序两两排序合并，合并完成已排序单元长度为4。</li>
<li>以此类推，直到单元长度intv &gt;= 链表长度，代表已经排序完成。</li>
</ul>
</li>
<li>据以上推论，我们可以仅根据intv计算每个单元边界，并完成链表的每轮排序合并，例如:<ul>
<li><p>当intv = 1时，将链表第1和第2节点排序合并，第3和第4节点排序合并，……。</p>
</li>
<li><p>当intv = 2时，将链表第1-2和第3-4节点排序合并（第一组小片段），第5-6和第7-8节点排序合并（第二组小片段），……。，</p>
</li>
<li><p>当intv = 4时，将链表第1-4和第5-8节点排序合并，第9-12和第13-16节点排序合并，……。</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>此方法时间复杂度O(nlogn)，空间复杂度O(1)。</p>
</li>
<li><p>模拟上述的多轮排序合并：</p>
<ul>
<li>统计链表长度length，用于通过判断intv &lt; length判定是否完成排序；</li>
<li>额外声明一个节点root，作为头部后面接整个链表，用于：<ul>
<li>intv *= 2即切换到下一轮合并时，可通过root.next找到链表头部cur；</li>
<li>执行排序合并时，需要一个辅助节点作为头部，而root则作为链表头部排序合并时的辅助头部merge_point；后面的合并排序可以将上次合并排序的尾部tail用做辅助节点。</li>
</ul>
</li>
<li>在每轮intv下的合并流程：<ol>
<li>根据intv找到合并单元1和单元2的头部h1, h2。<br>由于链表长度可能不是2^n，需要考虑边界条件：<ul>
<li>在找h2过程中，如果链表剩余元素个数少于intv，则无需合并环节，直接break，执行下一轮合并；</li>
<li>若h2存在，但以h2为头部的剩余元素个数少于intv，也执行合并环节，h2单元的长度为len2 = intv - intv_residue_2。</li>
</ul>
</li>
<li>合并长度为len1, len2的h1, h2链表，其中：<ul>
<li>合并完后，需要修改新的合并单元的尾部merge_point指针指向下一个合并单元头部current。<br>（在寻找h1, h2环节中，current指针已经被移动到下一个单元头部）</li>
<li>合并单元尾部同时也作为下次合并的辅助头部merge_point。</li>
</ul>
</li>
<li>当current == None，代表此轮intv合并完成，跳出。</li>
</ol>
</li>
<li>每轮合并完成后将单元长度×2，切换到下轮合并：intv *= 2。</li>
</ul>
</li>
</ul>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortList</span>(<span class="params">self, head: ListNode</span>) -&gt; ListNode:</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head <span class="keyword">or</span> <span class="keyword">not</span> head.next:</span><br><span class="line">            <span class="keyword">return</span> head</span><br><span class="line"></span><br><span class="line">        cur, length = head, <span class="number">0</span></span><br><span class="line">        <span class="comment">#  遍历链表求长度，时间复杂度就是On了,</span></span><br><span class="line">        <span class="comment">#  O(nlogn)复杂度高于线性低于平方,所以有个O(n)没关系</span></span><br><span class="line">        <span class="keyword">while</span> cur:</span><br><span class="line">            cur, length = cur.next, length + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        root = ListNode(<span class="number">0</span>)</span><br><span class="line">        root.next = head</span><br><span class="line">        intv = <span class="number">1</span>  <span class="comment"># 每次合并的规模</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 根据不同的链表切片规模，每一次都从头进行归并</span></span><br><span class="line">        <span class="keyword">while</span> intv &lt; length:</span><br><span class="line">            merge_point, current = root, root.next</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> current:  <span class="comment"># 根据当前的合并规模，将链表内的链表切片两两归并</span></span><br><span class="line">                <span class="comment"># 获取当前需要归并的子链表 h1</span></span><br><span class="line">                h1, intv_residue_1 = current, intv</span><br><span class="line">                <span class="keyword">while</span> intv_residue_1 <span class="keyword">and</span> current:</span><br><span class="line">                    current, intv_residue_1 = current.next, intv_residue_1 - <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> intv_residue_1:</span><br><span class="line">                    <span class="comment"># h2 在这种情况下不存在，所以本轮不需要合并</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># 获取当前需要归并的子链表 h2</span></span><br><span class="line">                h2, intv_residue_2 = current, intv</span><br><span class="line">                <span class="keyword">while</span> intv_residue_2 <span class="keyword">and</span> current:</span><br><span class="line">                    current, intv_residue_2 = current.next, intv_residue_2 - <span class="number">1</span></span><br><span class="line">                <span class="comment"># len2 的长度可能比 intv 小</span></span><br><span class="line">                len1, len2 = intv, intv - intv_residue_2</span><br><span class="line">                <span class="comment"># 归并排序</span></span><br><span class="line">                <span class="comment"># len1或len2一定有一个是等于0的，链接剩下的被切割剩下的一个链表</span></span><br><span class="line">                <span class="keyword">while</span> len1 <span class="keyword">and</span> len2:</span><br><span class="line">                    <span class="keyword">if</span> h1.val &lt; h2.val:</span><br><span class="line">                        merge_point.next, h1, len1 = h1, h1.next, len1 - <span class="number">1</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        merge_point.next, h2, len2 = h2, h2.next, len2 - <span class="number">1</span></span><br><span class="line">                    merge_point = merge_point.next</span><br><span class="line">                <span class="comment"># 归并排序处理一下没有被归并的剩余值</span></span><br><span class="line">                <span class="keyword">if</span> len1:</span><br><span class="line">                    merge_point.next = h1</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    merge_point.next = h2</span><br><span class="line">                <span class="comment"># merge_point.next=h1 or h2 只是完成了第一组内部小片段最后一个节点的连接，例如此时 h1 = 2, h2 = 3，把2 和 3 连上 </span></span><br><span class="line">                <span class="comment"># merge_point指向的元素不一定是当前链表切片的末尾</span></span><br><span class="line">                <span class="comment"># merge_point还应该继续后移，直到指向当前链表切片末尾（即下一次链表切片的开头）</span></span><br><span class="line">                <span class="keyword">while</span> len1 &gt; <span class="number">0</span> <span class="keyword">or</span> len2 &gt; <span class="number">0</span>:</span><br><span class="line">                    merge_point, len1, len2 = merge_point.next, len1 - <span class="number">1</span>, len2 - <span class="number">1</span></span><br><span class="line">                <span class="comment"># 把归并后的链表切片第一小组片段尾跟原链表h2之第二小组的头拼起来</span></span><br><span class="line">                <span class="comment"># 一次合并后有可能最后一个结点顺序被打乱而不是下一次合并的起点</span></span><br><span class="line">                <span class="comment"># [2 3] 要连上 还未排序的[4 6]</span></span><br><span class="line">                merge_point.next = current</span><br><span class="line"></span><br><span class="line">            intv *= <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> root.next</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span> <span class="number">2</span> <span class="number">4</span> <span class="number">6</span></span><br><span class="line"></span><br><span class="line">current = <span class="number">3</span></span><br><span class="line">length = <span class="number">0</span></span><br><span class="line">进入循环</span><br><span class="line">current = current.next = <span class="number">2</span></span><br><span class="line">length = <span class="number">1</span></span><br><span class="line">current = current.next = <span class="number">4</span></span><br><span class="line">length = <span class="number">2</span></span><br><span class="line">current = current.next = <span class="number">6</span></span><br><span class="line">length = <span class="number">3</span></span><br><span class="line">current = current.next = None</span><br><span class="line">length = <span class="number">4</span></span><br><span class="line">退出循环</span><br><span class="line"></span><br><span class="line">root.next = head</span><br><span class="line"><span class="built_in">int</span>v = <span class="number">1</span>  </span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>v = <span class="number">1</span> &lt; length = <span class="number">4</span></span><br><span class="line">merge_point = root </span><br><span class="line">current = root.next = head = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">进入循环</span><br><span class="line"></span><br><span class="line">h1 = current = <span class="number">3</span></span><br><span class="line"><span class="built_in">int</span>v_residue_1 = <span class="built_in">int</span>v = <span class="number">1</span></span><br><span class="line">进入子循环</span><br><span class="line">current = current.next = <span class="number">2</span></span><br><span class="line"><span class="built_in">int</span>v_residue_1 = <span class="built_in">int</span>v_residue_1 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">退出子循环</span><br><span class="line"></span><br><span class="line">h2 = current = <span class="number">2</span></span><br><span class="line"><span class="built_in">int</span>v_residue_2 = <span class="built_in">int</span>v = <span class="number">1</span></span><br><span class="line">进入子循环                    </span><br><span class="line">current = current.next = <span class="number">4</span></span><br><span class="line"><span class="built_in">int</span>v_residue_2 = <span class="built_in">int</span>v_residue_2 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">退出子循环</span><br><span class="line"></span><br><span class="line">len1 = <span class="built_in">int</span>v = <span class="number">1</span></span><br><span class="line">len2 = <span class="built_in">int</span>v - <span class="built_in">int</span>v_residue_2 = <span class="number">1</span>  </span><br><span class="line"></span><br><span class="line">进入子循环</span><br><span class="line"><span class="number">3</span> &gt; <span class="number">2</span></span><br><span class="line">merge_point.next = h2 = <span class="number">2</span></span><br><span class="line">h2 = h2.next = <span class="number">4</span></span><br><span class="line">len2 = len2 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">merge_point = merge_point.next = <span class="number">2</span></span><br><span class="line">跳出子循环</span><br><span class="line"></span><br><span class="line">merge_point.next = h1 = <span class="number">3</span>  </span><br><span class="line"></span><br><span class="line">merge_point = merge_point.next = <span class="number">3</span></span><br><span class="line">len1 = len1 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">len2 = len2 - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">merge_point.next = current = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">h1 = current = <span class="number">4</span></span><br><span class="line"><span class="built_in">int</span>v_residue_1 = <span class="built_in">int</span>v = <span class="number">1</span></span><br><span class="line">进入子循环</span><br><span class="line">current = current.next = <span class="number">6</span></span><br><span class="line"><span class="built_in">int</span>v_residue_1 = <span class="built_in">int</span>v_residue_1 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">退出子循环</span><br><span class="line"></span><br><span class="line">h2 = current = <span class="number">6</span></span><br><span class="line"><span class="built_in">int</span>v_residue_2 = <span class="built_in">int</span>v = <span class="number">1</span></span><br><span class="line">进入子循环                    </span><br><span class="line">current = current.next = None</span><br><span class="line"><span class="built_in">int</span>v_residue_2 = <span class="built_in">int</span>v_residue_2 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">退出子循环</span><br><span class="line">len1 = <span class="built_in">int</span>v = <span class="number">1</span></span><br><span class="line">len2 = <span class="built_in">int</span>v - <span class="built_in">int</span>v_residue_2 = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">进入子循环</span><br><span class="line"><span class="number">4</span> &lt; <span class="number">6</span></span><br><span class="line">merge_point.next = h1 = <span class="number">4</span></span><br><span class="line">h1 = h1.next = <span class="number">6</span></span><br><span class="line">len1 = len1 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">merge_point = merge_point.next = <span class="number">4</span></span><br><span class="line">跳出循环</span><br><span class="line"></span><br><span class="line">merge_point.next = h2 = <span class="number">6</span></span><br><span class="line"></span><br><span class="line">merge_point = merge_point.next = <span class="number">6</span></span><br><span class="line">len1 = len1 - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line">len2 = len2 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">merge_point.next = current = None</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>v = <span class="built_in">int</span>v * <span class="number">2</span> =  <span class="number">2</span></span><br><span class="line"></span><br><span class="line">merge_point = root</span><br><span class="line">current = root.next = head = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">进入循环</span><br><span class="line"></span><br><span class="line">h1 = current = <span class="number">2</span></span><br><span class="line"><span class="built_in">int</span>v_residue_1 = <span class="built_in">int</span>v = <span class="number">2</span></span><br><span class="line">进入子循环</span><br><span class="line">current = current.next = <span class="number">3</span></span><br><span class="line"><span class="built_in">int</span>v_residue_1 = <span class="built_in">int</span>v_residue_1 - <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">再循环</span><br><span class="line">current = current.next = <span class="number">4</span></span><br><span class="line"><span class="built_in">int</span>v_residue_1 = <span class="built_in">int</span>v_residue_1 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">退出子循环</span><br><span class="line"></span><br><span class="line">h2 = current = <span class="number">4</span></span><br><span class="line"><span class="built_in">int</span>v_residue_2 = <span class="built_in">int</span>v = <span class="number">2</span></span><br><span class="line">进入子循环                    </span><br><span class="line">current = current.next = <span class="number">6</span></span><br><span class="line"><span class="built_in">int</span>v_residue_2 = <span class="built_in">int</span>v_residue_2 - <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">退出子循环</span><br><span class="line">len1 = <span class="built_in">int</span>v = <span class="number">2</span></span><br><span class="line">len2 = <span class="built_in">int</span>v - <span class="built_in">int</span>v_residue_2 = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">进入子循环</span><br><span class="line"><span class="number">2</span> &lt; <span class="number">4</span></span><br><span class="line">merge_point.next = h1 = <span class="number">2</span></span><br><span class="line">h1 = h1.next = <span class="number">3</span> </span><br><span class="line">len1 = len1 - <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">merge_point = merge_point.next = <span class="number">2</span></span><br><span class="line"><span class="number">3</span> &lt; <span class="number">4</span></span><br><span class="line">merge_point.next = h1 = <span class="number">3</span></span><br><span class="line">h1 = h1.next = <span class="number">4</span> </span><br><span class="line">len1 = len1 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line">merge_point = merge_point.next = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">merge_point.next = h2 = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">merge_point = merge_point.next = <span class="number">4</span></span><br><span class="line">len1 = len1 - <span class="number">1</span> = <span class="number">-1</span></span><br><span class="line">len2 = len2 - <span class="number">1</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">merge_point.next = current = <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>v = <span class="built_in">int</span>v * <span class="number">2</span> = <span class="number">4</span> = length 跳出循环</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>root.next = head不写成root = head<br>head指向的头节点在排序过程中是变化的顺序可能会被打乱，比如 4，3，2，1第一次完成后变为3，4，1，2，此时head指向了第二个节点，就不是头节点了，而dummy.next始终会指向每次归并完之后的新头节点，我觉得可以参照代码手推下更好理解了</p>
<hr>
<h3 id="堆-Heap-是计算机科学中一类特殊的数据结构的统称，一般讨论的堆都是二叉堆。"><a href="#堆-Heap-是计算机科学中一类特殊的数据结构的统称，一般讨论的堆都是二叉堆。" class="headerlink" title="堆(Heap)是计算机科学中一类特殊的数据结构的统称，一般讨论的堆都是二叉堆。"></a>堆(Heap)是计算机科学中一类特殊的数据结构的统称，一般讨论的堆都是二叉堆。</h3><p>堆满足下列性质：</p>
<ol>
<li>堆中某个节点的值或索引总是不大于或不小于其父节点的值或索引。</li>
<li>堆总是一棵完全二叉树，且该完全二叉树的深度为 k，除第 k 层外，其它各层 (1～k-1) 的结点数都达到最大个数，第 k 层所有的结点都连续集中在最左边。</li>
</ol>
<p>把堆看作原生的Python list，数组的下标对应堆中节点的编号<br>我们使用了从零开始的索引。这使得节点和其孩子节点索引之间的关系不太直观但更加适合，<br>heap[0] 表示访问最小的元素总是在根结点而不弹出它。，同时 heap.sort() 维护了堆的不变性！</p>
<h3 id="堆排序：利用堆的概念来排序的选择排序。先将待排序的序列建成分为两种："><a href="#堆排序：利用堆的概念来排序的选择排序。先将待排序的序列建成分为两种：" class="headerlink" title="堆排序：利用堆的概念来排序的选择排序。先将待排序的序列建成分为两种："></a>堆排序：利用堆的概念来排序的选择排序。先将待排序的序列建成分为两种：</h3><ol>
<li>大顶堆：每个节点的值都大于或等于其子节点的值，在堆排序算法中用于升序排列；<br>此时整个序列最大值即为堆顶元素，我们将其与末尾元素交换，使末尾元素为最大值，然后再调整堆顶元素使得剩下的 n−1 个元素仍为大根堆，再重复执行以上操作我们即能得到一个有序的序列。</li>
<li>小顶堆：每个节点的值都小于或等于其子节点的值，在堆排序算法中用于降序排列；</li>
</ol>
<h1 id="Python-里的-heapq-模块"><a href="#Python-里的-heapq-模块" class="headerlink" title="Python 里的 heapq 模块"></a>Python 里的 heapq 模块</h1><p>python3标准库中提供了heapq，使用原地算法得到对小顶堆进行操作<br>提供了堆队列算法的实现，也称为优先队列算法。<br>一般我们刷题或者写业务代码的时候，使用这个内置的 heapq 模块就够用了</p>
<p>实现 大顶堆 方法：小顶堆的插入和弹出操作均将元素 取反<br>小顶堆[1,2,3]堆顶是1，<br>如果想让3在堆顶的话，就只能是[-3,-2,-1]，堆顶是-3，<br>然后每次heappop取出时，-3加上负号就变成3了，变相实现大顶堆</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>          <span class="number">-3</span></span><br><span class="line">  /  \       /  \</span><br><span class="line"> <span class="number">2</span>    <span class="number">3</span>     <span class="number">-2</span>  <span class="number">-1</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>shift up ：如何向一个最大堆中添加元素</li>
<li>shift down 如何从一个最大堆中取出一个元素，只能取出最大优先级的元素，也就是根节点，</li>
</ul>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">              <span class="number">62</span></span><br><span class="line">            /     \</span><br><span class="line">           <span class="number">52</span>      <span class="number">30</span></span><br><span class="line">         /   \     / \</span><br><span class="line">        <span class="number">28</span>    <span class="number">41</span>  <span class="number">22</span>  <span class="number">13</span></span><br><span class="line">       /  \      / \</span><br><span class="line">      <span class="number">19</span>  <span class="number">17</span> <span class="number">15</span> <span class="number">16</span></span><br><span class="line">把原来的 <span class="number">62</span> 取出后，</span><br><span class="line"></span><br><span class="line">            /     \</span><br><span class="line">           <span class="number">52</span>      <span class="number">30</span></span><br><span class="line">         /   \     / \</span><br><span class="line">        <span class="number">28</span>    <span class="number">41</span>  <span class="number">22</span>  <span class="number">13</span></span><br><span class="line">       /  \      / \</span><br><span class="line">      <span class="number">19</span>  <span class="number">17</span> <span class="number">15</span> <span class="number">16</span></span><br><span class="line"></span><br><span class="line">将数组最后一位数组放到根节点，此时不满足最大堆的定义。</span><br><span class="line">              <span class="number">16</span></span><br><span class="line">            /     \</span><br><span class="line">           <span class="number">52</span>      <span class="number">30</span></span><br><span class="line">         /   \     / \</span><br><span class="line">        <span class="number">28</span>    <span class="number">41</span>  <span class="number">22</span>  <span class="number">13</span></span><br><span class="line">       /  \      / \</span><br><span class="line">      <span class="number">19</span>  <span class="number">17</span> <span class="number">15</span> </span><br><span class="line">调整的过程是将这个根节点 <span class="number">16</span> 一步一步向下挪，<span class="number">16</span> 比子节点都小，</span><br><span class="line">先比较子节点 <span class="number">52</span> 和 <span class="number">30</span> 哪个大，和大的交换位置。</span><br><span class="line">              <span class="number">52</span></span><br><span class="line">            /     \</span><br><span class="line">           <span class="number">16</span>      <span class="number">30</span></span><br><span class="line">         /   \     / \</span><br><span class="line">        <span class="number">28</span>    <span class="number">41</span>  <span class="number">22</span>  <span class="number">13</span></span><br><span class="line">       /  \      / \</span><br><span class="line">      <span class="number">19</span>  <span class="number">17</span> <span class="number">15</span> </span><br><span class="line">继续比较 <span class="number">16</span> 的子节点 <span class="number">28</span> 和 <span class="number">41</span>，<span class="number">41</span> 大，所以 <span class="number">16</span> 和 <span class="number">41</span> 交换位置。</span><br><span class="line">              <span class="number">52</span></span><br><span class="line">            /     \</span><br><span class="line">           <span class="number">41</span>      <span class="number">30</span></span><br><span class="line">         /   \     / \</span><br><span class="line">        <span class="number">28</span>    <span class="number">16</span>  <span class="number">22</span>  <span class="number">13</span></span><br><span class="line">       /  \      / \</span><br><span class="line">      <span class="number">19</span>  <span class="number">17</span> <span class="number">15</span> </span><br><span class="line">继续 <span class="number">16</span> 和孩子节点 <span class="number">15</span> 进行比较，<span class="number">16</span> 大，所以现在不需要进行交换，最后我们的 shift down 操作完成，维持了一个最大堆的性质。</span><br></pre></td></tr></tbody></table></figure>


<p>要创建一个堆 </p>
<ol>
<li><p>或者 <code>heapq.heapify(list)</code> ，将列表list原地转换成为最小二叉堆列表，具备最小堆特征 线性时间内，算法时间复杂度为 O(n)。<br>Transform list x into a heap, in-place, in linear time.</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">heap2 = [<span class="number">5</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">heapq.heapify(heap2)</span><br><span class="line">print(heap2)</span><br><span class="line"><span class="comment"># [0, 1, 5, 3, 2, 7, 9, 8, 4, 6]</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">            0</span></span><br><span class="line"><span class="string">          /   \</span></span><br><span class="line"><span class="string">         1     5</span></span><br><span class="line"><span class="string">        / \   / \</span></span><br><span class="line"><span class="string">       3   2  7  9</span></span><br><span class="line"><span class="string">      / \ / \</span></span><br><span class="line"><span class="string">     8  4 6</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>可以使用list来初始化为 []<br><code>heapq.heappush(heap, item)</code><br>将 item 的值加入 heap 中，保持堆的不变性。<br>push后堆也应该是一棵完全二叉树，所以必须将元素追加到数组末尾</p>
</li>
</ol>
<p><code>heapq.heappop(heap)</code><br>弹出并返回 heap 的最小的元素，保持堆的不变性。<br>如果堆为空，抛出 IndexError 。</p>
<p><code>heapq.heappushpop(heap, item)</code><br>将 item 放入堆中，然后弹出并返回 heap 的最小元素。<br>该组合操作比先调用  heappush() 再调用 heappop() 运行起来更有效率。</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">从 iterable 所定义的数据集中返回前 n 个最小元素组成的列表。 </span><br><span class="line">如果提供了 key 则其应指定一个单参数的函数，</span><br><span class="line">用于从 iterable 的每个元素中提取比较键 (例如 key=str.lower)。 等价于: sorted(iterable, key=key)[:n]。。</span><br><span class="line"></span><br><span class="line">堆排序的原理是通过不断 交换元素 实现排序的：</span><br><span class="line">在数组中交换两个索引的元素时间复杂度为 O(1)，</span><br><span class="line">而链表 交换元素 本身是 O(N) 时间复杂度，若可以把此问题解决就可以用堆排。</span><br><span class="line"></span><br><span class="line">时间复杂度：O(nlogn)。初始化建堆的时间复杂度为 O(n)，建完堆以后需要进行 n-1 次调整，一次调整（即 maxHeapify） 的时间复杂度为 O(logn)，那么 n−1 次调整即需要 O(nlogn) 的时间复杂度。因此，总时间复杂度为 O(n+nlogn)=O(nlogn)。</span><br><span class="line"></span><br><span class="line">空间复杂度：O(1)。给一个未排序的数组arr，堆排序就地排序，不借用额外空间，仅在arr上调整元素位置完成排序。如果把原数组arr算上就是O(N)，但一般只计算使用到的额外空间，只需要常数的空间存放若干变量。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line">import heapq</span><br><span class="line"></span><br><span class="line">data = [3, 2, 6, 1]</span><br><span class="line">heap1 = []</span><br><span class="line"># 使用heapq库的heappush函数将数据堆入</span><br><span class="line">for i in data:</span><br><span class="line">    heapq.heappush(heap1, i)  # 数据堆入</span><br><span class="line">print(heap1)  # [1, 2, 6, 3]</span><br><span class="line">'''</span><br><span class="line">            1</span><br><span class="line">           /  \</span><br><span class="line">          2    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3</span><br><span class="line">'''</span><br><span class="line">heapq.heappush(heap1, 5)</span><br><span class="line">print(heap1)  # [1, 2, 6, 3, 5]</span><br><span class="line">'''</span><br><span class="line">            1</span><br><span class="line">           /  \</span><br><span class="line">          2    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5</span><br><span class="line">将元素追加到数组末尾，符合最小堆的规律        </span><br><span class="line">'''</span><br><span class="line">heapq.heappush(heap1, 0.5)</span><br><span class="line">print(heap1)</span><br><span class="line"># [0.5, 2, 1, 3, 5, 6]</span><br><span class="line">'''</span><br><span class="line">            1</span><br><span class="line">           /  \</span><br><span class="line">          2    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 0.5</span><br><span class="line">将元素追加到数组末尾，不符合最小堆的规律，需要调整</span><br><span class="line">            1</span><br><span class="line">           /  \</span><br><span class="line">          2    0.5</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 6</span><br><span class="line">            0.5</span><br><span class="line">           /  \</span><br><span class="line">          2    1</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 6</span><br><span class="line"></span><br><span class="line">'''</span><br><span class="line">print(heapq.heappop(heap1))  # 0.5 将数组堆中的最小元素弹出</span><br><span class="line">print(heap1)  # [1, 2, 6, 3, 5]</span><br><span class="line">'''</span><br><span class="line">            0.5</span><br><span class="line">           /  \</span><br><span class="line">          2    1</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 6</span><br><span class="line">第一步，先将根节点与编号最大节点的元素互换，并删除编号最大的节点。</span><br><span class="line">           /  \</span><br><span class="line">          2    1</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 6</span><br><span class="line">            6</span><br><span class="line">           /  \</span><br><span class="line">          2    1</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 </span><br><span class="line">此时堆仍然是一棵完全二叉树，但有可能不满足堆的性质一。</span><br><span class="line">所以我们需要对根节点的元素进行下沉操作，</span><br><span class="line">以大顶堆为例，设置一个游标 id, 初始指向根节点：</span><br><span class="line">如果id指向叶子节点，算法结束。</span><br><span class="line">如果id指向节点小于其左右子节点的值，算法结束。</span><br><span class="line">设id的左右子节点中，拥有较小值的编号为 p，交换 id 与 p 的值，并将 id 指向 p 节点。跳转步骤 1</span><br><span class="line">            1</span><br><span class="line">           /  \</span><br><span class="line">          2    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 </span><br><span class="line">'''</span><br><span class="line">print(heapq.heappop(heap1))  # 1 将数组堆中的最小元素弹出</span><br><span class="line">print(heap1)  # [2, 3, 6, 5]</span><br><span class="line">'''</span><br><span class="line">            1</span><br><span class="line">           /  \</span><br><span class="line">          2    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 </span><br><span class="line"></span><br><span class="line">           /  \</span><br><span class="line">          2    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3  5 </span><br><span class="line"></span><br><span class="line">            5</span><br><span class="line">           /  \</span><br><span class="line">          2    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3 </span><br><span class="line"></span><br><span class="line">            2</span><br><span class="line">           /  \</span><br><span class="line">          5    6</span><br><span class="line">         / \  / \</span><br><span class="line">        3  </span><br><span class="line"></span><br><span class="line">            2</span><br><span class="line">           /  \</span><br><span class="line">          3    6</span><br><span class="line">         / \  / \</span><br><span class="line">        5  </span><br><span class="line">'''</span><br></pre></td></tr></tbody></table></figure>


<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">max_heapify</span>(<span class="params">self, heap, root, heap_len</span>):</span></span><br><span class="line">        p = root</span><br><span class="line">        <span class="keyword">while</span> p * <span class="number">2</span> + <span class="number">1</span> &lt; heap_len:</span><br><span class="line">            l, r = p * <span class="number">2</span> + <span class="number">1</span>, p * <span class="number">2</span> + <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> heap_len &lt;= r <span class="keyword">or</span> heap[r] &lt; heap[l]:</span><br><span class="line">                nex = l</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                nex = r</span><br><span class="line">            <span class="keyword">if</span> heap[p] &lt; heap[nex]:</span><br><span class="line">                heap[p], heap[nex] = heap[nex], heap[p]</span><br><span class="line">                p = nex</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">build_heap</span>(<span class="params">self, heap</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(heap) - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            self.max_heapify(heap, i, len(heap))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">heap_sort</span>(<span class="params">self, nums</span>):</span></span><br><span class="line">        self.build_heap(nums)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums) - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            nums[i], nums[<span class="number">0</span>] = nums[<span class="number">0</span>], nums[i]</span><br><span class="line">            self.max_heapify(nums, <span class="number">0</span>, i)</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortArray</span>(<span class="params">self, nums: List[int]</span>) -&gt; List[int]:</span></span><br><span class="line">        self.heap_sort(nums)</span><br><span class="line">        <span class="keyword">return</span> nums</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">heap_sort(self, nums):</span><br><span class="line">self.build_heap(nums)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(heap) - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span> - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line"></span><br><span class="line">    i = <span class="number">4</span></span><br><span class="line">    self.max_heapify(heap, i, len(heap))</span><br><span class="line">    self.max_heapify(heap, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">    p = root = <span class="number">4</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">9</span> &gt; heap_len = <span class="number">5</span></span><br><span class="line">        不进入循环</span><br><span class="line">    </span><br><span class="line">    i = <span class="number">3</span></span><br><span class="line">    self.max_heapify(heap, i, len(heap))</span><br><span class="line">    self.max_heapify(heap, <span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line">    p = root = <span class="number">3</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">7</span> &gt; heap_len = <span class="number">5</span></span><br><span class="line">        不进入循环</span><br><span class="line"></span><br><span class="line">    i = <span class="number">2</span></span><br><span class="line">    self.max_heapify(heap, i, len(heap))</span><br><span class="line">    self.max_heapify(heap, <span class="number">2</span>, <span class="number">5</span>)</span><br><span class="line">    p = root = <span class="number">2</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">5</span> = heap_len = <span class="number">5</span></span><br><span class="line">        不进入循环    </span><br><span class="line"></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    self.max_heapify(heap, i, len(heap))</span><br><span class="line">    self.max_heapify(heap, <span class="number">1</span>, <span class="number">5</span>)</span><br><span class="line">    p = root = <span class="number">1</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> &lt; heap_len = <span class="number">5</span></span><br><span class="line">        [<span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>]</span><br><span class="line">        l = p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> * <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">        r = p * <span class="number">2</span> + <span class="number">2</span> = <span class="number">1</span> * <span class="number">2</span> + <span class="number">2</span> = <span class="number">4</span></span><br><span class="line">        heap_len = <span class="number">5</span> &gt; r = <span class="number">4</span> </span><br><span class="line">        heap[r] = heap[<span class="number">4</span>] = <span class="number">9</span> &gt; heap[l] = heap[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">        nex = r = <span class="number">4</span></span><br><span class="line">        heap[p] = heap[<span class="number">1</span>] = <span class="number">6</span> &lt; heap[nex] = heap[<span class="number">4</span>] = <span class="number">9</span>:</span><br><span class="line">        heap[p] = heap[nex] = heap[<span class="number">1</span>] = heap[<span class="number">4</span>] = <span class="number">9</span></span><br><span class="line">        heap[nex] = heap[p] = heap[<span class="number">4</span>] = heap[<span class="number">1</span>] = <span class="number">6</span></span><br><span class="line">        [<span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">        p = nex = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">9</span> &gt; heap_len = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    self.max_heapify(heap, i, len(heap))</span><br><span class="line">    self.max_heapify(heap, <span class="number">0</span>, <span class="number">5</span>)</span><br><span class="line">    p = root = <span class="number">0</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> &lt; heap_len = <span class="number">5</span></span><br><span class="line">        l = p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">        r = p * <span class="number">2</span> + <span class="number">2</span> = <span class="number">1</span> * <span class="number">2</span> + <span class="number">2</span> = <span class="number">2</span></span><br><span class="line">        heap_len = <span class="number">5</span> &gt; r = <span class="number">2</span> </span><br><span class="line">        heap[r] = heap[<span class="number">2</span>] = <span class="number">8</span> &lt; heap[l] = heap[<span class="number">1</span>] = <span class="number">9</span></span><br><span class="line">        nex = l = <span class="number">1</span></span><br><span class="line">        heap[p] = heap[<span class="number">0</span>] = <span class="number">4</span> &lt; heap[nex] = heap[<span class="number">1</span>] = <span class="number">9</span></span><br><span class="line">        heap[p] = heap[nex] = heap[<span class="number">0</span>] = heap[<span class="number">1</span>] = <span class="number">9</span></span><br><span class="line">        heap[nex] = heap[p] = heap[<span class="number">1</span>] = heap[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">        [<span class="number">9</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">        p = nex = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> &lt; heap_len = <span class="number">5</span></span><br><span class="line">        再循环</span><br><span class="line">        l = p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> * <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span></span><br><span class="line">        r = p * <span class="number">2</span> + <span class="number">2</span> = <span class="number">1</span> * <span class="number">2</span> + <span class="number">2</span> = <span class="number">4</span></span><br><span class="line">        heap_len = <span class="number">5</span> &gt; r = <span class="number">4</span> </span><br><span class="line">        heap[r] = heap[<span class="number">4</span>] = <span class="number">6</span> &gt; heap[l] = heap[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">        nex = r = <span class="number">4</span></span><br><span class="line">        heap[p] = heap[<span class="number">1</span>] = <span class="number">4</span> &lt; heap[nex] = heap[<span class="number">4</span>] = <span class="number">6</span>:</span><br><span class="line">        heap[p] = heap[nex] = heap[<span class="number">1</span>] = heap[<span class="number">4</span>] = <span class="number">6</span></span><br><span class="line">        heap[nex] = heap[p] = heap[<span class="number">4</span>] = heap[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line">        [<span class="number">9</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">4</span>]</span><br><span class="line">        p = nex = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">9</span> &gt; heap_len = <span class="number">5</span></span><br><span class="line">        退出循环</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums) - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span> - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">    i = <span class="number">4</span></span><br><span class="line">    nums[<span class="number">4</span>] = nums[<span class="number">0</span>] = <span class="number">9</span></span><br><span class="line">    nums[<span class="number">0</span>] = nums[i] = <span class="number">4</span></span><br><span class="line">    [<span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>]</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, i)</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line">    p = root = <span class="number">0</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> &lt; heap_len = <span class="number">4</span></span><br><span class="line">        l = p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">0</span> * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">        r = p * <span class="number">2</span> + <span class="number">2</span> = <span class="number">0</span> * <span class="number">2</span> + <span class="number">2</span> = <span class="number">2</span></span><br><span class="line">        heap_len = <span class="number">4</span> &gt; r = <span class="number">2</span> </span><br><span class="line">        heap[r] = heap[<span class="number">2</span>] = <span class="number">8</span> &gt; heap[l] = heap[<span class="number">1</span>] = <span class="number">6</span></span><br><span class="line">        nex = r = <span class="number">2</span></span><br><span class="line">        heap[p] = heap[<span class="number">0</span>] = <span class="number">4</span> &lt; heap[nex] = heap[<span class="number">2</span>] = <span class="number">8</span></span><br><span class="line">        heap[p] = heap[nex] = heap[<span class="number">0</span>] = heap[<span class="number">2</span>] = <span class="number">8</span></span><br><span class="line">        heap[nex] = heap[p] = heap[<span class="number">2</span>] = heap[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">        [<span class="number">8</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">9</span>]</span><br><span class="line">        p = nex = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">5</span> &gt; heap_len = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">3</span></span><br><span class="line">    nums[i] = nums[<span class="number">3</span>] = nums[<span class="number">0</span>] = <span class="number">8</span></span><br><span class="line">    nums[<span class="number">0</span>] = nums[i] = nums[<span class="number">3</span>] = <span class="number">5</span></span><br><span class="line">    [<span class="number">5</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, i)</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, <span class="number">3</span>)</span><br><span class="line">    p = root = <span class="number">0</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> &lt; heap_len = <span class="number">3</span></span><br><span class="line">        l = p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">0</span> * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">        r = p * <span class="number">2</span> + <span class="number">2</span> = <span class="number">0</span> * <span class="number">2</span> + <span class="number">2</span> = <span class="number">2</span></span><br><span class="line">        heap_len = <span class="number">3</span> &gt; r = <span class="number">2</span> </span><br><span class="line">        heap[r] = heap[<span class="number">2</span>] = <span class="number">4</span> &lt; heap[l] = heap[<span class="number">1</span>] = <span class="number">6</span></span><br><span class="line">        nex = l = <span class="number">1</span> </span><br><span class="line">        heap[p] = heap[<span class="number">0</span>] = <span class="number">5</span> &lt; heap[nex] = heap[<span class="number">1</span>] = <span class="number">6</span></span><br><span class="line">        heap[p] = heap[nex] = heap[<span class="number">0</span>] = heap[<span class="number">1</span>] = <span class="number">6</span></span><br><span class="line">        heap[nex] = heap[p] = heap[<span class="number">1</span>] = heap[<span class="number">0</span>] = <span class="number">5</span></span><br><span class="line">        [<span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">        p = nex = <span class="number">1</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> = heap_len = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">    i = <span class="number">2</span></span><br><span class="line">    nums[i] = nums[<span class="number">2</span>] = nums[<span class="number">0</span>] = <span class="number">6</span></span><br><span class="line">    nums[<span class="number">0</span>] = nums[i] = nums[<span class="number">2</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, i)</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">    p = root = <span class="number">0</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> &lt; heap_len = <span class="number">2</span></span><br><span class="line">        l = p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">0</span> * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span></span><br><span class="line">        r = p * <span class="number">2</span> + <span class="number">2</span> = <span class="number">0</span> * <span class="number">2</span> + <span class="number">2</span> = <span class="number">2</span></span><br><span class="line">        heap_len = <span class="number">2</span> = r = <span class="number">2</span> </span><br><span class="line">        heap[r] = heap[<span class="number">2</span>] = <span class="number">6</span> &gt; heap[l] = heap[<span class="number">1</span>] = <span class="number">6</span></span><br><span class="line">        nex = l = <span class="number">1</span> </span><br><span class="line">        heap[p] = heap[<span class="number">0</span>] = <span class="number">4</span> &lt; heap[nex] = heap[<span class="number">1</span>] = <span class="number">5</span></span><br><span class="line">        heap[p] = heap[nex] = heap[<span class="number">0</span>] = heap[<span class="number">1</span>] = <span class="number">5</span></span><br><span class="line">        heap[nex] = heap[p] = heap[<span class="number">1</span>] = heap[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">        [<span class="number">5</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">        p = nex = <span class="number">1</span> </span><br><span class="line"></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">3</span> &gt; heap_len = <span class="number">2</span></span><br><span class="line">    </span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    nums[i] = nums[<span class="number">1</span>] = nums[<span class="number">0</span>] = <span class="number">5</span></span><br><span class="line">    nums[<span class="number">0</span>] = nums[i] = nums[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, i)</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    p = root = <span class="number">0</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> = heap_len = <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    nums[i] = nums[<span class="number">0</span>] = nums[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    nums[<span class="number">0</span>] = nums[i] = nums[<span class="number">0</span>] = <span class="number">4</span></span><br><span class="line">    [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, i)</span><br><span class="line">    self.max_heapify(nums, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    p = root = <span class="number">0</span></span><br><span class="line">        p * <span class="number">2</span> + <span class="number">1</span> = <span class="number">1</span> &gt; heap_len = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> nums</span><br></pre></td></tr></tbody></table></figure>


<p>完全二叉树有个重要性质，对于第一个非叶子节点的索引是 n/2 取整数得到的索引值，<br>其中 n 是元素个数(前提是数组索引从 1 开始计算)。</p>
<figure class="highlight angelscript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">建立大顶堆</span><br><span class="line">    <span class="number">4</span></span><br><span class="line">   /  \</span><br><span class="line">  <span class="number">6</span>    <span class="number">8</span></span><br><span class="line"> / \  </span><br><span class="line"><span class="number">5</span>   <span class="number">9</span></span><br><span class="line"><span class="number">6</span> 是第一个非叶子节点，从它开始逐一向前分别把每个元素作为根节点进行 shift down 操作</span><br><span class="line"><span class="number">6</span> 和 <span class="number">9</span> 交换位置。</span><br><span class="line">满足最大堆的性质。</span><br><span class="line"></span><br><span class="line">    <span class="number">4</span></span><br><span class="line">   /  \</span><br><span class="line">  <span class="number">9</span>    <span class="number">8</span></span><br><span class="line"> / \  </span><br><span class="line"><span class="number">5</span>   <span class="number">6</span></span><br><span class="line">对根节点<span class="number">4</span> 元素进行 shift down 操作</span><br><span class="line"></span><br><span class="line">    <span class="number">9</span></span><br><span class="line">   /  \</span><br><span class="line">  <span class="number">4</span>    <span class="number">8</span></span><br><span class="line"> / \  </span><br><span class="line"><span class="number">5</span>   <span class="number">6</span></span><br><span class="line">对<span class="number">6</span> 元素进行 shift down 操作</span><br><span class="line"></span><br><span class="line">    <span class="number">9</span></span><br><span class="line">   /  \</span><br><span class="line">  <span class="number">6</span>    <span class="number">8</span></span><br><span class="line"> / \  </span><br><span class="line"><span class="number">5</span>   <span class="number">4</span></span><br><span class="line"></span><br><span class="line">此时整个序列最大值即为堆顶元素，</span><br><span class="line">我们将其与末尾元素交换，使末尾元素为最大值，</span><br><span class="line">然后再调整堆顶元素使得剩下的 n<span class="number">-1</span> 个元素仍为大根堆，</span><br><span class="line">再重复执行以上操作我们即能得到一个有序的序列。</span><br><span class="line"></span><br><span class="line">    <span class="number">4</span></span><br><span class="line">   /  \</span><br><span class="line">  <span class="number">6</span>    <span class="number">8</span></span><br><span class="line"> / \  </span><br><span class="line"><span class="number">5</span>   <span class="number">9</span></span><br><span class="line"></span><br><span class="line">    <span class="number">8</span></span><br><span class="line">   /  \</span><br><span class="line">  <span class="number">6</span>    <span class="number">4</span></span><br><span class="line"> / \  </span><br><span class="line"><span class="number">5</span>   <span class="number">9</span></span><br><span class="line"></span><br><span class="line">    <span class="number">5</span></span><br><span class="line">   / \</span><br><span class="line">  <span class="number">6</span>   <span class="number">4</span> </span><br><span class="line"> / \  </span><br><span class="line"><span class="number">8</span>   <span class="number">9</span></span><br><span class="line"></span><br><span class="line">    <span class="number">6</span></span><br><span class="line">   / \</span><br><span class="line">  <span class="number">5</span>   <span class="number">4</span> </span><br><span class="line"> / \  </span><br><span class="line"><span class="number">8</span>   <span class="number">9</span></span><br><span class="line"></span><br><span class="line">    <span class="number">4</span></span><br><span class="line">   / \</span><br><span class="line">  <span class="number">5</span>   <span class="number">6</span> </span><br><span class="line"> / \  </span><br><span class="line"><span class="number">8</span>   <span class="number">9</span></span><br><span class="line"></span><br><span class="line">    <span class="number">5</span></span><br><span class="line">   / \</span><br><span class="line">  <span class="number">4</span>   <span class="number">6</span> </span><br><span class="line"> / \  </span><br><span class="line"><span class="number">8</span>   <span class="number">9</span></span><br><span class="line">  </span><br><span class="line">    <span class="number">4</span></span><br><span class="line">   / \</span><br><span class="line">  <span class="number">5</span>   <span class="number">6</span> </span><br><span class="line"> / \  </span><br><span class="line"><span class="number">8</span>   <span class="number">9</span></span><br></pre></td></tr></tbody></table></figure>

<p>法二</p>
<figure class="highlight py"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">heap_sort</span>(<span class="params">nums</span>):</span></span><br><span class="line">    <span class="comment"># 调整堆</span></span><br><span class="line">    <span class="comment"># 迭代写法</span></span><br><span class="line">    <span class="comment"># def adjust_heap(nums, startpos, endpos):</span></span><br><span class="line">    <span class="comment">#     newitem = nums[startpos]</span></span><br><span class="line">    <span class="comment">#     pos = startpos</span></span><br><span class="line">    <span class="comment">#     childpos = pos * 2 + 1</span></span><br><span class="line">    <span class="comment">#     while childpos &lt; endpos:</span></span><br><span class="line">    <span class="comment">#         rightpos = childpos + 1</span></span><br><span class="line">    <span class="comment">#         if rightpos &lt; endpos and nums[rightpos] &gt;= nums[childpos]:</span></span><br><span class="line">    <span class="comment">#             childpos = rightpos</span></span><br><span class="line">    <span class="comment">#         if newitem &lt; nums[childpos]:</span></span><br><span class="line">    <span class="comment">#             nums[pos] = nums[childpos]</span></span><br><span class="line">    <span class="comment">#             pos = childpos</span></span><br><span class="line">    <span class="comment">#             childpos = pos * 2 + 1</span></span><br><span class="line">    <span class="comment">#         else:</span></span><br><span class="line">    <span class="comment">#             break</span></span><br><span class="line">    <span class="comment">#     nums[pos] = newitem</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 递归写法</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">adjust_heap</span>(<span class="params">nums, startpos, endpos</span>):</span></span><br><span class="line">        pos = startpos</span><br><span class="line">        chilidpos = pos * <span class="number">2</span> + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> chilidpos &lt; endpos:</span><br><span class="line">            rightpos = chilidpos + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> rightpos &lt; endpos <span class="keyword">and</span> nums[rightpos] &gt; nums[chilidpos]:</span><br><span class="line">                chilidpos = rightpos</span><br><span class="line">            <span class="keyword">if</span> nums[chilidpos] &gt; nums[pos]:</span><br><span class="line">                nums[pos], nums[chilidpos] = nums[chilidpos], nums[pos]</span><br><span class="line">                adjust_heap(nums, pos, endpos)</span><br><span class="line"></span><br><span class="line">    n = len(nums)</span><br><span class="line">    <span class="comment"># 建堆</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> reversed(range(n // <span class="number">2</span>)):</span><br><span class="line">        adjust_heap(nums, i, n)</span><br><span class="line">    <span class="comment"># 调整堆</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">        nums[<span class="number">0</span>], nums[i] = nums[i], nums[<span class="number">0</span>]</span><br><span class="line">        adjust_heap(nums, <span class="number">0</span>, i)</span><br><span class="line">    <span class="keyword">return</span> nums</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">alist = [<span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>]</span><br><span class="line">heap_sort(alist)</span><br><span class="line">print(alist)</span><br><span class="line"><span class="comment"># [4, 5, 6, 8, 9]</span></span><br></pre></td></tr></tbody></table></figure>

<h1 id="Top-K-问题"><a href="#Top-K-问题" class="headerlink" title="Top K 问题"></a>Top K 问题</h1><p>面试题中有这样一类问题，让求出大量数据中的top k 个元素，比如一亿个数字中最大的100个数字。<br>对于这种问题有很多种解法，比如直接排序、mapreduce、trie 树、分治法等，当然如果内存够用直接排序是最简单的。<br>如果内存不够用呢？ 这里我们提一下使用固定大小的堆来解决这个问题的方式。</p>
<p>一开始的思路可能是，既然求最大的 k 个数，是不是应该维护一个包含 k 个元素的最大堆呢？<br>稍微尝试下你会发现走不通。我们先用数组的前面 k 个元素建立最大堆，然后对剩下的元素进行比对，但是最大堆只能每次获取堆顶<br>最大的一个元素，如果我们取下一个大于堆顶的值和堆顶替换，你会发现堆底部的小数一直不会被换掉。如果下一个元素小于堆顶<br>就替换也不对，这样可能最大的元素就被我们丢掉了。</p>
<p>相反我们用最小堆呢？<br>先迭代前 k 个元素建立一个最小堆，之后的元素如果小于堆顶最小值，跳过，否则替换堆顶元素并重新调整堆。你会发现最小堆里<br>慢慢就被替换成了最大的那些值，并且最后堆顶是最大的 topk 个值中的最小值。<br>（比如1000个数找10个，最后堆里剩余的是 [990, 991, 992, 996, 994, 993, 997, 998, 999, 995]，第一个 990 最小)</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TopK</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    获取大量元素 topk 大个元素，固定内存</span></span><br><span class="line"><span class="string">    思路：</span></span><br><span class="line"><span class="string">    1.先放入元素前 K 个建立最小堆</span></span><br><span class="line"><span class="string">    2.迭代剩余元素：</span></span><br><span class="line"><span class="string">        如果当前元素小于堆顶元素，跳过该元素(肯定不是前 K 大)</span></span><br><span class="line"><span class="string">        否则替换堆顶元素为当前元素，并重新调整堆</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, iterable, k</span>):</span></span><br><span class="line">        self.minheap = []         <span class="comment"># 定义最小堆</span></span><br><span class="line">        self.capacity = k         <span class="comment"># 最小堆容量为k个元素</span></span><br><span class="line">        self.iterable = iterable</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span>(<span class="params">self, val</span>):</span></span><br><span class="line">        <span class="keyword">if</span> len(self.minheap) &gt;= self.capacity:</span><br><span class="line">            min_val = self.minheap[<span class="number">0</span>]  </span><br><span class="line">            <span class="keyword">if</span> val &lt; min_val: </span><br><span class="line">                <span class="comment"># 当然你可以直接 if val &gt; min_val操作，这里我只是显示指出跳过这个元素</span></span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 返回并且pop堆顶最小值，推入新的 val 值并调整堆</span></span><br><span class="line">                heapq.heapreplace(self.minheap, val)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 前面k个元素直接放入minheap</span></span><br><span class="line">            heapq.heappush(self.minheap, val)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_topk</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> val <span class="keyword">in</span> self.iterable:</span><br><span class="line">            self.push(val)</span><br><span class="line">        <span class="keyword">return</span> self.minheap</span><br><span class="line">            </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span>():</span></span><br><span class="line">    <span class="keyword">import</span> random</span><br><span class="line">    i = list(range(<span class="number">100</span>)) <span class="comment"># 这里可以是一个可迭代元素，节省内存</span></span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    random.shuffle(i)</span><br><span class="line">    _ = TopK(i, <span class="number">10</span>)</span><br><span class="line">    print(_.get_topk())</span><br><span class="line"> </span><br><span class="line">test()</span><br><span class="line"><span class="comment"># [90, 91, 93, 92, 97, 96, 94, 95, 98, 99]</span></span><br></pre></td></tr></tbody></table></figure>

<p>o(n^2)级别排序算法</p>
<p>为什么要学习O(n^2)的排序方法？<br>● 基础<br>● 编码简单，易于实现，是一些简单情景的首选<br>● 在一些特殊情况下，简单的排序算法更有效<br>● 简单的排序算法思想衍生出复杂的排序算法<br>● 作为子过程，改进更复杂的排序算法</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/31/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/31/">31</a><span class="page-number current">32</span><a class="page-number" href="/page/33/">33</a><a class="page-number" href="/page/34/">34</a><a class="extend next" rel="next" href="/page/33/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">外心人D</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
